(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const I of document.querySelectorAll('link[rel="modulepreload"]'))S(I);new MutationObserver(I=>{for(const B of I)if(B.type==="childList")for(const M of B.addedNodes)M.tagName==="LINK"&&M.rel==="modulepreload"&&S(M)}).observe(document,{childList:!0,subtree:!0});function T(I){const B={};return I.integrity&&(B.integrity=I.integrity),I.referrerPolicy&&(B.referrerPolicy=I.referrerPolicy),I.crossOrigin==="use-credentials"?B.credentials="include":I.crossOrigin==="anonymous"?B.credentials="omit":B.credentials="same-origin",B}function S(I){if(I.ep)return;I.ep=!0;const B=T(I);fetch(I.href,B)}})();function Ov(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var o_={exports:{}},Hm={};var ix;function lw(){if(ix)return Hm;ix=1;var d=Symbol.for("react.transitional.element"),g=Symbol.for("react.fragment");function T(S,I,B){var M=null;if(B!==void 0&&(M=""+B),I.key!==void 0&&(M=""+I.key),"key"in I){B={};for(var c in I)c!=="key"&&(B[c]=I[c])}else B=I;return I=B.ref,{$$typeof:d,type:S,key:M,ref:I!==void 0?I:null,props:B}}return Hm.Fragment=g,Hm.jsx=T,Hm.jsxs=T,Hm}var nx;function cw(){return nx||(nx=1,o_.exports=lw()),o_.exports}var R=cw(),l_={exports:{}},oi={};var rx;function uw(){if(rx)return oi;rx=1;var d=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),B=Symbol.for("react.consumer"),M=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),X=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),te=Symbol.for("react.activity"),de=Symbol.iterator;function De(Ee){return Ee===null||typeof Ee!="object"?null:(Ee=de&&Ee[de]||Ee["@@iterator"],typeof Ee=="function"?Ee:null)}var Ze={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xe=Object.assign,le={};function Xe(Ee,ot,St){this.props=Ee,this.context=ot,this.refs=le,this.updater=St||Ze}Xe.prototype.isReactComponent={},Xe.prototype.setState=function(Ee,ot){if(typeof Ee!="object"&&typeof Ee!="function"&&Ee!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ee,ot,"setState")},Xe.prototype.forceUpdate=function(Ee){this.updater.enqueueForceUpdate(this,Ee,"forceUpdate")};function Ve(){}Ve.prototype=Xe.prototype;function Ue(Ee,ot,St){this.props=Ee,this.context=ot,this.refs=le,this.updater=St||Ze}var gt=Ue.prototype=new Ve;gt.constructor=Ue,xe(gt,Xe.prototype),gt.isPureReactComponent=!0;var pt=Array.isArray;function Dt(){}var _t={H:null,A:null,T:null,S:null},Mt=Object.prototype.hasOwnProperty;function Ot(Ee,ot,St){var zt=St.ref;return{$$typeof:d,type:Ee,key:ot,ref:zt!==void 0?zt:null,props:St}}function si(Ee,ot){return Ot(Ee.type,ot,Ee.props)}function Gi(Ee){return typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===d}function ki(Ee){var ot={"=":"=0",":":"=2"};return"$"+Ee.replace(/[=:]/g,function(St){return ot[St]})}var Bn=/\/+/g;function yr(Ee,ot){return typeof Ee=="object"&&Ee!==null&&Ee.key!=null?ki(""+Ee.key):ot.toString(36)}function On(Ee){switch(Ee.status){case"fulfilled":return Ee.value;case"rejected":throw Ee.reason;default:switch(typeof Ee.status=="string"?Ee.then(Dt,Dt):(Ee.status="pending",Ee.then(function(ot){Ee.status==="pending"&&(Ee.status="fulfilled",Ee.value=ot)},function(ot){Ee.status==="pending"&&(Ee.status="rejected",Ee.reason=ot)})),Ee.status){case"fulfilled":return Ee.value;case"rejected":throw Ee.reason}}throw Ee}function Je(Ee,ot,St,zt,Ht){var Nt=typeof Ee;(Nt==="undefined"||Nt==="boolean")&&(Ee=null);var hi=!1;if(Ee===null)hi=!0;else switch(Nt){case"bigint":case"string":case"number":hi=!0;break;case"object":switch(Ee.$$typeof){case d:case g:hi=!0;break;case K:return hi=Ee._init,Je(hi(Ee._payload),ot,St,zt,Ht)}}if(hi)return Ht=Ht(Ee),hi=zt===""?"."+yr(Ee,0):zt,pt(Ht)?(St="",hi!=null&&(St=hi.replace(Bn,"$&/")+"/"),Je(Ht,ot,St,"",function(va){return va})):Ht!=null&&(Gi(Ht)&&(Ht=si(Ht,St+(Ht.key==null||Ee&&Ee.key===Ht.key?"":(""+Ht.key).replace(Bn,"$&/")+"/")+hi)),ot.push(Ht)),1;hi=0;var Li=zt===""?".":zt+":";if(pt(Ee))for(var Xi=0;Xi<Ee.length;Xi++)zt=Ee[Xi],Nt=Li+yr(zt,Xi),hi+=Je(zt,ot,St,Nt,Ht);else if(Xi=De(Ee),typeof Xi=="function")for(Ee=Xi.call(Ee),Xi=0;!(zt=Ee.next()).done;)zt=zt.value,Nt=Li+yr(zt,Xi++),hi+=Je(zt,ot,St,Nt,Ht);else if(Nt==="object"){if(typeof Ee.then=="function")return Je(On(Ee),ot,St,zt,Ht);throw ot=String(Ee),Error("Objects are not valid as a React child (found: "+(ot==="[object Object]"?"object with keys {"+Object.keys(Ee).join(", ")+"}":ot)+"). If you meant to render a collection of children, use an array instead.")}return hi}function at(Ee,ot,St){if(Ee==null)return Ee;var zt=[],Ht=0;return Je(Ee,zt,"","",function(Nt){return ot.call(St,Nt,Ht++)}),zt}function Pt(Ee){if(Ee._status===-1){var ot=Ee._result;ot=ot(),ot.then(function(St){(Ee._status===0||Ee._status===-1)&&(Ee._status=1,Ee._result=St)},function(St){(Ee._status===0||Ee._status===-1)&&(Ee._status=2,Ee._result=St)}),Ee._status===-1&&(Ee._status=0,Ee._result=ot)}if(Ee._status===1)return Ee._result.default;throw Ee._result}var It=typeof reportError=="function"?reportError:function(Ee){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ot=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Ee=="object"&&Ee!==null&&typeof Ee.message=="string"?String(Ee.message):String(Ee),error:Ee});if(!window.dispatchEvent(ot))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Ee);return}console.error(Ee)},ni={map:at,forEach:function(Ee,ot,St){at(Ee,function(){ot.apply(this,arguments)},St)},count:function(Ee){var ot=0;return at(Ee,function(){ot++}),ot},toArray:function(Ee){return at(Ee,function(ot){return ot})||[]},only:function(Ee){if(!Gi(Ee))throw Error("React.Children.only expected to receive a single React element child.");return Ee}};return oi.Activity=te,oi.Children=ni,oi.Component=Xe,oi.Fragment=T,oi.Profiler=I,oi.PureComponent=Ue,oi.StrictMode=S,oi.Suspense=V,oi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=_t,oi.__COMPILER_RUNTIME={__proto__:null,c:function(Ee){return _t.H.useMemoCache(Ee)}},oi.cache=function(Ee){return function(){return Ee.apply(null,arguments)}},oi.cacheSignal=function(){return null},oi.cloneElement=function(Ee,ot,St){if(Ee==null)throw Error("The argument must be a React element, but you passed "+Ee+".");var zt=xe({},Ee.props),Ht=Ee.key;if(ot!=null)for(Nt in ot.key!==void 0&&(Ht=""+ot.key),ot)!Mt.call(ot,Nt)||Nt==="key"||Nt==="__self"||Nt==="__source"||Nt==="ref"&&ot.ref===void 0||(zt[Nt]=ot[Nt]);var Nt=arguments.length-2;if(Nt===1)zt.children=St;else if(1<Nt){for(var hi=Array(Nt),Li=0;Li<Nt;Li++)hi[Li]=arguments[Li+2];zt.children=hi}return Ot(Ee.type,Ht,zt)},oi.createContext=function(Ee){return Ee={$$typeof:M,_currentValue:Ee,_currentValue2:Ee,_threadCount:0,Provider:null,Consumer:null},Ee.Provider=Ee,Ee.Consumer={$$typeof:B,_context:Ee},Ee},oi.createElement=function(Ee,ot,St){var zt,Ht={},Nt=null;if(ot!=null)for(zt in ot.key!==void 0&&(Nt=""+ot.key),ot)Mt.call(ot,zt)&&zt!=="key"&&zt!=="__self"&&zt!=="__source"&&(Ht[zt]=ot[zt]);var hi=arguments.length-2;if(hi===1)Ht.children=St;else if(1<hi){for(var Li=Array(hi),Xi=0;Xi<hi;Xi++)Li[Xi]=arguments[Xi+2];Ht.children=Li}if(Ee&&Ee.defaultProps)for(zt in hi=Ee.defaultProps,hi)Ht[zt]===void 0&&(Ht[zt]=hi[zt]);return Ot(Ee,Nt,Ht)},oi.createRef=function(){return{current:null}},oi.forwardRef=function(Ee){return{$$typeof:c,render:Ee}},oi.isValidElement=Gi,oi.lazy=function(Ee){return{$$typeof:K,_payload:{_status:-1,_result:Ee},_init:Pt}},oi.memo=function(Ee,ot){return{$$typeof:X,type:Ee,compare:ot===void 0?null:ot}},oi.startTransition=function(Ee){var ot=_t.T,St={};_t.T=St;try{var zt=Ee(),Ht=_t.S;Ht!==null&&Ht(St,zt),typeof zt=="object"&&zt!==null&&typeof zt.then=="function"&&zt.then(Dt,It)}catch(Nt){It(Nt)}finally{ot!==null&&St.types!==null&&(ot.types=St.types),_t.T=ot}},oi.unstable_useCacheRefresh=function(){return _t.H.useCacheRefresh()},oi.use=function(Ee){return _t.H.use(Ee)},oi.useActionState=function(Ee,ot,St){return _t.H.useActionState(Ee,ot,St)},oi.useCallback=function(Ee,ot){return _t.H.useCallback(Ee,ot)},oi.useContext=function(Ee){return _t.H.useContext(Ee)},oi.useDebugValue=function(){},oi.useDeferredValue=function(Ee,ot){return _t.H.useDeferredValue(Ee,ot)},oi.useEffect=function(Ee,ot){return _t.H.useEffect(Ee,ot)},oi.useEffectEvent=function(Ee){return _t.H.useEffectEvent(Ee)},oi.useId=function(){return _t.H.useId()},oi.useImperativeHandle=function(Ee,ot,St){return _t.H.useImperativeHandle(Ee,ot,St)},oi.useInsertionEffect=function(Ee,ot){return _t.H.useInsertionEffect(Ee,ot)},oi.useLayoutEffect=function(Ee,ot){return _t.H.useLayoutEffect(Ee,ot)},oi.useMemo=function(Ee,ot){return _t.H.useMemo(Ee,ot)},oi.useOptimistic=function(Ee,ot){return _t.H.useOptimistic(Ee,ot)},oi.useReducer=function(Ee,ot,St){return _t.H.useReducer(Ee,ot,St)},oi.useRef=function(Ee){return _t.H.useRef(Ee)},oi.useState=function(Ee){return _t.H.useState(Ee)},oi.useSyncExternalStore=function(Ee,ot,St){return _t.H.useSyncExternalStore(Ee,ot,St)},oi.useTransition=function(){return _t.H.useTransition()},oi.version="19.2.4",oi}var ax;function r0(){return ax||(ax=1,l_.exports=uw()),l_.exports}var Se=r0();const hw=Ov(Se);var c_={exports:{}},$m={},u_={exports:{}},h_={};var sx;function dw(){return sx||(sx=1,(function(d){function g(Je,at){var Pt=Je.length;Je.push(at);e:for(;0<Pt;){var It=Pt-1>>>1,ni=Je[It];if(0<I(ni,at))Je[It]=at,Je[Pt]=ni,Pt=It;else break e}}function T(Je){return Je.length===0?null:Je[0]}function S(Je){if(Je.length===0)return null;var at=Je[0],Pt=Je.pop();if(Pt!==at){Je[0]=Pt;e:for(var It=0,ni=Je.length,Ee=ni>>>1;It<Ee;){var ot=2*(It+1)-1,St=Je[ot],zt=ot+1,Ht=Je[zt];if(0>I(St,Pt))zt<ni&&0>I(Ht,St)?(Je[It]=Ht,Je[zt]=Pt,It=zt):(Je[It]=St,Je[ot]=Pt,It=ot);else if(zt<ni&&0>I(Ht,Pt))Je[It]=Ht,Je[zt]=Pt,It=zt;else break e}}return at}function I(Je,at){var Pt=Je.sortIndex-at.sortIndex;return Pt!==0?Pt:Je.id-at.id}if(d.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var B=performance;d.unstable_now=function(){return B.now()}}else{var M=Date,c=M.now();d.unstable_now=function(){return M.now()-c}}var V=[],X=[],K=1,te=null,de=3,De=!1,Ze=!1,xe=!1,le=!1,Xe=typeof setTimeout=="function"?setTimeout:null,Ve=typeof clearTimeout=="function"?clearTimeout:null,Ue=typeof setImmediate<"u"?setImmediate:null;function gt(Je){for(var at=T(X);at!==null;){if(at.callback===null)S(X);else if(at.startTime<=Je)S(X),at.sortIndex=at.expirationTime,g(V,at);else break;at=T(X)}}function pt(Je){if(xe=!1,gt(Je),!Ze)if(T(V)!==null)Ze=!0,Dt||(Dt=!0,ki());else{var at=T(X);at!==null&&On(pt,at.startTime-Je)}}var Dt=!1,_t=-1,Mt=5,Ot=-1;function si(){return le?!0:!(d.unstable_now()-Ot<Mt)}function Gi(){if(le=!1,Dt){var Je=d.unstable_now();Ot=Je;var at=!0;try{e:{Ze=!1,xe&&(xe=!1,Ve(_t),_t=-1),De=!0;var Pt=de;try{t:{for(gt(Je),te=T(V);te!==null&&!(te.expirationTime>Je&&si());){var It=te.callback;if(typeof It=="function"){te.callback=null,de=te.priorityLevel;var ni=It(te.expirationTime<=Je);if(Je=d.unstable_now(),typeof ni=="function"){te.callback=ni,gt(Je),at=!0;break t}te===T(V)&&S(V),gt(Je)}else S(V);te=T(V)}if(te!==null)at=!0;else{var Ee=T(X);Ee!==null&&On(pt,Ee.startTime-Je),at=!1}}break e}finally{te=null,de=Pt,De=!1}at=void 0}}finally{at?ki():Dt=!1}}}var ki;if(typeof Ue=="function")ki=function(){Ue(Gi)};else if(typeof MessageChannel<"u"){var Bn=new MessageChannel,yr=Bn.port2;Bn.port1.onmessage=Gi,ki=function(){yr.postMessage(null)}}else ki=function(){Xe(Gi,0)};function On(Je,at){_t=Xe(function(){Je(d.unstable_now())},at)}d.unstable_IdlePriority=5,d.unstable_ImmediatePriority=1,d.unstable_LowPriority=4,d.unstable_NormalPriority=3,d.unstable_Profiling=null,d.unstable_UserBlockingPriority=2,d.unstable_cancelCallback=function(Je){Je.callback=null},d.unstable_forceFrameRate=function(Je){0>Je||125<Je?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Mt=0<Je?Math.floor(1e3/Je):5},d.unstable_getCurrentPriorityLevel=function(){return de},d.unstable_next=function(Je){switch(de){case 1:case 2:case 3:var at=3;break;default:at=de}var Pt=de;de=at;try{return Je()}finally{de=Pt}},d.unstable_requestPaint=function(){le=!0},d.unstable_runWithPriority=function(Je,at){switch(Je){case 1:case 2:case 3:case 4:case 5:break;default:Je=3}var Pt=de;de=Je;try{return at()}finally{de=Pt}},d.unstable_scheduleCallback=function(Je,at,Pt){var It=d.unstable_now();switch(typeof Pt=="object"&&Pt!==null?(Pt=Pt.delay,Pt=typeof Pt=="number"&&0<Pt?It+Pt:It):Pt=It,Je){case 1:var ni=-1;break;case 2:ni=250;break;case 5:ni=1073741823;break;case 4:ni=1e4;break;default:ni=5e3}return ni=Pt+ni,Je={id:K++,callback:at,priorityLevel:Je,startTime:Pt,expirationTime:ni,sortIndex:-1},Pt>It?(Je.sortIndex=Pt,g(X,Je),T(V)===null&&Je===T(X)&&(xe?(Ve(_t),_t=-1):xe=!0,On(pt,Pt-It))):(Je.sortIndex=ni,g(V,Je),Ze||De||(Ze=!0,Dt||(Dt=!0,ki()))),Je},d.unstable_shouldYield=si,d.unstable_wrapCallback=function(Je){var at=de;return function(){var Pt=de;de=at;try{return Je.apply(this,arguments)}finally{de=Pt}}}})(h_)),h_}var ox;function fw(){return ox||(ox=1,u_.exports=dw()),u_.exports}var d_={exports:{}},Va={};var lx;function pw(){if(lx)return Va;lx=1;var d=r0();function g(V){var X="https://react.dev/errors/"+V;if(1<arguments.length){X+="?args[]="+encodeURIComponent(arguments[1]);for(var K=2;K<arguments.length;K++)X+="&args[]="+encodeURIComponent(arguments[K])}return"Minified React error #"+V+"; visit "+X+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function T(){}var S={d:{f:T,r:function(){throw Error(g(522))},D:T,C:T,L:T,m:T,X:T,S:T,M:T},p:0,findDOMNode:null},I=Symbol.for("react.portal");function B(V,X,K){var te=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:I,key:te==null?null:""+te,children:V,containerInfo:X,implementation:K}}var M=d.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(V,X){if(V==="font")return"";if(typeof X=="string")return X==="use-credentials"?X:""}return Va.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,Va.createPortal=function(V,X){var K=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!X||X.nodeType!==1&&X.nodeType!==9&&X.nodeType!==11)throw Error(g(299));return B(V,X,null,K)},Va.flushSync=function(V){var X=M.T,K=S.p;try{if(M.T=null,S.p=2,V)return V()}finally{M.T=X,S.p=K,S.d.f()}},Va.preconnect=function(V,X){typeof V=="string"&&(X?(X=X.crossOrigin,X=typeof X=="string"?X==="use-credentials"?X:"":void 0):X=null,S.d.C(V,X))},Va.prefetchDNS=function(V){typeof V=="string"&&S.d.D(V)},Va.preinit=function(V,X){if(typeof V=="string"&&X&&typeof X.as=="string"){var K=X.as,te=c(K,X.crossOrigin),de=typeof X.integrity=="string"?X.integrity:void 0,De=typeof X.fetchPriority=="string"?X.fetchPriority:void 0;K==="style"?S.d.S(V,typeof X.precedence=="string"?X.precedence:void 0,{crossOrigin:te,integrity:de,fetchPriority:De}):K==="script"&&S.d.X(V,{crossOrigin:te,integrity:de,fetchPriority:De,nonce:typeof X.nonce=="string"?X.nonce:void 0})}},Va.preinitModule=function(V,X){if(typeof V=="string")if(typeof X=="object"&&X!==null){if(X.as==null||X.as==="script"){var K=c(X.as,X.crossOrigin);S.d.M(V,{crossOrigin:K,integrity:typeof X.integrity=="string"?X.integrity:void 0,nonce:typeof X.nonce=="string"?X.nonce:void 0})}}else X==null&&S.d.M(V)},Va.preload=function(V,X){if(typeof V=="string"&&typeof X=="object"&&X!==null&&typeof X.as=="string"){var K=X.as,te=c(K,X.crossOrigin);S.d.L(V,K,{crossOrigin:te,integrity:typeof X.integrity=="string"?X.integrity:void 0,nonce:typeof X.nonce=="string"?X.nonce:void 0,type:typeof X.type=="string"?X.type:void 0,fetchPriority:typeof X.fetchPriority=="string"?X.fetchPriority:void 0,referrerPolicy:typeof X.referrerPolicy=="string"?X.referrerPolicy:void 0,imageSrcSet:typeof X.imageSrcSet=="string"?X.imageSrcSet:void 0,imageSizes:typeof X.imageSizes=="string"?X.imageSizes:void 0,media:typeof X.media=="string"?X.media:void 0})}},Va.preloadModule=function(V,X){if(typeof V=="string")if(X){var K=c(X.as,X.crossOrigin);S.d.m(V,{as:typeof X.as=="string"&&X.as!=="script"?X.as:void 0,crossOrigin:K,integrity:typeof X.integrity=="string"?X.integrity:void 0})}else S.d.m(V)},Va.requestFormReset=function(V){S.d.r(V)},Va.unstable_batchedUpdates=function(V,X){return V(X)},Va.useFormState=function(V,X,K){return M.H.useFormState(V,X,K)},Va.useFormStatus=function(){return M.H.useHostTransitionStatus()},Va.version="19.2.4",Va}var cx;function mw(){if(cx)return d_.exports;cx=1;function d(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d)}catch(g){console.error(g)}}return d(),d_.exports=pw(),d_.exports}var ux;function gw(){if(ux)return $m;ux=1;var d=fw(),g=r0(),T=mw();function S(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)s+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function I(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function B(r){var s=r,h=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(h=s.return),r=s.return;while(r)}return s.tag===3?h:null}function M(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function c(r){if(r.tag===31){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function V(r){if(B(r)!==r)throw Error(S(188))}function X(r){var s=r.alternate;if(!s){if(s=B(r),s===null)throw Error(S(188));return s!==r?null:r}for(var h=r,_=s;;){var A=h.return;if(A===null)break;var z=A.alternate;if(z===null){if(_=A.return,_!==null){h=_;continue}break}if(A.child===z.child){for(z=A.child;z;){if(z===h)return V(A),r;if(z===_)return V(A),s;z=z.sibling}throw Error(S(188))}if(h.return!==_.return)h=A,_=z;else{for(var G=!1,ne=A.child;ne;){if(ne===h){G=!0,h=A,_=z;break}if(ne===_){G=!0,_=A,h=z;break}ne=ne.sibling}if(!G){for(ne=z.child;ne;){if(ne===h){G=!0,h=z,_=A;break}if(ne===_){G=!0,_=z,h=A;break}ne=ne.sibling}if(!G)throw Error(S(189))}}if(h.alternate!==_)throw Error(S(190))}if(h.tag!==3)throw Error(S(188));return h.stateNode.current===h?r:s}function K(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=K(r),s!==null)return s;r=r.sibling}return null}var te=Object.assign,de=Symbol.for("react.element"),De=Symbol.for("react.transitional.element"),Ze=Symbol.for("react.portal"),xe=Symbol.for("react.fragment"),le=Symbol.for("react.strict_mode"),Xe=Symbol.for("react.profiler"),Ve=Symbol.for("react.consumer"),Ue=Symbol.for("react.context"),gt=Symbol.for("react.forward_ref"),pt=Symbol.for("react.suspense"),Dt=Symbol.for("react.suspense_list"),_t=Symbol.for("react.memo"),Mt=Symbol.for("react.lazy"),Ot=Symbol.for("react.activity"),si=Symbol.for("react.memo_cache_sentinel"),Gi=Symbol.iterator;function ki(r){return r===null||typeof r!="object"?null:(r=Gi&&r[Gi]||r["@@iterator"],typeof r=="function"?r:null)}var Bn=Symbol.for("react.client.reference");function yr(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Bn?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case xe:return"Fragment";case Xe:return"Profiler";case le:return"StrictMode";case pt:return"Suspense";case Dt:return"SuspenseList";case Ot:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case Ze:return"Portal";case Ue:return r.displayName||"Context";case Ve:return(r._context.displayName||"Context")+".Consumer";case gt:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case _t:return s=r.displayName||null,s!==null?s:yr(r.type)||"Memo";case Mt:s=r._payload,r=r._init;try{return yr(r(s))}catch{}}return null}var On=Array.isArray,Je=g.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,at=T.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Pt={pending:!1,data:null,method:null,action:null},It=[],ni=-1;function Ee(r){return{current:r}}function ot(r){0>ni||(r.current=It[ni],It[ni]=null,ni--)}function St(r,s){ni++,It[ni]=r.current,r.current=s}var zt=Ee(null),Ht=Ee(null),Nt=Ee(null),hi=Ee(null);function Li(r,s){switch(St(Nt,s),St(Ht,r),St(zt,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?vc(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=vc(s),r=wm(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}ot(zt),St(zt,r)}function Xi(){ot(zt),ot(Ht),ot(Nt)}function va(r){r.memoizedState!==null&&St(hi,r);var s=zt.current,h=wm(s,r.type);s!==h&&(St(Ht,r),St(zt,h))}function Kr(r){Ht.current===r&&(ot(zt),ot(Ht)),hi.current===r&&(ot(hi),Rh._currentValue=Pt)}var Qr,kc;function sn(r){if(Qr===void 0)try{throw Error()}catch(h){var s=h.stack.trim().match(/\n( *(at )?)/);Qr=s&&s[1]||"",kc=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Qr+r+kc}var jr=!1;function Jr(r,s){if(!r||jr)return"";jr=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var _={DetermineComponentFrameRoot:function(){try{if(s){var ct=function(){throw Error()};if(Object.defineProperty(ct.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ct,[])}catch(Ke){var He=Ke}Reflect.construct(r,[],ct)}else{try{ct.call()}catch(Ke){He=Ke}r.call(ct.prototype)}}else{try{throw Error()}catch(Ke){He=Ke}(ct=r())&&typeof ct.catch=="function"&&ct.catch(function(){})}}catch(Ke){if(Ke&&He&&typeof Ke.stack=="string")return[Ke.stack,He.stack]}return[null,null]}};_.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(_.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(_.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var z=_.DetermineComponentFrameRoot(),G=z[0],ne=z[1];if(G&&ne){var we=G.split(`
`),Ge=ne.split(`
`);for(A=_=0;_<we.length&&!we[_].includes("DetermineComponentFrameRoot");)_++;for(;A<Ge.length&&!Ge[A].includes("DetermineComponentFrameRoot");)A++;if(_===we.length||A===Ge.length)for(_=we.length-1,A=Ge.length-1;1<=_&&0<=A&&we[_]!==Ge[A];)A--;for(;1<=_&&0<=A;_--,A--)if(we[_]!==Ge[A]){if(_!==1||A!==1)do if(_--,A--,0>A||we[_]!==Ge[A]){var et=`
`+we[_].replace(" at new "," at ");return r.displayName&&et.includes("<anonymous>")&&(et=et.replace("<anonymous>",r.displayName)),et}while(1<=_&&0<=A);break}}}finally{jr=!1,Error.prepareStackTrace=h}return(h=r?r.displayName||r.name:"")?sn(h):""}function on(r,s){switch(r.tag){case 26:case 27:case 5:return sn(r.type);case 16:return sn("Lazy");case 13:return r.child!==s&&s!==null?sn("Suspense Fallback"):sn("Suspense");case 19:return sn("SuspenseList");case 0:case 15:return Jr(r.type,!1);case 11:return Jr(r.type.render,!1);case 1:return Jr(r.type,!0);case 31:return sn("Activity");default:return""}}function cs(r){try{var s="",h=null;do s+=on(r,h),h=r,r=r.return;while(r);return s}catch(_){return`
Error generating stack: `+_.message+`
`+_.stack}}var ho=Object.prototype.hasOwnProperty,fo=d.unstable_scheduleCallback,ba=d.unstable_cancelCallback,Os=d.unstable_shouldYield,$o=d.unstable_requestPaint,Qn=d.unstable_now,ea=d.unstable_getCurrentPriorityLevel,Fs=d.unstable_ImmediatePriority,Nl=d.unstable_UserBlockingPriority,Ns=d.unstable_NormalPriority,Vl=d.unstable_LowPriority,Ce=d.unstable_IdlePriority,Y=d.log,W=d.unstable_setDisableYieldValue,J=null,pe=null;function ve(r){if(typeof Y=="function"&&W(r),pe&&typeof pe.setStrictMode=="function")try{pe.setStrictMode(J,r)}catch{}}var Pe=Math.clz32?Math.clz32:Re,ke=Math.log,ze=Math.LN2;function Re(r){return r>>>=0,r===0?32:31-(ke(r)/ze|0)|0}var nt=256,$e=262144,lt=4194304;function Te(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Ut(r,s,h){var _=r.pendingLanes;if(_===0)return 0;var A=0,z=r.suspendedLanes,G=r.pingedLanes;r=r.warmLanes;var ne=_&134217727;return ne!==0?(_=ne&~z,_!==0?A=Te(_):(G&=ne,G!==0?A=Te(G):h||(h=ne&~r,h!==0&&(A=Te(h))))):(ne=_&~z,ne!==0?A=Te(ne):G!==0?A=Te(G):h||(h=_&~r,h!==0&&(A=Te(h)))),A===0?0:s!==0&&s!==A&&(s&z)===0&&(z=A&-A,h=s&-s,z>=h||z===32&&(h&4194048)!==0)?s:A}function wi(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function At(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rt(){var r=lt;return lt<<=1,(lt&62914560)===0&&(lt=4194304),r}function Wt(r){for(var s=[],h=0;31>h;h++)s.push(r);return s}function qi(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Zi(r,s,h,_,A,z){var G=r.pendingLanes;r.pendingLanes=h,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=h,r.entangledLanes&=h,r.errorRecoveryDisabledLanes&=h,r.shellSuspendCounter=0;var ne=r.entanglements,we=r.expirationTimes,Ge=r.hiddenUpdates;for(h=G&~h;0<h;){var et=31-Pe(h),ct=1<<et;ne[et]=0,we[et]=-1;var He=Ge[et];if(He!==null)for(Ge[et]=null,et=0;et<He.length;et++){var Ke=He[et];Ke!==null&&(Ke.lane&=-536870913)}h&=~ct}_!==0&&Fn(r,_,0),z!==0&&A===0&&r.tag!==0&&(r.suspendedLanes|=z&~(G&~s))}function Fn(r,s,h){r.pendingLanes|=s,r.suspendedLanes&=~s;var _=31-Pe(s);r.entangledLanes|=s,r.entanglements[_]=r.entanglements[_]|1073741824|h&261930}function Nn(r,s){var h=r.entangledLanes|=s;for(r=r.entanglements;h;){var _=31-Pe(h),A=1<<_;A&s|r[_]&s&&(r[_]|=s),h&=~A}}function ln(r,s){var h=s&-s;return h=(h&42)!==0?1:Dn(h),(h&(r.suspendedLanes|s))!==0?0:h}function Dn(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function tt(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Tn(){var r=at.p;return r!==0?r:(r=window.event,r===void 0?32:zu(r.type))}function Er(r,s){var h=at.p;try{return at.p=r,s()}finally{at.p=h}}var Br=Math.random().toString(36).slice(2),ci="__reactFiber$"+Br,ht="__reactProps$"+Br,qt="__reactContainer$"+Br,Jt="__reactEvents$"+Br,ta="__reactListeners$"+Br,Ou="__reactHandles$"+Br,us="__reactResources$"+Br,Xt="__reactMarker$"+Br;function Xo(r){delete r[ci],delete r[ht],delete r[Jt],delete r[ta],delete r[Ou]}function hs(r){var s=r[ci];if(s)return s;for(var h=r.parentNode;h;){if(s=h[qt]||h[ci]){if(h=s.alternate,s.child!==null||h!==null&&h.child!==null)for(r=Bd(r);r!==null;){if(h=r[ci])return h;r=Bd(r)}return s}r=h,h=r.parentNode}return null}function Vs(r){if(r=r[ci]||r[qt]){var s=r.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return r}return null}function ds(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(S(33))}function fs(r){var s=r[us];return s||(s=r[us]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function fn(r){r[Xt]=!0}var Ul=new Set,_r={};function di(r,s){Us(r,s),Us(r+"Capture",s)}function Us(r,s){for(_r[r]=s,r=0;r<s.length;r++)Ul.add(s[r])}var Gl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ql={},po={};function qa(r){return ho.call(po,r)?!0:ho.call(ql,r)?!1:Gl.test(r)?po[r]=!0:(ql[r]=!0,!1)}function Lc(r,s,h){if(qa(s))if(h===null)r.removeAttribute(s);else{switch(typeof h){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var _=s.toLowerCase().slice(0,5);if(_!=="data-"&&_!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+h)}}function ps(r,s,h){if(h===null)r.removeAttribute(s);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+h)}}function wa(r,s,h,_){if(_===null)r.removeAttribute(h);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(h);return}r.setAttributeNS(s,h,""+_)}}function _i(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Zh(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function lf(r,s,h){var _=Object.getOwnPropertyDescriptor(r.constructor.prototype,s);if(!r.hasOwnProperty(s)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var A=_.get,z=_.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return A.call(this)},set:function(G){h=""+G,z.call(this,G)}}),Object.defineProperty(r,s,{enumerable:_.enumerable}),{getValue:function(){return h},setValue:function(G){h=""+G},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function Yo(r){if(!r._valueTracker){var s=Zh(r)?"checked":"value";r._valueTracker=lf(r,s,""+r[s])}}function Hh(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var h=s.getValue(),_="";return r&&(_=Zh(r)?r.checked?"true":"false":r.value),r=_,r!==h?(s.setValue(r),!0):!1}function jc(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var cf=/[\n"\\]/g;function Ar(r){return r.replace(cf,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Bc(r,s,h,_,A,z,G,ne){r.name="",G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?r.type=G:r.removeAttribute("type"),s!=null?G==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+_i(s)):r.value!==""+_i(s)&&(r.value=""+_i(s)):G!=="submit"&&G!=="reset"||r.removeAttribute("value"),s!=null?Oc(r,G,_i(s)):h!=null?Oc(r,G,_i(h)):_!=null&&r.removeAttribute("value"),A==null&&z!=null&&(r.defaultChecked=!!z),A!=null&&(r.checked=A&&typeof A!="function"&&typeof A!="symbol"),ne!=null&&typeof ne!="function"&&typeof ne!="symbol"&&typeof ne!="boolean"?r.name=""+_i(ne):r.removeAttribute("name")}function Fu(r,s,h,_,A,z,G,ne){if(z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(r.type=z),s!=null||h!=null){if(!(z!=="submit"&&z!=="reset"||s!=null)){Yo(r);return}h=h!=null?""+_i(h):"",s=s!=null?""+_i(s):h,ne||s===r.value||(r.value=s),r.defaultValue=s}_=_??A,_=typeof _!="function"&&typeof _!="symbol"&&!!_,r.checked=ne?r.checked:!!_,r.defaultChecked=!!_,G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"&&(r.name=G),Yo(r)}function Oc(r,s,h){s==="number"&&jc(r.ownerDocument)===r||r.defaultValue===""+h||(r.defaultValue=""+h)}function mo(r,s,h,_){if(r=r.options,s){s={};for(var A=0;A<h.length;A++)s["$"+h[A]]=!0;for(h=0;h<r.length;h++)A=s.hasOwnProperty("$"+r[h].value),r[h].selected!==A&&(r[h].selected=A),A&&_&&(r[h].defaultSelected=!0)}else{for(h=""+_i(h),s=null,A=0;A<r.length;A++){if(r[A].value===h){r[A].selected=!0,_&&(r[A].defaultSelected=!0);return}s!==null||r[A].disabled||(s=r[A])}s!==null&&(s.selected=!0)}}function uf(r,s,h){if(s!=null&&(s=""+_i(s),s!==r.value&&(r.value=s),h==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=h!=null?""+_i(h):""}function Zl(r,s,h,_){if(s==null){if(_!=null){if(h!=null)throw Error(S(92));if(On(_)){if(1<_.length)throw Error(S(93));_=_[0]}h=_}h==null&&(h=""),s=h}h=_i(s),r.defaultValue=h,_=r.textContent,_===h&&_!==""&&_!==null&&(r.value=_),Yo(r)}function Gs(r,s){if(s){var h=r.firstChild;if(h&&h===r.lastChild&&h.nodeType===3){h.nodeValue=s;return}}r.textContent=s}var hf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Wo(r,s,h){var _=s.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?_?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":_?r.setProperty(s,h):typeof h!="number"||h===0||hf.has(s)?s==="float"?r.cssFloat=h:r[s]=(""+h).trim():r[s]=h+"px"}function Nu(r,s,h){if(s!=null&&typeof s!="object")throw Error(S(62));if(r=r.style,h!=null){for(var _ in h)!h.hasOwnProperty(_)||s!=null&&s.hasOwnProperty(_)||(_.indexOf("--")===0?r.setProperty(_,""):_==="float"?r.cssFloat="":r[_]="");for(var A in s)_=s[A],s.hasOwnProperty(A)&&h[A]!==_&&Wo(r,A,_)}else for(var z in s)s.hasOwnProperty(z)&&Wo(r,z,s[z])}function Ko(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var go=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hl=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Qt(r){return Hl.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Za(){}var $h=null;function Fc(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Zn=null,zn=null;function Qi(r){var s=Vs(r);if(s&&(r=s.stateNode)){var h=r[ht]||null;e:switch(r=s.stateNode,s.type){case"input":if(Bc(r,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),s=h.name,h.type==="radio"&&s!=null){for(h=r;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Ar(""+s)+'"][type="radio"]'),s=0;s<h.length;s++){var _=h[s];if(_!==r&&_.form===r.form){var A=_[ht]||null;if(!A)throw Error(S(90));Bc(_,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name)}}for(s=0;s<h.length;s++)_=h[s],_.form===r.form&&Hh(_)}break e;case"textarea":uf(r,h.value,h.defaultValue);break e;case"select":s=h.value,s!=null&&mo(r,!!h.multiple,s,!1)}}}var Vt=!1;function ji(r,s,h){if(Vt)return r(s,h);Vt=!0;try{var _=r(s);return _}finally{if(Vt=!1,(Zn!==null||zn!==null)&&(Dd(),Zn&&(s=Zn,r=zn,zn=Zn=null,Qi(s),r)))for(s=0;s<r.length;s++)Qi(r[s])}}function Ta(r,s){var h=r.stateNode;if(h===null)return null;var _=h[ht]||null;if(_===null)return null;h=_[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(r=r.type,_=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!_;break e;default:r=!1}if(r)return null;if(h&&typeof h!="function")throw Error(S(231,s,typeof h));return h}var pn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cr=!1;if(pn)try{var Hn={};Object.defineProperty(Hn,"passive",{get:function(){Cr=!0}}),window.addEventListener("test",Hn,Hn),window.removeEventListener("test",Hn,Hn)}catch{Cr=!1}var ia=null,ms=null,Ji=null;function yo(){if(Ji)return Ji;var r,s=ms,h=s.length,_,A="value"in ia?ia.value:ia.textContent,z=A.length;for(r=0;r<h&&s[r]===A[r];r++);var G=h-r;for(_=1;_<=G&&s[h-_]===A[z-_];_++);return Ji=A.slice(r,1<_?1-_:void 0)}function na(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function Qo(){return!0}function Dr(){return!1}function Vn(r){function s(h,_,A,z,G){this._reactName=h,this._targetInst=A,this.type=_,this.nativeEvent=z,this.target=G,this.currentTarget=null;for(var ne in r)r.hasOwnProperty(ne)&&(h=r[ne],this[ne]=h?h(z):z[ne]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?Qo:Dr,this.isPropagationStopped=Dr,this}return te(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Qo)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Qo)},persist:function(){},isPersistent:Qo}),s}var zr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nc=Vn(zr),Jo=te({},zr,{view:0,detail:0}),el=Vn(Jo),Ci,_o,ri,Yt=te({},Jo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gc,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ri&&(ri&&r.type==="mousemove"?(Ci=r.screenX-ri.screenX,_o=r.screenY-ri.screenY):_o=Ci=0,ri=r),Ci)},movementY:function(r){return"movementY"in r?r.movementY:_o}}),tl=Vn(Yt),fi=te({},Yt,{dataTransfer:0}),Vc=Vn(fi),Sa=te({},Jo,{relatedTarget:0}),xo=Vn(Sa),vo=te({},zr,{animationName:0,elapsedTime:0,pseudoElement:0}),df=Vn(vo),Uc=te({},zr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Xh=Vn(Uc),Np=te({},zr,{data:0}),Yh=Vn(Np),Pr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},en={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function il(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=en[r])?!!s[r]:!1}function Gc(){return il}var qc=te({},Jo,{key:function(r){if(r.key){var s=Pr[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=na(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?gs[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gc,charCode:function(r){return r.type==="keypress"?na(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?na(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),mn=Vn(qc),ff=te({},Yt,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vu=Vn(ff),pf=te({},Jo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gc}),Vp=Vn(pf),$l=te({},zr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Uu=Vn($l),Xl=te({},Yt,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Wh=Vn(Xl),Zc=te({},zr,{newState:0,oldState:0}),Yl=Vn(Zc),Wl=[9,13,27,32],Sn=pn&&"CompositionEvent"in window,Kl=null;pn&&"documentMode"in document&&(Kl=document.documentMode);var Ql=pn&&"TextEvent"in window&&!Kl,Jl=pn&&(!Sn||Kl&&8<Kl&&11>=Kl),bo=" ",mf=!1;function Hc(r,s){switch(r){case"keyup":return Wl.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gf(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ha=!1;function Gu(r,s){switch(r){case"compositionend":return gf(s);case"keypress":return s.which!==32?null:(mf=!0,bo);case"textInput":return r=s.data,r===bo&&mf?null:r;default:return null}}function yf(r,s){if(Ha)return r==="compositionend"||!Sn&&Hc(r,s)?(r=yo(),Ji=ms=ia=null,Ha=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Jl&&s.locale!=="ko"?null:s.data;default:return null}}var _f={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qu(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!_f[r.type]:s==="textarea"}function Zu(r,s,h,_){Zn?zn?zn.push(_):zn=[_]:Zn=_,s=Rd(s,"onChange"),0<s.length&&(h=new Nc("onChange","change",null,h,_),r.push({event:h,listeners:s}))}var nl=null,ec=null;function xf(r){Xg(r,0)}function $c(r){var s=ds(r);if(Hh(s))return r}function wo(r,s){if(r==="change")return s}var Kh=!1;if(pn){var Xc;if(pn){var To="oninput"in document;if(!To){var Qh=document.createElement("div");Qh.setAttribute("oninput","return;"),To=typeof Qh.oninput=="function"}Xc=To}else Xc=!1;Kh=Xc&&(!document.documentMode||9<document.documentMode)}function Yc(){nl&&(nl.detachEvent("onpropertychange",vf),ec=nl=null)}function vf(r){if(r.propertyName==="value"&&$c(ec)){var s=[];Zu(s,ec,r,Fc(r)),ji(xf,s)}}function Up(r,s,h){r==="focusin"?(Yc(),nl=s,ec=h,nl.attachEvent("onpropertychange",vf)):r==="focusout"&&Yc()}function bf(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return $c(ec)}function Wc(r,s){if(r==="click")return $c(s)}function wf(r,s){if(r==="input"||r==="change")return $c(s)}function Jh(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Or=typeof Object.is=="function"?Object.is:Jh;function So(r,s){if(Or(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var h=Object.keys(r),_=Object.keys(s);if(h.length!==_.length)return!1;for(_=0;_<h.length;_++){var A=h[_];if(!ho.call(s,A)||!Or(r[A],s[A]))return!1}return!0}function Ma(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Kc(r,s){var h=Ma(r);r=0;for(var _;h;){if(h.nodeType===3){if(_=r+h.textContent.length,r<=s&&_>=s)return{node:h,offset:s-r};r=_}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Ma(h)}}function Hu(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?Hu(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function $u(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=jc(r.document);s instanceof r.HTMLIFrameElement;){try{var h=typeof s.contentWindow.location.href=="string"}catch{h=!1}if(h)r=s.contentWindow;else break;s=jc(r.document)}return s}function Qc(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var Xu=pn&&"documentMode"in document&&11>=document.documentMode,Ea=null,Jc=null,eu=null,Yu=!1;function Tf(r,s,h){var _=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Yu||Ea==null||Ea!==jc(_)||(_=Ea,"selectionStart"in _&&Qc(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),eu&&So(eu,_)||(eu=_,_=Rd(Jc,"onSelect"),0<_.length&&(s=new Nc("onSelect","select",null,s,h),r.push({event:s,listeners:_}),s.target=Ea)))}function rl(r,s){var h={};return h[r.toLowerCase()]=s.toLowerCase(),h["Webkit"+r]="webkit"+s,h["Moz"+r]="moz"+s,h}var al={animationend:rl("Animation","AnimationEnd"),animationiteration:rl("Animation","AnimationIteration"),animationstart:rl("Animation","AnimationStart"),transitionrun:rl("Transition","TransitionRun"),transitionstart:rl("Transition","TransitionStart"),transitioncancel:rl("Transition","TransitionCancel"),transitionend:rl("Transition","TransitionEnd")},ed={},xi={};pn&&(xi=document.createElement("div").style,"AnimationEvent"in window||(delete al.animationend.animation,delete al.animationiteration.animation,delete al.animationstart.animation),"TransitionEvent"in window||delete al.transitionend.transition);function ys(r){if(ed[r])return ed[r];if(!al[r])return r;var s=al[r],h;for(h in s)if(s.hasOwnProperty(h)&&h in xi)return ed[r]=s[h];return r}var tu=ys("animationend"),iu=ys("animationiteration"),Wu=ys("animationstart"),sl=ys("transitionrun"),nu=ys("transitionstart"),tc=ys("transitioncancel"),ra=ys("transitionend"),td=new Map,Ku="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ku.push("scrollEnd");function aa(r,s){td.set(r,s),di(s,[r])}var _s=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Ir=[],qs=0,ol=0;function ll(){for(var r=qs,s=ol=qs=0;s<r;){var h=Ir[s];Ir[s++]=null;var _=Ir[s];Ir[s++]=null;var A=Ir[s];Ir[s++]=null;var z=Ir[s];if(Ir[s++]=null,_!==null&&A!==null){var G=_.pending;G===null?A.next=A:(A.next=G.next,G.next=A),_.pending=A}z!==0&&id(h,A,z)}}function ru(r,s,h,_){Ir[qs++]=r,Ir[qs++]=s,Ir[qs++]=h,Ir[qs++]=_,ol|=_,r.lanes|=_,r=r.alternate,r!==null&&(r.lanes|=_)}function Mo(r,s,h,_){return ru(r,s,h,_),ic(r)}function Aa(r,s){return ru(r,null,null,s),ic(r)}function id(r,s,h){r.lanes|=h;var _=r.alternate;_!==null&&(_.lanes|=h);for(var A=!1,z=r.return;z!==null;)z.childLanes|=h,_=z.alternate,_!==null&&(_.childLanes|=h),z.tag===22&&(r=z.stateNode,r===null||r._visibility&1||(A=!0)),r=z,z=z.return;return r.tag===3?(z=r.stateNode,A&&s!==null&&(A=31-Pe(h),r=z.hiddenUpdates,_=r[A],_===null?r[A]=[s]:_.push(s),s.lane=h|536870912),z):null}function ic(r){if(50<Cd)throw Cd=0,sm=null,Error(S(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var Kt={};function Qu(r,s,h,_){this.tag=r,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sa(r,s,h,_){return new Qu(r,s,h,_)}function Ju(r){return r=r.prototype,!(!r||!r.isReactComponent)}function oa(r,s){var h=r.alternate;return h===null?(h=sa(r.tag,s,r.key,r.mode),h.elementType=r.elementType,h.type=r.type,h.stateNode=r.stateNode,h.alternate=r,r.alternate=h):(h.pendingProps=s,h.type=r.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=r.flags&65011712,h.childLanes=r.childLanes,h.lanes=r.lanes,h.child=r.child,h.memoizedProps=r.memoizedProps,h.memoizedState=r.memoizedState,h.updateQueue=r.updateQueue,s=r.dependencies,h.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},h.sibling=r.sibling,h.index=r.index,h.ref=r.ref,h.refCleanup=r.refCleanup,h}function Sf(r,s){r.flags&=65011714;var h=r.alternate;return h===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=h.childLanes,r.lanes=h.lanes,r.child=h.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=h.memoizedProps,r.memoizedState=h.memoizedState,r.updateQueue=h.updateQueue,r.type=h.type,s=h.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function eh(r,s,h,_,A,z){var G=0;if(_=r,typeof r=="function")Ju(r)&&(G=1);else if(typeof r=="string")G=yp(r,h,zt.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case Ot:return r=sa(31,h,s,A),r.elementType=Ot,r.lanes=z,r;case xe:return Eo(h.children,A,z,s);case le:G=8,A|=24;break;case Xe:return r=sa(12,h,s,A|2),r.elementType=Xe,r.lanes=z,r;case pt:return r=sa(13,h,s,A),r.elementType=pt,r.lanes=z,r;case Dt:return r=sa(19,h,s,A),r.elementType=Dt,r.lanes=z,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Ue:G=10;break e;case Ve:G=9;break e;case gt:G=11;break e;case _t:G=14;break e;case Mt:G=16,_=null;break e}G=29,h=Error(S(130,r===null?"null":typeof r,"")),_=null}return s=sa(G,h,s,A),s.elementType=r,s.type=_,s.lanes=z,s}function Eo(r,s,h,_){return r=sa(7,r,_,s),r.lanes=h,r}function nd(r,s,h){return r=sa(6,r,null,s),r.lanes=h,r}function th(r){var s=sa(18,null,null,0);return s.stateNode=r,s}function Ao(r,s,h){return s=sa(4,r.children!==null?r.children:[],r.key,s),s.lanes=h,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var nc=new WeakMap;function Rr(r,s){if(typeof r=="object"&&r!==null){var h=nc.get(r);return h!==void 0?h:(s={value:r,source:s,stack:cs(s)},nc.set(r,s),s)}return{value:r,source:s,stack:cs(s)}}var Co=[],Do=0,cl=null,zo=0,$n=[],Jn=0,xs=null,vs=1,Fr="";function Zs(r,s){Co[Do++]=zo,Co[Do++]=cl,cl=r,zo=s}function rd(r,s,h){$n[Jn++]=vs,$n[Jn++]=Fr,$n[Jn++]=xs,xs=r;var _=vs;r=Fr;var A=32-Pe(_)-1;_&=~(1<<A),h+=1;var z=32-Pe(s)+A;if(30<z){var G=A-A%5;z=(_&(1<<G)-1).toString(32),_>>=G,A-=G,vs=1<<32-Pe(s)+A|h<<A|_,Fr=z+r}else vs=1<<z|h<<A|_,Fr=r}function ul(r){r.return!==null&&(Zs(r,1),rd(r,1,0))}function rc(r){for(;r===cl;)cl=Co[--Do],Co[Do]=null,zo=Co[--Do],Co[Do]=null;for(;r===xs;)xs=$n[--Jn],$n[Jn]=null,Fr=$n[--Jn],$n[Jn]=null,vs=$n[--Jn],$n[Jn]=null}function ad(r,s){$n[Jn++]=vs,$n[Jn++]=Fr,$n[Jn++]=xs,vs=s.id,Fr=s.overflow,xs=r}var er=null,Bi=null,ui=!1,Hs=null,la=!1,cn=Error(S(519));function Nr(r){var s=Error(S(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw $s(Rr(s,r)),cn}function Vr(r){var s=r.stateNode,h=r.type,_=r.memoizedProps;switch(s[ci]=r,s[ht]=_,h){case"dialog":yi("cancel",s),yi("close",s);break;case"iframe":case"object":case"embed":yi("load",s);break;case"video":case"audio":for(h=0;h<xc.length;h++)yi(xc[h],s);break;case"source":yi("error",s);break;case"img":case"image":case"link":yi("error",s),yi("load",s);break;case"details":yi("toggle",s);break;case"input":yi("invalid",s),Fu(s,_.value,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name,!0);break;case"select":yi("invalid",s);break;case"textarea":yi("invalid",s),Zl(s,_.value,_.defaultValue,_.children)}h=_.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||s.textContent===""+h||_.suppressHydrationWarning===!0||vm(s.textContent,h)?(_.popover!=null&&(yi("beforetoggle",s),yi("toggle",s)),_.onScroll!=null&&yi("scroll",s),_.onScrollEnd!=null&&yi("scrollend",s),_.onClick!=null&&(s.onclick=Za),s=!0):s=!1,s||Nr(r,!0)}function au(r){for(er=r.return;er;)switch(er.tag){case 5:case 31:case 13:la=!1;return;case 27:case 3:la=!0;return;default:er=er.return}}function bs(r){if(r!==er)return!1;if(!ui)return au(r),ui=!0,!1;var s=r.tag,h;if((h=s!==3&&s!==27)&&((h=s===5)&&(h=r.type,h=!(h!=="form"&&h!=="button")||up(r.type,r.memoizedProps)),h=!h),h&&Bi&&Nr(r),au(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(S(317));Bi=lr(r)}else if(s===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(S(317));Bi=lr(r)}else s===27?(s=Bi,wc(r.type)?(r=ga,ga=null,Bi=r):Bi=s):Bi=er?rs(r.stateNode.nextSibling):null;return!0}function ws(){Bi=er=null,ui=!1}function Ts(){var r=Hs;return r!==null&&(Ba===null?Ba=r:Ba.push.apply(Ba,r),Hs=null),r}function $s(r){Hs===null?Hs=[r]:Hs.push(r)}var Xs=Ee(null),Ca=null,Ss=null;function Ys(r,s,h){St(Xs,s._currentValue),s._currentValue=h}function Ms(r){r._currentValue=Xs.current,ot(Xs)}function ih(r,s,h){for(;r!==null;){var _=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,_!==null&&(_.childLanes|=s)):_!==null&&(_.childLanes&s)!==s&&(_.childLanes|=s),r===h)break;r=r.return}}function nh(r,s,h,_){var A=r.child;for(A!==null&&(A.return=r);A!==null;){var z=A.dependencies;if(z!==null){var G=A.child;z=z.firstContext;e:for(;z!==null;){var ne=z;z=A;for(var we=0;we<s.length;we++)if(ne.context===s[we]){z.lanes|=h,ne=z.alternate,ne!==null&&(ne.lanes|=h),ih(z.return,h,r),_||(G=null);break e}z=ne.next}}else if(A.tag===18){if(G=A.return,G===null)throw Error(S(341));G.lanes|=h,z=G.alternate,z!==null&&(z.lanes|=h),ih(G,h,r),G=null}else G=A.child;if(G!==null)G.return=A;else for(G=A;G!==null;){if(G===r){G=null;break}if(A=G.sibling,A!==null){A.return=G.return,G=A;break}G=G.return}A=G}}function ca(r,s,h,_){r=null;for(var A=s,z=!1;A!==null;){if(!z){if((A.flags&524288)!==0)z=!0;else if((A.flags&262144)!==0)break}if(A.tag===10){var G=A.alternate;if(G===null)throw Error(S(387));if(G=G.memoizedProps,G!==null){var ne=A.type;Or(A.pendingProps.value,G.value)||(r!==null?r.push(ne):r=[ne])}}else if(A===hi.current){if(G=A.alternate,G===null)throw Error(S(387));G.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(r!==null?r.push(Rh):r=[Rh])}A=A.return}r!==null&&nh(s,r,h,_),s.flags|=262144}function ac(r){for(r=r.firstContext;r!==null;){if(!Or(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ws(r){Ca=r,Ss=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Pn(r){return rh(Ca,r)}function su(r,s){return Ca===null&&Ws(r),rh(r,s)}function rh(r,s){var h=s._currentValue;if(s={context:s,memoizedValue:h,next:null},Ss===null){if(r===null)throw Error(S(308));Ss=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else Ss=Ss.next=s;return h}var sd=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(h,_){r.push(_)}};this.abort=function(){s.aborted=!0,r.forEach(function(h){return h()})}},Mf=d.unstable_scheduleCallback,od=d.unstable_NormalPriority,Mn={$$typeof:Ue,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Es(){return{controller:new sd,data:new Map,refCount:0}}function sc(r){r.refCount--,r.refCount===0&&Mf(od,function(){r.controller.abort()})}var xr=null,ua=0,hl=0,vr=null;function Gp(r,s){if(xr===null){var h=xr=[];ua=0,hl=mm(),vr={status:"pending",value:void 0,then:function(_){h.push(_)}}}return ua++,s.then(oc,oc),s}function oc(){if(--ua===0&&xr!==null){vr!==null&&(vr.status="fulfilled");var r=xr;xr=null,hl=0,vr=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function ou(r,s){var h=[],_={status:"pending",value:null,reason:null,then:function(A){h.push(A)}};return r.then(function(){_.status="fulfilled",_.value=s;for(var A=0;A<h.length;A++)(0,h[A])(s)},function(A){for(_.status="rejected",_.reason=A,A=0;A<h.length;A++)(0,h[A])(void 0)}),_}var Xn=Je.S;Je.S=function(r,s){Pg=Qn(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&Gp(r,s),Xn!==null&&Xn(r,s)};var $a=Ee(null);function ah(){var r=$a.current;return r!==null?r:rn.pooledCache}function sh(r,s){s===null?St($a,$a.current):St($a,s.pool)}function Ef(){var r=ah();return r===null?null:{parent:Mn._currentValue,pool:r}}var Xa=Error(S(460)),Po=Error(S(474)),Ur=Error(S(542)),wt={then:function(){}};function lu(r){return r=r.status,r==="fulfilled"||r==="rejected"}function oh(r,s,h){switch(h=r[h],h===void 0?r.push(s):h!==s&&(s.then(Za,Za),s=h),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,lh(r),r;default:if(typeof s.status=="string")s.then(Za,Za);else{if(r=rn,r!==null&&100<r.shellSuspendCounter)throw Error(S(482));r=s,r.status="pending",r.then(function(_){if(s.status==="pending"){var A=s;A.status="fulfilled",A.value=_}},function(_){if(s.status==="pending"){var A=s;A.status="rejected",A.reason=_}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,lh(r),r}throw Ya=s,Xa}}function Da(r){try{var s=r._init;return s(r._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(Ya=h,Xa):h}}var Ya=null;function lc(){if(Ya===null)throw Error(S(459));var r=Ya;return Ya=null,r}function lh(r){if(r===Xa||r===Ur)throw Error(S(483))}var As=null,dl=0;function cu(r){var s=dl;return dl+=1,As===null&&(As=[]),oh(As,r,s)}function Cs(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function ch(r,s){throw s.$$typeof===de?Error(S(525)):(r=Object.prototype.toString.call(s),Error(S(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function uu(r){function s(Ie,Ae){if(r){var Ne=Ie.deletions;Ne===null?(Ie.deletions=[Ae],Ie.flags|=16):Ne.push(Ae)}}function h(Ie,Ae){if(!r)return null;for(;Ae!==null;)s(Ie,Ae),Ae=Ae.sibling;return null}function _(Ie){for(var Ae=new Map;Ie!==null;)Ie.key!==null?Ae.set(Ie.key,Ie):Ae.set(Ie.index,Ie),Ie=Ie.sibling;return Ae}function A(Ie,Ae){return Ie=oa(Ie,Ae),Ie.index=0,Ie.sibling=null,Ie}function z(Ie,Ae,Ne){return Ie.index=Ne,r?(Ne=Ie.alternate,Ne!==null?(Ne=Ne.index,Ne<Ae?(Ie.flags|=67108866,Ae):Ne):(Ie.flags|=67108866,Ae)):(Ie.flags|=1048576,Ae)}function G(Ie){return r&&Ie.alternate===null&&(Ie.flags|=67108866),Ie}function ne(Ie,Ae,Ne,st){return Ae===null||Ae.tag!==6?(Ae=nd(Ne,Ie.mode,st),Ae.return=Ie,Ae):(Ae=A(Ae,Ne),Ae.return=Ie,Ae)}function we(Ie,Ae,Ne,st){var Gt=Ne.type;return Gt===xe?et(Ie,Ae,Ne.props.children,st,Ne.key):Ae!==null&&(Ae.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===Mt&&Da(Gt)===Ae.type)?(Ae=A(Ae,Ne.props),Cs(Ae,Ne),Ae.return=Ie,Ae):(Ae=eh(Ne.type,Ne.key,Ne.props,null,Ie.mode,st),Cs(Ae,Ne),Ae.return=Ie,Ae)}function Ge(Ie,Ae,Ne,st){return Ae===null||Ae.tag!==4||Ae.stateNode.containerInfo!==Ne.containerInfo||Ae.stateNode.implementation!==Ne.implementation?(Ae=Ao(Ne,Ie.mode,st),Ae.return=Ie,Ae):(Ae=A(Ae,Ne.children||[]),Ae.return=Ie,Ae)}function et(Ie,Ae,Ne,st,Gt){return Ae===null||Ae.tag!==7?(Ae=Eo(Ne,Ie.mode,st,Gt),Ae.return=Ie,Ae):(Ae=A(Ae,Ne),Ae.return=Ie,Ae)}function ct(Ie,Ae,Ne){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return Ae=nd(""+Ae,Ie.mode,Ne),Ae.return=Ie,Ae;if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case De:return Ne=eh(Ae.type,Ae.key,Ae.props,null,Ie.mode,Ne),Cs(Ne,Ae),Ne.return=Ie,Ne;case Ze:return Ae=Ao(Ae,Ie.mode,Ne),Ae.return=Ie,Ae;case Mt:return Ae=Da(Ae),ct(Ie,Ae,Ne)}if(On(Ae)||ki(Ae))return Ae=Eo(Ae,Ie.mode,Ne,null),Ae.return=Ie,Ae;if(typeof Ae.then=="function")return ct(Ie,cu(Ae),Ne);if(Ae.$$typeof===Ue)return ct(Ie,su(Ie,Ae),Ne);ch(Ie,Ae)}return null}function He(Ie,Ae,Ne,st){var Gt=Ae!==null?Ae.key:null;if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return Gt!==null?null:ne(Ie,Ae,""+Ne,st);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case De:return Ne.key===Gt?we(Ie,Ae,Ne,st):null;case Ze:return Ne.key===Gt?Ge(Ie,Ae,Ne,st):null;case Mt:return Ne=Da(Ne),He(Ie,Ae,Ne,st)}if(On(Ne)||ki(Ne))return Gt!==null?null:et(Ie,Ae,Ne,st,null);if(typeof Ne.then=="function")return He(Ie,Ae,cu(Ne),st);if(Ne.$$typeof===Ue)return He(Ie,Ae,su(Ie,Ne),st);ch(Ie,Ne)}return null}function Ke(Ie,Ae,Ne,st,Gt){if(typeof st=="string"&&st!==""||typeof st=="number"||typeof st=="bigint")return Ie=Ie.get(Ne)||null,ne(Ae,Ie,""+st,Gt);if(typeof st=="object"&&st!==null){switch(st.$$typeof){case De:return Ie=Ie.get(st.key===null?Ne:st.key)||null,we(Ae,Ie,st,Gt);case Ze:return Ie=Ie.get(st.key===null?Ne:st.key)||null,Ge(Ae,Ie,st,Gt);case Mt:return st=Da(st),Ke(Ie,Ae,Ne,st,Gt)}if(On(st)||ki(st))return Ie=Ie.get(Ne)||null,et(Ae,Ie,st,Gt,null);if(typeof st.then=="function")return Ke(Ie,Ae,Ne,cu(st),Gt);if(st.$$typeof===Ue)return Ke(Ie,Ae,Ne,su(Ae,st),Gt);ch(Ae,st)}return null}function kt(Ie,Ae,Ne,st){for(var Gt=null,Pi=null,Lt=Ae,Ft=Ae=0,pi=null;Lt!==null&&Ft<Ne.length;Ft++){Lt.index>Ft?(pi=Lt,Lt=null):pi=Lt.sibling;var Ai=He(Ie,Lt,Ne[Ft],st);if(Ai===null){Lt===null&&(Lt=pi);break}r&&Lt&&Ai.alternate===null&&s(Ie,Lt),Ae=z(Ai,Ae,Ft),Pi===null?Gt=Ai:Pi.sibling=Ai,Pi=Ai,Lt=pi}if(Ft===Ne.length)return h(Ie,Lt),ui&&Zs(Ie,Ft),Gt;if(Lt===null){for(;Ft<Ne.length;Ft++)Lt=ct(Ie,Ne[Ft],st),Lt!==null&&(Ae=z(Lt,Ae,Ft),Pi===null?Gt=Lt:Pi.sibling=Lt,Pi=Lt);return ui&&Zs(Ie,Ft),Gt}for(Lt=_(Lt);Ft<Ne.length;Ft++)pi=Ke(Lt,Ie,Ft,Ne[Ft],st),pi!==null&&(r&&pi.alternate!==null&&Lt.delete(pi.key===null?Ft:pi.key),Ae=z(pi,Ae,Ft),Pi===null?Gt=pi:Pi.sibling=pi,Pi=pi);return r&&Lt.forEach(function(Rl){return s(Ie,Rl)}),ui&&Zs(Ie,Ft),Gt}function Zt(Ie,Ae,Ne,st){if(Ne==null)throw Error(S(151));for(var Gt=null,Pi=null,Lt=Ae,Ft=Ae=0,pi=null,Ai=Ne.next();Lt!==null&&!Ai.done;Ft++,Ai=Ne.next()){Lt.index>Ft?(pi=Lt,Lt=null):pi=Lt.sibling;var Rl=He(Ie,Lt,Ai.value,st);if(Rl===null){Lt===null&&(Lt=pi);break}r&&Lt&&Rl.alternate===null&&s(Ie,Lt),Ae=z(Rl,Ae,Ft),Pi===null?Gt=Rl:Pi.sibling=Rl,Pi=Rl,Lt=pi}if(Ai.done)return h(Ie,Lt),ui&&Zs(Ie,Ft),Gt;if(Lt===null){for(;!Ai.done;Ft++,Ai=Ne.next())Ai=ct(Ie,Ai.value,st),Ai!==null&&(Ae=z(Ai,Ae,Ft),Pi===null?Gt=Ai:Pi.sibling=Ai,Pi=Ai);return ui&&Zs(Ie,Ft),Gt}for(Lt=_(Lt);!Ai.done;Ft++,Ai=Ne.next())Ai=Ke(Lt,Ie,Ft,Ai.value,st),Ai!==null&&(r&&Ai.alternate!==null&&Lt.delete(Ai.key===null?Ft:Ai.key),Ae=z(Ai,Ae,Ft),Pi===null?Gt=Ai:Pi.sibling=Ai,Pi=Ai);return r&&Lt.forEach(function(Um){return s(Ie,Um)}),ui&&Zs(Ie,Ft),Gt}function $i(Ie,Ae,Ne,st){if(typeof Ne=="object"&&Ne!==null&&Ne.type===xe&&Ne.key===null&&(Ne=Ne.props.children),typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case De:e:{for(var Gt=Ne.key;Ae!==null;){if(Ae.key===Gt){if(Gt=Ne.type,Gt===xe){if(Ae.tag===7){h(Ie,Ae.sibling),st=A(Ae,Ne.props.children),st.return=Ie,Ie=st;break e}}else if(Ae.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===Mt&&Da(Gt)===Ae.type){h(Ie,Ae.sibling),st=A(Ae,Ne.props),Cs(st,Ne),st.return=Ie,Ie=st;break e}h(Ie,Ae);break}else s(Ie,Ae);Ae=Ae.sibling}Ne.type===xe?(st=Eo(Ne.props.children,Ie.mode,st,Ne.key),st.return=Ie,Ie=st):(st=eh(Ne.type,Ne.key,Ne.props,null,Ie.mode,st),Cs(st,Ne),st.return=Ie,Ie=st)}return G(Ie);case Ze:e:{for(Gt=Ne.key;Ae!==null;){if(Ae.key===Gt)if(Ae.tag===4&&Ae.stateNode.containerInfo===Ne.containerInfo&&Ae.stateNode.implementation===Ne.implementation){h(Ie,Ae.sibling),st=A(Ae,Ne.children||[]),st.return=Ie,Ie=st;break e}else{h(Ie,Ae);break}else s(Ie,Ae);Ae=Ae.sibling}st=Ao(Ne,Ie.mode,st),st.return=Ie,Ie=st}return G(Ie);case Mt:return Ne=Da(Ne),$i(Ie,Ae,Ne,st)}if(On(Ne))return kt(Ie,Ae,Ne,st);if(ki(Ne)){if(Gt=ki(Ne),typeof Gt!="function")throw Error(S(150));return Ne=Gt.call(Ne),Zt(Ie,Ae,Ne,st)}if(typeof Ne.then=="function")return $i(Ie,Ae,cu(Ne),st);if(Ne.$$typeof===Ue)return $i(Ie,Ae,su(Ie,Ne),st);ch(Ie,Ne)}return typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint"?(Ne=""+Ne,Ae!==null&&Ae.tag===6?(h(Ie,Ae.sibling),st=A(Ae,Ne),st.return=Ie,Ie=st):(h(Ie,Ae),st=nd(Ne,Ie.mode,st),st.return=Ie,Ie=st),G(Ie)):h(Ie,Ae)}return function(Ie,Ae,Ne,st){try{dl=0;var Gt=$i(Ie,Ae,Ne,st);return As=null,Gt}catch(Lt){if(Lt===Xa||Lt===Ur)throw Lt;var Pi=sa(29,Lt,null,Ie.mode);return Pi.lanes=st,Pi.return=Ie,Pi}}}var Ds=uu(!0),ld=uu(!1),zs=!1;function uh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function hu(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Ps(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Ks(r,s,h){var _=r.updateQueue;if(_===null)return null;if(_=_.shared,(Ni&2)!==0){var A=_.pending;return A===null?s.next=s:(s.next=A.next,A.next=s),_.pending=s,s=ic(r),id(r,null,h),s}return ru(r,_,s,h),ic(r)}function za(r,s,h){if(s=s.updateQueue,s!==null&&(s=s.shared,(h&4194048)!==0)){var _=s.lanes;_&=r.pendingLanes,h|=_,s.lanes=h,Nn(r,h)}}function Mi(r,s){var h=r.updateQueue,_=r.alternate;if(_!==null&&(_=_.updateQueue,h===_)){var A=null,z=null;if(h=h.firstBaseUpdate,h!==null){do{var G={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};z===null?A=z=G:z=z.next=G,h=h.next}while(h!==null);z===null?A=z=s:z=z.next=s}else A=z=s;h={baseState:_.baseState,firstBaseUpdate:A,lastBaseUpdate:z,shared:_.shared,callbacks:_.callbacks},r.updateQueue=h;return}r=h.lastBaseUpdate,r===null?h.firstBaseUpdate=s:r.next=s,h.lastBaseUpdate=s}var cd=!1;function Qs(){if(cd){var r=vr;if(r!==null)throw r}}function Io(r,s,h,_){cd=!1;var A=r.updateQueue;zs=!1;var z=A.firstBaseUpdate,G=A.lastBaseUpdate,ne=A.shared.pending;if(ne!==null){A.shared.pending=null;var we=ne,Ge=we.next;we.next=null,G===null?z=Ge:G.next=Ge,G=we;var et=r.alternate;et!==null&&(et=et.updateQueue,ne=et.lastBaseUpdate,ne!==G&&(ne===null?et.firstBaseUpdate=Ge:ne.next=Ge,et.lastBaseUpdate=we))}if(z!==null){var ct=A.baseState;G=0,et=Ge=we=null,ne=z;do{var He=ne.lane&-536870913,Ke=He!==ne.lane;if(Ke?(gi&He)===He:(_&He)===He){He!==0&&He===hl&&(cd=!0),et!==null&&(et=et.next={lane:0,tag:ne.tag,payload:ne.payload,callback:null,next:null});e:{var kt=r,Zt=ne;He=s;var $i=h;switch(Zt.tag){case 1:if(kt=Zt.payload,typeof kt=="function"){ct=kt.call($i,ct,He);break e}ct=kt;break e;case 3:kt.flags=kt.flags&-65537|128;case 0:if(kt=Zt.payload,He=typeof kt=="function"?kt.call($i,ct,He):kt,He==null)break e;ct=te({},ct,He);break e;case 2:zs=!0}}He=ne.callback,He!==null&&(r.flags|=64,Ke&&(r.flags|=8192),Ke=A.callbacks,Ke===null?A.callbacks=[He]:Ke.push(He))}else Ke={lane:He,tag:ne.tag,payload:ne.payload,callback:ne.callback,next:null},et===null?(Ge=et=Ke,we=ct):et=et.next=Ke,G|=He;if(ne=ne.next,ne===null){if(ne=A.shared.pending,ne===null)break;Ke=ne,ne=Ke.next,Ke.next=null,A.lastBaseUpdate=Ke,A.shared.pending=null}}while(!0);et===null&&(we=ct),A.baseState=we,A.firstBaseUpdate=Ge,A.lastBaseUpdate=et,z===null&&(A.shared.lanes=0),El|=G,r.lanes=G,r.memoizedState=ct}}function du(r,s){if(typeof r!="function")throw Error(S(191,r));r.call(s)}function hh(r,s){var h=r.callbacks;if(h!==null)for(r.callbacks=null,r=0;r<h.length;r++)du(h[r],s)}var fl=Ee(null),fu=Ee(0);function ud(r,s){r=Ml,St(fu,r),St(fl,s),Ml=r|s.baseLanes}function ha(){St(fu,Ml),St(fl,fl.current)}function pl(){Ml=fu.current,ot(fl),ot(fu)}var Tt=Ee(null),Ct=null;function Pa(r){var s=r.alternate;St(gn,gn.current&1),St(Tt,r),Ct===null&&(s===null||fl.current!==null||s.memoizedState!==null)&&(Ct=r)}function cc(r){St(gn,gn.current),St(Tt,r),Ct===null&&(Ct=r)}function pu(r){r.tag===22?(St(gn,gn.current),St(Tt,r),Ct===null&&(Ct=r)):En()}function En(){St(gn,gn.current),St(Tt,Tt.current)}function un(r){ot(Tt),Ct===r&&(Ct=null),ot(gn)}var gn=Ee(0);function mu(r){for(var s=r;s!==null;){if(s.tag===13){var h=s.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||Hr(h)||Gn(h)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Js=0,ii=null,Ti=null,ei=null,tn=!1,Ia=!1,Wa=!1,ml=0,gl=0,eo=null,hd=0;function Yi(){throw Error(S(321))}function Ka(r,s){if(s===null)return!1;for(var h=0;h<s.length&&h<r.length;h++)if(!Or(r[h],s[h]))return!1;return!0}function uc(r,s,h,_,A,z){return Js=z,ii=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Je.H=r===null||r.memoizedState===null?Fi:In,Wa=!1,z=h(_,A),Wa=!1,Ia&&(z=gu(s,h,_,A)),hc(r),z}function hc(r){Je.H=Ei;var s=Ti!==null&&Ti.next!==null;if(Js=0,ei=Ti=ii=null,tn=!1,gl=0,eo=null,s)throw Error(S(300));r===null||nr||(r=r.dependencies,r!==null&&ac(r)&&(nr=!0))}function gu(r,s,h,_){ii=r;var A=0;do{if(Ia&&(eo=null),gl=0,Ia=!1,25<=A)throw Error(S(301));if(A+=1,ei=Ti=null,r.updateQueue!=null){var z=r.updateQueue;z.lastEffect=null,z.events=null,z.stores=null,z.memoCache!=null&&(z.memoCache.index=0)}Je.H=Un,z=s(h,_)}while(Ia);return z}function yu(){var r=Je.H,s=r.useState()[0];return s=typeof s.then=="function"?yl(s):s,r=r.useState()[0],(Ti!==null?Ti.memoizedState:null)!==r&&(ii.flags|=1024),s}function _u(){var r=ml!==0;return ml=0,r}function Ro(r,s,h){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~h}function to(r){if(tn){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}tn=!1}Js=0,ei=Ti=ii=null,Ia=!1,gl=ml=0,eo=null}function dr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ei===null?ii.memoizedState=ei=r:ei=ei.next=r,ei}function nn(){if(Ti===null){var r=ii.alternate;r=r!==null?r.memoizedState:null}else r=Ti.next;var s=ei===null?ii.memoizedState:ei.next;if(s!==null)ei=s,Ti=r;else{if(r===null)throw ii.alternate===null?Error(S(467)):Error(S(310));Ti=r,r={memoizedState:Ti.memoizedState,baseState:Ti.baseState,baseQueue:Ti.baseQueue,queue:Ti.queue,next:null},ei===null?ii.memoizedState=ei=r:ei=ei.next=r}return ei}function Is(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function yl(r){var s=gl;return gl+=1,eo===null&&(eo=[]),r=oh(eo,r,s),s=ii,(ei===null?s.memoizedState:ei.next)===null&&(s=s.alternate,Je.H=s===null||s.memoizedState===null?Fi:In),r}function _l(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return yl(r);if(r.$$typeof===Ue)return Pn(r)}throw Error(S(438,String(r)))}function dc(r){var s=null,h=ii.updateQueue;if(h!==null&&(s=h.memoCache),s==null){var _=ii.alternate;_!==null&&(_=_.updateQueue,_!==null&&(_=_.memoCache,_!=null&&(s={data:_.data.map(function(A){return A.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),h===null&&(h=Is(),ii.updateQueue=h),h.memoCache=s,h=s.data[s.index],h===void 0)for(h=s.data[s.index]=Array(r),_=0;_<r;_++)h[_]=si;return s.index++,h}function Qa(r,s){return typeof s=="function"?s(r):s}function y(r){var s=nn();return t(s,Ti,r)}function t(r,s,h){var _=r.queue;if(_===null)throw Error(S(311));_.lastRenderedReducer=h;var A=r.baseQueue,z=_.pending;if(z!==null){if(A!==null){var G=A.next;A.next=z.next,z.next=G}s.baseQueue=A=z,_.pending=null}if(z=r.baseState,A===null)r.memoizedState=z;else{s=A.next;var ne=G=null,we=null,Ge=s,et=!1;do{var ct=Ge.lane&-536870913;if(ct!==Ge.lane?(gi&ct)===ct:(Js&ct)===ct){var He=Ge.revertLane;if(He===0)we!==null&&(we=we.next={lane:0,revertLane:0,gesture:null,action:Ge.action,hasEagerState:Ge.hasEagerState,eagerState:Ge.eagerState,next:null}),ct===hl&&(et=!0);else if((Js&He)===He){Ge=Ge.next,He===hl&&(et=!0);continue}else ct={lane:0,revertLane:Ge.revertLane,gesture:null,action:Ge.action,hasEagerState:Ge.hasEagerState,eagerState:Ge.eagerState,next:null},we===null?(ne=we=ct,G=z):we=we.next=ct,ii.lanes|=He,El|=He;ct=Ge.action,Wa&&h(z,ct),z=Ge.hasEagerState?Ge.eagerState:h(z,ct)}else He={lane:ct,revertLane:Ge.revertLane,gesture:Ge.gesture,action:Ge.action,hasEagerState:Ge.hasEagerState,eagerState:Ge.eagerState,next:null},we===null?(ne=we=He,G=z):we=we.next=He,ii.lanes|=ct,El|=ct;Ge=Ge.next}while(Ge!==null&&Ge!==s);if(we===null?G=z:we.next=ne,!Or(z,r.memoizedState)&&(nr=!0,et&&(h=vr,h!==null)))throw h;r.memoizedState=z,r.baseState=G,r.baseQueue=we,_.lastRenderedState=z}return A===null&&(_.lanes=0),[r.memoizedState,_.dispatch]}function a(r){var s=nn(),h=s.queue;if(h===null)throw Error(S(311));h.lastRenderedReducer=r;var _=h.dispatch,A=h.pending,z=s.memoizedState;if(A!==null){h.pending=null;var G=A=A.next;do z=r(z,G.action),G=G.next;while(G!==A);Or(z,s.memoizedState)||(nr=!0),s.memoizedState=z,s.baseQueue===null&&(s.baseState=z),h.lastRenderedState=z}return[z,_]}function l(r,s,h){var _=ii,A=nn(),z=ui;if(z){if(h===void 0)throw Error(S(407));h=h()}else h=s();var G=!Or((Ti||A).memoizedState,h);if(G&&(A.memoizedState=h,nr=!0),A=A.queue,Oe(b.bind(null,_,A,r),[r]),A.getSnapshot!==s||G||ei!==null&&ei.memoizedState.tag&1){if(_.flags|=2048,me(9,{destroy:void 0},x.bind(null,_,A,h,s),null),rn===null)throw Error(S(349));z||(Js&127)!==0||f(_,s,h)}return h}function f(r,s,h){r.flags|=16384,r={getSnapshot:s,value:h},s=ii.updateQueue,s===null?(s=Is(),ii.updateQueue=s,s.stores=[r]):(h=s.stores,h===null?s.stores=[r]:h.push(r))}function x(r,s,h,_){s.value=h,s.getSnapshot=_,E(s)&&D(r)}function b(r,s,h){return h(function(){E(s)&&D(r)})}function E(r){var s=r.getSnapshot;r=r.value;try{var h=s();return!Or(r,h)}catch{return!0}}function D(r){var s=Aa(r,2);s!==null&&Fa(s,r,2)}function k(r){var s=dr();if(typeof r=="function"){var h=r;if(r=h(),Wa){ve(!0);try{h()}finally{ve(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:r},s}function j(r,s,h,_){return r.baseState=h,t(r,Ti,typeof _=="function"?_:Qa)}function U(r,s,h,_,A){if(da(r))throw Error(S(485));if(r=s.action,r!==null){var z={payload:A,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(G){z.listeners.push(G)}};Je.T!==null?h(!0):z.isTransition=!1,_(z),h=s.pending,h===null?(z.next=s.pending=z,N(s,z)):(z.next=h.next,s.pending=h.next=z)}}function N(r,s){var h=s.action,_=s.payload,A=r.state;if(s.isTransition){var z=Je.T,G={};Je.T=G;try{var ne=h(A,_),we=Je.S;we!==null&&we(G,ne),H(r,s,ne)}catch(Ge){ae(r,s,Ge)}finally{z!==null&&G.types!==null&&(z.types=G.types),Je.T=z}}else try{z=h(A,_),H(r,s,z)}catch(Ge){ae(r,s,Ge)}}function H(r,s,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(_){Q(r,s,_)},function(_){return ae(r,s,_)}):Q(r,s,h)}function Q(r,s,h){s.status="fulfilled",s.value=h,oe(s),r.state=h,s=r.pending,s!==null&&(h=s.next,h===s?r.pending=null:(h=h.next,s.next=h,N(r,h)))}function ae(r,s,h){var _=r.pending;if(r.pending=null,_!==null){_=_.next;do s.status="rejected",s.reason=h,oe(s),s=s.next;while(s!==_)}r.action=null}function oe(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function se(r,s){return s}function he(r,s){if(ui){var h=rn.formState;if(h!==null){e:{var _=ii;if(ui){if(Bi){t:{for(var A=Bi,z=la;A.nodeType!==8;){if(!z){A=null;break t}if(A=rs(A.nextSibling),A===null){A=null;break t}}z=A.data,A=z==="F!"||z==="F"?A:null}if(A){Bi=rs(A.nextSibling),_=A.data==="F!";break e}}Nr(_)}_=!1}_&&(s=h[0])}}return h=dr(),h.memoizedState=h.baseState=s,_={pending:null,lanes:0,dispatch:null,lastRenderedReducer:se,lastRenderedState:s},h.queue=_,h=fc.bind(null,ii,_),_.dispatch=h,_=k(!1),z=qr.bind(null,ii,!1,_.queue),_=dr(),A={state:s,dispatch:null,action:r,pending:null},_.queue=A,h=U.bind(null,ii,A,z,h),A.dispatch=h,_.memoizedState=r,[s,h,!1]}function ye(r){var s=nn();return ce(s,Ti,r)}function ce(r,s,h){if(s=t(r,s,se)[0],r=y(Qa)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var _=yl(s)}catch(G){throw G===Xa?Ur:G}else _=s;s=nn();var A=s.queue,z=A.dispatch;return h!==s.memoizedState&&(ii.flags|=2048,me(9,{destroy:void 0},ge.bind(null,A,h),null)),[_,z,r]}function ge(r,s){r.action=s}function be(r){var s=nn(),h=Ti;if(h!==null)return ce(s,h,r);nn(),s=s.memoizedState,h=nn();var _=h.queue.dispatch;return h.memoizedState=r,[s,_,!1]}function me(r,s,h,_){return r={tag:r,create:h,deps:_,inst:s,next:null},s=ii.updateQueue,s===null&&(s=Is(),ii.updateQueue=s),h=s.lastEffect,h===null?s.lastEffect=r.next=r:(_=h.next,h.next=r,r.next=_,s.lastEffect=r),r}function Me(){return nn().memoizedState}function Fe(r,s,h,_){var A=dr();ii.flags|=r,A.memoizedState=me(1|s,{destroy:void 0},h,_===void 0?null:_)}function Le(r,s,h,_){var A=nn();_=_===void 0?null:_;var z=A.memoizedState.inst;Ti!==null&&_!==null&&Ka(_,Ti.memoizedState.deps)?A.memoizedState=me(s,z,h,_):(ii.flags|=r,A.memoizedState=me(1|s,z,h,_))}function Be(r,s){Fe(8390656,8,r,s)}function Oe(r,s){Le(2048,8,r,s)}function dt(r){ii.flags|=4;var s=ii.updateQueue;if(s===null)s=Is(),ii.updateQueue=s,s.events=[r];else{var h=s.events;h===null?s.events=[r]:h.push(r)}}function ft(r){var s=nn().memoizedState;return dt({ref:s,nextImpl:r}),function(){if((Ni&2)!==0)throw Error(S(440));return s.impl.apply(void 0,arguments)}}function rt(r,s){return Le(4,2,r,s)}function yt(r,s){return Le(4,4,r,s)}function $t(r,s){if(typeof s=="function"){r=r();var h=s(r);return function(){typeof h=="function"?h():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function Si(r,s,h){h=h!=null?h.concat([r]):null,Le(4,4,$t.bind(null,s,r),h)}function Ui(){}function Oi(r,s){var h=nn();s=s===void 0?null:s;var _=h.memoizedState;return s!==null&&Ka(s,_[1])?_[0]:(h.memoizedState=[r,s],r)}function Wi(r,s){var h=nn();s=s===void 0?null:s;var _=h.memoizedState;if(s!==null&&Ka(s,_[1]))return _[0];if(_=r(),Wa){ve(!0);try{r()}finally{ve(!1)}}return h.memoizedState=[_,s],_}function Di(r,s,h){return h===void 0||(Js&1073741824)!==0&&(gi&261930)===0?r.memoizedState=s:(r.memoizedState=h,r=Rg(),ii.lanes|=r,El|=r,h)}function hn(r,s,h,_){return Or(h,s)?h:fl.current!==null?(r=Di(r,h,_),Or(r,s)||(nr=!0),r):(Js&42)===0||(Js&1073741824)!==0&&(gi&261930)===0?(nr=!0,r.memoizedState=h):(r=Rg(),ii.lanes|=r,El|=r,s)}function Ki(r,s,h,_,A){var z=at.p;at.p=z!==0&&8>z?z:8;var G=Je.T,ne={};Je.T=ne,qr(r,!1,s,h);try{var we=A(),Ge=Je.S;if(Ge!==null&&Ge(ne,we),we!==null&&typeof we=="object"&&typeof we.then=="function"){var et=ou(we,_);es(r,s,et,Oa(r))}else es(r,s,_,Oa(r))}catch(ct){es(r,s,{then:function(){},status:"rejected",reason:ct},Oa())}finally{at.p=z,G!==null&&ne.types!==null&&(G.types=ne.types),Je.T=G}}function tr(){}function yn(r,s,h,_){if(r.tag!==5)throw Error(S(476));var A=_n(r).queue;Ki(r,A,s,Pt,h===null?tr:function(){return ir(r),h(_)})}function _n(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:Pt,baseState:Pt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:Pt},next:null};var h={};return s.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:h},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function ir(r){var s=_n(r);s.next===null&&(s=r.alternate.memoizedState),es(r,s.next.queue,{},Oa())}function Rs(){return Pn(Rh)}function ks(){return nn().memoizedState}function Ja(){return nn().memoizedState}function Gr(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var h=Oa();r=Ps(h);var _=Ks(s,r,h);_!==null&&(Fa(_,s,h),za(_,s,h)),s={cache:Es()},r.payload=s;return}s=s.return}}function xl(r,s,h){var _=Oa();h={lane:_,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},da(r)?Ra(s,h):(h=Mo(r,s,h,_),h!==null&&(Fa(h,r,_),ka(h,s,_)))}function fc(r,s,h){var _=Oa();es(r,s,h,_)}function es(r,s,h,_){var A={lane:_,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(da(r))Ra(s,A);else{var z=r.alternate;if(r.lanes===0&&(z===null||z.lanes===0)&&(z=s.lastRenderedReducer,z!==null))try{var G=s.lastRenderedState,ne=z(G,h);if(A.hasEagerState=!0,A.eagerState=ne,Or(ne,G))return ru(r,s,A,0),rn===null&&ll(),!1}catch{}if(h=Mo(r,s,A,_),h!==null)return Fa(h,r,_),ka(h,s,_),!0}return!1}function qr(r,s,h,_){if(_={lane:2,revertLane:mm(),gesture:null,action:_,hasEagerState:!1,eagerState:null,next:null},da(r)){if(s)throw Error(S(479))}else s=Mo(r,h,_,2),s!==null&&Fa(s,r,2)}function da(r){var s=r.alternate;return r===ii||s!==null&&s===ii}function Ra(r,s){Ia=tn=!0;var h=r.pending;h===null?s.next=s:(s.next=h.next,h.next=s),r.pending=s}function ka(r,s,h){if((h&4194048)!==0){var _=s.lanes;_&=r.pendingLanes,h|=_,s.lanes=h,Nn(r,h)}}var Ei={readContext:Pn,use:_l,useCallback:Yi,useContext:Yi,useEffect:Yi,useImperativeHandle:Yi,useLayoutEffect:Yi,useInsertionEffect:Yi,useMemo:Yi,useReducer:Yi,useRef:Yi,useState:Yi,useDebugValue:Yi,useDeferredValue:Yi,useTransition:Yi,useSyncExternalStore:Yi,useId:Yi,useHostTransitionStatus:Yi,useFormState:Yi,useActionState:Yi,useOptimistic:Yi,useMemoCache:Yi,useCacheRefresh:Yi};Ei.useEffectEvent=Yi;var Fi={readContext:Pn,use:_l,useCallback:function(r,s){return dr().memoizedState=[r,s===void 0?null:s],r},useContext:Pn,useEffect:Be,useImperativeHandle:function(r,s,h){h=h!=null?h.concat([r]):null,Fe(4194308,4,$t.bind(null,s,r),h)},useLayoutEffect:function(r,s){return Fe(4194308,4,r,s)},useInsertionEffect:function(r,s){Fe(4,2,r,s)},useMemo:function(r,s){var h=dr();s=s===void 0?null:s;var _=r();if(Wa){ve(!0);try{r()}finally{ve(!1)}}return h.memoizedState=[_,s],_},useReducer:function(r,s,h){var _=dr();if(h!==void 0){var A=h(s);if(Wa){ve(!0);try{h(s)}finally{ve(!1)}}}else A=s;return _.memoizedState=_.baseState=A,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:A},_.queue=r,r=r.dispatch=xl.bind(null,ii,r),[_.memoizedState,r]},useRef:function(r){var s=dr();return r={current:r},s.memoizedState=r},useState:function(r){r=k(r);var s=r.queue,h=fc.bind(null,ii,s);return s.dispatch=h,[r.memoizedState,h]},useDebugValue:Ui,useDeferredValue:function(r,s){var h=dr();return Di(h,r,s)},useTransition:function(){var r=k(!1);return r=Ki.bind(null,ii,r.queue,!0,!1),dr().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,h){var _=ii,A=dr();if(ui){if(h===void 0)throw Error(S(407));h=h()}else{if(h=s(),rn===null)throw Error(S(349));(gi&127)!==0||f(_,s,h)}A.memoizedState=h;var z={value:h,getSnapshot:s};return A.queue=z,Be(b.bind(null,_,z,r),[r]),_.flags|=2048,me(9,{destroy:void 0},x.bind(null,_,z,h,s),null),h},useId:function(){var r=dr(),s=rn.identifierPrefix;if(ui){var h=Fr,_=vs;h=(_&~(1<<32-Pe(_)-1)).toString(32)+h,s="_"+s+"R_"+h,h=ml++,0<h&&(s+="H"+h.toString(32)),s+="_"}else h=hd++,s="_"+s+"r_"+h.toString(32)+"_";return r.memoizedState=s},useHostTransitionStatus:Rs,useFormState:he,useActionState:he,useOptimistic:function(r){var s=dr();s.memoizedState=s.baseState=r;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=h,s=qr.bind(null,ii,!0,h),h.dispatch=s,[r,s]},useMemoCache:dc,useCacheRefresh:function(){return dr().memoizedState=Gr.bind(null,ii)},useEffectEvent:function(r){var s=dr(),h={impl:r};return s.memoizedState=h,function(){if((Ni&2)!==0)throw Error(S(440));return h.impl.apply(void 0,arguments)}}},In={readContext:Pn,use:_l,useCallback:Oi,useContext:Pn,useEffect:Oe,useImperativeHandle:Si,useInsertionEffect:rt,useLayoutEffect:yt,useMemo:Wi,useReducer:y,useRef:Me,useState:function(){return y(Qa)},useDebugValue:Ui,useDeferredValue:function(r,s){var h=nn();return hn(h,Ti.memoizedState,r,s)},useTransition:function(){var r=y(Qa)[0],s=nn().memoizedState;return[typeof r=="boolean"?r:yl(r),s]},useSyncExternalStore:l,useId:ks,useHostTransitionStatus:Rs,useFormState:ye,useActionState:ye,useOptimistic:function(r,s){var h=nn();return j(h,Ti,r,s)},useMemoCache:dc,useCacheRefresh:Ja};In.useEffectEvent=ft;var Un={readContext:Pn,use:_l,useCallback:Oi,useContext:Pn,useEffect:Oe,useImperativeHandle:Si,useInsertionEffect:rt,useLayoutEffect:yt,useMemo:Wi,useReducer:a,useRef:Me,useState:function(){return a(Qa)},useDebugValue:Ui,useDeferredValue:function(r,s){var h=nn();return Ti===null?Di(h,r,s):hn(h,Ti.memoizedState,r,s)},useTransition:function(){var r=a(Qa)[0],s=nn().memoizedState;return[typeof r=="boolean"?r:yl(r),s]},useSyncExternalStore:l,useId:ks,useHostTransitionStatus:Rs,useFormState:be,useActionState:be,useOptimistic:function(r,s){var h=nn();return Ti!==null?j(h,Ti,r,s):(h.baseState=r,[r,h.queue.dispatch])},useMemoCache:dc,useCacheRefresh:Ja};Un.useEffectEvent=ft;function dh(r,s,h,_){s=r.memoizedState,h=h(_,s),h=h==null?s:te({},s,h),r.memoizedState=h,r.lanes===0&&(r.updateQueue.baseState=h)}var fh={enqueueSetState:function(r,s,h){r=r._reactInternals;var _=Oa(),A=Ps(_);A.payload=s,h!=null&&(A.callback=h),s=Ks(r,A,_),s!==null&&(Fa(s,r,_),za(s,r,_))},enqueueReplaceState:function(r,s,h){r=r._reactInternals;var _=Oa(),A=Ps(_);A.tag=1,A.payload=s,h!=null&&(A.callback=h),s=Ks(r,A,_),s!==null&&(Fa(s,r,_),za(s,r,_))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var h=Oa(),_=Ps(h);_.tag=2,s!=null&&(_.callback=s),s=Ks(r,_,h),s!==null&&(Fa(s,r,h),za(s,r,h))}};function ko(r,s,h,_,A,z,G){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(_,z,G):s.prototype&&s.prototype.isPureReactComponent?!So(h,_)||!So(A,z):!0}function Af(r,s,h,_){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(h,_),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(h,_),s.state!==r&&fh.enqueueReplaceState(s,s.state,null)}function Lo(r,s){var h=s;if("ref"in s){h={};for(var _ in s)_!=="ref"&&(h[_]=s[_])}if(r=r.defaultProps){h===s&&(h=te({},h));for(var A in r)h[A]===void 0&&(h[A]=r[A])}return h}function ph(r){_s(r)}function io(r){console.error(r)}function no(r){_s(r)}function ts(r,s){try{var h=r.onUncaughtError;h(s.value,{componentStack:s.stack})}catch(_){setTimeout(function(){throw _})}}function mh(r,s,h){try{var _=r.onCaughtError;_(h.value,{componentStack:h.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function xu(r,s,h){return h=Ps(h),h.tag=3,h.payload={element:null},h.callback=function(){ts(r,s)},h}function vu(r){return r=Ps(r),r.tag=3,r}function bu(r,s,h,_){var A=h.type.getDerivedStateFromError;if(typeof A=="function"){var z=_.value;r.payload=function(){return A(z)},r.callback=function(){mh(s,h,_)}}var G=h.stateNode;G!==null&&typeof G.componentDidCatch=="function"&&(r.callback=function(){mh(s,h,_),typeof A!="function"&&(Al===null?Al=new Set([this]):Al.add(this));var ne=_.stack;this.componentDidCatch(_.value,{componentStack:ne!==null?ne:""})})}function Cf(r,s,h,_,A){if(h.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){if(s=h.alternate,s!==null&&ca(s,h,A,!0),h=Tt.current,h!==null){switch(h.tag){case 31:case 13:return Ct===null?zd():h.alternate===null&&Rn===0&&(Rn=3),h.flags&=-257,h.flags|=65536,h.lanes=A,_===wt?h.flags|=16384:(s=h.updateQueue,s===null?h.updateQueue=new Set([_]):s.add(_),Jf(r,_,A)),!1;case 22:return h.flags|=65536,_===wt?h.flags|=16384:(s=h.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([_])},h.updateQueue=s):(h=s.retryQueue,h===null?s.retryQueue=new Set([_]):h.add(_)),Jf(r,_,A)),!1}throw Error(S(435,h.tag))}return Jf(r,_,A),zd(),!1}if(ui)return s=Tt.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=A,_!==cn&&(r=Error(S(422),{cause:_}),$s(Rr(r,h)))):(_!==cn&&(s=Error(S(423),{cause:_}),$s(Rr(s,h))),r=r.current.alternate,r.flags|=65536,A&=-A,r.lanes|=A,_=Rr(_,h),A=xu(r.stateNode,_,A),Mi(r,A),Rn!==4&&(Rn=2)),!1;var z=Error(S(520),{cause:_});if(z=Rr(z,h),Ed===null?Ed=[z]:Ed.push(z),Rn!==4&&(Rn=2),s===null)return!0;_=Rr(_,h),h=s;do{switch(h.tag){case 3:return h.flags|=65536,r=A&-A,h.lanes|=r,r=xu(h.stateNode,_,r),Mi(h,r),!1;case 1:if(s=h.type,z=h.stateNode,(h.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(Al===null||!Al.has(z))))return h.flags|=65536,A&=-A,h.lanes|=A,A=vu(A),bu(A,r,h,_),Mi(h,A),!1}h=h.return}while(h!==null);return!1}var Df=Error(S(461)),nr=!1;function fr(r,s,h,_){s.child=r===null?ld(s,null,h,_):Ds(s,r.child,h,_)}function gg(r,s,h,_,A){h=h.render;var z=s.ref;if("ref"in _){var G={};for(var ne in _)ne!=="ref"&&(G[ne]=_[ne])}else G=_;return Ws(s),_=uc(r,s,h,G,z,A),ne=_u(),r!==null&&!nr?(Ro(r,s,A),Bo(r,s,A)):(ui&&ne&&ul(s),s.flags|=1,fr(r,s,_,A),s.child)}function zf(r,s,h,_,A){if(r===null){var z=h.type;return typeof z=="function"&&!Ju(z)&&z.defaultProps===void 0&&h.compare===null?(s.tag=15,s.type=z,qp(r,s,z,_,A)):(r=eh(h.type,null,_,s,s.mode,A),r.ref=s.ref,r.return=s,s.child=r)}if(z=r.child,!pd(r,A)){var G=z.memoizedProps;if(h=h.compare,h=h!==null?h:So,h(G,_)&&r.ref===s.ref)return Bo(r,s,A)}return s.flags|=1,r=oa(z,_),r.ref=s.ref,r.return=s,s.child=r}function qp(r,s,h,_,A){if(r!==null){var z=r.memoizedProps;if(So(z,_)&&r.ref===s.ref)if(nr=!1,s.pendingProps=_=z,pd(r,A))(r.flags&131072)!==0&&(nr=!0);else return s.lanes=r.lanes,Bo(r,s,A)}return Hp(r,s,h,_,A)}function Zp(r,s,h,_){var A=_.children,z=r!==null?r.memoizedState:null;if(r===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),_.mode==="hidden"){if((s.flags&128)!==0){if(z=z!==null?z.baseLanes|h:h,r!==null){for(_=s.child=r.child,A=0;_!==null;)A=A|_.lanes|_.childLanes,_=_.sibling;_=A&~z}else _=0,s.child=null;return yg(r,s,z,h,_)}if((h&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&sh(s,z!==null?z.cachePool:null),z!==null?ud(s,z):ha(),pu(s);else return _=s.lanes=536870912,yg(r,s,z!==null?z.baseLanes|h:h,h,_)}else z!==null?(sh(s,z.cachePool),ud(s,z),En(),s.memoizedState=null):(r!==null&&sh(s,null),ha(),En());return fr(r,s,A,h),s.child}function jo(r,s){return r!==null&&r.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function yg(r,s,h,_,A){var z=ah();return z=z===null?null:{parent:Mn._currentValue,pool:z},s.memoizedState={baseLanes:h,cachePool:z},r!==null&&sh(s,null),ha(),pu(s),r!==null&&ca(r,s,_,!0),s.childLanes=A,null}function vl(r,s){return s=Lf({mode:s.mode,children:s.children},r.mode),s.ref=r.ref,r.child=s,s.return=r,s}function dd(r,s,h){return Ds(s,r.child,null,h),r=vl(s,s.pendingProps),r.flags|=2,un(s),s.memoizedState=null,r}function Pf(r,s,h){var _=s.pendingProps,A=(s.flags&128)!==0;if(s.flags&=-129,r===null){if(ui){if(_.mode==="hidden")return r=vl(s,_),s.lanes=536870912,jo(null,r);if(cc(s),(r=Bi)?(r=Tc(r,la),r=r!==null&&r.data==="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:xs!==null?{id:vs,overflow:Fr}:null,retryLane:536870912,hydrationErrors:null},h=th(r),h.return=s,s.child=h,er=s,Bi=null)):r=null,r===null)throw Nr(s);return s.lanes=536870912,null}return vl(s,_)}var z=r.memoizedState;if(z!==null){var G=z.dehydrated;if(cc(s),A)if(s.flags&256)s.flags&=-257,s=dd(r,s,h);else if(s.memoizedState!==null)s.child=r.child,s.flags|=128,s=null;else throw Error(S(558));else if(nr||ca(r,s,h,!1),A=(h&r.childLanes)!==0,nr||A){if(_=rn,_!==null&&(G=ln(_,h),G!==0&&G!==z.retryLane))throw z.retryLane=G,Aa(r,G),Fa(_,r,G),Df;zd(),s=dd(r,s,h)}else r=z.treeContext,Bi=rs(G.nextSibling),er=s,ui=!0,Hs=null,la=!1,r!==null&&ad(s,r),s=vl(s,_),s.flags|=4096;return s}return r=oa(r.child,{mode:_.mode,children:_.children}),r.ref=s.ref,s.child=r,r.return=s,r}function If(r,s){var h=s.ref;if(h===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(S(284));(r===null||r.ref!==h)&&(s.flags|=4194816)}}function Hp(r,s,h,_,A){return Ws(s),h=uc(r,s,h,_,void 0,A),_=_u(),r!==null&&!nr?(Ro(r,s,A),Bo(r,s,A)):(ui&&_&&ul(s),s.flags|=1,fr(r,s,h,A),s.child)}function _g(r,s,h,_,A,z){return Ws(s),s.updateQueue=null,h=gu(s,_,h,A),hc(r),_=_u(),r!==null&&!nr?(Ro(r,s,z),Bo(r,s,z)):(ui&&_&&ul(s),s.flags|=1,fr(r,s,h,z),s.child)}function xg(r,s,h,_,A){if(Ws(s),s.stateNode===null){var z=Kt,G=h.contextType;typeof G=="object"&&G!==null&&(z=Pn(G)),z=new h(_,z),s.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,z.updater=fh,s.stateNode=z,z._reactInternals=s,z=s.stateNode,z.props=_,z.state=s.memoizedState,z.refs={},uh(s),G=h.contextType,z.context=typeof G=="object"&&G!==null?Pn(G):Kt,z.state=s.memoizedState,G=h.getDerivedStateFromProps,typeof G=="function"&&(dh(s,h,G,_),z.state=s.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(G=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),G!==z.state&&fh.enqueueReplaceState(z,z.state,null),Io(s,_,z,A),Qs(),z.state=s.memoizedState),typeof z.componentDidMount=="function"&&(s.flags|=4194308),_=!0}else if(r===null){z=s.stateNode;var ne=s.memoizedProps,we=Lo(h,ne);z.props=we;var Ge=z.context,et=h.contextType;G=Kt,typeof et=="object"&&et!==null&&(G=Pn(et));var ct=h.getDerivedStateFromProps;et=typeof ct=="function"||typeof z.getSnapshotBeforeUpdate=="function",ne=s.pendingProps!==ne,et||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ne||Ge!==G)&&Af(s,z,_,G),zs=!1;var He=s.memoizedState;z.state=He,Io(s,_,z,A),Qs(),Ge=s.memoizedState,ne||He!==Ge||zs?(typeof ct=="function"&&(dh(s,h,ct,_),Ge=s.memoizedState),(we=zs||ko(s,h,we,_,He,Ge,G))?(et||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(s.flags|=4194308)):(typeof z.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=_,s.memoizedState=Ge),z.props=_,z.state=Ge,z.context=G,_=we):(typeof z.componentDidMount=="function"&&(s.flags|=4194308),_=!1)}else{z=s.stateNode,hu(r,s),G=s.memoizedProps,et=Lo(h,G),z.props=et,ct=s.pendingProps,He=z.context,Ge=h.contextType,we=Kt,typeof Ge=="object"&&Ge!==null&&(we=Pn(Ge)),ne=h.getDerivedStateFromProps,(Ge=typeof ne=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(G!==ct||He!==we)&&Af(s,z,_,we),zs=!1,He=s.memoizedState,z.state=He,Io(s,_,z,A),Qs();var Ke=s.memoizedState;G!==ct||He!==Ke||zs||r!==null&&r.dependencies!==null&&ac(r.dependencies)?(typeof ne=="function"&&(dh(s,h,ne,_),Ke=s.memoizedState),(et=zs||ko(s,h,et,_,He,Ke,we)||r!==null&&r.dependencies!==null&&ac(r.dependencies))?(Ge||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(_,Ke,we),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(_,Ke,we)),typeof z.componentDidUpdate=="function"&&(s.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof z.componentDidUpdate!="function"||G===r.memoizedProps&&He===r.memoizedState||(s.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||G===r.memoizedProps&&He===r.memoizedState||(s.flags|=1024),s.memoizedProps=_,s.memoizedState=Ke),z.props=_,z.state=Ke,z.context=we,_=et):(typeof z.componentDidUpdate!="function"||G===r.memoizedProps&&He===r.memoizedState||(s.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||G===r.memoizedProps&&He===r.memoizedState||(s.flags|=1024),_=!1)}return z=_,If(r,s),_=(s.flags&128)!==0,z||_?(z=s.stateNode,h=_&&typeof h.getDerivedStateFromError!="function"?null:z.render(),s.flags|=1,r!==null&&_?(s.child=Ds(s,r.child,null,A),s.child=Ds(s,null,h,A)):fr(r,s,h,A),s.memoizedState=z.state,r=s.child):r=Bo(r,s,A),r}function vg(r,s,h,_){return ws(),s.flags|=256,fr(r,s,h,_),s.child}var Rf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function fd(r){return{baseLanes:r,cachePool:Ef()}}function kf(r,s,h){return r=r!==null?r.childLanes&~h:0,s&&(r|=kr),r}function $p(r,s,h){var _=s.pendingProps,A=!1,z=(s.flags&128)!==0,G;if((G=z)||(G=r!==null&&r.memoizedState===null?!1:(gn.current&2)!==0),G&&(A=!0,s.flags&=-129),G=(s.flags&32)!==0,s.flags&=-33,r===null){if(ui){if(A?Pa(s):En(),(r=Bi)?(r=Tc(r,la),r=r!==null&&r.data!=="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:xs!==null?{id:vs,overflow:Fr}:null,retryLane:536870912,hydrationErrors:null},h=th(r),h.return=s,s.child=h,er=s,Bi=null)):r=null,r===null)throw Nr(s);return Gn(r)?s.lanes=32:s.lanes=536870912,null}var ne=_.children;return _=_.fallback,A?(En(),A=s.mode,ne=Lf({mode:"hidden",children:ne},A),_=Eo(_,A,h,null),ne.return=s,_.return=s,ne.sibling=_,s.child=ne,_=s.child,_.memoizedState=fd(h),_.childLanes=kf(r,G,h),s.memoizedState=Rf,jo(null,_)):(Pa(s),Xp(s,ne))}var we=r.memoizedState;if(we!==null&&(ne=we.dehydrated,ne!==null)){if(z)s.flags&256?(Pa(s),s.flags&=-257,s=jf(r,s,h)):s.memoizedState!==null?(En(),s.child=r.child,s.flags|=128,s=null):(En(),ne=_.fallback,A=s.mode,_=Lf({mode:"visible",children:_.children},A),ne=Eo(ne,A,h,null),ne.flags|=2,_.return=s,ne.return=s,_.sibling=ne,s.child=_,Ds(s,r.child,null,h),_=s.child,_.memoizedState=fd(h),_.childLanes=kf(r,G,h),s.memoizedState=Rf,s=jo(null,_));else if(Pa(s),Gn(ne)){if(G=ne.nextSibling&&ne.nextSibling.dataset,G)var Ge=G.dgst;G=Ge,_=Error(S(419)),_.stack="",_.digest=G,$s({value:_,source:null,stack:null}),s=jf(r,s,h)}else if(nr||ca(r,s,h,!1),G=(h&r.childLanes)!==0,nr||G){if(G=rn,G!==null&&(_=ln(G,h),_!==0&&_!==we.retryLane))throw we.retryLane=_,Aa(r,_),Fa(G,r,_),Df;Hr(ne)||zd(),s=jf(r,s,h)}else Hr(ne)?(s.flags|=192,s.child=r.child,s=null):(r=we.treeContext,Bi=rs(ne.nextSibling),er=s,ui=!0,Hs=null,la=!1,r!==null&&ad(s,r),s=Xp(s,_.children),s.flags|=4096);return s}return A?(En(),ne=_.fallback,A=s.mode,we=r.child,Ge=we.sibling,_=oa(we,{mode:"hidden",children:_.children}),_.subtreeFlags=we.subtreeFlags&65011712,Ge!==null?ne=oa(Ge,ne):(ne=Eo(ne,A,h,null),ne.flags|=2),ne.return=s,_.return=s,_.sibling=ne,s.child=_,jo(null,_),_=s.child,ne=r.child.memoizedState,ne===null?ne=fd(h):(A=ne.cachePool,A!==null?(we=Mn._currentValue,A=A.parent!==we?{parent:we,pool:we}:A):A=Ef(),ne={baseLanes:ne.baseLanes|h,cachePool:A}),_.memoizedState=ne,_.childLanes=kf(r,G,h),s.memoizedState=Rf,jo(r.child,_)):(Pa(s),h=r.child,r=h.sibling,h=oa(h,{mode:"visible",children:_.children}),h.return=s,h.sibling=null,r!==null&&(G=s.deletions,G===null?(s.deletions=[r],s.flags|=16):G.push(r)),s.child=h,s.memoizedState=null,h)}function Xp(r,s){return s=Lf({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function Lf(r,s){return r=sa(22,r,null,s),r.lanes=0,r}function jf(r,s,h){return Ds(s,r.child,null,h),r=Xp(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function Yp(r,s,h){r.lanes|=s;var _=r.alternate;_!==null&&(_.lanes|=s),ih(r.return,s,h)}function Wp(r,s,h,_,A,z){var G=r.memoizedState;G===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:_,tail:h,tailMode:A,treeForkCount:z}:(G.isBackwards=s,G.rendering=null,G.renderingStartTime=0,G.last=_,G.tail=h,G.tailMode=A,G.treeForkCount=z)}function Bf(r,s,h){var _=s.pendingProps,A=_.revealOrder,z=_.tail;_=_.children;var G=gn.current,ne=(G&2)!==0;if(ne?(G=G&1|2,s.flags|=128):G&=1,St(gn,G),fr(r,s,_,h),_=ui?zo:0,!ne&&r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Yp(r,h,s);else if(r.tag===19)Yp(r,h,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(A){case"forwards":for(h=s.child,A=null;h!==null;)r=h.alternate,r!==null&&mu(r)===null&&(A=h),h=h.sibling;h=A,h===null?(A=s.child,s.child=null):(A=h.sibling,h.sibling=null),Wp(s,!1,A,h,z,_);break;case"backwards":case"unstable_legacy-backwards":for(h=null,A=s.child,s.child=null;A!==null;){if(r=A.alternate,r!==null&&mu(r)===null){s.child=A;break}r=A.sibling,A.sibling=h,h=A,A=r}Wp(s,!0,h,null,z,_);break;case"together":Wp(s,!1,null,null,void 0,_);break;default:s.memoizedState=null}return s.child}function Bo(r,s,h){if(r!==null&&(s.dependencies=r.dependencies),El|=s.lanes,(h&s.childLanes)===0)if(r!==null){if(ca(r,s,h,!1),(h&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(S(153));if(s.child!==null){for(r=s.child,h=oa(r,r.pendingProps),s.child=h,h.return=s;r.sibling!==null;)r=r.sibling,h=h.sibling=oa(r,r.pendingProps),h.return=s;h.sibling=null}return s.child}function pd(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&ac(r)))}function md(r,s,h){switch(s.tag){case 3:Li(s,s.stateNode.containerInfo),Ys(s,Mn,r.memoizedState.cache),ws();break;case 27:case 5:va(s);break;case 4:Li(s,s.stateNode.containerInfo);break;case 10:Ys(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,cc(s),null;break;case 13:var _=s.memoizedState;if(_!==null)return _.dehydrated!==null?(Pa(s),s.flags|=128,null):(h&s.child.childLanes)!==0?$p(r,s,h):(Pa(s),r=Bo(r,s,h),r!==null?r.sibling:null);Pa(s);break;case 19:var A=(r.flags&128)!==0;if(_=(h&s.childLanes)!==0,_||(ca(r,s,h,!1),_=(h&s.childLanes)!==0),A){if(_)return Bf(r,s,h);s.flags|=128}if(A=s.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),St(gn,gn.current),_)break;return null;case 22:return s.lanes=0,Zp(r,s,h,s.pendingProps);case 24:Ys(s,Mn,r.memoizedState.cache)}return Bo(r,s,h)}function Zr(r,s,h){if(r!==null)if(r.memoizedProps!==s.pendingProps)nr=!0;else{if(!pd(r,h)&&(s.flags&128)===0)return nr=!1,md(r,s,h);nr=(r.flags&131072)!==0}else nr=!1,ui&&(s.flags&1048576)!==0&&rd(s,zo,s.index);switch(s.lanes=0,s.tag){case 16:e:{var _=s.pendingProps;if(r=Da(s.elementType),s.type=r,typeof r=="function")Ju(r)?(_=Lo(r,_),s.tag=1,s=xg(null,s,r,_,h)):(s.tag=0,s=Hp(null,s,r,_,h));else{if(r!=null){var A=r.$$typeof;if(A===gt){s.tag=11,s=gg(null,s,r,_,h);break e}else if(A===_t){s.tag=14,s=zf(null,s,r,_,h);break e}}throw s=yr(r)||r,Error(S(306,s,""))}}return s;case 0:return Hp(r,s,s.type,s.pendingProps,h);case 1:return _=s.type,A=Lo(_,s.pendingProps),xg(r,s,_,A,h);case 3:e:{if(Li(s,s.stateNode.containerInfo),r===null)throw Error(S(387));_=s.pendingProps;var z=s.memoizedState;A=z.element,hu(r,s),Io(s,_,null,h);var G=s.memoizedState;if(_=G.cache,Ys(s,Mn,_),_!==z.cache&&nh(s,[Mn],h,!0),Qs(),_=G.element,z.isDehydrated)if(z={element:_,isDehydrated:!1,cache:G.cache},s.updateQueue.baseState=z,s.memoizedState=z,s.flags&256){s=vg(r,s,_,h);break e}else if(_!==A){A=Rr(Error(S(424)),s),$s(A),s=vg(r,s,_,h);break e}else for(r=s.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,Bi=rs(r.firstChild),er=s,ui=!0,Hs=null,la=!0,h=ld(s,null,_,h),s.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(ws(),_===A){s=Bo(r,s,h);break e}fr(r,s,_,h)}s=s.child}return s;case 26:return If(r,s),r===null?(h=zm(s.type,null,s.pendingProps,null))?s.memoizedState=h:ui||(h=s.type,r=s.pendingProps,_=jd(Nt.current).createElement(h),_[ci]=s,_[ht]=r,mr(_,h,r),fn(_),s.stateNode=_):s.memoizedState=zm(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return va(s),r===null&&ui&&(_=s.stateNode=ey(s.type,s.pendingProps,Nt.current),er=s,la=!0,A=Bi,wc(s.type)?(ga=A,Bi=rs(_.firstChild)):Bi=A),fr(r,s,s.pendingProps.children,h),If(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&ui&&((A=_=Bi)&&(_=br(_,s.type,s.pendingProps,la),_!==null?(s.stateNode=_,er=s,Bi=rs(_.firstChild),la=!1,A=!0):A=!1),A||Nr(s)),va(s),A=s.type,z=s.pendingProps,G=r!==null?r.memoizedProps:null,_=z.children,up(A,z)?_=null:G!==null&&up(A,G)&&(s.flags|=32),s.memoizedState!==null&&(A=uc(r,s,yu,null,null,h),Rh._currentValue=A),If(r,s),fr(r,s,_,h),s.child;case 6:return r===null&&ui&&((r=h=Bi)&&(h=lo(h,s.pendingProps,la),h!==null?(s.stateNode=h,er=s,Bi=null,r=!0):r=!1),r||Nr(s)),null;case 13:return $p(r,s,h);case 4:return Li(s,s.stateNode.containerInfo),_=s.pendingProps,r===null?s.child=Ds(s,null,_,h):fr(r,s,_,h),s.child;case 11:return gg(r,s,s.type,s.pendingProps,h);case 7:return fr(r,s,s.pendingProps,h),s.child;case 8:return fr(r,s,s.pendingProps.children,h),s.child;case 12:return fr(r,s,s.pendingProps.children,h),s.child;case 10:return _=s.pendingProps,Ys(s,s.type,_.value),fr(r,s,_.children,h),s.child;case 9:return A=s.type._context,_=s.pendingProps.children,Ws(s),A=Pn(A),_=_(A),s.flags|=1,fr(r,s,_,h),s.child;case 14:return zf(r,s,s.type,s.pendingProps,h);case 15:return qp(r,s,s.type,s.pendingProps,h);case 19:return Bf(r,s,h);case 31:return Pf(r,s,h);case 22:return Zp(r,s,h,s.pendingProps);case 24:return Ws(s),_=Pn(Mn),r===null?(A=ah(),A===null&&(A=rn,z=Es(),A.pooledCache=z,z.refCount++,z!==null&&(A.pooledCacheLanes|=h),A=z),s.memoizedState={parent:_,cache:A},uh(s),Ys(s,Mn,A)):((r.lanes&h)!==0&&(hu(r,s),Io(s,null,null,h),Qs()),A=r.memoizedState,z=s.memoizedState,A.parent!==_?(A={parent:_,cache:_},s.memoizedState=A,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=A),Ys(s,Mn,_)):(_=z.cache,Ys(s,Mn,_),_!==A.cache&&nh(s,[Mn],h,!0))),fr(r,s,s.pendingProps.children,h),s.child;case 29:throw s.pendingProps}throw Error(S(156,s.tag))}function Oo(r){r.flags|=4}function gd(r,s,h,_,A){if((s=(r.mode&32)!==0)&&(s=!1),s){if(r.flags|=16777216,(A&335544128)===A)if(r.stateNode.complete)r.flags|=8192;else if(lm())r.flags|=8192;else throw Ya=wt,Po}else r.flags&=-16777217}function bg(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Nd(s))if(lm())r.flags|=8192;else throw Ya=wt,Po}function yd(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?Rt():536870912,r.lanes|=s,Eu|=s)}function _d(r,s){if(!ui)switch(r.tailMode){case"hidden":s=r.tail;for(var h=null;s!==null;)s.alternate!==null&&(h=s),s=s.sibling;h===null?r.tail=null:h.sibling=null;break;case"collapsed":h=r.tail;for(var _=null;h!==null;)h.alternate!==null&&(_=h),h=h.sibling;_===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:_.sibling=null}}function xn(r){var s=r.alternate!==null&&r.alternate.child===r.child,h=0,_=0;if(s)for(var A=r.child;A!==null;)h|=A.lanes|A.childLanes,_|=A.subtreeFlags&65011712,_|=A.flags&65011712,A.return=r,A=A.sibling;else for(A=r.child;A!==null;)h|=A.lanes|A.childLanes,_|=A.subtreeFlags,_|=A.flags,A.return=r,A=A.sibling;return r.subtreeFlags|=_,r.childLanes=h,s}function wg(r,s,h){var _=s.pendingProps;switch(rc(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xn(s),null;case 1:return xn(s),null;case 3:return h=s.stateNode,_=null,r!==null&&(_=r.memoizedState.cache),s.memoizedState.cache!==_&&(s.flags|=2048),Ms(Mn),Xi(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(bs(s)?Oo(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Ts())),xn(s),null;case 26:var A=s.type,z=s.memoizedState;return r===null?(Oo(s),z!==null?(xn(s),bg(s,z)):(xn(s),gd(s,A,null,_,h))):z?z!==r.memoizedState?(Oo(s),xn(s),bg(s,z)):(xn(s),s.flags&=-16777217):(r=r.memoizedProps,r!==_&&Oo(s),xn(s),gd(s,A,r,_,h)),null;case 27:if(Kr(s),h=Nt.current,A=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==_&&Oo(s);else{if(!_){if(s.stateNode===null)throw Error(S(166));return xn(s),null}r=zt.current,bs(s)?Vr(s):(r=ey(A,_,h),s.stateNode=r,Oo(s))}return xn(s),null;case 5:if(Kr(s),A=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==_&&Oo(s);else{if(!_){if(s.stateNode===null)throw Error(S(166));return xn(s),null}if(z=zt.current,bs(s))Vr(s);else{var G=jd(Nt.current);switch(z){case 1:z=G.createElementNS("http://www.w3.org/2000/svg",A);break;case 2:z=G.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;default:switch(A){case"svg":z=G.createElementNS("http://www.w3.org/2000/svg",A);break;case"math":z=G.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;case"script":z=G.createElement("div"),z.innerHTML="<script><\/script>",z=z.removeChild(z.firstChild);break;case"select":z=typeof _.is=="string"?G.createElement("select",{is:_.is}):G.createElement("select"),_.multiple?z.multiple=!0:_.size&&(z.size=_.size);break;default:z=typeof _.is=="string"?G.createElement(A,{is:_.is}):G.createElement(A)}}z[ci]=s,z[ht]=_;e:for(G=s.child;G!==null;){if(G.tag===5||G.tag===6)z.appendChild(G.stateNode);else if(G.tag!==4&&G.tag!==27&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===s)break e;for(;G.sibling===null;){if(G.return===null||G.return===s)break e;G=G.return}G.sibling.return=G.return,G=G.sibling}s.stateNode=z;e:switch(mr(z,A,_),A){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}_&&Oo(s)}}return xn(s),gd(s,s.type,r===null?null:r.memoizedProps,s.pendingProps,h),null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==_&&Oo(s);else{if(typeof _!="string"&&s.stateNode===null)throw Error(S(166));if(r=Nt.current,bs(s)){if(r=s.stateNode,h=s.memoizedProps,_=null,A=er,A!==null)switch(A.tag){case 27:case 5:_=A.memoizedProps}r[ci]=s,r=!!(r.nodeValue===h||_!==null&&_.suppressHydrationWarning===!0||vm(r.nodeValue,h)),r||Nr(s,!0)}else r=jd(r).createTextNode(_),r[ci]=s,s.stateNode=r}return xn(s),null;case 31:if(h=s.memoizedState,r===null||r.memoizedState!==null){if(_=bs(s),h!==null){if(r===null){if(!_)throw Error(S(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(S(557));r[ci]=s}else ws(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;xn(s),r=!1}else h=Ts(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=h),r=!0;if(!r)return s.flags&256?(un(s),s):(un(s),null);if((s.flags&128)!==0)throw Error(S(558))}return xn(s),null;case 13:if(_=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(A=bs(s),_!==null&&_.dehydrated!==null){if(r===null){if(!A)throw Error(S(318));if(A=s.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(S(317));A[ci]=s}else ws(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;xn(s),A=!1}else A=Ts(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=A),A=!0;if(!A)return s.flags&256?(un(s),s):(un(s),null)}return un(s),(s.flags&128)!==0?(s.lanes=h,s):(h=_!==null,r=r!==null&&r.memoizedState!==null,h&&(_=s.child,A=null,_.alternate!==null&&_.alternate.memoizedState!==null&&_.alternate.memoizedState.cachePool!==null&&(A=_.alternate.memoizedState.cachePool.pool),z=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(z=_.memoizedState.cachePool.pool),z!==A&&(_.flags|=2048)),h!==r&&h&&(s.child.flags|=8192),yd(s,s.updateQueue),xn(s),null);case 4:return Xi(),r===null&&_m(s.stateNode.containerInfo),xn(s),null;case 10:return Ms(s.type),xn(s),null;case 19:if(ot(gn),_=s.memoizedState,_===null)return xn(s),null;if(A=(s.flags&128)!==0,z=_.rendering,z===null)if(A)_d(_,!1);else{if(Rn!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(z=mu(r),z!==null){for(s.flags|=128,_d(_,!1),r=z.updateQueue,s.updateQueue=r,yd(s,r),s.subtreeFlags=0,r=h,h=s.child;h!==null;)Sf(h,r),h=h.sibling;return St(gn,gn.current&1|2),ui&&Zs(s,_.treeForkCount),s.child}r=r.sibling}_.tail!==null&&Qn()>Ad&&(s.flags|=128,A=!0,_d(_,!1),s.lanes=4194304)}else{if(!A)if(r=mu(z),r!==null){if(s.flags|=128,A=!0,r=r.updateQueue,s.updateQueue=r,yd(s,r),_d(_,!0),_.tail===null&&_.tailMode==="hidden"&&!z.alternate&&!ui)return xn(s),null}else 2*Qn()-_.renderingStartTime>Ad&&h!==536870912&&(s.flags|=128,A=!0,_d(_,!1),s.lanes=4194304);_.isBackwards?(z.sibling=s.child,s.child=z):(r=_.last,r!==null?r.sibling=z:s.child=z,_.last=z)}return _.tail!==null?(r=_.tail,_.rendering=r,_.tail=r.sibling,_.renderingStartTime=Qn(),r.sibling=null,h=gn.current,St(gn,A?h&1|2:h&1),ui&&Zs(s,_.treeForkCount),r):(xn(s),null);case 22:case 23:return un(s),pl(),_=s.memoizedState!==null,r!==null?r.memoizedState!==null!==_&&(s.flags|=8192):_&&(s.flags|=8192),_?(h&536870912)!==0&&(s.flags&128)===0&&(xn(s),s.subtreeFlags&6&&(s.flags|=8192)):xn(s),h=s.updateQueue,h!==null&&yd(s,h.retryQueue),h=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),_=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(_=s.memoizedState.cachePool.pool),_!==h&&(s.flags|=2048),r!==null&&ot($a),null;case 24:return h=null,r!==null&&(h=r.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),Ms(Mn),xn(s),null;case 25:return null;case 30:return null}throw Error(S(156,s.tag))}function qy(r,s){switch(rc(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return Ms(Mn),Xi(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return Kr(s),null;case 31:if(s.memoizedState!==null){if(un(s),s.alternate===null)throw Error(S(340));ws()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 13:if(un(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(S(340));ws()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return ot(gn),null;case 4:return Xi(),null;case 10:return Ms(s.type),null;case 22:case 23:return un(s),pl(),r!==null&&ot($a),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return Ms(Mn),null;case 25:return null;default:return null}}function Of(r,s){switch(rc(s),s.tag){case 3:Ms(Mn),Xi();break;case 26:case 27:case 5:Kr(s);break;case 4:Xi();break;case 31:s.memoizedState!==null&&un(s);break;case 13:un(s);break;case 19:ot(gn);break;case 10:Ms(s.type);break;case 22:case 23:un(s),pl(),r!==null&&ot($a);break;case 24:Ms(Mn)}}function gh(r,s){try{var h=s.updateQueue,_=h!==null?h.lastEffect:null;if(_!==null){var A=_.next;h=A;do{if((h.tag&r)===r){_=void 0;var z=h.create,G=h.inst;_=z(),G.destroy=_}h=h.next}while(h!==A)}}catch(ne){Vi(s,s.return,ne)}}function bl(r,s,h){try{var _=s.updateQueue,A=_!==null?_.lastEffect:null;if(A!==null){var z=A.next;_=z;do{if((_.tag&r)===r){var G=_.inst,ne=G.destroy;if(ne!==void 0){G.destroy=void 0,A=s;var we=h,Ge=ne;try{Ge()}catch(et){Vi(A,we,et)}}}_=_.next}while(_!==z)}}catch(et){Vi(s,s.return,et)}}function Tg(r){var s=r.updateQueue;if(s!==null){var h=r.stateNode;try{hh(s,h)}catch(_){Vi(r,r.return,_)}}}function Sg(r,s,h){h.props=Lo(r.type,r.memoizedProps),h.state=r.memoizedState;try{h.componentWillUnmount()}catch(_){Vi(r,s,_)}}function xd(r,s){try{var h=r.ref;if(h!==null){switch(r.tag){case 26:case 27:case 5:var _=r.stateNode;break;case 30:_=r.stateNode;break;default:_=r.stateNode}typeof h=="function"?r.refCleanup=h(_):h.current=_}}catch(A){Vi(r,s,A)}}function is(r,s){var h=r.ref,_=r.refCleanup;if(h!==null)if(typeof _=="function")try{_()}catch(A){Vi(r,s,A)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(A){Vi(r,s,A)}else h.current=null}function Ff(r){var s=r.type,h=r.memoizedProps,_=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":h.autoFocus&&_.focus();break e;case"img":h.src?_.src=h.src:h.srcSet&&(_.srcset=h.srcSet)}}catch(A){Vi(r,r.return,A)}}function Nf(r,s,h){try{var _=r.stateNode;Qg(_,r.type,h,s),_[ht]=s}catch(A){Vi(r,r.return,A)}}function pc(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&wc(r.type)||r.tag===4}function wu(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||pc(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&wc(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Kp(r,s,h){var _=r.tag;if(_===5||_===6)r=r.stateNode,s?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(r,s):(s=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,s.appendChild(r),h=h._reactRootContainer,h!=null||s.onclick!==null||(s.onclick=Za));else if(_!==4&&(_===27&&wc(r.type)&&(h=r.stateNode,s=null),r=r.child,r!==null))for(Kp(r,s,h),r=r.sibling;r!==null;)Kp(r,s,h),r=r.sibling}function Vf(r,s,h){var _=r.tag;if(_===5||_===6)r=r.stateNode,s?h.insertBefore(r,s):h.appendChild(r);else if(_!==4&&(_===27&&wc(r.type)&&(h=r.stateNode),r=r.child,r!==null))for(Vf(r,s,h),r=r.sibling;r!==null;)Vf(r,s,h),r=r.sibling}function Mg(r){var s=r.stateNode,h=r.memoizedProps;try{for(var _=r.type,A=s.attributes;A.length;)s.removeAttributeNode(A[0]);mr(s,_,h),s[ci]=r,s[ht]=h}catch(z){Vi(r,r.return,z)}}var wl=!1,rr=!1,Qp=!1,Eg=typeof WeakSet=="function"?WeakSet:Set,ar=null;function Zy(r,s){if(r=r.containerInfo,Ld=Zd,r=$u(r),Qc(r)){if("selectionStart"in r)var h={start:r.selectionStart,end:r.selectionEnd};else e:{h=(h=r.ownerDocument)&&h.defaultView||window;var _=h.getSelection&&h.getSelection();if(_&&_.rangeCount!==0){h=_.anchorNode;var A=_.anchorOffset,z=_.focusNode;_=_.focusOffset;try{h.nodeType,z.nodeType}catch{h=null;break e}var G=0,ne=-1,we=-1,Ge=0,et=0,ct=r,He=null;t:for(;;){for(var Ke;ct!==h||A!==0&&ct.nodeType!==3||(ne=G+A),ct!==z||_!==0&&ct.nodeType!==3||(we=G+_),ct.nodeType===3&&(G+=ct.nodeValue.length),(Ke=ct.firstChild)!==null;)He=ct,ct=Ke;for(;;){if(ct===r)break t;if(He===h&&++Ge===A&&(ne=G),He===z&&++et===_&&(we=G),(Ke=ct.nextSibling)!==null)break;ct=He,He=ct.parentNode}ct=Ke}h=ne===-1||we===-1?null:{start:ne,end:we}}else h=null}h=h||{start:0,end:0}}else h=null;for(bm={focusedElem:r,selectionRange:h},Zd=!1,ar=s;ar!==null;)if(s=ar,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,ar=r;else for(;ar!==null;){switch(s=ar,z=s.alternate,r=s.flags,s.tag){case 0:if((r&4)!==0&&(r=s.updateQueue,r=r!==null?r.events:null,r!==null))for(h=0;h<r.length;h++)A=r[h],A.ref.impl=A.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&z!==null){r=void 0,h=s,A=z.memoizedProps,z=z.memoizedState,_=h.stateNode;try{var kt=Lo(h.type,A);r=_.getSnapshotBeforeUpdate(kt,z),_.__reactInternalSnapshotBeforeUpdate=r}catch(Zt){Vi(h,h.return,Zt)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,h=r.nodeType,h===9)oo(r);else if(h===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":oo(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(S(163))}if(r=s.sibling,r!==null){r.return=s.return,ar=r;break}ar=s.return}}function Jp(r,s,h){var _=h.flags;switch(h.tag){case 0:case 11:case 15:ja(r,h),_&4&&gh(5,h);break;case 1:if(ja(r,h),_&4)if(r=h.stateNode,s===null)try{r.componentDidMount()}catch(G){Vi(h,h.return,G)}else{var A=Lo(h.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(A,s,r.__reactInternalSnapshotBeforeUpdate)}catch(G){Vi(h,h.return,G)}}_&64&&Tg(h),_&512&&xd(h,h.return);break;case 3:if(ja(r,h),_&64&&(r=h.updateQueue,r!==null)){if(s=null,h.child!==null)switch(h.child.tag){case 27:case 5:s=h.child.stateNode;break;case 1:s=h.child.stateNode}try{hh(r,s)}catch(G){Vi(h,h.return,G)}}break;case 27:s===null&&_&4&&Mg(h);case 26:case 5:ja(r,h),s===null&&_&4&&Ff(h),_&512&&xd(h,h.return);break;case 12:ja(r,h);break;case 31:ja(r,h),_&4&&vd(r,h);break;case 13:ja(r,h),_&4&&bd(r,h),_&64&&(r=h.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(h=um.bind(null,h),or(r,h))));break;case 22:if(_=h.memoizedState!==null||wl,!_){s=s!==null&&s.memoizedState!==null||rr,A=wl;var z=rr;wl=_,(rr=s)&&!z?Tl(r,h,(h.subtreeFlags&8772)!==0):ja(r,h),wl=A,rr=z}break;case 30:break;default:ja(r,h)}}function yh(r){var s=r.alternate;s!==null&&(r.alternate=null,yh(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&Xo(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var An=null,vi=!1;function La(r,s,h){for(h=h.child;h!==null;)em(r,s,h),h=h.sibling}function em(r,s,h){if(pe&&typeof pe.onCommitFiberUnmount=="function")try{pe.onCommitFiberUnmount(J,h)}catch{}switch(h.tag){case 26:rr||is(h,s),La(r,s,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:rr||is(h,s);var _=An,A=vi;wc(h.type)&&(An=h.stateNode,vi=!1),La(r,s,h),zh(h.stateNode),An=_,vi=A;break;case 5:rr||is(h,s);case 6:if(_=An,A=vi,An=null,La(r,s,h),An=_,vi=A,An!==null)if(vi)try{(An.nodeType===9?An.body:An.nodeName==="HTML"?An.ownerDocument.body:An).removeChild(h.stateNode)}catch(z){Vi(h,s,z)}else try{An.removeChild(h.stateNode)}catch(z){Vi(h,s,z)}break;case 18:An!==null&&(vi?(r=An,Jg(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,h.stateNode),Cc(r)):Jg(An,h.stateNode));break;case 4:_=An,A=vi,An=h.stateNode.containerInfo,vi=!0,La(r,s,h),An=_,vi=A;break;case 0:case 11:case 14:case 15:bl(2,h,s),rr||bl(4,h,s),La(r,s,h);break;case 1:rr||(is(h,s),_=h.stateNode,typeof _.componentWillUnmount=="function"&&Sg(h,s,_)),La(r,s,h);break;case 21:La(r,s,h);break;case 22:rr=(_=rr)||h.memoizedState!==null,La(r,s,h),rr=_;break;default:La(r,s,h)}}function vd(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Cc(r)}catch(h){Vi(s,s.return,h)}}}function bd(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Cc(r)}catch(h){Vi(s,s.return,h)}}function wd(r){switch(r.tag){case 31:case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new Eg),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new Eg),s;default:throw Error(S(435,r.tag))}}function Td(r,s){var h=wd(r);s.forEach(function(_){if(!h.has(_)){h.add(_);var A=Xy.bind(null,r,_);_.then(A,A)}})}function fa(r,s){var h=s.deletions;if(h!==null)for(var _=0;_<h.length;_++){var A=h[_],z=r,G=s,ne=G;e:for(;ne!==null;){switch(ne.tag){case 27:if(wc(ne.type)){An=ne.stateNode,vi=!1;break e}break;case 5:An=ne.stateNode,vi=!1;break e;case 3:case 4:An=ne.stateNode.containerInfo,vi=!0;break e}ne=ne.return}if(An===null)throw Error(S(160));em(z,G,A),An=null,vi=!1,z=A.alternate,z!==null&&(z.return=null),A.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Uf(s,r),s=s.sibling}var pa=null;function Uf(r,s){var h=r.alternate,_=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:fa(s,r),pr(r),_&4&&(bl(3,r,r.return),gh(3,r),bl(5,r,r.return));break;case 1:fa(s,r),pr(r),_&512&&(rr||h===null||is(h,h.return)),_&64&&wl&&(r=r.updateQueue,r!==null&&(_=r.callbacks,_!==null&&(h=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=h===null?_:h.concat(_))));break;case 26:var A=pa;if(fa(s,r),pr(r),_&512&&(rr||h===null||is(h,h.return)),_&4){var z=h!==null?h.memoizedState:null;if(_=r.memoizedState,h===null)if(_===null)if(r.stateNode===null){e:{_=r.type,h=r.memoizedProps,A=A.ownerDocument||A;t:switch(_){case"title":z=A.getElementsByTagName("title")[0],(!z||z[Xt]||z[ci]||z.namespaceURI==="http://www.w3.org/2000/svg"||z.hasAttribute("itemprop"))&&(z=A.createElement(_),A.head.insertBefore(z,A.querySelector("head > title"))),mr(z,_,h),z[ci]=r,fn(z),_=z;break e;case"link":var G=km("link","href",A).get(_+(h.href||""));if(G){for(var ne=0;ne<G.length;ne++)if(z=G[ne],z.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&z.getAttribute("rel")===(h.rel==null?null:h.rel)&&z.getAttribute("title")===(h.title==null?null:h.title)&&z.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){G.splice(ne,1);break t}}z=A.createElement(_),mr(z,_,h),A.head.appendChild(z);break;case"meta":if(G=km("meta","content",A).get(_+(h.content||""))){for(ne=0;ne<G.length;ne++)if(z=G[ne],z.getAttribute("content")===(h.content==null?null:""+h.content)&&z.getAttribute("name")===(h.name==null?null:h.name)&&z.getAttribute("property")===(h.property==null?null:h.property)&&z.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&z.getAttribute("charset")===(h.charSet==null?null:h.charSet)){G.splice(ne,1);break t}}z=A.createElement(_),mr(z,_,h),A.head.appendChild(z);break;default:throw Error(S(468,_))}z[ci]=r,fn(z),_=z}r.stateNode=_}else Fd(A,r.type,r.stateNode);else r.stateNode=Rm(A,_,r.memoizedProps);else z!==_?(z===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):z.count--,_===null?Fd(A,r.type,r.stateNode):Rm(A,_,r.memoizedProps)):_===null&&r.stateNode!==null&&Nf(r,r.memoizedProps,h.memoizedProps)}break;case 27:fa(s,r),pr(r),_&512&&(rr||h===null||is(h,h.return)),h!==null&&_&4&&Nf(r,r.memoizedProps,h.memoizedProps);break;case 5:if(fa(s,r),pr(r),_&512&&(rr||h===null||is(h,h.return)),r.flags&32){A=r.stateNode;try{Gs(A,"")}catch(kt){Vi(r,r.return,kt)}}_&4&&r.stateNode!=null&&(A=r.memoizedProps,Nf(r,A,h!==null?h.memoizedProps:A)),_&1024&&(Qp=!0);break;case 6:if(fa(s,r),pr(r),_&4){if(r.stateNode===null)throw Error(S(162));_=r.memoizedProps,h=r.stateNode;try{h.nodeValue=_}catch(kt){Vi(r,r.return,kt)}}break;case 3:if(gp=null,A=pa,pa=fp(s.containerInfo),fa(s,r),pa=A,pr(r),_&4&&h!==null&&h.memoizedState.isDehydrated)try{Cc(s.containerInfo)}catch(kt){Vi(r,r.return,kt)}Qp&&(Qp=!1,Sd(r));break;case 4:_=pa,pa=fp(r.stateNode.containerInfo),fa(s,r),pr(r),pa=_;break;case 12:fa(s,r),pr(r);break;case 31:fa(s,r),pr(r),_&4&&(_=r.updateQueue,_!==null&&(r.updateQueue=null,Td(r,_)));break;case 13:fa(s,r),pr(r),r.child.flags&8192&&r.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Zf=Qn()),_&4&&(_=r.updateQueue,_!==null&&(r.updateQueue=null,Td(r,_)));break;case 22:A=r.memoizedState!==null;var we=h!==null&&h.memoizedState!==null,Ge=wl,et=rr;if(wl=Ge||A,rr=et||we,fa(s,r),rr=et,wl=Ge,pr(r),_&8192)e:for(s=r.stateNode,s._visibility=A?s._visibility&-2:s._visibility|1,A&&(h===null||we||wl||rr||ro(r)),h=null,s=r;;){if(s.tag===5||s.tag===26){if(h===null){we=h=s;try{if(z=we.stateNode,A)G=z.style,typeof G.setProperty=="function"?G.setProperty("display","none","important"):G.display="none";else{ne=we.stateNode;var ct=we.memoizedProps.style,He=ct!=null&&ct.hasOwnProperty("display")?ct.display:null;ne.style.display=He==null||typeof He=="boolean"?"":(""+He).trim()}}catch(kt){Vi(we,we.return,kt)}}}else if(s.tag===6){if(h===null){we=s;try{we.stateNode.nodeValue=A?"":we.memoizedProps}catch(kt){Vi(we,we.return,kt)}}}else if(s.tag===18){if(h===null){we=s;try{var Ke=we.stateNode;A?ai(Ke,!0):ai(we.stateNode,!1)}catch(kt){Vi(we,we.return,kt)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;h===s&&(h=null),s=s.return}h===s&&(h=null),s.sibling.return=s.return,s=s.sibling}_&4&&(_=r.updateQueue,_!==null&&(h=_.retryQueue,h!==null&&(_.retryQueue=null,Td(r,h))));break;case 19:fa(s,r),pr(r),_&4&&(_=r.updateQueue,_!==null&&(r.updateQueue=null,Td(r,_)));break;case 30:break;case 21:break;default:fa(s,r),pr(r)}}function pr(r){var s=r.flags;if(s&2){try{for(var h,_=r.return;_!==null;){if(pc(_)){h=_;break}_=_.return}if(h==null)throw Error(S(160));switch(h.tag){case 27:var A=h.stateNode,z=wu(r);Vf(r,z,A);break;case 5:var G=h.stateNode;h.flags&32&&(Gs(G,""),h.flags&=-33);var ne=wu(r);Vf(r,ne,G);break;case 3:case 4:var we=h.stateNode.containerInfo,Ge=wu(r);Kp(r,Ge,we);break;default:throw Error(S(161))}}catch(et){Vi(r,r.return,et)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function Sd(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;Sd(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function ja(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Jp(r,s.alternate,s),s=s.sibling}function ro(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:bl(4,s,s.return),ro(s);break;case 1:is(s,s.return);var h=s.stateNode;typeof h.componentWillUnmount=="function"&&Sg(s,s.return,h),ro(s);break;case 27:zh(s.stateNode);case 26:case 5:is(s,s.return),ro(s);break;case 22:s.memoizedState===null&&ro(s);break;case 30:ro(s);break;default:ro(s)}r=r.sibling}}function Tl(r,s,h){for(h=h&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var _=s.alternate,A=r,z=s,G=z.flags;switch(z.tag){case 0:case 11:case 15:Tl(A,z,h),gh(4,z);break;case 1:if(Tl(A,z,h),_=z,A=_.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch(Ge){Vi(_,_.return,Ge)}if(_=z,A=_.updateQueue,A!==null){var ne=_.stateNode;try{var we=A.shared.hiddenCallbacks;if(we!==null)for(A.shared.hiddenCallbacks=null,A=0;A<we.length;A++)du(we[A],ne)}catch(Ge){Vi(_,_.return,Ge)}}h&&G&64&&Tg(z),xd(z,z.return);break;case 27:Mg(z);case 26:case 5:Tl(A,z,h),h&&_===null&&G&4&&Ff(z),xd(z,z.return);break;case 12:Tl(A,z,h);break;case 31:Tl(A,z,h),h&&G&4&&vd(A,z);break;case 13:Tl(A,z,h),h&&G&4&&bd(A,z);break;case 22:z.memoizedState===null&&Tl(A,z,h),xd(z,z.return);break;case 30:break;default:Tl(A,z,h)}s=s.sibling}}function Gf(r,s){var h=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==h&&(r!=null&&r.refCount++,h!=null&&sc(h))}function Sl(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&sc(r))}function ao(r,s,h,_){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)tm(r,s,h,_),s=s.sibling}function tm(r,s,h,_){var A=s.flags;switch(s.tag){case 0:case 11:case 15:ao(r,s,h,_),A&2048&&gh(9,s);break;case 1:ao(r,s,h,_);break;case 3:ao(r,s,h,_),A&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&sc(r)));break;case 12:if(A&2048){ao(r,s,h,_),r=s.stateNode;try{var z=s.memoizedProps,G=z.id,ne=z.onPostCommit;typeof ne=="function"&&ne(G,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(we){Vi(s,s.return,we)}}else ao(r,s,h,_);break;case 31:ao(r,s,h,_);break;case 13:ao(r,s,h,_);break;case 23:break;case 22:z=s.stateNode,G=s.alternate,s.memoizedState!==null?z._visibility&2?ao(r,s,h,_):Tu(r,s):z._visibility&2?ao(r,s,h,_):(z._visibility|=2,Fo(r,s,h,_,(s.subtreeFlags&10256)!==0||!1)),A&2048&&Gf(G,s);break;case 24:ao(r,s,h,_),A&2048&&Sl(s.alternate,s);break;default:ao(r,s,h,_)}}function Fo(r,s,h,_,A){for(A=A&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var z=r,G=s,ne=h,we=_,Ge=G.flags;switch(G.tag){case 0:case 11:case 15:Fo(z,G,ne,we,A),gh(8,G);break;case 23:break;case 22:var et=G.stateNode;G.memoizedState!==null?et._visibility&2?Fo(z,G,ne,we,A):Tu(z,G):(et._visibility|=2,Fo(z,G,ne,we,A)),A&&Ge&2048&&Gf(G.alternate,G);break;case 24:Fo(z,G,ne,we,A),A&&Ge&2048&&Sl(G.alternate,G);break;default:Fo(z,G,ne,we,A)}s=s.sibling}}function Tu(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var h=r,_=s,A=_.flags;switch(_.tag){case 22:Tu(h,_),A&2048&&Gf(_.alternate,_);break;case 24:Tu(h,_),A&2048&&Sl(_.alternate,_);break;default:Tu(h,_)}s=s.sibling}}var _h=8192;function Su(r,s,h){if(r.subtreeFlags&_h)for(r=r.child;r!==null;)Ag(r,s,h),r=r.sibling}function Ag(r,s,h){switch(r.tag){case 26:Su(r,s,h),r.flags&_h&&r.memoizedState!==null&&Lm(h,pa,r.memoizedState,r.memoizedProps);break;case 5:Su(r,s,h);break;case 3:case 4:var _=pa;pa=fp(r.stateNode.containerInfo),Su(r,s,h),pa=_;break;case 22:r.memoizedState===null&&(_=r.alternate,_!==null&&_.memoizedState!==null?(_=_h,_h=16777216,Su(r,s,h),_h=_):Su(r,s,h));break;default:Su(r,s,h)}}function Cg(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function Md(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var h=0;h<s.length;h++){var _=s[h];ar=_,xh(_,r)}Cg(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Dg(r),r=r.sibling}function Dg(r){switch(r.tag){case 0:case 11:case 15:Md(r),r.flags&2048&&bl(9,r,r.return);break;case 3:Md(r);break;case 12:Md(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,qf(r)):Md(r);break;default:Md(r)}}function qf(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var h=0;h<s.length;h++){var _=s[h];ar=_,xh(_,r)}Cg(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:bl(8,s,s.return),qf(s);break;case 22:h=s.stateNode,h._visibility&2&&(h._visibility&=-3,qf(s));break;default:qf(s)}r=r.sibling}}function xh(r,s){for(;ar!==null;){var h=ar;switch(h.tag){case 0:case 11:case 15:bl(8,h,s);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var _=h.memoizedState.cachePool.pool;_!=null&&_.refCount++}break;case 24:sc(h.memoizedState.cache)}if(_=h.child,_!==null)_.return=h,ar=_;else e:for(h=r;ar!==null;){_=ar;var A=_.sibling,z=_.return;if(yh(_),_===h){ar=null;break e}if(A!==null){A.return=z,ar=A;break e}ar=z}}}var Hy={getCacheForType:function(r){var s=Pn(Mn),h=s.data.get(r);return h===void 0&&(h=r(),s.data.set(r,h)),h},cacheSignal:function(){return Pn(Mn).controller.signal}},zg=typeof WeakMap=="function"?WeakMap:Map,Ni=0,rn=null,mi=null,gi=0,Hi=0,ma=null,Ls=!1,mc=!1,im=!1,Ml=0,Rn=0,El=0,Mu=0,nm=0,kr=0,Eu=0,Ed=null,Ba=null,rm=!1,Zf=0,Pg=0,Ad=1/0,vh=null,Al=null,sr=0,Cl=null,bh=null,js=0,am=0,Hf=null,Ig=null,Cd=0,sm=null;function Oa(){return(Ni&2)!==0&&gi!==0?gi&-gi:Je.T!==null?mm():Tn()}function Rg(){if(kr===0)if((gi&536870912)===0||ui){var r=$e;$e<<=1,($e&3932160)===0&&($e=262144),kr=r}else kr=536870912;return r=Tt.current,r!==null&&(r.flags|=32),kr}function Fa(r,s,h){(r===rn&&(Hi===2||Hi===9)||r.cancelPendingCommit!==null)&&(Th(r,0),gc(r,gi,kr,!1)),qi(r,h),((Ni&2)===0||r!==rn)&&(r===rn&&((Ni&2)===0&&(Mu|=h),Rn===4&&gc(r,gi,kr,!1)),so(r))}function Yn(r,s,h){if((Ni&6)!==0)throw Error(S(327));var _=!h&&(s&127)===0&&(s&r.expiredLanes)===0||wi(r,s),A=_?Sh(r,s):Yf(r,s,!0),z=_;do{if(A===0){mc&&!_&&gc(r,s,0,!1);break}else{if(h=r.current.alternate,z&&!$y(h)){A=Yf(r,s,!1),z=!1;continue}if(A===2){if(z=s,r.errorRecoveryDisabledLanes&z)var G=0;else G=r.pendingLanes&-536870913,G=G!==0?G:G&536870912?536870912:0;if(G!==0){s=G;e:{var ne=r;A=Ed;var we=ne.current.memoizedState.isDehydrated;if(we&&(Th(ne,G).flags|=256),G=Yf(ne,G,!1),G!==2){if(im&&!we){ne.errorRecoveryDisabledLanes|=z,Mu|=z,A=4;break e}z=Ba,Ba=A,z!==null&&(Ba===null?Ba=z:Ba.push.apply(Ba,z))}A=G}if(z=!1,A!==2)continue}}if(A===1){Th(r,0),gc(r,s,0,!0);break}e:{switch(_=r,z=A,z){case 0:case 1:throw Error(S(345));case 4:if((s&4194048)!==s)break;case 6:gc(_,s,kr,!Ls);break e;case 2:Ba=null;break;case 3:case 5:break;default:throw Error(S(329))}if((s&62914560)===s&&(A=Zf+300-Qn(),10<A)){if(gc(_,s,kr,!Ls),Ut(_,0,!0)!==0)break e;js=s,_.timeoutHandle=dp(wh.bind(null,_,h,Ba,vh,rm,s,kr,Mu,Eu,Ls,z,"Throttled",-0,0),A);break e}wh(_,h,Ba,vh,rm,s,kr,Mu,Eu,Ls,z,null,-0,0)}}break}while(!0);so(r)}function wh(r,s,h,_,A,z,G,ne,we,Ge,et,ct,He,Ke){if(r.timeoutHandle=-1,ct=s.subtreeFlags,ct&8192||(ct&16785408)===16785408){ct={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Za},Ag(s,z,ct);var kt=(z&62914560)===z?Zf-Qn():(z&4194048)===z?Pg-Qn():0;if(kt=jm(ct,kt),kt!==null){js=z,r.cancelPendingCommit=kt(Og.bind(null,r,s,z,h,_,A,G,ne,we,et,ct,null,He,Ke)),gc(r,z,G,!Ge);return}}Og(r,s,z,h,_,A,G,ne,we)}function $y(r){for(var s=r;;){var h=s.tag;if((h===0||h===11||h===15)&&s.flags&16384&&(h=s.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var _=0;_<h.length;_++){var A=h[_],z=A.getSnapshot;A=A.value;try{if(!Or(z(),A))return!1}catch{return!1}}if(h=s.child,s.subtreeFlags&16384&&h!==null)h.return=s,s=h;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function gc(r,s,h,_){s&=~nm,s&=~Mu,r.suspendedLanes|=s,r.pingedLanes&=~s,_&&(r.warmLanes|=s),_=r.expirationTimes;for(var A=s;0<A;){var z=31-Pe(A),G=1<<z;_[z]=-1,A&=~G}h!==0&&Fn(r,h,s)}function Dd(){return(Ni&6)===0?(ns(0),!1):!0}function $f(){if(mi!==null){if(Hi===0)var r=mi.return;else r=mi,Ss=Ca=null,to(r),As=null,dl=0,r=mi;for(;r!==null;)Of(r.alternate,r),r=r.return;mi=null}}function Th(r,s){var h=r.timeoutHandle;h!==-1&&(r.timeoutHandle=-1,Tm(h)),h=r.cancelPendingCommit,h!==null&&(r.cancelPendingCommit=null,h()),js=0,$f(),rn=r,mi=h=oa(r.current,null),gi=s,Hi=0,ma=null,Ls=!1,mc=wi(r,s),im=!1,Eu=kr=nm=Mu=El=Rn=0,Ba=Ed=null,rm=!1,(s&8)!==0&&(s|=s&32);var _=r.entangledLanes;if(_!==0)for(r=r.entanglements,_&=s;0<_;){var A=31-Pe(_),z=1<<A;s|=r[A],_&=~z}return Ml=s,ll(),h}function om(r,s){ii=null,Je.H=Ei,s===Xa||s===Ur?(s=lc(),Hi=3):s===Po?(s=lc(),Hi=4):Hi=s===Df?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,ma=s,mi===null&&(Rn=1,ts(r,Rr(s,r.current)))}function lm(){var r=Tt.current;return r===null?!0:(gi&4194048)===gi?Ct===null:(gi&62914560)===gi||(gi&536870912)!==0?r===Ct:!1}function Au(){var r=Je.H;return Je.H=Ei,r===null?Ei:r}function Xf(){var r=Je.A;return Je.A=Hy,r}function zd(){Rn=4,Ls||(gi&4194048)!==gi&&Tt.current!==null||(mc=!0),(El&134217727)===0&&(Mu&134217727)===0||rn===null||gc(rn,gi,kr,!1)}function Yf(r,s,h){var _=Ni;Ni|=2;var A=Au(),z=Xf();(rn!==r||gi!==s)&&(vh=null,Th(r,s)),s=!1;var G=Rn;e:do try{if(Hi!==0&&mi!==null){var ne=mi,we=ma;switch(Hi){case 8:$f(),G=6;break e;case 3:case 2:case 9:case 6:Tt.current===null&&(s=!0);var Ge=Hi;if(Hi=0,ma=null,Mh(r,ne,we,Ge),h&&mc){G=0;break e}break;default:Ge=Hi,Hi=0,ma=null,Mh(r,ne,we,Ge)}}Wf(),G=Rn;break}catch(et){om(r,et)}while(!0);return s&&r.shellSuspendCounter++,Ss=Ca=null,Ni=_,Je.H=A,Je.A=z,mi===null&&(rn=null,gi=0,ll()),G}function Wf(){for(;mi!==null;)Lg(mi)}function Sh(r,s){var h=Ni;Ni|=2;var _=Au(),A=Xf();rn!==r||gi!==s?(vh=null,Ad=Qn()+500,Th(r,s)):mc=wi(r,s);e:do try{if(Hi!==0&&mi!==null){s=mi;var z=ma;t:switch(Hi){case 1:Hi=0,ma=null,Mh(r,s,z,1);break;case 2:case 9:if(lu(z)){Hi=0,ma=null,jg(s);break}s=function(){Hi!==2&&Hi!==9||rn!==r||(Hi=7),so(r)},z.then(s,s);break e;case 3:Hi=7;break e;case 4:Hi=5;break e;case 7:lu(z)?(Hi=0,ma=null,jg(s)):(Hi=0,ma=null,Mh(r,s,z,7));break;case 5:var G=null;switch(mi.tag){case 26:G=mi.memoizedState;case 5:case 27:var ne=mi;if(G?Nd(G):ne.stateNode.complete){Hi=0,ma=null;var we=ne.sibling;if(we!==null)mi=we;else{var Ge=ne.return;Ge!==null?(mi=Ge,Kf(Ge)):mi=null}break t}}Hi=0,ma=null,Mh(r,s,z,5);break;case 6:Hi=0,ma=null,Mh(r,s,z,6);break;case 8:$f(),Rn=6;break e;default:throw Error(S(462))}}kg();break}catch(et){om(r,et)}while(!0);return Ss=Ca=null,Je.H=_,Je.A=A,Ni=h,mi!==null?0:(rn=null,gi=0,ll(),Rn)}function kg(){for(;mi!==null&&!Os();)Lg(mi)}function Lg(r){var s=Zr(r.alternate,r,Ml);r.memoizedProps=r.pendingProps,s===null?Kf(r):mi=s}function jg(r){var s=r,h=s.alternate;switch(s.tag){case 15:case 0:s=_g(h,s,s.pendingProps,s.type,void 0,gi);break;case 11:s=_g(h,s,s.pendingProps,s.type.render,s.ref,gi);break;case 5:to(s);default:Of(h,s),s=mi=Sf(s,Ml),s=Zr(h,s,Ml)}r.memoizedProps=r.pendingProps,s===null?Kf(r):mi=s}function Mh(r,s,h,_){Ss=Ca=null,to(s),As=null,dl=0;var A=s.return;try{if(Cf(r,A,s,h,gi)){Rn=1,ts(r,Rr(h,r.current)),mi=null;return}}catch(z){if(A!==null)throw mi=A,z;Rn=1,ts(r,Rr(h,r.current)),mi=null;return}s.flags&32768?(ui||_===1?r=!0:mc||(gi&536870912)!==0?r=!1:(Ls=r=!0,(_===2||_===9||_===3||_===6)&&(_=Tt.current,_!==null&&_.tag===13&&(_.flags|=16384))),Bg(s,r)):Kf(s)}function Kf(r){var s=r;do{if((s.flags&32768)!==0){Bg(s,Ls);return}r=s.return;var h=wg(s.alternate,s,Ml);if(h!==null){mi=h;return}if(s=s.sibling,s!==null){mi=s;return}mi=s=r}while(s!==null);Rn===0&&(Rn=5)}function Bg(r,s){do{var h=qy(r.alternate,r);if(h!==null){h.flags&=32767,mi=h;return}if(h=r.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!s&&(r=r.sibling,r!==null)){mi=r;return}mi=r=h}while(r!==null);Rn=6,mi=null}function Og(r,s,h,_,A,z,G,ne,we){r.cancelPendingCommit=null;do Qf();while(sr!==0);if((Ni&6)!==0)throw Error(S(327));if(s!==null){if(s===r.current)throw Error(S(177));if(z=s.lanes|s.childLanes,z|=ol,Zi(r,h,z,G,ne,we),r===rn&&(mi=rn=null,gi=0),bh=s,Cl=r,js=h,am=z,Hf=A,Ig=_,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,qg(Ns,function(){return Gg(),null})):(r.callbackNode=null,r.callbackPriority=0),_=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||_){_=Je.T,Je.T=null,A=at.p,at.p=2,G=Ni,Ni|=4;try{Zy(r,s,h)}finally{Ni=G,at.p=A,Je.T=_}}sr=1,Fg(),Ng(),Vg()}}function Fg(){if(sr===1){sr=0;var r=Cl,s=bh,h=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||h){h=Je.T,Je.T=null;var _=at.p;at.p=2;var A=Ni;Ni|=4;try{Uf(s,r);var z=bm,G=$u(r.containerInfo),ne=z.focusedElem,we=z.selectionRange;if(G!==ne&&ne&&ne.ownerDocument&&Hu(ne.ownerDocument.documentElement,ne)){if(we!==null&&Qc(ne)){var Ge=we.start,et=we.end;if(et===void 0&&(et=Ge),"selectionStart"in ne)ne.selectionStart=Ge,ne.selectionEnd=Math.min(et,ne.value.length);else{var ct=ne.ownerDocument||document,He=ct&&ct.defaultView||window;if(He.getSelection){var Ke=He.getSelection(),kt=ne.textContent.length,Zt=Math.min(we.start,kt),$i=we.end===void 0?Zt:Math.min(we.end,kt);!Ke.extend&&Zt>$i&&(G=$i,$i=Zt,Zt=G);var Ie=Kc(ne,Zt),Ae=Kc(ne,$i);if(Ie&&Ae&&(Ke.rangeCount!==1||Ke.anchorNode!==Ie.node||Ke.anchorOffset!==Ie.offset||Ke.focusNode!==Ae.node||Ke.focusOffset!==Ae.offset)){var Ne=ct.createRange();Ne.setStart(Ie.node,Ie.offset),Ke.removeAllRanges(),Zt>$i?(Ke.addRange(Ne),Ke.extend(Ae.node,Ae.offset)):(Ne.setEnd(Ae.node,Ae.offset),Ke.addRange(Ne))}}}}for(ct=[],Ke=ne;Ke=Ke.parentNode;)Ke.nodeType===1&&ct.push({element:Ke,left:Ke.scrollLeft,top:Ke.scrollTop});for(typeof ne.focus=="function"&&ne.focus(),ne=0;ne<ct.length;ne++){var st=ct[ne];st.element.scrollLeft=st.left,st.element.scrollTop=st.top}}Zd=!!Ld,bm=Ld=null}finally{Ni=A,at.p=_,Je.T=h}}r.current=s,sr=2}}function Ng(){if(sr===2){sr=0;var r=Cl,s=bh,h=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||h){h=Je.T,Je.T=null;var _=at.p;at.p=2;var A=Ni;Ni|=4;try{Jp(r,s.alternate,s)}finally{Ni=A,at.p=_,Je.T=h}}sr=3}}function Vg(){if(sr===4||sr===3){sr=0,$o();var r=Cl,s=bh,h=js,_=Ig;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?sr=5:(sr=0,bh=Cl=null,Ug(r,r.pendingLanes));var A=r.pendingLanes;if(A===0&&(Al=null),tt(h),s=s.stateNode,pe&&typeof pe.onCommitFiberRoot=="function")try{pe.onCommitFiberRoot(J,s,void 0,(s.current.flags&128)===128)}catch{}if(_!==null){s=Je.T,A=at.p,at.p=2,Je.T=null;try{for(var z=r.onRecoverableError,G=0;G<_.length;G++){var ne=_[G];z(ne.value,{componentStack:ne.stack})}}finally{Je.T=s,at.p=A}}(js&3)!==0&&Qf(),so(r),A=r.pendingLanes,(h&261930)!==0&&(A&42)!==0?r===sm?Cd++:(Cd=0,sm=r):Cd=0,ns(0)}}function Ug(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,sc(s)))}function Qf(){return Fg(),Ng(),Vg(),Gg()}function Gg(){if(sr!==5)return!1;var r=Cl,s=am;am=0;var h=tt(js),_=Je.T,A=at.p;try{at.p=32>h?32:h,Je.T=null,h=Hf,Hf=null;var z=Cl,G=js;if(sr=0,bh=Cl=null,js=0,(Ni&6)!==0)throw Error(S(331));var ne=Ni;if(Ni|=4,Dg(z.current),tm(z,z.current,G,h),Ni=ne,ns(0,!1),pe&&typeof pe.onPostCommitFiberRoot=="function")try{pe.onPostCommitFiberRoot(J,z)}catch{}return!0}finally{at.p=A,Je.T=_,Ug(r,s)}}function cm(r,s,h){s=Rr(h,s),s=xu(r.stateNode,s,2),r=Ks(r,s,2),r!==null&&(qi(r,2),so(r))}function Vi(r,s,h){if(r.tag===3)cm(r,r,h);else for(;s!==null;){if(s.tag===3){cm(s,r,h);break}else if(s.tag===1){var _=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Al===null||!Al.has(_))){r=Rr(h,r),h=vu(2),_=Ks(s,h,2),_!==null&&(bu(h,_,s,r),qi(_,2),so(_));break}}s=s.return}}function Jf(r,s,h){var _=r.pingCache;if(_===null){_=r.pingCache=new zg;var A=new Set;_.set(s,A)}else A=_.get(s),A===void 0&&(A=new Set,_.set(s,A));A.has(h)||(im=!0,A.add(h),r=yc.bind(null,r,s,h),s.then(r,r))}function yc(r,s,h){var _=r.pingCache;_!==null&&_.delete(s),r.pingedLanes|=r.suspendedLanes&h,r.warmLanes&=~h,rn===r&&(gi&h)===h&&(Rn===4||Rn===3&&(gi&62914560)===gi&&300>Qn()-Zf?(Ni&2)===0&&Th(r,0):nm|=h,Eu===gi&&(Eu=0)),so(r)}function Pd(r,s){s===0&&(s=Rt()),r=Aa(r,s),r!==null&&(qi(r,s),so(r))}function um(r){var s=r.memoizedState,h=0;s!==null&&(h=s.retryLane),Pd(r,h)}function Xy(r,s){var h=0;switch(r.tag){case 31:case 13:var _=r.stateNode,A=r.memoizedState;A!==null&&(h=A.retryLane);break;case 19:_=r.stateNode;break;case 22:_=r.stateNode._retryCache;break;default:throw Error(S(314))}_!==null&&_.delete(s),Pd(r,h)}function qg(r,s){return fo(r,s)}var ep=null,Eh=null,hm=!1,tp=!1,dm=!1,Dl=0;function so(r){r!==Eh&&r.next===null&&(Eh===null?ep=Eh=r:Eh=Eh.next=r),tp=!0,hm||(hm=!0,pm())}function ns(r,s){if(!dm&&tp){dm=!0;do for(var h=!1,_=ep;_!==null;){if(r!==0){var A=_.pendingLanes;if(A===0)var z=0;else{var G=_.suspendedLanes,ne=_.pingedLanes;z=(1<<31-Pe(42|r)+1)-1,z&=A&~(G&~ne),z=z&201326741?z&201326741|1:z?z|2:0}z!==0&&(h=!0,Id(_,z))}else z=gi,z=Ut(_,_===rn?z:0,_.cancelPendingCommit!==null||_.timeoutHandle!==-1),(z&3)===0||wi(_,z)||(h=!0,Id(_,z));_=_.next}while(h);dm=!1}}function _c(){fm()}function fm(){tp=hm=!1;var r=0;Dl!==0&&hp()&&(r=Dl);for(var s=Qn(),h=null,_=ep;_!==null;){var A=_.next,z=ip(_,s);z===0?(_.next=null,h===null?ep=A:h.next=A,A===null&&(Eh=h)):(h=_,(r!==0||(z&3)!==0)&&(tp=!0)),_=A}sr!==0&&sr!==5||ns(r),Dl!==0&&(Dl=0)}function ip(r,s){for(var h=r.suspendedLanes,_=r.pingedLanes,A=r.expirationTimes,z=r.pendingLanes&-62914561;0<z;){var G=31-Pe(z),ne=1<<G,we=A[G];we===-1?((ne&h)===0||(ne&_)!==0)&&(A[G]=At(ne,s)):we<=s&&(r.expiredLanes|=ne),z&=~ne}if(s=rn,h=gi,h=Ut(r,r===s?h:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),_=r.callbackNode,h===0||r===s&&(Hi===2||Hi===9)||r.cancelPendingCommit!==null)return _!==null&&_!==null&&ba(_),r.callbackNode=null,r.callbackPriority=0;if((h&3)===0||wi(r,h)){if(s=h&-h,s===r.callbackPriority)return s;switch(_!==null&&ba(_),tt(h)){case 2:case 8:h=Nl;break;case 32:h=Ns;break;case 268435456:h=Ce;break;default:h=Ns}return _=Zg.bind(null,r),h=fo(h,_),r.callbackPriority=s,r.callbackNode=h,s}return _!==null&&_!==null&&ba(_),r.callbackPriority=2,r.callbackNode=null,2}function Zg(r,s){if(sr!==0&&sr!==5)return r.callbackNode=null,r.callbackPriority=0,null;var h=r.callbackNode;if(Qf()&&r.callbackNode!==h)return null;var _=gi;return _=Ut(r,r===rn?_:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),_===0?null:(Yn(r,_,s),ip(r,Qn()),r.callbackNode!=null&&r.callbackNode===h?Zg.bind(null,r):null)}function Id(r,s){if(Qf())return null;Yn(r,s,!0)}function pm(){Mm(function(){(Ni&6)!==0?fo(Fs,_c):fm()})}function mm(){if(Dl===0){var r=hl;r===0&&(r=nt,nt<<=1,(nt&261888)===0&&(nt=256)),Dl=r}return Dl}function np(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Qt(""+r)}function rp(r,s){var h=s.ownerDocument.createElement("input");return h.name=s.name,h.value=s.value,r.id&&h.setAttribute("form",r.id),s.parentNode.insertBefore(h,s),r=new FormData(r),h.parentNode.removeChild(h),r}function Ah(r,s,h,_,A){if(s==="submit"&&h&&h.stateNode===A){var z=np((A[ht]||null).action),G=_.submitter;G&&(s=(s=G[ht]||null)?np(s.formAction):G.getAttribute("formAction"),s!==null&&(z=s,G=null));var ne=new Nc("action","action",null,_,A);r.push({event:ne,listeners:[{instance:null,listener:function(){if(_.defaultPrevented){if(Dl!==0){var we=G?rp(A,G):new FormData(A);yn(h,{pending:!0,data:we,method:A.method,action:z},null,we)}}else typeof z=="function"&&(ne.preventDefault(),we=G?rp(A,G):new FormData(A),yn(h,{pending:!0,data:we,method:A.method,action:z},z,we))},currentTarget:A}]})}}for(var ap=0;ap<Ku.length;ap++){var sp=Ku[ap],gm=sp.toLowerCase(),Hg=sp[0].toUpperCase()+sp.slice(1);aa(gm,"on"+Hg)}aa(tu,"onAnimationEnd"),aa(iu,"onAnimationIteration"),aa(Wu,"onAnimationStart"),aa("dblclick","onDoubleClick"),aa("focusin","onFocus"),aa("focusout","onBlur"),aa(sl,"onTransitionRun"),aa(nu,"onTransitionStart"),aa(tc,"onTransitionCancel"),aa(ra,"onTransitionEnd"),Us("onMouseEnter",["mouseout","mouseover"]),Us("onMouseLeave",["mouseout","mouseover"]),Us("onPointerEnter",["pointerout","pointerover"]),Us("onPointerLeave",["pointerout","pointerover"]),di("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),di("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),di("onBeforeInput",["compositionend","keypress","textInput","paste"]),di("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),di("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),di("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$g=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(xc));function Xg(r,s){s=(s&4)!==0;for(var h=0;h<r.length;h++){var _=r[h],A=_.event;_=_.listeners;e:{var z=void 0;if(s)for(var G=_.length-1;0<=G;G--){var ne=_[G],we=ne.instance,Ge=ne.currentTarget;if(ne=ne.listener,we!==z&&A.isPropagationStopped())break e;z=ne,A.currentTarget=Ge;try{z(A)}catch(et){_s(et)}A.currentTarget=null,z=we}else for(G=0;G<_.length;G++){if(ne=_[G],we=ne.instance,Ge=ne.currentTarget,ne=ne.listener,we!==z&&A.isPropagationStopped())break e;z=ne,A.currentTarget=Ge;try{z(A)}catch(et){_s(et)}A.currentTarget=null,z=we}}}}function yi(r,s){var h=s[Jt];h===void 0&&(h=s[Jt]=new Set);var _=r+"__bubble";h.has(_)||(lp(s,r,2,!1),h.add(_))}function ym(r,s,h){var _=0;s&&(_|=4),lp(h,r,_,s)}var op="_reactListening"+Math.random().toString(36).slice(2);function _m(r){if(!r[op]){r[op]=!0,Ul.forEach(function(h){h!=="selectionchange"&&($g.has(h)||ym(h,!1,r),ym(h,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[op]||(s[op]=!0,ym("selectionchange",!1,s))}}function lp(r,s,h,_){switch(zu(s)){case 2:var A=Hd;break;case 8:A=ly;break;default:A=Om}h=A.bind(null,s,h,r),A=void 0,!Cr||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(A=!0),_?A!==void 0?r.addEventListener(s,h,{capture:!0,passive:A}):r.addEventListener(s,h,!0):A!==void 0?r.addEventListener(s,h,{passive:A}):r.addEventListener(s,h,!1)}function No(r,s,h,_,A){var z=_;if((s&1)===0&&(s&2)===0&&_!==null)e:for(;;){if(_===null)return;var G=_.tag;if(G===3||G===4){var ne=_.stateNode.containerInfo;if(ne===A)break;if(G===4)for(G=_.return;G!==null;){var we=G.tag;if((we===3||we===4)&&G.stateNode.containerInfo===A)return;G=G.return}for(;ne!==null;){if(G=hs(ne),G===null)return;if(we=G.tag,we===5||we===6||we===26||we===27){_=z=G;continue e}ne=ne.parentNode}}_=_.return}ji(function(){var Ge=z,et=Fc(h),ct=[];e:{var He=td.get(r);if(He!==void 0){var Ke=Nc,kt=r;switch(r){case"keypress":if(na(h)===0)break e;case"keydown":case"keyup":Ke=mn;break;case"focusin":kt="focus",Ke=xo;break;case"focusout":kt="blur",Ke=xo;break;case"beforeblur":case"afterblur":Ke=xo;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ke=tl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ke=Vc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ke=Vp;break;case tu:case iu:case Wu:Ke=df;break;case ra:Ke=Uu;break;case"scroll":case"scrollend":Ke=el;break;case"wheel":Ke=Wh;break;case"copy":case"cut":case"paste":Ke=Xh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ke=Vu;break;case"toggle":case"beforetoggle":Ke=Yl}var Zt=(s&4)!==0,$i=!Zt&&(r==="scroll"||r==="scrollend"),Ie=Zt?He!==null?He+"Capture":null:He;Zt=[];for(var Ae=Ge,Ne;Ae!==null;){var st=Ae;if(Ne=st.stateNode,st=st.tag,st!==5&&st!==26&&st!==27||Ne===null||Ie===null||(st=Ta(Ae,Ie),st!=null&&Zt.push(Ch(Ae,st,Ne))),$i)break;Ae=Ae.return}0<Zt.length&&(He=new Ke(He,kt,null,h,et),ct.push({event:He,listeners:Zt}))}}if((s&7)===0){e:{if(He=r==="mouseover"||r==="pointerover",Ke=r==="mouseout"||r==="pointerout",He&&h!==$h&&(kt=h.relatedTarget||h.fromElement)&&(hs(kt)||kt[qt]))break e;if((Ke||He)&&(He=et.window===et?et:(He=et.ownerDocument)?He.defaultView||He.parentWindow:window,Ke?(kt=h.relatedTarget||h.toElement,Ke=Ge,kt=kt?hs(kt):null,kt!==null&&($i=B(kt),Zt=kt.tag,kt!==$i||Zt!==5&&Zt!==27&&Zt!==6)&&(kt=null)):(Ke=null,kt=Ge),Ke!==kt)){if(Zt=tl,st="onMouseLeave",Ie="onMouseEnter",Ae="mouse",(r==="pointerout"||r==="pointerover")&&(Zt=Vu,st="onPointerLeave",Ie="onPointerEnter",Ae="pointer"),$i=Ke==null?He:ds(Ke),Ne=kt==null?He:ds(kt),He=new Zt(st,Ae+"leave",Ke,h,et),He.target=$i,He.relatedTarget=Ne,st=null,hs(et)===Ge&&(Zt=new Zt(Ie,Ae+"enter",kt,h,et),Zt.target=Ne,Zt.relatedTarget=$i,st=Zt),$i=st,Ke&&kt)t:{for(Zt=Yg,Ie=Ke,Ae=kt,Ne=0,st=Ie;st;st=Zt(st))Ne++;st=0;for(var Gt=Ae;Gt;Gt=Zt(Gt))st++;for(;0<Ne-st;)Ie=Zt(Ie),Ne--;for(;0<st-Ne;)Ae=Zt(Ae),st--;for(;Ne--;){if(Ie===Ae||Ae!==null&&Ie===Ae.alternate){Zt=Ie;break t}Ie=Zt(Ie),Ae=Zt(Ae)}Zt=null}else Zt=null;Ke!==null&&xm(ct,He,Ke,Zt,!1),kt!==null&&$i!==null&&xm(ct,$i,kt,Zt,!0)}}e:{if(He=Ge?ds(Ge):window,Ke=He.nodeName&&He.nodeName.toLowerCase(),Ke==="select"||Ke==="input"&&He.type==="file")var Pi=wo;else if(qu(He))if(Kh)Pi=wf;else{Pi=bf;var Lt=Up}else Ke=He.nodeName,!Ke||Ke.toLowerCase()!=="input"||He.type!=="checkbox"&&He.type!=="radio"?Ge&&Ko(Ge.elementType)&&(Pi=wo):Pi=Wc;if(Pi&&(Pi=Pi(r,Ge))){Zu(ct,Pi,h,et);break e}Lt&&Lt(r,He,Ge),r==="focusout"&&Ge&&He.type==="number"&&Ge.memoizedProps.value!=null&&Oc(He,"number",He.value)}switch(Lt=Ge?ds(Ge):window,r){case"focusin":(qu(Lt)||Lt.contentEditable==="true")&&(Ea=Lt,Jc=Ge,eu=null);break;case"focusout":eu=Jc=Ea=null;break;case"mousedown":Yu=!0;break;case"contextmenu":case"mouseup":case"dragend":Yu=!1,Tf(ct,h,et);break;case"selectionchange":if(Xu)break;case"keydown":case"keyup":Tf(ct,h,et)}var Ft;if(Sn)e:{switch(r){case"compositionstart":var pi="onCompositionStart";break e;case"compositionend":pi="onCompositionEnd";break e;case"compositionupdate":pi="onCompositionUpdate";break e}pi=void 0}else Ha?Hc(r,h)&&(pi="onCompositionEnd"):r==="keydown"&&h.keyCode===229&&(pi="onCompositionStart");pi&&(Jl&&h.locale!=="ko"&&(Ha||pi!=="onCompositionStart"?pi==="onCompositionEnd"&&Ha&&(Ft=yo()):(ia=et,ms="value"in ia?ia.value:ia.textContent,Ha=!0)),Lt=Rd(Ge,pi),0<Lt.length&&(pi=new Yh(pi,r,null,h,et),ct.push({event:pi,listeners:Lt}),Ft?pi.data=Ft:(Ft=gf(h),Ft!==null&&(pi.data=Ft)))),(Ft=Ql?Gu(r,h):yf(r,h))&&(pi=Rd(Ge,"onBeforeInput"),0<pi.length&&(Lt=new Yh("onBeforeInput","beforeinput",null,h,et),ct.push({event:Lt,listeners:pi}),Lt.data=Ft)),Ah(ct,r,Ge,h,et)}Xg(ct,s)})}function Ch(r,s,h){return{instance:r,listener:s,currentTarget:h}}function Rd(r,s){for(var h=s+"Capture",_=[];r!==null;){var A=r,z=A.stateNode;if(A=A.tag,A!==5&&A!==26&&A!==27||z===null||(A=Ta(r,h),A!=null&&_.unshift(Ch(r,A,z)),A=Ta(r,s),A!=null&&_.push(Ch(r,A,z))),r.tag===3)return _;r=r.return}return[]}function Yg(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function xm(r,s,h,_,A){for(var z=s._reactName,G=[];h!==null&&h!==_;){var ne=h,we=ne.alternate,Ge=ne.stateNode;if(ne=ne.tag,we!==null&&we===_)break;ne!==5&&ne!==26&&ne!==27||Ge===null||(we=Ge,A?(Ge=Ta(h,z),Ge!=null&&G.unshift(Ch(h,Ge,we))):A||(Ge=Ta(h,z),Ge!=null&&G.push(Ch(h,Ge,we)))),h=h.return}G.length!==0&&r.push({event:s,listeners:G})}var Wg=/\r\n?/g,Kg=/\u0000|\uFFFD/g;function kd(r){return(typeof r=="string"?r:""+r).replace(Wg,`
`).replace(Kg,"")}function vm(r,s){return s=kd(s),kd(r)===s}function zi(r,s,h,_,A,z){switch(h){case"children":typeof _=="string"?s==="body"||s==="textarea"&&_===""||Gs(r,_):(typeof _=="number"||typeof _=="bigint")&&s!=="body"&&Gs(r,""+_);break;case"className":ps(r,"class",_);break;case"tabIndex":ps(r,"tabindex",_);break;case"dir":case"role":case"viewBox":case"width":case"height":ps(r,h,_);break;case"style":Nu(r,_,z);break;case"data":if(s!=="object"){ps(r,"data",_);break}case"src":case"href":if(_===""&&(s!=="a"||h!=="href")){r.removeAttribute(h);break}if(_==null||typeof _=="function"||typeof _=="symbol"||typeof _=="boolean"){r.removeAttribute(h);break}_=Qt(""+_),r.setAttribute(h,_);break;case"action":case"formAction":if(typeof _=="function"){r.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof z=="function"&&(h==="formAction"?(s!=="input"&&zi(r,s,"name",A.name,A,null),zi(r,s,"formEncType",A.formEncType,A,null),zi(r,s,"formMethod",A.formMethod,A,null),zi(r,s,"formTarget",A.formTarget,A,null)):(zi(r,s,"encType",A.encType,A,null),zi(r,s,"method",A.method,A,null),zi(r,s,"target",A.target,A,null)));if(_==null||typeof _=="symbol"||typeof _=="boolean"){r.removeAttribute(h);break}_=Qt(""+_),r.setAttribute(h,_);break;case"onClick":_!=null&&(r.onclick=Za);break;case"onScroll":_!=null&&yi("scroll",r);break;case"onScrollEnd":_!=null&&yi("scrollend",r);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(S(61));if(h=_.__html,h!=null){if(A.children!=null)throw Error(S(60));r.innerHTML=h}}break;case"multiple":r.multiple=_&&typeof _!="function"&&typeof _!="symbol";break;case"muted":r.muted=_&&typeof _!="function"&&typeof _!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(_==null||typeof _=="function"||typeof _=="boolean"||typeof _=="symbol"){r.removeAttribute("xlink:href");break}h=Qt(""+_),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":_!=null&&typeof _!="function"&&typeof _!="symbol"?r.setAttribute(h,""+_):r.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":_&&typeof _!="function"&&typeof _!="symbol"?r.setAttribute(h,""):r.removeAttribute(h);break;case"capture":case"download":_===!0?r.setAttribute(h,""):_!==!1&&_!=null&&typeof _!="function"&&typeof _!="symbol"?r.setAttribute(h,_):r.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":_!=null&&typeof _!="function"&&typeof _!="symbol"&&!isNaN(_)&&1<=_?r.setAttribute(h,_):r.removeAttribute(h);break;case"rowSpan":case"start":_==null||typeof _=="function"||typeof _=="symbol"||isNaN(_)?r.removeAttribute(h):r.setAttribute(h,_);break;case"popover":yi("beforetoggle",r),yi("toggle",r),Lc(r,"popover",_);break;case"xlinkActuate":wa(r,"http://www.w3.org/1999/xlink","xlink:actuate",_);break;case"xlinkArcrole":wa(r,"http://www.w3.org/1999/xlink","xlink:arcrole",_);break;case"xlinkRole":wa(r,"http://www.w3.org/1999/xlink","xlink:role",_);break;case"xlinkShow":wa(r,"http://www.w3.org/1999/xlink","xlink:show",_);break;case"xlinkTitle":wa(r,"http://www.w3.org/1999/xlink","xlink:title",_);break;case"xlinkType":wa(r,"http://www.w3.org/1999/xlink","xlink:type",_);break;case"xmlBase":wa(r,"http://www.w3.org/XML/1998/namespace","xml:base",_);break;case"xmlLang":wa(r,"http://www.w3.org/XML/1998/namespace","xml:lang",_);break;case"xmlSpace":wa(r,"http://www.w3.org/XML/1998/namespace","xml:space",_);break;case"is":Lc(r,"is",_);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=go.get(h)||h,Lc(r,h,_))}}function cp(r,s,h,_,A,z){switch(h){case"style":Nu(r,_,z);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(S(61));if(h=_.__html,h!=null){if(A.children!=null)throw Error(S(60));r.innerHTML=h}}break;case"children":typeof _=="string"?Gs(r,_):(typeof _=="number"||typeof _=="bigint")&&Gs(r,""+_);break;case"onScroll":_!=null&&yi("scroll",r);break;case"onScrollEnd":_!=null&&yi("scrollend",r);break;case"onClick":_!=null&&(r.onclick=Za);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!_r.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(A=h.endsWith("Capture"),s=h.slice(2,A?h.length-7:void 0),z=r[ht]||null,z=z!=null?z[h]:null,typeof z=="function"&&r.removeEventListener(s,z,A),typeof _=="function")){typeof z!="function"&&z!==null&&(h in r?r[h]=null:r.hasAttribute(h)&&r.removeAttribute(h)),r.addEventListener(s,_,A);break e}h in r?r[h]=_:_===!0?r.setAttribute(h,""):Lc(r,h,_)}}}function mr(r,s,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yi("error",r),yi("load",r);var _=!1,A=!1,z;for(z in h)if(h.hasOwnProperty(z)){var G=h[z];if(G!=null)switch(z){case"src":_=!0;break;case"srcSet":A=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(S(137,s));default:zi(r,s,z,G,h,null)}}A&&zi(r,s,"srcSet",h.srcSet,h,null),_&&zi(r,s,"src",h.src,h,null);return;case"input":yi("invalid",r);var ne=z=G=A=null,we=null,Ge=null;for(_ in h)if(h.hasOwnProperty(_)){var et=h[_];if(et!=null)switch(_){case"name":A=et;break;case"type":G=et;break;case"checked":we=et;break;case"defaultChecked":Ge=et;break;case"value":z=et;break;case"defaultValue":ne=et;break;case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(S(137,s));break;default:zi(r,s,_,et,h,null)}}Fu(r,z,ne,we,Ge,G,A,!1);return;case"select":yi("invalid",r),_=G=z=null;for(A in h)if(h.hasOwnProperty(A)&&(ne=h[A],ne!=null))switch(A){case"value":z=ne;break;case"defaultValue":G=ne;break;case"multiple":_=ne;default:zi(r,s,A,ne,h,null)}s=z,h=G,r.multiple=!!_,s!=null?mo(r,!!_,s,!1):h!=null&&mo(r,!!_,h,!0);return;case"textarea":yi("invalid",r),z=A=_=null;for(G in h)if(h.hasOwnProperty(G)&&(ne=h[G],ne!=null))switch(G){case"value":_=ne;break;case"defaultValue":A=ne;break;case"children":z=ne;break;case"dangerouslySetInnerHTML":if(ne!=null)throw Error(S(91));break;default:zi(r,s,G,ne,h,null)}Zl(r,_,A,z);return;case"option":for(we in h)h.hasOwnProperty(we)&&(_=h[we],_!=null)&&(we==="selected"?r.selected=_&&typeof _!="function"&&typeof _!="symbol":zi(r,s,we,_,h,null));return;case"dialog":yi("beforetoggle",r),yi("toggle",r),yi("cancel",r),yi("close",r);break;case"iframe":case"object":yi("load",r);break;case"video":case"audio":for(_=0;_<xc.length;_++)yi(xc[_],r);break;case"image":yi("error",r),yi("load",r);break;case"details":yi("toggle",r);break;case"embed":case"source":case"link":yi("error",r),yi("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ge in h)if(h.hasOwnProperty(Ge)&&(_=h[Ge],_!=null))switch(Ge){case"children":case"dangerouslySetInnerHTML":throw Error(S(137,s));default:zi(r,s,Ge,_,h,null)}return;default:if(Ko(s)){for(et in h)h.hasOwnProperty(et)&&(_=h[et],_!==void 0&&cp(r,s,et,_,h,void 0));return}}for(ne in h)h.hasOwnProperty(ne)&&(_=h[ne],_!=null&&zi(r,s,ne,_,h,null))}function Qg(r,s,h,_){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var A=null,z=null,G=null,ne=null,we=null,Ge=null,et=null;for(Ke in h){var ct=h[Ke];if(h.hasOwnProperty(Ke)&&ct!=null)switch(Ke){case"checked":break;case"value":break;case"defaultValue":we=ct;default:_.hasOwnProperty(Ke)||zi(r,s,Ke,null,_,ct)}}for(var He in _){var Ke=_[He];if(ct=h[He],_.hasOwnProperty(He)&&(Ke!=null||ct!=null))switch(He){case"type":z=Ke;break;case"name":A=Ke;break;case"checked":Ge=Ke;break;case"defaultChecked":et=Ke;break;case"value":G=Ke;break;case"defaultValue":ne=Ke;break;case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(S(137,s));break;default:Ke!==ct&&zi(r,s,He,Ke,_,ct)}}Bc(r,G,ne,we,Ge,et,z,A);return;case"select":Ke=G=ne=He=null;for(z in h)if(we=h[z],h.hasOwnProperty(z)&&we!=null)switch(z){case"value":break;case"multiple":Ke=we;default:_.hasOwnProperty(z)||zi(r,s,z,null,_,we)}for(A in _)if(z=_[A],we=h[A],_.hasOwnProperty(A)&&(z!=null||we!=null))switch(A){case"value":He=z;break;case"defaultValue":ne=z;break;case"multiple":G=z;default:z!==we&&zi(r,s,A,z,_,we)}s=ne,h=G,_=Ke,He!=null?mo(r,!!h,He,!1):!!_!=!!h&&(s!=null?mo(r,!!h,s,!0):mo(r,!!h,h?[]:"",!1));return;case"textarea":Ke=He=null;for(ne in h)if(A=h[ne],h.hasOwnProperty(ne)&&A!=null&&!_.hasOwnProperty(ne))switch(ne){case"value":break;case"children":break;default:zi(r,s,ne,null,_,A)}for(G in _)if(A=_[G],z=h[G],_.hasOwnProperty(G)&&(A!=null||z!=null))switch(G){case"value":He=A;break;case"defaultValue":Ke=A;break;case"children":break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(S(91));break;default:A!==z&&zi(r,s,G,A,_,z)}uf(r,He,Ke);return;case"option":for(var kt in h)He=h[kt],h.hasOwnProperty(kt)&&He!=null&&!_.hasOwnProperty(kt)&&(kt==="selected"?r.selected=!1:zi(r,s,kt,null,_,He));for(we in _)He=_[we],Ke=h[we],_.hasOwnProperty(we)&&He!==Ke&&(He!=null||Ke!=null)&&(we==="selected"?r.selected=He&&typeof He!="function"&&typeof He!="symbol":zi(r,s,we,He,_,Ke));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Zt in h)He=h[Zt],h.hasOwnProperty(Zt)&&He!=null&&!_.hasOwnProperty(Zt)&&zi(r,s,Zt,null,_,He);for(Ge in _)if(He=_[Ge],Ke=h[Ge],_.hasOwnProperty(Ge)&&He!==Ke&&(He!=null||Ke!=null))switch(Ge){case"children":case"dangerouslySetInnerHTML":if(He!=null)throw Error(S(137,s));break;default:zi(r,s,Ge,He,_,Ke)}return;default:if(Ko(s)){for(var $i in h)He=h[$i],h.hasOwnProperty($i)&&He!==void 0&&!_.hasOwnProperty($i)&&cp(r,s,$i,void 0,_,He);for(et in _)He=_[et],Ke=h[et],!_.hasOwnProperty(et)||He===Ke||He===void 0&&Ke===void 0||cp(r,s,et,He,_,Ke);return}}for(var Ie in h)He=h[Ie],h.hasOwnProperty(Ie)&&He!=null&&!_.hasOwnProperty(Ie)&&zi(r,s,Ie,null,_,He);for(ct in _)He=_[ct],Ke=h[ct],!_.hasOwnProperty(ct)||He===Ke||He==null&&Ke==null||zi(r,s,ct,He,_,Ke)}function Na(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Dh(){if(typeof performance.getEntriesByType=="function"){for(var r=0,s=0,h=performance.getEntriesByType("resource"),_=0;_<h.length;_++){var A=h[_],z=A.transferSize,G=A.initiatorType,ne=A.duration;if(z&&ne&&Na(G)){for(G=0,ne=A.responseEnd,_+=1;_<h.length;_++){var we=h[_],Ge=we.startTime;if(Ge>ne)break;var et=we.transferSize,ct=we.initiatorType;et&&Na(ct)&&(we=we.responseEnd,G+=et*(we<ne?1:(ne-Ge)/(we-Ge)))}if(--_,s+=8*(z+G)/(A.duration/1e3),r++,10<r)break}}if(0<r)return s/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Ld=null,bm=null;function jd(r){return r.nodeType===9?r:r.ownerDocument}function vc(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wm(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function up(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var bc=null;function hp(){var r=window.event;return r&&r.type==="popstate"?r===bc?!1:(bc=r,!0):(bc=null,!1)}var dp=typeof setTimeout=="function"?setTimeout:void 0,Tm=typeof clearTimeout=="function"?clearTimeout:void 0,Sm=typeof Promise=="function"?Promise:void 0,Mm=typeof queueMicrotask=="function"?queueMicrotask:typeof Sm<"u"?function(r){return Sm.resolve(null).then(r).catch(Em)}:dp;function Em(r){setTimeout(function(){throw r})}function wc(r){return r==="head"}function Jg(r,s){var h=s,_=0;do{var A=h.nextSibling;if(r.removeChild(h),A&&A.nodeType===8)if(h=A.data,h==="/$"||h==="/&"){if(_===0){r.removeChild(A),Cc(s);return}_--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")_++;else if(h==="html")zh(r.ownerDocument.documentElement);else if(h==="head"){h=r.ownerDocument.head,zh(h);for(var z=h.firstChild;z;){var G=z.nextSibling,ne=z.nodeName;z[Xt]||ne==="SCRIPT"||ne==="STYLE"||ne==="LINK"&&z.rel.toLowerCase()==="stylesheet"||h.removeChild(z),z=G}}else h==="body"&&zh(r.ownerDocument.body);h=A}while(h);Cc(s)}function ai(r,s){var h=r;r=0;do{var _=h.nextSibling;if(h.nodeType===1?s?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(s?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),_&&_.nodeType===8)if(h=_.data,h==="/$"){if(r===0)break;r--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||r++;h=_}while(h)}function oo(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var h=s;switch(s=s.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":oo(h),Xo(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}r.removeChild(h)}}function br(r,s,h,_){for(;r.nodeType===1;){var A=h;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!_&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(_){if(!r[Xt])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(z=r.getAttribute("rel"),z==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(z!==A.rel||r.getAttribute("href")!==(A.href==null||A.href===""?null:A.href)||r.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin)||r.getAttribute("title")!==(A.title==null?null:A.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(z=r.getAttribute("src"),(z!==(A.src==null?null:A.src)||r.getAttribute("type")!==(A.type==null?null:A.type)||r.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin))&&z&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var z=A.name==null?null:""+A.name;if(A.type==="hidden"&&r.getAttribute("name")===z)return r}else return r;if(r=rs(r.nextSibling),r===null)break}return null}function lo(r,s,h){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!h||(r=rs(r.nextSibling),r===null))return null;return r}function Tc(r,s){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!s||(r=rs(r.nextSibling),r===null))return null;return r}function Hr(r){return r.data==="$?"||r.data==="$~"}function Gn(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function or(r,s){var h=r.ownerDocument;if(r.data==="$~")r._reactRetry=s;else if(r.data!=="$?"||h.readyState!=="loading")s();else{var _=function(){s(),h.removeEventListener("DOMContentLoaded",_)};h.addEventListener("DOMContentLoaded",_),r._reactRetry=_}}function rs(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return r}var ga=null;function lr(r){r=r.nextSibling;for(var s=0;r;){if(r.nodeType===8){var h=r.data;if(h==="/$"||h==="/&"){if(s===0)return rs(r.nextSibling);s--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||s++}r=r.nextSibling}return null}function Bd(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var h=r.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(s===0)return r;s--}else h!=="/$"&&h!=="/&"||s++}r=r.previousSibling}return null}function ey(r,s,h){switch(s=jd(h),r){case"html":if(r=s.documentElement,!r)throw Error(S(452));return r;case"head":if(r=s.head,!r)throw Error(S(453));return r;case"body":if(r=s.body,!r)throw Error(S(454));return r;default:throw Error(S(451))}}function zh(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);Xo(r)}var wr=new Map,Cu=new Set;function fp(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Vo=at.d;at.d={f:ty,r:iy,D:Cm,C:$r,L:co,m:Xr,X:pp,S:Mc,M:Dm};function ty(){var r=Vo.f(),s=Dd();return r||s}function iy(r){var s=Vs(r);s!==null&&s.tag===5&&s.type==="form"?ir(s):Vo.r(r)}var Sc=typeof document>"u"?null:document;function Am(r,s,h){var _=Sc;if(_&&typeof s=="string"&&s){var A=Ar(s);A='link[rel="'+r+'"][href="'+A+'"]',typeof h=="string"&&(A+='[crossorigin="'+h+'"]'),Cu.has(A)||(Cu.add(A),r={rel:r,crossOrigin:h,href:s},_.querySelector(A)===null&&(s=_.createElement("link"),mr(s,"link",r),fn(s),_.head.appendChild(s)))}}function Cm(r){Vo.D(r),Am("dns-prefetch",r,null)}function $r(r,s){Vo.C(r,s),Am("preconnect",r,s)}function co(r,s,h){Vo.L(r,s,h);var _=Sc;if(_&&r&&s){var A='link[rel="preload"][as="'+Ar(s)+'"]';s==="image"&&h&&h.imageSrcSet?(A+='[imagesrcset="'+Ar(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(A+='[imagesizes="'+Ar(h.imageSizes)+'"]')):A+='[href="'+Ar(r)+'"]';var z=A;switch(s){case"style":z=Du(r);break;case"script":z=zl(r)}wr.has(z)||(r=te({rel:"preload",href:s==="image"&&h&&h.imageSrcSet?void 0:r,as:s},h),wr.set(z,r),_.querySelector(A)!==null||s==="style"&&_.querySelector(Ph(z))||s==="script"&&_.querySelector(Ih(z))||(s=_.createElement("link"),mr(s,"link",r),fn(s),_.head.appendChild(s)))}}function Xr(r,s){Vo.m(r,s);var h=Sc;if(h&&r){var _=s&&typeof s.as=="string"?s.as:"script",A='link[rel="modulepreload"][as="'+Ar(_)+'"][href="'+Ar(r)+'"]',z=A;switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":z=zl(r)}if(!wr.has(z)&&(r=te({rel:"modulepreload",href:r},s),wr.set(z,r),h.querySelector(A)===null)){switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Ih(z)))return}_=h.createElement("link"),mr(_,"link",r),fn(_),h.head.appendChild(_)}}}function Mc(r,s,h){Vo.S(r,s,h);var _=Sc;if(_&&r){var A=fs(_).hoistableStyles,z=Du(r);s=s||"default";var G=A.get(z);if(!G){var ne={loading:0,preload:null};if(G=_.querySelector(Ph(z)))ne.loading=5;else{r=te({rel:"stylesheet",href:r,"data-precedence":s},h),(h=wr.get(z))&&Od(r,h);var we=G=_.createElement("link");fn(we),mr(we,"link",r),we._p=new Promise(function(Ge,et){we.onload=Ge,we.onerror=et}),we.addEventListener("load",function(){ne.loading|=1}),we.addEventListener("error",function(){ne.loading|=2}),ne.loading|=4,Pl(G,s,_)}G={type:"stylesheet",instance:G,count:1,state:ne},A.set(z,G)}}}function pp(r,s){Vo.X(r,s);var h=Sc;if(h&&r){var _=fs(h).hoistableScripts,A=zl(r),z=_.get(A);z||(z=h.querySelector(Ih(A)),z||(r=te({src:r,async:!0},s),(s=wr.get(A))&&mp(r,s),z=h.createElement("script"),fn(z),mr(z,"link",r),h.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},_.set(A,z))}}function Dm(r,s){Vo.M(r,s);var h=Sc;if(h&&r){var _=fs(h).hoistableScripts,A=zl(r),z=_.get(A);z||(z=h.querySelector(Ih(A)),z||(r=te({src:r,async:!0,type:"module"},s),(s=wr.get(A))&&mp(r,s),z=h.createElement("script"),fn(z),mr(z,"link",r),h.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},_.set(A,z))}}function zm(r,s,h,_){var A=(A=Nt.current)?fp(A):null;if(!A)throw Error(S(446));switch(r){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(s=Du(h.href),h=fs(A).hoistableStyles,_=h.get(s),_||(_={type:"style",instance:null,count:0,state:null},h.set(s,_)),_):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){r=Du(h.href);var z=fs(A).hoistableStyles,G=z.get(r);if(G||(A=A.ownerDocument||A,G={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},z.set(r,G),(z=A.querySelector(Ph(r)))&&!z._p&&(G.instance=z,G.state.loading=5),wr.has(r)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},wr.set(r,h),z||Im(A,r,h,G.state))),s&&_===null)throw Error(S(528,""));return G}if(s&&_!==null)throw Error(S(529,""));return null;case"script":return s=h.async,h=h.src,typeof h=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=zl(h),h=fs(A).hoistableScripts,_=h.get(s),_||(_={type:"script",instance:null,count:0,state:null},h.set(s,_)),_):{type:"void",instance:null,count:0,state:null};default:throw Error(S(444,r))}}function Du(r){return'href="'+Ar(r)+'"'}function Ph(r){return'link[rel="stylesheet"]['+r+"]"}function Pm(r){return te({},r,{"data-precedence":r.precedence,precedence:null})}function Im(r,s,h,_){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?_.loading=1:(s=r.createElement("link"),_.preload=s,s.addEventListener("load",function(){return _.loading|=1}),s.addEventListener("error",function(){return _.loading|=2}),mr(s,"link",h),fn(s),r.head.appendChild(s))}function zl(r){return'[src="'+Ar(r)+'"]'}function Ih(r){return"script[async]"+r}function Rm(r,s,h){if(s.count++,s.instance===null)switch(s.type){case"style":var _=r.querySelector('style[data-href~="'+Ar(h.href)+'"]');if(_)return s.instance=_,fn(_),_;var A=te({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return _=(r.ownerDocument||r).createElement("style"),fn(_),mr(_,"style",A),Pl(_,h.precedence,r),s.instance=_;case"stylesheet":A=Du(h.href);var z=r.querySelector(Ph(A));if(z)return s.state.loading|=4,s.instance=z,fn(z),z;_=Pm(h),(A=wr.get(A))&&Od(_,A),z=(r.ownerDocument||r).createElement("link"),fn(z);var G=z;return G._p=new Promise(function(ne,we){G.onload=ne,G.onerror=we}),mr(z,"link",_),s.state.loading|=4,Pl(z,h.precedence,r),s.instance=z;case"script":return z=zl(h.src),(A=r.querySelector(Ih(z)))?(s.instance=A,fn(A),A):(_=h,(A=wr.get(z))&&(_=te({},h),mp(_,A)),r=r.ownerDocument||r,A=r.createElement("script"),fn(A),mr(A,"link",_),r.head.appendChild(A),s.instance=A);case"void":return null;default:throw Error(S(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(_=s.instance,s.state.loading|=4,Pl(_,h.precedence,r));return s.instance}function Pl(r,s,h){for(var _=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),A=_.length?_[_.length-1]:null,z=A,G=0;G<_.length;G++){var ne=_[G];if(ne.dataset.precedence===s)z=ne;else if(z!==A)break}z?z.parentNode.insertBefore(r,z.nextSibling):(s=h.nodeType===9?h.head:h,s.insertBefore(r,s.firstChild))}function Od(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function mp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var gp=null;function km(r,s,h){if(gp===null){var _=new Map,A=gp=new Map;A.set(h,_)}else A=gp,_=A.get(h),_||(_=new Map,A.set(h,_));if(_.has(r))return _;for(_.set(r,null),h=h.getElementsByTagName(r),A=0;A<h.length;A++){var z=h[A];if(!(z[Xt]||z[ci]||r==="link"&&z.getAttribute("rel")==="stylesheet")&&z.namespaceURI!=="http://www.w3.org/2000/svg"){var G=z.getAttribute(s)||"";G=r+G;var ne=_.get(G);ne?ne.push(z):_.set(G,[z])}}return _}function Fd(r,s,h){r=r.ownerDocument||r,r.head.insertBefore(h,s==="title"?r.querySelector("head > title"):null)}function yp(r,s,h){if(h===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(r=s.disabled,typeof s.precedence=="string"&&r==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Nd(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function Lm(r,s,h,_){if(h.type==="stylesheet"&&(typeof _.media!="string"||matchMedia(_.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var A=Du(_.href),z=s.querySelector(Ph(A));if(z){s=z._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(r.count++,r=Ud.bind(r),s.then(r,r)),h.state.loading|=4,h.instance=z,fn(z);return}z=s.ownerDocument||s,_=Pm(_),(A=wr.get(A))&&Od(_,A),z=z.createElement("link"),fn(z);var G=z;G._p=new Promise(function(ne,we){G.onload=ne,G.onerror=we}),mr(z,"link",_),h.instance=z}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(h,s),(s=h.state.preload)&&(h.state.loading&3)===0&&(r.count++,h=Ud.bind(r),s.addEventListener("load",h),s.addEventListener("error",h))}}var Vd=0;function jm(r,s){return r.stylesheets&&r.count===0&&qd(r,r.stylesheets),0<r.count||0<r.imgCount?function(h){var _=setTimeout(function(){if(r.stylesheets&&qd(r,r.stylesheets),r.unsuspend){var z=r.unsuspend;r.unsuspend=null,z()}},6e4+s);0<r.imgBytes&&Vd===0&&(Vd=62500*Dh());var A=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&qd(r,r.stylesheets),r.unsuspend)){var z=r.unsuspend;r.unsuspend=null,z()}},(r.imgBytes>Vd?50:800)+s);return r.unsuspend=h,function(){r.unsuspend=null,clearTimeout(_),clearTimeout(A)}}:null}function Ud(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)qd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Gd=null;function qd(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Gd=new Map,s.forEach(ny,r),Gd=null,Ud.call(r))}function ny(r,s){if(!(s.state.loading&4)){var h=Gd.get(r);if(h)var _=h.get(null);else{h=new Map,Gd.set(r,h);for(var A=r.querySelectorAll("link[data-precedence],style[data-precedence]"),z=0;z<A.length;z++){var G=A[z];(G.nodeName==="LINK"||G.getAttribute("media")!=="not all")&&(h.set(G.dataset.precedence,G),_=G)}_&&h.set(null,_)}A=s.instance,G=A.getAttribute("data-precedence"),z=h.get(G)||_,z===_&&h.set(null,A),h.set(G,A),this.count++,_=Ud.bind(this),A.addEventListener("load",_),A.addEventListener("error",_),z?z.parentNode.insertBefore(A,z.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(A,r.firstChild)),s.state.loading|=4}}var Rh={$$typeof:Ue,Provider:null,Consumer:null,_currentValue:Pt,_currentValue2:Pt,_threadCount:0};function Yy(r,s,h,_,A,z,G,ne,we){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Wt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wt(0),this.hiddenUpdates=Wt(null),this.identifierPrefix=_,this.onUncaughtError=A,this.onCaughtError=z,this.onRecoverableError=G,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=we,this.incompleteTransitions=new Map}function Bm(r,s,h,_,A,z,G,ne,we,Ge,et,ct){return r=new Yy(r,s,h,G,we,Ge,et,ct,ne),s=1,z===!0&&(s|=24),z=sa(3,null,null,s),r.current=z,z.stateNode=r,s=Es(),s.refCount++,r.pooledCache=s,s.refCount++,z.memoizedState={element:_,isDehydrated:h,cache:s},uh(z),r}function ry(r){return r?(r=Kt,r):Kt}function ay(r,s,h,_,A,z){A=ry(A),_.context===null?_.context=A:_.pendingContext=A,_=Ps(s),_.payload={element:h},z=z===void 0?null:z,z!==null&&(_.callback=z),h=Ks(r,_,s),h!==null&&(Fa(h,r,s),za(h,r,s))}function _p(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var h=r.retryLane;r.retryLane=h!==0&&h<s?h:s}}function xp(r,s){_p(r,s),(r=r.alternate)&&_p(r,s)}function sy(r){if(r.tag===13||r.tag===31){var s=Aa(r,67108864);s!==null&&Fa(s,r,67108864),xp(r,67108864)}}function oy(r){if(r.tag===13||r.tag===31){var s=Oa();s=Dn(s);var h=Aa(r,s);h!==null&&Fa(h,r,s),xp(r,s)}}var Zd=!0;function Hd(r,s,h,_){var A=Je.T;Je.T=null;var z=at.p;try{at.p=2,Om(r,s,h,_)}finally{at.p=z,Je.T=A}}function ly(r,s,h,_){var A=Je.T;Je.T=null;var z=at.p;try{at.p=8,Om(r,s,h,_)}finally{at.p=z,Je.T=A}}function Om(r,s,h,_){if(Zd){var A=$d(_);if(A===null)No(r,s,_,kh,h),cy(r,_);else if(Ky(A,r,s,h,_))_.stopPropagation();else if(cy(r,_),s&4&&-1<Wy.indexOf(r)){for(;A!==null;){var z=Vs(A);if(z!==null)switch(z.tag){case 3:if(z=z.stateNode,z.current.memoizedState.isDehydrated){var G=Te(z.pendingLanes);if(G!==0){var ne=z;for(ne.pendingLanes|=2,ne.entangledLanes|=2;G;){var we=1<<31-Pe(G);ne.entanglements[1]|=we,G&=~we}so(z),(Ni&6)===0&&(Ad=Qn()+500,ns(0))}}break;case 31:case 13:ne=Aa(z,2),ne!==null&&Fa(ne,z,2),Dd(),xp(z,2)}if(z=$d(_),z===null&&No(r,s,_,kh,h),z===A)break;A=z}A!==null&&_.stopPropagation()}else No(r,s,_,null,h)}}function $d(r){return r=Fc(r),vp(r)}var kh=null;function vp(r){if(kh=null,r=hs(r),r!==null){var s=B(r);if(s===null)r=null;else{var h=s.tag;if(h===13){if(r=M(s),r!==null)return r;r=null}else if(h===31){if(r=c(s),r!==null)return r;r=null}else if(h===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return kh=r,null}function zu(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ea()){case Fs:return 2;case Nl:return 8;case Ns:case Vl:return 32;case Ce:return 268435456;default:return 32}default:return 32}}var bp=!1,Ec=null,Bs=null,Ac=null,Xd=new Map,Lh=new Map,Il=[],Wy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function cy(r,s){switch(r){case"focusin":case"focusout":Ec=null;break;case"dragenter":case"dragleave":Bs=null;break;case"mouseover":case"mouseout":Ac=null;break;case"pointerover":case"pointerout":Xd.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lh.delete(s.pointerId)}}function Yd(r,s,h,_,A,z){return r===null||r.nativeEvent!==z?(r={blockedOn:s,domEventName:h,eventSystemFlags:_,nativeEvent:z,targetContainers:[A]},s!==null&&(s=Vs(s),s!==null&&sy(s)),r):(r.eventSystemFlags|=_,s=r.targetContainers,A!==null&&s.indexOf(A)===-1&&s.push(A),r)}function Ky(r,s,h,_,A){switch(s){case"focusin":return Ec=Yd(Ec,r,s,h,_,A),!0;case"dragenter":return Bs=Yd(Bs,r,s,h,_,A),!0;case"mouseover":return Ac=Yd(Ac,r,s,h,_,A),!0;case"pointerover":var z=A.pointerId;return Xd.set(z,Yd(Xd.get(z)||null,r,s,h,_,A)),!0;case"gotpointercapture":return z=A.pointerId,Lh.set(z,Yd(Lh.get(z)||null,r,s,h,_,A)),!0}return!1}function uy(r){var s=hs(r.target);if(s!==null){var h=B(s);if(h!==null){if(s=h.tag,s===13){if(s=M(h),s!==null){r.blockedOn=s,Er(r.priority,function(){oy(h)});return}}else if(s===31){if(s=c(h),s!==null){r.blockedOn=s,Er(r.priority,function(){oy(h)});return}}else if(s===3&&h.stateNode.current.memoizedState.isDehydrated){r.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Wd(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var h=$d(r.nativeEvent);if(h===null){h=r.nativeEvent;var _=new h.constructor(h.type,h);$h=_,h.target.dispatchEvent(_),$h=null}else return s=Vs(h),s!==null&&sy(s),r.blockedOn=h,!1;s.shift()}return!0}function hy(r,s,h){Wd(r)&&h.delete(s)}function Kd(){bp=!1,Ec!==null&&Wd(Ec)&&(Ec=null),Bs!==null&&Wd(Bs)&&(Bs=null),Ac!==null&&Wd(Ac)&&(Ac=null),Xd.forEach(hy),Lh.forEach(hy)}function wp(r,s){r.blockedOn===s&&(r.blockedOn=null,bp||(bp=!0,d.unstable_scheduleCallback(d.unstable_NormalPriority,Kd)))}var Tp=null;function dy(r){Tp!==r&&(Tp=r,d.unstable_scheduleCallback(d.unstable_NormalPriority,function(){Tp===r&&(Tp=null);for(var s=0;s<r.length;s+=3){var h=r[s],_=r[s+1],A=r[s+2];if(typeof _!="function"){if(vp(_||h)===null)continue;break}var z=Vs(h);z!==null&&(r.splice(s,3),s-=3,yn(z,{pending:!0,data:A,method:h.method,action:_},_,A))}}))}function Cc(r){function s(we){return wp(we,r)}Ec!==null&&wp(Ec,r),Bs!==null&&wp(Bs,r),Ac!==null&&wp(Ac,r),Xd.forEach(s),Lh.forEach(s);for(var h=0;h<Il.length;h++){var _=Il[h];_.blockedOn===r&&(_.blockedOn=null)}for(;0<Il.length&&(h=Il[0],h.blockedOn===null);)uy(h),h.blockedOn===null&&Il.shift();if(h=(r.ownerDocument||r).$$reactFormReplay,h!=null)for(_=0;_<h.length;_+=3){var A=h[_],z=h[_+1],G=A[ht]||null;if(typeof z=="function")G||dy(h);else if(G){var ne=null;if(z&&z.hasAttribute("formAction")){if(A=z,G=z[ht]||null)ne=G.formAction;else if(vp(A)!==null)continue}else ne=G.action;typeof ne=="function"?h[_+1]=ne:(h.splice(_,3),_-=3),dy(h)}}}function Fm(){function r(z){z.canIntercept&&z.info==="react-transition"&&z.intercept({handler:function(){return new Promise(function(G){return A=G})},focusReset:"manual",scroll:"manual"})}function s(){A!==null&&(A(),A=null),_||setTimeout(h,20)}function h(){if(!_&&!navigation.transition){var z=navigation.currentEntry;z&&z.url!=null&&navigation.navigate(z.url,{state:z.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var _=!1,A=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(h,100),function(){_=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),A!==null&&(A(),A=null)}}}function Nm(r){this._internalRoot=r}Sp.prototype.render=Nm.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(S(409));var h=s.current,_=Oa();ay(h,_,r,s,null,null)},Sp.prototype.unmount=Nm.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;ay(r.current,2,null,r,null,null),Dd(),s[qt]=null}};function Sp(r){this._internalRoot=r}Sp.prototype.unstable_scheduleHydration=function(r){if(r){var s=Tn();r={blockedOn:null,target:r,priority:s};for(var h=0;h<Il.length&&s!==0&&s<Il[h].priority;h++);Il.splice(h,0,r),h===0&&uy(r)}};var Vm=g.version;if(Vm!=="19.2.4")throw Error(S(527,Vm,"19.2.4"));at.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(S(188)):(r=Object.keys(r).join(","),Error(S(268,r)));return r=X(s),r=r!==null?K(r):null,r=r===null?null:r.stateNode,r};var fy={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Je,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mp.isDisabled&&Mp.supportsFiber)try{J=Mp.inject(fy),pe=Mp}catch{}}return $m.createRoot=function(r,s){if(!I(r))throw Error(S(299));var h=!1,_="",A=ph,z=io,G=no;return s!=null&&(s.unstable_strictMode===!0&&(h=!0),s.identifierPrefix!==void 0&&(_=s.identifierPrefix),s.onUncaughtError!==void 0&&(A=s.onUncaughtError),s.onCaughtError!==void 0&&(z=s.onCaughtError),s.onRecoverableError!==void 0&&(G=s.onRecoverableError)),s=Bm(r,1,!1,null,null,h,_,null,A,z,G,Fm),r[qt]=s.current,_m(r),new Nm(s)},$m.hydrateRoot=function(r,s,h){if(!I(r))throw Error(S(299));var _=!1,A="",z=ph,G=io,ne=no,we=null;return h!=null&&(h.unstable_strictMode===!0&&(_=!0),h.identifierPrefix!==void 0&&(A=h.identifierPrefix),h.onUncaughtError!==void 0&&(z=h.onUncaughtError),h.onCaughtError!==void 0&&(G=h.onCaughtError),h.onRecoverableError!==void 0&&(ne=h.onRecoverableError),h.formState!==void 0&&(we=h.formState)),s=Bm(r,1,!0,s,h??null,_,A,we,z,G,ne,Fm),s.context=ry(null),h=s.current,_=Oa(),_=Dn(_),A=Ps(_),A.callback=null,Ks(h,A,_),h=_,s.current.lanes=h,qi(s,h),so(s),r[qt]=s.current,_m(r),new Sp(s)},$m.version="19.2.4",$m}var hx;function yw(){if(hx)return c_.exports;hx=1;function d(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d)}catch(g){console.error(g)}}return d(),c_.exports=gw(),c_.exports}var _w=yw();const xw=Ov(_w);var dx="popstate";function vw(d={}){function g(S,I){let{pathname:B,search:M,hash:c}=S.location;return I_("",{pathname:B,search:M,hash:c},I.state&&I.state.usr||null,I.state&&I.state.key||"default")}function T(S,I){return typeof I=="string"?I:ng(I)}return ww(g,T,null,d)}function Kn(d,g){if(d===!1||d===null||typeof d>"u")throw new Error(g)}function Pc(d,g){if(!d){typeof console<"u"&&console.warn(g);try{throw new Error(g)}catch{}}}function bw(){return Math.random().toString(36).substring(2,10)}function fx(d,g){return{usr:d.state,key:d.key,idx:g}}function I_(d,g,T=null,S){return{pathname:typeof d=="string"?d:d.pathname,search:"",hash:"",...typeof g=="string"?Lp(g):g,state:T,key:g&&g.key||S||bw()}}function ng({pathname:d="/",search:g="",hash:T=""}){return g&&g!=="?"&&(d+=g.charAt(0)==="?"?g:"?"+g),T&&T!=="#"&&(d+=T.charAt(0)==="#"?T:"#"+T),d}function Lp(d){let g={};if(d){let T=d.indexOf("#");T>=0&&(g.hash=d.substring(T),d=d.substring(0,T));let S=d.indexOf("?");S>=0&&(g.search=d.substring(S),d=d.substring(0,S)),d&&(g.pathname=d)}return g}function ww(d,g,T,S={}){let{window:I=document.defaultView,v5Compat:B=!1}=S,M=I.history,c="POP",V=null,X=K();X==null&&(X=0,M.replaceState({...M.state,idx:X},""));function K(){return(M.state||{idx:null}).idx}function te(){c="POP";let le=K(),Xe=le==null?null:le-X;X=le,V&&V({action:c,location:xe.location,delta:Xe})}function de(le,Xe){c="PUSH";let Ve=I_(xe.location,le,Xe);X=K()+1;let Ue=fx(Ve,X),gt=xe.createHref(Ve);try{M.pushState(Ue,"",gt)}catch(pt){if(pt instanceof DOMException&&pt.name==="DataCloneError")throw pt;I.location.assign(gt)}B&&V&&V({action:c,location:xe.location,delta:1})}function De(le,Xe){c="REPLACE";let Ve=I_(xe.location,le,Xe);X=K();let Ue=fx(Ve,X),gt=xe.createHref(Ve);M.replaceState(Ue,"",gt),B&&V&&V({action:c,location:xe.location,delta:0})}function Ze(le){return Tw(le)}let xe={get action(){return c},get location(){return d(I,M)},listen(le){if(V)throw new Error("A history only accepts one active listener");return I.addEventListener(dx,te),V=le,()=>{I.removeEventListener(dx,te),V=null}},createHref(le){return g(I,le)},createURL:Ze,encodeLocation(le){let Xe=Ze(le);return{pathname:Xe.pathname,search:Xe.search,hash:Xe.hash}},push:de,replace:De,go(le){return M.go(le)}};return xe}function Tw(d,g=!1){let T="http://localhost";typeof window<"u"&&(T=window.location.origin!=="null"?window.location.origin:window.location.href),Kn(T,"No window.location.(origin|href) available to create URL");let S=typeof d=="string"?d:ng(d);return S=S.replace(/ $/,"%20"),!g&&S.startsWith("//")&&(S=T+S),new URL(S,T)}function Fv(d,g,T="/"){return Sw(d,g,T,!1)}function Sw(d,g,T,S){let I=typeof g=="string"?Lp(g):g,B=Lu(I.pathname||"/",T);if(B==null)return null;let M=Nv(d);Mw(M);let c=null;for(let V=0;c==null&&V<M.length;++V){let X=jw(B);c=kw(M[V],X,S)}return c}function Nv(d,g=[],T=[],S="",I=!1){let B=(M,c,V=I,X)=>{let K={relativePath:X===void 0?M.path||"":X,caseSensitive:M.caseSensitive===!0,childrenIndex:c,route:M};if(K.relativePath.startsWith("/")){if(!K.relativePath.startsWith(S)&&V)return;Kn(K.relativePath.startsWith(S),`Absolute route path "${K.relativePath}" nested under path "${S}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),K.relativePath=K.relativePath.slice(S.length)}let te=Ru([S,K.relativePath]),de=T.concat(K);M.children&&M.children.length>0&&(Kn(M.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${te}".`),Nv(M.children,g,de,te,V)),!(M.path==null&&!M.index)&&g.push({path:te,score:Iw(te,M.index),routesMeta:de})};return d.forEach((M,c)=>{if(M.path===""||!M.path?.includes("?"))B(M,c);else for(let V of Vv(M.path))B(M,c,!0,V)}),g}function Vv(d){let g=d.split("/");if(g.length===0)return[];let[T,...S]=g,I=T.endsWith("?"),B=T.replace(/\?$/,"");if(S.length===0)return I?[B,""]:[B];let M=Vv(S.join("/")),c=[];return c.push(...M.map(V=>V===""?B:[B,V].join("/"))),I&&c.push(...M),c.map(V=>d.startsWith("/")&&V===""?"/":V)}function Mw(d){d.sort((g,T)=>g.score!==T.score?T.score-g.score:Rw(g.routesMeta.map(S=>S.childrenIndex),T.routesMeta.map(S=>S.childrenIndex)))}var Ew=/^:[\w-]+$/,Aw=3,Cw=2,Dw=1,zw=10,Pw=-2,px=d=>d==="*";function Iw(d,g){let T=d.split("/"),S=T.length;return T.some(px)&&(S+=Pw),g&&(S+=Cw),T.filter(I=>!px(I)).reduce((I,B)=>I+(Ew.test(B)?Aw:B===""?Dw:zw),S)}function Rw(d,g){return d.length===g.length&&d.slice(0,-1).every((S,I)=>S===g[I])?d[d.length-1]-g[g.length-1]:0}function kw(d,g,T=!1){let{routesMeta:S}=d,I={},B="/",M=[];for(let c=0;c<S.length;++c){let V=S[c],X=c===S.length-1,K=B==="/"?g:g.slice(B.length)||"/",te=Dy({path:V.relativePath,caseSensitive:V.caseSensitive,end:X},K),de=V.route;if(!te&&X&&T&&!S[S.length-1].route.index&&(te=Dy({path:V.relativePath,caseSensitive:V.caseSensitive,end:!1},K)),!te)return null;Object.assign(I,te.params),M.push({params:I,pathname:Ru([B,te.pathname]),pathnameBase:Nw(Ru([B,te.pathnameBase])),route:de}),te.pathnameBase!=="/"&&(B=Ru([B,te.pathnameBase]))}return M}function Dy(d,g){typeof d=="string"&&(d={path:d,caseSensitive:!1,end:!0});let[T,S]=Lw(d.path,d.caseSensitive,d.end),I=g.match(T);if(!I)return null;let B=I[0],M=B.replace(/(.)\/+$/,"$1"),c=I.slice(1);return{params:S.reduce((X,{paramName:K,isOptional:te},de)=>{if(K==="*"){let Ze=c[de]||"";M=B.slice(0,B.length-Ze.length).replace(/(.)\/+$/,"$1")}const De=c[de];return te&&!De?X[K]=void 0:X[K]=(De||"").replace(/%2F/g,"/"),X},{}),pathname:B,pathnameBase:M,pattern:d}}function Lw(d,g=!1,T=!0){Pc(d==="*"||!d.endsWith("*")||d.endsWith("/*"),`Route path "${d}" will be treated as if it were "${d.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${d.replace(/\*$/,"/*")}".`);let S=[],I="^"+d.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(M,c,V)=>(S.push({paramName:c,isOptional:V!=null}),V?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return d.endsWith("*")?(S.push({paramName:"*"}),I+=d==="*"||d==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):T?I+="\\/*$":d!==""&&d!=="/"&&(I+="(?:(?=\\/|$))"),[new RegExp(I,g?void 0:"i"),S]}function jw(d){try{return d.split("/").map(g=>decodeURIComponent(g).replace(/\//g,"%2F")).join("/")}catch(g){return Pc(!1,`The URL path "${d}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${g}).`),d}}function Lu(d,g){if(g==="/")return d;if(!d.toLowerCase().startsWith(g.toLowerCase()))return null;let T=g.endsWith("/")?g.length-1:g.length,S=d.charAt(T);return S&&S!=="/"?null:d.slice(T)||"/"}var Bw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Ow(d,g="/"){let{pathname:T,search:S="",hash:I=""}=typeof d=="string"?Lp(d):d,B;return T?(T=T.replace(/\/\/+/g,"/"),T.startsWith("/")?B=mx(T.substring(1),"/"):B=mx(T,g)):B=g,{pathname:B,search:Vw(S),hash:Uw(I)}}function mx(d,g){let T=g.replace(/\/+$/,"").split("/");return d.split("/").forEach(I=>{I===".."?T.length>1&&T.pop():I!=="."&&T.push(I)}),T.length>1?T.join("/"):"/"}function f_(d,g,T,S){return`Cannot include a '${d}' character in a manually specified \`to.${g}\` field [${JSON.stringify(S)}].  Please separate it out to the \`to.${T}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Fw(d){return d.filter((g,T)=>T===0||g.route.path&&g.route.path.length>0)}function Uv(d){let g=Fw(d);return g.map((T,S)=>S===g.length-1?T.pathname:T.pathnameBase)}function Gv(d,g,T,S=!1){let I;typeof d=="string"?I=Lp(d):(I={...d},Kn(!I.pathname||!I.pathname.includes("?"),f_("?","pathname","search",I)),Kn(!I.pathname||!I.pathname.includes("#"),f_("#","pathname","hash",I)),Kn(!I.search||!I.search.includes("#"),f_("#","search","hash",I)));let B=d===""||I.pathname==="",M=B?"/":I.pathname,c;if(M==null)c=T;else{let te=g.length-1;if(!S&&M.startsWith("..")){let de=M.split("/");for(;de[0]==="..";)de.shift(),te-=1;I.pathname=de.join("/")}c=te>=0?g[te]:"/"}let V=Ow(I,c),X=M&&M!=="/"&&M.endsWith("/"),K=(B||M===".")&&T.endsWith("/");return!V.pathname.endsWith("/")&&(X||K)&&(V.pathname+="/"),V}var Ru=d=>d.join("/").replace(/\/\/+/g,"/"),Nw=d=>d.replace(/\/+$/,"").replace(/^\/*/,"/"),Vw=d=>!d||d==="?"?"":d.startsWith("?")?d:"?"+d,Uw=d=>!d||d==="#"?"":d.startsWith("#")?d:"#"+d,Gw=class{constructor(d,g,T,S=!1){this.status=d,this.statusText=g||"",this.internal=S,T instanceof Error?(this.data=T.toString(),this.error=T):this.data=T}};function qw(d){return d!=null&&typeof d.status=="number"&&typeof d.statusText=="string"&&typeof d.internal=="boolean"&&"data"in d}function Zw(d){return d.map(g=>g.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var qv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Zv(d,g){let T=d;if(typeof T!="string"||!Bw.test(T))return{absoluteURL:void 0,isExternal:!1,to:T};let S=T,I=!1;if(qv)try{let B=new URL(window.location.href),M=T.startsWith("//")?new URL(B.protocol+T):new URL(T),c=Lu(M.pathname,g);M.origin===B.origin&&c!=null?T=c+M.search+M.hash:I=!0}catch{Pc(!1,`<Link to="${T}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:S,isExternal:I,to:T}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Hv=["POST","PUT","PATCH","DELETE"];new Set(Hv);var Hw=["GET",...Hv];new Set(Hw);var jp=Se.createContext(null);jp.displayName="DataRouter";var Oy=Se.createContext(null);Oy.displayName="DataRouterState";var $w=Se.createContext(!1),$v=Se.createContext({isTransitioning:!1});$v.displayName="ViewTransition";var Xw=Se.createContext(new Map);Xw.displayName="Fetchers";var Yw=Se.createContext(null);Yw.displayName="Await";var Ho=Se.createContext(null);Ho.displayName="Navigation";var cg=Se.createContext(null);cg.displayName="Location";var Fl=Se.createContext({outlet:null,matches:[],isDataRoute:!1});Fl.displayName="Route";var a0=Se.createContext(null);a0.displayName="RouteError";var Xv="REACT_ROUTER_ERROR",Ww="REDIRECT",Kw="ROUTE_ERROR_RESPONSE";function Qw(d){if(d.startsWith(`${Xv}:${Ww}:{`))try{let g=JSON.parse(d.slice(28));if(typeof g=="object"&&g&&typeof g.status=="number"&&typeof g.statusText=="string"&&typeof g.location=="string"&&typeof g.reloadDocument=="boolean"&&typeof g.replace=="boolean")return g}catch{}}function Jw(d){if(d.startsWith(`${Xv}:${Kw}:{`))try{let g=JSON.parse(d.slice(40));if(typeof g=="object"&&g&&typeof g.status=="number"&&typeof g.statusText=="string")return new Gw(g.status,g.statusText,g.data)}catch{}}function e2(d,{relative:g}={}){Kn(ug(),"useHref() may be used only in the context of a <Router> component.");let{basename:T,navigator:S}=Se.useContext(Ho),{hash:I,pathname:B,search:M}=hg(d,{relative:g}),c=B;return T!=="/"&&(c=B==="/"?T:Ru([T,B])),S.createHref({pathname:c,search:M,hash:I})}function ug(){return Se.useContext(cg)!=null}function Gh(){return Kn(ug(),"useLocation() may be used only in the context of a <Router> component."),Se.useContext(cg).location}var Yv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Wv(d){Se.useContext(Ho).static||Se.useLayoutEffect(d)}function t2(){let{isDataRoute:d}=Se.useContext(Fl);return d?y2():i2()}function i2(){Kn(ug(),"useNavigate() may be used only in the context of a <Router> component.");let d=Se.useContext(jp),{basename:g,navigator:T}=Se.useContext(Ho),{matches:S}=Se.useContext(Fl),{pathname:I}=Gh(),B=JSON.stringify(Uv(S)),M=Se.useRef(!1);return Wv(()=>{M.current=!0}),Se.useCallback((V,X={})=>{if(Pc(M.current,Yv),!M.current)return;if(typeof V=="number"){T.go(V);return}let K=Gv(V,JSON.parse(B),I,X.relative==="path");d==null&&g!=="/"&&(K.pathname=K.pathname==="/"?g:Ru([g,K.pathname])),(X.replace?T.replace:T.push)(K,X.state,X)},[g,T,B,I,d])}var n2=Se.createContext(null);function r2(d){let g=Se.useContext(Fl).outlet;return Se.useMemo(()=>g&&Se.createElement(n2.Provider,{value:d},g),[g,d])}function a2(){let{matches:d}=Se.useContext(Fl),g=d[d.length-1];return g?g.params:{}}function hg(d,{relative:g}={}){let{matches:T}=Se.useContext(Fl),{pathname:S}=Gh(),I=JSON.stringify(Uv(T));return Se.useMemo(()=>Gv(d,JSON.parse(I),S,g==="path"),[d,I,S,g])}function s2(d,g){return Kv(d,g)}function Kv(d,g,T,S,I){Kn(ug(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:B}=Se.useContext(Ho),{matches:M}=Se.useContext(Fl),c=M[M.length-1],V=c?c.params:{},X=c?c.pathname:"/",K=c?c.pathnameBase:"/",te=c&&c.route;{let Ve=te&&te.path||"";Jv(X,!te||Ve.endsWith("*")||Ve.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${X}" (under <Route path="${Ve}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Ve}"> to <Route path="${Ve==="/"?"*":`${Ve}/*`}">.`)}let de=Gh(),De;if(g){let Ve=typeof g=="string"?Lp(g):g;Kn(K==="/"||Ve.pathname?.startsWith(K),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${K}" but pathname "${Ve.pathname}" was given in the \`location\` prop.`),De=Ve}else De=de;let Ze=De.pathname||"/",xe=Ze;if(K!=="/"){let Ve=K.replace(/^\//,"").split("/");xe="/"+Ze.replace(/^\//,"").split("/").slice(Ve.length).join("/")}let le=Fv(d,{pathname:xe});Pc(te||le!=null,`No routes matched location "${De.pathname}${De.search}${De.hash}" `),Pc(le==null||le[le.length-1].route.element!==void 0||le[le.length-1].route.Component!==void 0||le[le.length-1].route.lazy!==void 0,`Matched leaf route at location "${De.pathname}${De.search}${De.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Xe=h2(le&&le.map(Ve=>Object.assign({},Ve,{params:Object.assign({},V,Ve.params),pathname:Ru([K,B.encodeLocation?B.encodeLocation(Ve.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Ve.pathname]),pathnameBase:Ve.pathnameBase==="/"?K:Ru([K,B.encodeLocation?B.encodeLocation(Ve.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Ve.pathnameBase])})),M,T,S,I);return g&&Xe?Se.createElement(cg.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...De},navigationType:"POP"}},Xe):Xe}function o2(){let d=g2(),g=qw(d)?`${d.status} ${d.statusText}`:d instanceof Error?d.message:JSON.stringify(d),T=d instanceof Error?d.stack:null,S="rgba(200,200,200, 0.5)",I={padding:"0.5rem",backgroundColor:S},B={padding:"2px 4px",backgroundColor:S},M=null;return console.error("Error handled by React Router default ErrorBoundary:",d),M=Se.createElement(Se.Fragment,null,Se.createElement("p",null," Hey developer "),Se.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Se.createElement("code",{style:B},"ErrorBoundary")," or"," ",Se.createElement("code",{style:B},"errorElement")," prop on your route.")),Se.createElement(Se.Fragment,null,Se.createElement("h2",null,"Unexpected Application Error!"),Se.createElement("h3",{style:{fontStyle:"italic"}},g),T?Se.createElement("pre",{style:I},T):null,M)}var l2=Se.createElement(o2,null),Qv=class extends Se.Component{constructor(d){super(d),this.state={location:d.location,revalidation:d.revalidation,error:d.error}}static getDerivedStateFromError(d){return{error:d}}static getDerivedStateFromProps(d,g){return g.location!==d.location||g.revalidation!=="idle"&&d.revalidation==="idle"?{error:d.error,location:d.location,revalidation:d.revalidation}:{error:d.error!==void 0?d.error:g.error,location:g.location,revalidation:d.revalidation||g.revalidation}}componentDidCatch(d,g){this.props.onError?this.props.onError(d,g):console.error("React Router caught the following error during render",d)}render(){let d=this.state.error;if(this.context&&typeof d=="object"&&d&&"digest"in d&&typeof d.digest=="string"){const T=Jw(d.digest);T&&(d=T)}let g=d!==void 0?Se.createElement(Fl.Provider,{value:this.props.routeContext},Se.createElement(a0.Provider,{value:d,children:this.props.component})):this.props.children;return this.context?Se.createElement(c2,{error:d},g):g}};Qv.contextType=$w;var p_=new WeakMap;function c2({children:d,error:g}){let{basename:T}=Se.useContext(Ho);if(typeof g=="object"&&g&&"digest"in g&&typeof g.digest=="string"){let S=Qw(g.digest);if(S){let I=p_.get(g);if(I)throw I;let B=Zv(S.location,T);if(qv&&!p_.get(g))if(B.isExternal||S.reloadDocument)window.location.href=B.absoluteURL||B.to;else{const M=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(B.to,{replace:S.replace}));throw p_.set(g,M),M}return Se.createElement("meta",{httpEquiv:"refresh",content:`0;url=${B.absoluteURL||B.to}`})}}return d}function u2({routeContext:d,match:g,children:T}){let S=Se.useContext(jp);return S&&S.static&&S.staticContext&&(g.route.errorElement||g.route.ErrorBoundary)&&(S.staticContext._deepestRenderedBoundaryId=g.route.id),Se.createElement(Fl.Provider,{value:d},T)}function h2(d,g=[],T=null,S=null,I=null){if(d==null){if(!T)return null;if(T.errors)d=T.matches;else if(g.length===0&&!T.initialized&&T.matches.length>0)d=T.matches;else return null}let B=d,M=T?.errors;if(M!=null){let K=B.findIndex(te=>te.route.id&&M?.[te.route.id]!==void 0);Kn(K>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(M).join(",")}`),B=B.slice(0,Math.min(B.length,K+1))}let c=!1,V=-1;if(T)for(let K=0;K<B.length;K++){let te=B[K];if((te.route.HydrateFallback||te.route.hydrateFallbackElement)&&(V=K),te.route.id){let{loaderData:de,errors:De}=T,Ze=te.route.loader&&!de.hasOwnProperty(te.route.id)&&(!De||De[te.route.id]===void 0);if(te.route.lazy||Ze){c=!0,V>=0?B=B.slice(0,V+1):B=[B[0]];break}}}let X=T&&S?(K,te)=>{S(K,{location:T.location,params:T.matches?.[0]?.params??{},unstable_pattern:Zw(T.matches),errorInfo:te})}:void 0;return B.reduceRight((K,te,de)=>{let De,Ze=!1,xe=null,le=null;T&&(De=M&&te.route.id?M[te.route.id]:void 0,xe=te.route.errorElement||l2,c&&(V<0&&de===0?(Jv("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),Ze=!0,le=null):V===de&&(Ze=!0,le=te.route.hydrateFallbackElement||null)));let Xe=g.concat(B.slice(0,de+1)),Ve=()=>{let Ue;return De?Ue=xe:Ze?Ue=le:te.route.Component?Ue=Se.createElement(te.route.Component,null):te.route.element?Ue=te.route.element:Ue=K,Se.createElement(u2,{match:te,routeContext:{outlet:K,matches:Xe,isDataRoute:T!=null},children:Ue})};return T&&(te.route.ErrorBoundary||te.route.errorElement||de===0)?Se.createElement(Qv,{location:T.location,revalidation:T.revalidation,component:xe,error:De,children:Ve(),routeContext:{outlet:null,matches:Xe,isDataRoute:!0},onError:X}):Ve()},null)}function s0(d){return`${d} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function d2(d){let g=Se.useContext(jp);return Kn(g,s0(d)),g}function f2(d){let g=Se.useContext(Oy);return Kn(g,s0(d)),g}function p2(d){let g=Se.useContext(Fl);return Kn(g,s0(d)),g}function o0(d){let g=p2(d),T=g.matches[g.matches.length-1];return Kn(T.route.id,`${d} can only be used on routes that contain a unique "id"`),T.route.id}function m2(){return o0("useRouteId")}function g2(){let d=Se.useContext(a0),g=f2("useRouteError"),T=o0("useRouteError");return d!==void 0?d:g.errors?.[T]}function y2(){let{router:d}=d2("useNavigate"),g=o0("useNavigate"),T=Se.useRef(!1);return Wv(()=>{T.current=!0}),Se.useCallback(async(I,B={})=>{Pc(T.current,Yv),T.current&&(typeof I=="number"?await d.navigate(I):await d.navigate(I,{fromRouteId:g,...B}))},[d,g])}var gx={};function Jv(d,g,T){!g&&!gx[d]&&(gx[d]=!0,Pc(!1,T))}Se.memo(_2);function _2({routes:d,future:g,state:T,onError:S}){return Kv(d,void 0,T,S,g)}function x2(d){return r2(d.context)}function Bh(d){Kn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function v2({basename:d="/",children:g=null,location:T,navigationType:S="POP",navigator:I,static:B=!1,unstable_useTransitions:M}){Kn(!ug(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=d.replace(/^\/*/,"/"),V=Se.useMemo(()=>({basename:c,navigator:I,static:B,unstable_useTransitions:M,future:{}}),[c,I,B,M]);typeof T=="string"&&(T=Lp(T));let{pathname:X="/",search:K="",hash:te="",state:de=null,key:De="default"}=T,Ze=Se.useMemo(()=>{let xe=Lu(X,c);return xe==null?null:{location:{pathname:xe,search:K,hash:te,state:de,key:De},navigationType:S}},[c,X,K,te,de,De,S]);return Pc(Ze!=null,`<Router basename="${c}"> is not able to match the URL "${X}${K}${te}" because it does not start with the basename, so the <Router> won't render anything.`),Ze==null?null:Se.createElement(Ho.Provider,{value:V},Se.createElement(cg.Provider,{children:g,value:Ze}))}function b2({children:d,location:g}){return s2(R_(d),g)}function R_(d,g=[]){let T=[];return Se.Children.forEach(d,(S,I)=>{if(!Se.isValidElement(S))return;let B=[...g,I];if(S.type===Se.Fragment){T.push.apply(T,R_(S.props.children,B));return}Kn(S.type===Bh,`[${typeof S.type=="string"?S.type:S.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Kn(!S.props.index||!S.props.children,"An index route cannot have child routes.");let M={id:S.props.id||B.join("-"),caseSensitive:S.props.caseSensitive,element:S.props.element,Component:S.props.Component,index:S.props.index,path:S.props.path,middleware:S.props.middleware,loader:S.props.loader,action:S.props.action,hydrateFallbackElement:S.props.hydrateFallbackElement,HydrateFallback:S.props.HydrateFallback,errorElement:S.props.errorElement,ErrorBoundary:S.props.ErrorBoundary,hasErrorBoundary:S.props.hasErrorBoundary===!0||S.props.ErrorBoundary!=null||S.props.errorElement!=null,shouldRevalidate:S.props.shouldRevalidate,handle:S.props.handle,lazy:S.props.lazy};S.props.children&&(M.children=R_(S.props.children,B)),T.push(M)}),T}var by="get",wy="application/x-www-form-urlencoded";function Fy(d){return typeof HTMLElement<"u"&&d instanceof HTMLElement}function w2(d){return Fy(d)&&d.tagName.toLowerCase()==="button"}function T2(d){return Fy(d)&&d.tagName.toLowerCase()==="form"}function S2(d){return Fy(d)&&d.tagName.toLowerCase()==="input"}function M2(d){return!!(d.metaKey||d.altKey||d.ctrlKey||d.shiftKey)}function E2(d,g){return d.button===0&&(!g||g==="_self")&&!M2(d)}var gy=null;function A2(){if(gy===null)try{new FormData(document.createElement("form"),0),gy=!1}catch{gy=!0}return gy}var C2=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function m_(d){return d!=null&&!C2.has(d)?(Pc(!1,`"${d}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${wy}"`),null):d}function D2(d,g){let T,S,I,B,M;if(T2(d)){let c=d.getAttribute("action");S=c?Lu(c,g):null,T=d.getAttribute("method")||by,I=m_(d.getAttribute("enctype"))||wy,B=new FormData(d)}else if(w2(d)||S2(d)&&(d.type==="submit"||d.type==="image")){let c=d.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let V=d.getAttribute("formaction")||c.getAttribute("action");if(S=V?Lu(V,g):null,T=d.getAttribute("formmethod")||c.getAttribute("method")||by,I=m_(d.getAttribute("formenctype"))||m_(c.getAttribute("enctype"))||wy,B=new FormData(c,d),!A2()){let{name:X,type:K,value:te}=d;if(K==="image"){let de=X?`${X}.`:"";B.append(`${de}x`,"0"),B.append(`${de}y`,"0")}else X&&B.append(X,te)}}else{if(Fy(d))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');T=by,S=null,I=wy,M=d}return B&&I==="text/plain"&&(M=B,B=void 0),{action:S,method:T.toLowerCase(),encType:I,formData:B,body:M}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function l0(d,g){if(d===!1||d===null||typeof d>"u")throw new Error(g)}function z2(d,g,T,S){let I=typeof d=="string"?new URL(d,typeof window>"u"?"server://singlefetch/":window.location.origin):d;return T?I.pathname.endsWith("/")?I.pathname=`${I.pathname}_.${S}`:I.pathname=`${I.pathname}.${S}`:I.pathname==="/"?I.pathname=`_root.${S}`:g&&Lu(I.pathname,g)==="/"?I.pathname=`${g.replace(/\/$/,"")}/_root.${S}`:I.pathname=`${I.pathname.replace(/\/$/,"")}.${S}`,I}async function P2(d,g){if(d.id in g)return g[d.id];try{let T=await import(d.module);return g[d.id]=T,T}catch(T){return console.error(`Error loading route module \`${d.module}\`, reloading page...`),console.error(T),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function I2(d){return d==null?!1:d.href==null?d.rel==="preload"&&typeof d.imageSrcSet=="string"&&typeof d.imageSizes=="string":typeof d.rel=="string"&&typeof d.href=="string"}async function R2(d,g,T){let S=await Promise.all(d.map(async I=>{let B=g.routes[I.route.id];if(B){let M=await P2(B,T);return M.links?M.links():[]}return[]}));return B2(S.flat(1).filter(I2).filter(I=>I.rel==="stylesheet"||I.rel==="preload").map(I=>I.rel==="stylesheet"?{...I,rel:"prefetch",as:"style"}:{...I,rel:"prefetch"}))}function yx(d,g,T,S,I,B){let M=(V,X)=>T[X]?V.route.id!==T[X].route.id:!0,c=(V,X)=>T[X].pathname!==V.pathname||T[X].route.path?.endsWith("*")&&T[X].params["*"]!==V.params["*"];return B==="assets"?g.filter((V,X)=>M(V,X)||c(V,X)):B==="data"?g.filter((V,X)=>{let K=S.routes[V.route.id];if(!K||!K.hasLoader)return!1;if(M(V,X)||c(V,X))return!0;if(V.route.shouldRevalidate){let te=V.route.shouldRevalidate({currentUrl:new URL(I.pathname+I.search+I.hash,window.origin),currentParams:T[0]?.params||{},nextUrl:new URL(d,window.origin),nextParams:V.params,defaultShouldRevalidate:!0});if(typeof te=="boolean")return te}return!0}):[]}function k2(d,g,{includeHydrateFallback:T}={}){return L2(d.map(S=>{let I=g.routes[S.route.id];if(!I)return[];let B=[I.module];return I.clientActionModule&&(B=B.concat(I.clientActionModule)),I.clientLoaderModule&&(B=B.concat(I.clientLoaderModule)),T&&I.hydrateFallbackModule&&(B=B.concat(I.hydrateFallbackModule)),I.imports&&(B=B.concat(I.imports)),B}).flat(1))}function L2(d){return[...new Set(d)]}function j2(d){let g={},T=Object.keys(d).sort();for(let S of T)g[S]=d[S];return g}function B2(d,g){let T=new Set;return new Set(g),d.reduce((S,I)=>{let B=JSON.stringify(j2(I));return T.has(B)||(T.add(B),S.push({key:B,link:I})),S},[])}function eb(){let d=Se.useContext(jp);return l0(d,"You must render this element inside a <DataRouterContext.Provider> element"),d}function O2(){let d=Se.useContext(Oy);return l0(d,"You must render this element inside a <DataRouterStateContext.Provider> element"),d}var c0=Se.createContext(void 0);c0.displayName="FrameworkContext";function tb(){let d=Se.useContext(c0);return l0(d,"You must render this element inside a <HydratedRouter> element"),d}function F2(d,g){let T=Se.useContext(c0),[S,I]=Se.useState(!1),[B,M]=Se.useState(!1),{onFocus:c,onBlur:V,onMouseEnter:X,onMouseLeave:K,onTouchStart:te}=g,de=Se.useRef(null);Se.useEffect(()=>{if(d==="render"&&M(!0),d==="viewport"){let xe=Xe=>{Xe.forEach(Ve=>{M(Ve.isIntersecting)})},le=new IntersectionObserver(xe,{threshold:.5});return de.current&&le.observe(de.current),()=>{le.disconnect()}}},[d]),Se.useEffect(()=>{if(S){let xe=setTimeout(()=>{M(!0)},100);return()=>{clearTimeout(xe)}}},[S]);let De=()=>{I(!0)},Ze=()=>{I(!1),M(!1)};return T?d!=="intent"?[B,de,{}]:[B,de,{onFocus:Xm(c,De),onBlur:Xm(V,Ze),onMouseEnter:Xm(X,De),onMouseLeave:Xm(K,Ze),onTouchStart:Xm(te,De)}]:[!1,de,{}]}function Xm(d,g){return T=>{d&&d(T),T.defaultPrevented||g(T)}}function N2({page:d,...g}){let{router:T}=eb(),S=Se.useMemo(()=>Fv(T.routes,d,T.basename),[T.routes,d,T.basename]);return S?Se.createElement(U2,{page:d,matches:S,...g}):null}function V2(d){let{manifest:g,routeModules:T}=tb(),[S,I]=Se.useState([]);return Se.useEffect(()=>{let B=!1;return R2(d,g,T).then(M=>{B||I(M)}),()=>{B=!0}},[d,g,T]),S}function U2({page:d,matches:g,...T}){let S=Gh(),{future:I,manifest:B,routeModules:M}=tb(),{basename:c}=eb(),{loaderData:V,matches:X}=O2(),K=Se.useMemo(()=>yx(d,g,X,B,S,"data"),[d,g,X,B,S]),te=Se.useMemo(()=>yx(d,g,X,B,S,"assets"),[d,g,X,B,S]),de=Se.useMemo(()=>{if(d===S.pathname+S.search+S.hash)return[];let xe=new Set,le=!1;if(g.forEach(Ve=>{let Ue=B.routes[Ve.route.id];!Ue||!Ue.hasLoader||(!K.some(gt=>gt.route.id===Ve.route.id)&&Ve.route.id in V&&M[Ve.route.id]?.shouldRevalidate||Ue.hasClientLoader?le=!0:xe.add(Ve.route.id))}),xe.size===0)return[];let Xe=z2(d,c,I.unstable_trailingSlashAwareDataRequests,"data");return le&&xe.size>0&&Xe.searchParams.set("_routes",g.filter(Ve=>xe.has(Ve.route.id)).map(Ve=>Ve.route.id).join(",")),[Xe.pathname+Xe.search]},[c,I.unstable_trailingSlashAwareDataRequests,V,S,B,K,g,d,M]),De=Se.useMemo(()=>k2(te,B),[te,B]),Ze=V2(te);return Se.createElement(Se.Fragment,null,de.map(xe=>Se.createElement("link",{key:xe,rel:"prefetch",as:"fetch",href:xe,...T})),De.map(xe=>Se.createElement("link",{key:xe,rel:"modulepreload",href:xe,...T})),Ze.map(({key:xe,link:le})=>Se.createElement("link",{key:xe,nonce:T.nonce,...le,crossOrigin:le.crossOrigin??T.crossOrigin})))}function G2(...d){return g=>{d.forEach(T=>{typeof T=="function"?T(g):T!=null&&(T.current=g)})}}var q2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{q2&&(window.__reactRouterVersion="7.13.0")}catch{}function Z2({basename:d,children:g,unstable_useTransitions:T,window:S}){let I=Se.useRef();I.current==null&&(I.current=vw({window:S,v5Compat:!0}));let B=I.current,[M,c]=Se.useState({action:B.action,location:B.location}),V=Se.useCallback(X=>{T===!1?c(X):Se.startTransition(()=>c(X))},[T]);return Se.useLayoutEffect(()=>B.listen(V),[B,V]),Se.createElement(v2,{basename:d,children:g,location:M.location,navigationType:M.action,navigator:B,unstable_useTransitions:T})}var ib=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ic=Se.forwardRef(function({onClick:g,discover:T="render",prefetch:S="none",relative:I,reloadDocument:B,replace:M,state:c,target:V,to:X,preventScrollReset:K,viewTransition:te,unstable_defaultShouldRevalidate:de,...De},Ze){let{basename:xe,unstable_useTransitions:le}=Se.useContext(Ho),Xe=typeof X=="string"&&ib.test(X),Ve=Zv(X,xe);X=Ve.to;let Ue=e2(X,{relative:I}),[gt,pt,Dt]=F2(S,De),_t=X2(X,{replace:M,state:c,target:V,preventScrollReset:K,relative:I,viewTransition:te,unstable_defaultShouldRevalidate:de,unstable_useTransitions:le});function Mt(si){g&&g(si),si.defaultPrevented||_t(si)}let Ot=Se.createElement("a",{...De,...Dt,href:Ve.absoluteURL||Ue,onClick:Ve.isExternal||B?g:Mt,ref:G2(Ze,pt),target:V,"data-discover":!Xe&&T==="render"?"true":void 0});return gt&&!Xe?Se.createElement(Se.Fragment,null,Ot,Se.createElement(N2,{page:Ue})):Ot});Ic.displayName="Link";var k_=Se.forwardRef(function({"aria-current":g="page",caseSensitive:T=!1,className:S="",end:I=!1,style:B,to:M,viewTransition:c,children:V,...X},K){let te=hg(M,{relative:X.relative}),de=Gh(),De=Se.useContext(Oy),{navigator:Ze,basename:xe}=Se.useContext(Ho),le=De!=null&&J2(te)&&c===!0,Xe=Ze.encodeLocation?Ze.encodeLocation(te).pathname:te.pathname,Ve=de.pathname,Ue=De&&De.navigation&&De.navigation.location?De.navigation.location.pathname:null;T||(Ve=Ve.toLowerCase(),Ue=Ue?Ue.toLowerCase():null,Xe=Xe.toLowerCase()),Ue&&xe&&(Ue=Lu(Ue,xe)||Ue);const gt=Xe!=="/"&&Xe.endsWith("/")?Xe.length-1:Xe.length;let pt=Ve===Xe||!I&&Ve.startsWith(Xe)&&Ve.charAt(gt)==="/",Dt=Ue!=null&&(Ue===Xe||!I&&Ue.startsWith(Xe)&&Ue.charAt(Xe.length)==="/"),_t={isActive:pt,isPending:Dt,isTransitioning:le},Mt=pt?g:void 0,Ot;typeof S=="function"?Ot=S(_t):Ot=[S,pt?"active":null,Dt?"pending":null,le?"transitioning":null].filter(Boolean).join(" ");let si=typeof B=="function"?B(_t):B;return Se.createElement(Ic,{...X,"aria-current":Mt,className:Ot,ref:K,style:si,to:M,viewTransition:c},typeof V=="function"?V(_t):V)});k_.displayName="NavLink";var H2=Se.forwardRef(({discover:d="render",fetcherKey:g,navigate:T,reloadDocument:S,replace:I,state:B,method:M=by,action:c,onSubmit:V,relative:X,preventScrollReset:K,viewTransition:te,unstable_defaultShouldRevalidate:de,...De},Ze)=>{let{unstable_useTransitions:xe}=Se.useContext(Ho),le=K2(),Xe=Q2(c,{relative:X}),Ve=M.toLowerCase()==="get"?"get":"post",Ue=typeof c=="string"&&ib.test(c),gt=pt=>{if(V&&V(pt),pt.defaultPrevented)return;pt.preventDefault();let Dt=pt.nativeEvent.submitter,_t=Dt?.getAttribute("formmethod")||M,Mt=()=>le(Dt||pt.currentTarget,{fetcherKey:g,method:_t,navigate:T,replace:I,state:B,relative:X,preventScrollReset:K,viewTransition:te,unstable_defaultShouldRevalidate:de});xe&&T!==!1?Se.startTransition(()=>Mt()):Mt()};return Se.createElement("form",{ref:Ze,method:Ve,action:Xe,onSubmit:S?V:gt,...De,"data-discover":!Ue&&d==="render"?"true":void 0})});H2.displayName="Form";function $2(d){return`${d} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function nb(d){let g=Se.useContext(jp);return Kn(g,$2(d)),g}function X2(d,{target:g,replace:T,state:S,preventScrollReset:I,relative:B,viewTransition:M,unstable_defaultShouldRevalidate:c,unstable_useTransitions:V}={}){let X=t2(),K=Gh(),te=hg(d,{relative:B});return Se.useCallback(de=>{if(E2(de,g)){de.preventDefault();let De=T!==void 0?T:ng(K)===ng(te),Ze=()=>X(d,{replace:De,state:S,preventScrollReset:I,relative:B,viewTransition:M,unstable_defaultShouldRevalidate:c});V?Se.startTransition(()=>Ze()):Ze()}},[K,X,te,T,S,g,d,I,B,M,c,V])}var Y2=0,W2=()=>`__${String(++Y2)}__`;function K2(){let{router:d}=nb("useSubmit"),{basename:g}=Se.useContext(Ho),T=m2(),S=d.fetch,I=d.navigate;return Se.useCallback(async(B,M={})=>{let{action:c,method:V,encType:X,formData:K,body:te}=D2(B,g);if(M.navigate===!1){let de=M.fetcherKey||W2();await S(de,T,M.action||c,{unstable_defaultShouldRevalidate:M.unstable_defaultShouldRevalidate,preventScrollReset:M.preventScrollReset,formData:K,body:te,formMethod:M.method||V,formEncType:M.encType||X,flushSync:M.flushSync})}else await I(M.action||c,{unstable_defaultShouldRevalidate:M.unstable_defaultShouldRevalidate,preventScrollReset:M.preventScrollReset,formData:K,body:te,formMethod:M.method||V,formEncType:M.encType||X,replace:M.replace,state:M.state,fromRouteId:T,flushSync:M.flushSync,viewTransition:M.viewTransition})},[S,I,g,T])}function Q2(d,{relative:g}={}){let{basename:T}=Se.useContext(Ho),S=Se.useContext(Fl);Kn(S,"useFormAction must be used inside a RouteContext");let[I]=S.matches.slice(-1),B={...hg(d||".",{relative:g})},M=Gh();if(d==null){B.search=M.search;let c=new URLSearchParams(B.search),V=c.getAll("index");if(V.some(K=>K==="")){c.delete("index"),V.filter(te=>te).forEach(te=>c.append("index",te));let K=c.toString();B.search=K?`?${K}`:""}}return(!d||d===".")&&I.route.index&&(B.search=B.search?B.search.replace(/^\?/,"?index&"):"?index"),T!=="/"&&(B.pathname=B.pathname==="/"?T:Ru([T,B.pathname])),ng(B)}function J2(d,{relative:g}={}){let T=Se.useContext($v);Kn(T!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:S}=nb("useViewTransitionState"),I=hg(d,{relative:g});if(!T.isTransitioning)return!1;let B=Lu(T.currentLocation.pathname,S)||T.currentLocation.pathname,M=Lu(T.nextLocation.pathname,S)||T.nextLocation.pathname;return Dy(I.pathname,M)!=null||Dy(I.pathname,B)!=null}const u0=Se.createContext({});function h0(d){const g=Se.useRef(null);return g.current===null&&(g.current=d()),g.current}const rb=typeof window<"u",ab=rb?Se.useLayoutEffect:Se.useEffect,Ny=Se.createContext(null);function d0(d,g){d.indexOf(g)===-1&&d.push(g)}function f0(d,g){const T=d.indexOf(g);T>-1&&d.splice(T,1)}const Rc=(d,g,T)=>T>g?g:T<d?d:T;let p0=()=>{};const ju={},sb=d=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(d);function ob(d){return typeof d=="object"&&d!==null}const lb=d=>/^0[^.\s]+$/u.test(d);function m0(d){let g;return()=>(g===void 0&&(g=d()),g)}const Zo=d=>d,eT=(d,g)=>T=>g(d(T)),dg=(...d)=>d.reduce(eT),rg=(d,g,T)=>{const S=g-d;return S===0?1:(T-d)/S};class g0{constructor(){this.subscriptions=[]}add(g){return d0(this.subscriptions,g),()=>f0(this.subscriptions,g)}notify(g,T,S){const I=this.subscriptions.length;if(I)if(I===1)this.subscriptions[0](g,T,S);else for(let B=0;B<I;B++){const M=this.subscriptions[B];M&&M(g,T,S)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ku=d=>d*1e3,qo=d=>d/1e3;function cb(d,g){return g?d*(1e3/g):0}const ub=(d,g,T)=>(((1-3*T+3*g)*d+(3*T-6*g))*d+3*g)*d,tT=1e-7,iT=12;function nT(d,g,T,S,I){let B,M,c=0;do M=g+(T-g)/2,B=ub(M,S,I)-d,B>0?T=M:g=M;while(Math.abs(B)>tT&&++c<iT);return M}function fg(d,g,T,S){if(d===g&&T===S)return Zo;const I=B=>nT(B,0,1,d,T);return B=>B===0||B===1?B:ub(I(B),g,S)}const hb=d=>g=>g<=.5?d(2*g)/2:(2-d(2*(1-g)))/2,db=d=>g=>1-d(1-g),fb=fg(.33,1.53,.69,.99),y0=db(fb),pb=hb(y0),mb=d=>(d*=2)<1?.5*y0(d):.5*(2-Math.pow(2,-10*(d-1))),_0=d=>1-Math.sin(Math.acos(d)),gb=db(_0),yb=hb(_0),rT=fg(.42,0,1,1),aT=fg(0,0,.58,1),_b=fg(.42,0,.58,1),sT=d=>Array.isArray(d)&&typeof d[0]!="number",xb=d=>Array.isArray(d)&&typeof d[0]=="number",oT={linear:Zo,easeIn:rT,easeInOut:_b,easeOut:aT,circIn:_0,circInOut:yb,circOut:gb,backIn:y0,backInOut:pb,backOut:fb,anticipate:mb},lT=d=>typeof d=="string",_x=d=>{if(xb(d)){p0(d.length===4);const[g,T,S,I]=d;return fg(g,T,S,I)}else if(lT(d))return oT[d];return d},yy=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function cT(d,g){let T=new Set,S=new Set,I=!1,B=!1;const M=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function V(K){M.has(K)&&(X.schedule(K),d()),K(c)}const X={schedule:(K,te=!1,de=!1)=>{const Ze=de&&I?T:S;return te&&M.add(K),Ze.has(K)||Ze.add(K),K},cancel:K=>{S.delete(K),M.delete(K)},process:K=>{if(c=K,I){B=!0;return}I=!0,[T,S]=[S,T],T.forEach(V),T.clear(),I=!1,B&&(B=!1,X.process(K))}};return X}const uT=40;function vb(d,g){let T=!1,S=!0;const I={delta:0,timestamp:0,isProcessing:!1},B=()=>T=!0,M=yy.reduce((Ue,gt)=>(Ue[gt]=cT(B),Ue),{}),{setup:c,read:V,resolveKeyframes:X,preUpdate:K,update:te,preRender:de,render:De,postRender:Ze}=M,xe=()=>{const Ue=ju.useManualTiming?I.timestamp:performance.now();T=!1,ju.useManualTiming||(I.delta=S?1e3/60:Math.max(Math.min(Ue-I.timestamp,uT),1)),I.timestamp=Ue,I.isProcessing=!0,c.process(I),V.process(I),X.process(I),K.process(I),te.process(I),de.process(I),De.process(I),Ze.process(I),I.isProcessing=!1,T&&g&&(S=!1,d(xe))},le=()=>{T=!0,S=!0,I.isProcessing||d(xe)};return{schedule:yy.reduce((Ue,gt)=>{const pt=M[gt];return Ue[gt]=(Dt,_t=!1,Mt=!1)=>(T||le(),pt.schedule(Dt,_t,Mt)),Ue},{}),cancel:Ue=>{for(let gt=0;gt<yy.length;gt++)M[yy[gt]].cancel(Ue)},state:I,steps:M}}const{schedule:jn,cancel:Nh,state:_a,steps:g_}=vb(typeof requestAnimationFrame<"u"?requestAnimationFrame:Zo,!0);let Ty;function hT(){Ty=void 0}const os={now:()=>(Ty===void 0&&os.set(_a.isProcessing||ju.useManualTiming?_a.timestamp:performance.now()),Ty),set:d=>{Ty=d,queueMicrotask(hT)}},bb=d=>g=>typeof g=="string"&&g.startsWith(d),wb=bb("--"),dT=bb("var(--"),x0=d=>dT(d)?fT.test(d.split("/*")[0].trim()):!1,fT=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function xx(d){return typeof d!="string"?!1:d.split("/*")[0].includes("var(--")}const Bp={test:d=>typeof d=="number",parse:parseFloat,transform:d=>d},ag={...Bp,transform:d=>Rc(0,1,d)},_y={...Bp,default:1},Jm=d=>Math.round(d*1e5)/1e5,v0=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function pT(d){return d==null}const mT=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,b0=(d,g)=>T=>!!(typeof T=="string"&&mT.test(T)&&T.startsWith(d)||g&&!pT(T)&&Object.prototype.hasOwnProperty.call(T,g)),Tb=(d,g,T)=>S=>{if(typeof S!="string")return S;const[I,B,M,c]=S.match(v0);return{[d]:parseFloat(I),[g]:parseFloat(B),[T]:parseFloat(M),alpha:c!==void 0?parseFloat(c):1}},gT=d=>Rc(0,255,d),y_={...Bp,transform:d=>Math.round(gT(d))},af={test:b0("rgb","red"),parse:Tb("red","green","blue"),transform:({red:d,green:g,blue:T,alpha:S=1})=>"rgba("+y_.transform(d)+", "+y_.transform(g)+", "+y_.transform(T)+", "+Jm(ag.transform(S))+")"};function yT(d){let g="",T="",S="",I="";return d.length>5?(g=d.substring(1,3),T=d.substring(3,5),S=d.substring(5,7),I=d.substring(7,9)):(g=d.substring(1,2),T=d.substring(2,3),S=d.substring(3,4),I=d.substring(4,5),g+=g,T+=T,S+=S,I+=I),{red:parseInt(g,16),green:parseInt(T,16),blue:parseInt(S,16),alpha:I?parseInt(I,16)/255:1}}const L_={test:b0("#"),parse:yT,transform:af.transform},pg=d=>({test:g=>typeof g=="string"&&g.endsWith(d)&&g.split(" ").length===1,parse:parseFloat,transform:g=>`${g}${d}`}),Oh=pg("deg"),zc=pg("%"),Bt=pg("px"),_T=pg("vh"),xT=pg("vw"),vx={...zc,parse:d=>zc.parse(d)/100,transform:d=>zc.transform(d*100)},Dp={test:b0("hsl","hue"),parse:Tb("hue","saturation","lightness"),transform:({hue:d,saturation:g,lightness:T,alpha:S=1})=>"hsla("+Math.round(d)+", "+zc.transform(Jm(g))+", "+zc.transform(Jm(T))+", "+Jm(ag.transform(S))+")"},Mr={test:d=>af.test(d)||L_.test(d)||Dp.test(d),parse:d=>af.test(d)?af.parse(d):Dp.test(d)?Dp.parse(d):L_.parse(d),transform:d=>typeof d=="string"?d:d.hasOwnProperty("red")?af.transform(d):Dp.transform(d),getAnimatableNone:d=>{const g=Mr.parse(d);return g.alpha=0,Mr.transform(g)}},vT=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function bT(d){return isNaN(d)&&typeof d=="string"&&(d.match(v0)?.length||0)+(d.match(vT)?.length||0)>0}const Sb="number",Mb="color",wT="var",TT="var(",bx="${}",ST=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function sg(d){const g=d.toString(),T=[],S={color:[],number:[],var:[]},I=[];let B=0;const c=g.replace(ST,V=>(Mr.test(V)?(S.color.push(B),I.push(Mb),T.push(Mr.parse(V))):V.startsWith(TT)?(S.var.push(B),I.push(wT),T.push(V)):(S.number.push(B),I.push(Sb),T.push(parseFloat(V))),++B,bx)).split(bx);return{values:T,split:c,indexes:S,types:I}}function Eb(d){return sg(d).values}function Ab(d){const{split:g,types:T}=sg(d),S=g.length;return I=>{let B="";for(let M=0;M<S;M++)if(B+=g[M],I[M]!==void 0){const c=T[M];c===Sb?B+=Jm(I[M]):c===Mb?B+=Mr.transform(I[M]):B+=I[M]}return B}}const MT=d=>typeof d=="number"?0:Mr.test(d)?Mr.getAnimatableNone(d):d;function ET(d){const g=Eb(d);return Ab(d)(g.map(MT))}const Vh={test:bT,parse:Eb,createTransformer:Ab,getAnimatableNone:ET};function __(d,g,T){return T<0&&(T+=1),T>1&&(T-=1),T<1/6?d+(g-d)*6*T:T<1/2?g:T<2/3?d+(g-d)*(2/3-T)*6:d}function AT({hue:d,saturation:g,lightness:T,alpha:S}){d/=360,g/=100,T/=100;let I=0,B=0,M=0;if(!g)I=B=M=T;else{const c=T<.5?T*(1+g):T+g-T*g,V=2*T-c;I=__(V,c,d+1/3),B=__(V,c,d),M=__(V,c,d-1/3)}return{red:Math.round(I*255),green:Math.round(B*255),blue:Math.round(M*255),alpha:S}}function zy(d,g){return T=>T>0?g:d}const Wn=(d,g,T)=>d+(g-d)*T,x_=(d,g,T)=>{const S=d*d,I=T*(g*g-S)+S;return I<0?0:Math.sqrt(I)},CT=[L_,af,Dp],DT=d=>CT.find(g=>g.test(d));function wx(d){const g=DT(d);if(!g)return!1;let T=g.parse(d);return g===Dp&&(T=AT(T)),T}const Tx=(d,g)=>{const T=wx(d),S=wx(g);if(!T||!S)return zy(d,g);const I={...T};return B=>(I.red=x_(T.red,S.red,B),I.green=x_(T.green,S.green,B),I.blue=x_(T.blue,S.blue,B),I.alpha=Wn(T.alpha,S.alpha,B),af.transform(I))},j_=new Set(["none","hidden"]);function zT(d,g){return j_.has(d)?T=>T<=0?d:g:T=>T>=1?g:d}function PT(d,g){return T=>Wn(d,g,T)}function w0(d){return typeof d=="number"?PT:typeof d=="string"?x0(d)?zy:Mr.test(d)?Tx:kT:Array.isArray(d)?Cb:typeof d=="object"?Mr.test(d)?Tx:IT:zy}function Cb(d,g){const T=[...d],S=T.length,I=d.map((B,M)=>w0(B)(B,g[M]));return B=>{for(let M=0;M<S;M++)T[M]=I[M](B);return T}}function IT(d,g){const T={...d,...g},S={};for(const I in T)d[I]!==void 0&&g[I]!==void 0&&(S[I]=w0(d[I])(d[I],g[I]));return I=>{for(const B in S)T[B]=S[B](I);return T}}function RT(d,g){const T=[],S={color:0,var:0,number:0};for(let I=0;I<g.values.length;I++){const B=g.types[I],M=d.indexes[B][S[B]],c=d.values[M]??0;T[I]=c,S[B]++}return T}const kT=(d,g)=>{const T=Vh.createTransformer(g),S=sg(d),I=sg(g);return S.indexes.var.length===I.indexes.var.length&&S.indexes.color.length===I.indexes.color.length&&S.indexes.number.length>=I.indexes.number.length?j_.has(d)&&!I.values.length||j_.has(g)&&!S.values.length?zT(d,g):dg(Cb(RT(S,I),I.values),T):zy(d,g)};function Db(d,g,T){return typeof d=="number"&&typeof g=="number"&&typeof T=="number"?Wn(d,g,T):w0(d)(d,g)}const LT=d=>{const g=({timestamp:T})=>d(T);return{start:(T=!0)=>jn.update(g,T),stop:()=>Nh(g),now:()=>_a.isProcessing?_a.timestamp:os.now()}},zb=(d,g,T=10)=>{let S="";const I=Math.max(Math.round(g/T),2);for(let B=0;B<I;B++)S+=Math.round(d(B/(I-1))*1e4)/1e4+", ";return`linear(${S.substring(0,S.length-2)})`},Py=2e4;function T0(d){let g=0;const T=50;let S=d.next(g);for(;!S.done&&g<Py;)g+=T,S=d.next(g);return g>=Py?1/0:g}function jT(d,g=100,T){const S=T({...d,keyframes:[0,g]}),I=Math.min(T0(S),Py);return{type:"keyframes",ease:B=>S.next(I*B).value/g,duration:qo(I)}}const BT=5;function Pb(d,g,T){const S=Math.max(g-BT,0);return cb(T-d(S),g-S)}const hr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},v_=.001;function OT({duration:d=hr.duration,bounce:g=hr.bounce,velocity:T=hr.velocity,mass:S=hr.mass}){let I,B,M=1-g;M=Rc(hr.minDamping,hr.maxDamping,M),d=Rc(hr.minDuration,hr.maxDuration,qo(d)),M<1?(I=X=>{const K=X*M,te=K*d,de=K-T,De=B_(X,M),Ze=Math.exp(-te);return v_-de/De*Ze},B=X=>{const te=X*M*d,de=te*T+T,De=Math.pow(M,2)*Math.pow(X,2)*d,Ze=Math.exp(-te),xe=B_(Math.pow(X,2),M);return(-I(X)+v_>0?-1:1)*((de-De)*Ze)/xe}):(I=X=>{const K=Math.exp(-X*d),te=(X-T)*d+1;return-v_+K*te},B=X=>{const K=Math.exp(-X*d),te=(T-X)*(d*d);return K*te});const c=5/d,V=NT(I,B,c);if(d=ku(d),isNaN(V))return{stiffness:hr.stiffness,damping:hr.damping,duration:d};{const X=Math.pow(V,2)*S;return{stiffness:X,damping:M*2*Math.sqrt(S*X),duration:d}}}const FT=12;function NT(d,g,T){let S=T;for(let I=1;I<FT;I++)S=S-d(S)/g(S);return S}function B_(d,g){return d*Math.sqrt(1-g*g)}const VT=["duration","bounce"],UT=["stiffness","damping","mass"];function Sx(d,g){return g.some(T=>d[T]!==void 0)}function GT(d){let g={velocity:hr.velocity,stiffness:hr.stiffness,damping:hr.damping,mass:hr.mass,isResolvedFromDuration:!1,...d};if(!Sx(d,UT)&&Sx(d,VT))if(d.visualDuration){const T=d.visualDuration,S=2*Math.PI/(T*1.2),I=S*S,B=2*Rc(.05,1,1-(d.bounce||0))*Math.sqrt(I);g={...g,mass:hr.mass,stiffness:I,damping:B}}else{const T=OT(d);g={...g,...T,mass:hr.mass},g.isResolvedFromDuration=!0}return g}function Iy(d=hr.visualDuration,g=hr.bounce){const T=typeof d!="object"?{visualDuration:d,keyframes:[0,1],bounce:g}:d;let{restSpeed:S,restDelta:I}=T;const B=T.keyframes[0],M=T.keyframes[T.keyframes.length-1],c={done:!1,value:B},{stiffness:V,damping:X,mass:K,duration:te,velocity:de,isResolvedFromDuration:De}=GT({...T,velocity:-qo(T.velocity||0)}),Ze=de||0,xe=X/(2*Math.sqrt(V*K)),le=M-B,Xe=qo(Math.sqrt(V/K)),Ve=Math.abs(le)<5;S||(S=Ve?hr.restSpeed.granular:hr.restSpeed.default),I||(I=Ve?hr.restDelta.granular:hr.restDelta.default);let Ue;if(xe<1){const pt=B_(Xe,xe);Ue=Dt=>{const _t=Math.exp(-xe*Xe*Dt);return M-_t*((Ze+xe*Xe*le)/pt*Math.sin(pt*Dt)+le*Math.cos(pt*Dt))}}else if(xe===1)Ue=pt=>M-Math.exp(-Xe*pt)*(le+(Ze+Xe*le)*pt);else{const pt=Xe*Math.sqrt(xe*xe-1);Ue=Dt=>{const _t=Math.exp(-xe*Xe*Dt),Mt=Math.min(pt*Dt,300);return M-_t*((Ze+xe*Xe*le)*Math.sinh(Mt)+pt*le*Math.cosh(Mt))/pt}}const gt={calculatedDuration:De&&te||null,next:pt=>{const Dt=Ue(pt);if(De)c.done=pt>=te;else{let _t=pt===0?Ze:0;xe<1&&(_t=pt===0?ku(Ze):Pb(Ue,pt,Dt));const Mt=Math.abs(_t)<=S,Ot=Math.abs(M-Dt)<=I;c.done=Mt&&Ot}return c.value=c.done?M:Dt,c},toString:()=>{const pt=Math.min(T0(gt),Py),Dt=zb(_t=>gt.next(pt*_t).value,pt,30);return pt+"ms "+Dt},toTransition:()=>{}};return gt}Iy.applyToOptions=d=>{const g=jT(d,100,Iy);return d.ease=g.ease,d.duration=ku(g.duration),d.type="keyframes",d};function O_({keyframes:d,velocity:g=0,power:T=.8,timeConstant:S=325,bounceDamping:I=10,bounceStiffness:B=500,modifyTarget:M,min:c,max:V,restDelta:X=.5,restSpeed:K}){const te=d[0],de={done:!1,value:te},De=Mt=>c!==void 0&&Mt<c||V!==void 0&&Mt>V,Ze=Mt=>c===void 0?V:V===void 0||Math.abs(c-Mt)<Math.abs(V-Mt)?c:V;let xe=T*g;const le=te+xe,Xe=M===void 0?le:M(le);Xe!==le&&(xe=Xe-te);const Ve=Mt=>-xe*Math.exp(-Mt/S),Ue=Mt=>Xe+Ve(Mt),gt=Mt=>{const Ot=Ve(Mt),si=Ue(Mt);de.done=Math.abs(Ot)<=X,de.value=de.done?Xe:si};let pt,Dt;const _t=Mt=>{De(de.value)&&(pt=Mt,Dt=Iy({keyframes:[de.value,Ze(de.value)],velocity:Pb(Ue,Mt,de.value),damping:I,stiffness:B,restDelta:X,restSpeed:K}))};return _t(0),{calculatedDuration:null,next:Mt=>{let Ot=!1;return!Dt&&pt===void 0&&(Ot=!0,gt(Mt),_t(Mt)),pt!==void 0&&Mt>=pt?Dt.next(Mt-pt):(!Ot&&gt(Mt),de)}}}function qT(d,g,T){const S=[],I=T||ju.mix||Db,B=d.length-1;for(let M=0;M<B;M++){let c=I(d[M],d[M+1]);if(g){const V=Array.isArray(g)?g[M]||Zo:g;c=dg(V,c)}S.push(c)}return S}function ZT(d,g,{clamp:T=!0,ease:S,mixer:I}={}){const B=d.length;if(p0(B===g.length),B===1)return()=>g[0];if(B===2&&g[0]===g[1])return()=>g[1];const M=d[0]===d[1];d[0]>d[B-1]&&(d=[...d].reverse(),g=[...g].reverse());const c=qT(g,S,I),V=c.length,X=K=>{if(M&&K<d[0])return g[0];let te=0;if(V>1)for(;te<d.length-2&&!(K<d[te+1]);te++);const de=rg(d[te],d[te+1],K);return c[te](de)};return T?K=>X(Rc(d[0],d[B-1],K)):X}function HT(d,g){const T=d[d.length-1];for(let S=1;S<=g;S++){const I=rg(0,g,S);d.push(Wn(T,1,I))}}function $T(d){const g=[0];return HT(g,d.length-1),g}function XT(d,g){return d.map(T=>T*g)}function YT(d,g){return d.map(()=>g||_b).splice(0,d.length-1)}function eg({duration:d=300,keyframes:g,times:T,ease:S="easeInOut"}){const I=sT(S)?S.map(_x):_x(S),B={done:!1,value:g[0]},M=XT(T&&T.length===g.length?T:$T(g),d),c=ZT(M,g,{ease:Array.isArray(I)?I:YT(g,I)});return{calculatedDuration:d,next:V=>(B.value=c(V),B.done=V>=d,B)}}const WT=d=>d!==null;function S0(d,{repeat:g,repeatType:T="loop"},S,I=1){const B=d.filter(WT),c=I<0||g&&T!=="loop"&&g%2===1?0:B.length-1;return!c||S===void 0?B[c]:S}const KT={decay:O_,inertia:O_,tween:eg,keyframes:eg,spring:Iy};function Ib(d){typeof d.type=="string"&&(d.type=KT[d.type])}class M0{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(g=>{this.resolve=g})}notifyFinished(){this.resolve()}then(g,T){return this.finished.then(g,T)}}const QT=d=>d/100;class E0 extends M0{constructor(g){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:T}=this.options;T&&T.updatedAt!==os.now()&&this.tick(os.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=g,this.initAnimation(),this.play(),g.autoplay===!1&&this.pause()}initAnimation(){const{options:g}=this;Ib(g);const{type:T=eg,repeat:S=0,repeatDelay:I=0,repeatType:B,velocity:M=0}=g;let{keyframes:c}=g;const V=T||eg;V!==eg&&typeof c[0]!="number"&&(this.mixKeyframes=dg(QT,Db(c[0],c[1])),c=[0,100]);const X=V({...g,keyframes:c});B==="mirror"&&(this.mirroredGenerator=V({...g,keyframes:[...c].reverse(),velocity:-M})),X.calculatedDuration===null&&(X.calculatedDuration=T0(X));const{calculatedDuration:K}=X;this.calculatedDuration=K,this.resolvedDuration=K+I,this.totalDuration=this.resolvedDuration*(S+1)-I,this.generator=X}updateTime(g){const T=Math.round(g-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=T}tick(g,T=!1){const{generator:S,totalDuration:I,mixKeyframes:B,mirroredGenerator:M,resolvedDuration:c,calculatedDuration:V}=this;if(this.startTime===null)return S.next(0);const{delay:X=0,keyframes:K,repeat:te,repeatType:de,repeatDelay:De,type:Ze,onUpdate:xe,finalKeyframe:le}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,g):this.speed<0&&(this.startTime=Math.min(g-I/this.speed,this.startTime)),T?this.currentTime=g:this.updateTime(g);const Xe=this.currentTime-X*(this.playbackSpeed>=0?1:-1),Ve=this.playbackSpeed>=0?Xe<0:Xe>I;this.currentTime=Math.max(Xe,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=I);let Ue=this.currentTime,gt=S;if(te){const Mt=Math.min(this.currentTime,I)/c;let Ot=Math.floor(Mt),si=Mt%1;!si&&Mt>=1&&(si=1),si===1&&Ot--,Ot=Math.min(Ot,te+1),Ot%2&&(de==="reverse"?(si=1-si,De&&(si-=De/c)):de==="mirror"&&(gt=M)),Ue=Rc(0,1,si)*c}const pt=Ve?{done:!1,value:K[0]}:gt.next(Ue);B&&(pt.value=B(pt.value));let{done:Dt}=pt;!Ve&&V!==null&&(Dt=this.playbackSpeed>=0?this.currentTime>=I:this.currentTime<=0);const _t=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&Dt);return _t&&Ze!==O_&&(pt.value=S0(K,this.options,le,this.speed)),xe&&xe(pt.value),_t&&this.finish(),pt}then(g,T){return this.finished.then(g,T)}get duration(){return qo(this.calculatedDuration)}get iterationDuration(){const{delay:g=0}=this.options||{};return this.duration+qo(g)}get time(){return qo(this.currentTime)}set time(g){g=ku(g),this.currentTime=g,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=g:this.driver&&(this.startTime=this.driver.now()-g/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(g){this.updateTime(os.now());const T=this.playbackSpeed!==g;this.playbackSpeed=g,T&&(this.time=qo(this.currentTime))}play(){if(this.isStopped)return;const{driver:g=LT,startTime:T}=this.options;this.driver||(this.driver=g(I=>this.tick(I))),this.options.onPlay?.();const S=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=S):this.holdTime!==null?this.startTime=S-this.holdTime:this.startTime||(this.startTime=T??S),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(os.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(g){return this.startTime=0,this.tick(g,!0)}attachTimeline(g){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),g.observe(this)}}function JT(d){for(let g=1;g<d.length;g++)d[g]??(d[g]=d[g-1])}const sf=d=>d*180/Math.PI,F_=d=>{const g=sf(Math.atan2(d[1],d[0]));return N_(g)},eS={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:d=>(Math.abs(d[0])+Math.abs(d[3]))/2,rotate:F_,rotateZ:F_,skewX:d=>sf(Math.atan(d[1])),skewY:d=>sf(Math.atan(d[2])),skew:d=>(Math.abs(d[1])+Math.abs(d[2]))/2},N_=d=>(d=d%360,d<0&&(d+=360),d),Mx=F_,Ex=d=>Math.sqrt(d[0]*d[0]+d[1]*d[1]),Ax=d=>Math.sqrt(d[4]*d[4]+d[5]*d[5]),tS={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Ex,scaleY:Ax,scale:d=>(Ex(d)+Ax(d))/2,rotateX:d=>N_(sf(Math.atan2(d[6],d[5]))),rotateY:d=>N_(sf(Math.atan2(-d[2],d[0]))),rotateZ:Mx,rotate:Mx,skewX:d=>sf(Math.atan(d[4])),skewY:d=>sf(Math.atan(d[1])),skew:d=>(Math.abs(d[1])+Math.abs(d[4]))/2};function V_(d){return d.includes("scale")?1:0}function U_(d,g){if(!d||d==="none")return V_(g);const T=d.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let S,I;if(T)S=tS,I=T;else{const c=d.match(/^matrix\(([-\d.e\s,]+)\)$/u);S=eS,I=c}if(!I)return V_(g);const B=S[g],M=I[1].split(",").map(nS);return typeof B=="function"?B(M):M[B]}const iS=(d,g)=>{const{transform:T="none"}=getComputedStyle(d);return U_(T,g)};function nS(d){return parseFloat(d.trim())}const Op=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Fp=new Set(Op),Cx=d=>d===Bp||d===Bt,rS=new Set(["x","y","z"]),aS=Op.filter(d=>!rS.has(d));function sS(d){const g=[];return aS.forEach(T=>{const S=d.getValue(T);S!==void 0&&(g.push([T,S.get()]),S.set(T.startsWith("scale")?1:0))}),g}const Fh={width:({x:d},{paddingLeft:g="0",paddingRight:T="0"})=>d.max-d.min-parseFloat(g)-parseFloat(T),height:({y:d},{paddingTop:g="0",paddingBottom:T="0"})=>d.max-d.min-parseFloat(g)-parseFloat(T),top:(d,{top:g})=>parseFloat(g),left:(d,{left:g})=>parseFloat(g),bottom:({y:d},{top:g})=>parseFloat(g)+(d.max-d.min),right:({x:d},{left:g})=>parseFloat(g)+(d.max-d.min),x:(d,{transform:g})=>U_(g,"x"),y:(d,{transform:g})=>U_(g,"y")};Fh.translateX=Fh.x;Fh.translateY=Fh.y;const of=new Set;let G_=!1,q_=!1,Z_=!1;function Rb(){if(q_){const d=Array.from(of).filter(S=>S.needsMeasurement),g=new Set(d.map(S=>S.element)),T=new Map;g.forEach(S=>{const I=sS(S);I.length&&(T.set(S,I),S.render())}),d.forEach(S=>S.measureInitialState()),g.forEach(S=>{S.render();const I=T.get(S);I&&I.forEach(([B,M])=>{S.getValue(B)?.set(M)})}),d.forEach(S=>S.measureEndState()),d.forEach(S=>{S.suspendedScrollY!==void 0&&window.scrollTo(0,S.suspendedScrollY)})}q_=!1,G_=!1,of.forEach(d=>d.complete(Z_)),of.clear()}function kb(){of.forEach(d=>{d.readKeyframes(),d.needsMeasurement&&(q_=!0)})}function oS(){Z_=!0,kb(),Rb(),Z_=!1}class A0{constructor(g,T,S,I,B,M=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...g],this.onComplete=T,this.name=S,this.motionValue=I,this.element=B,this.isAsync=M}scheduleResolve(){this.state="scheduled",this.isAsync?(of.add(this),G_||(G_=!0,jn.read(kb),jn.resolveKeyframes(Rb))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:g,name:T,element:S,motionValue:I}=this;if(g[0]===null){const B=I?.get(),M=g[g.length-1];if(B!==void 0)g[0]=B;else if(S&&T){const c=S.readValue(T,M);c!=null&&(g[0]=c)}g[0]===void 0&&(g[0]=M),I&&B===void 0&&I.set(g[0])}JT(g)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(g=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,g),of.delete(this)}cancel(){this.state==="scheduled"&&(of.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const lS=d=>d.startsWith("--");function cS(d,g,T){lS(g)?d.style.setProperty(g,T):d.style[g]=T}const uS=m0(()=>window.ScrollTimeline!==void 0),hS={};function dS(d,g){const T=m0(d);return()=>hS[g]??T()}const Lb=dS(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Km=([d,g,T,S])=>`cubic-bezier(${d}, ${g}, ${T}, ${S})`,Dx={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Km([0,.65,.55,1]),circOut:Km([.55,0,1,.45]),backIn:Km([.31,.01,.66,-.59]),backOut:Km([.33,1.53,.69,.99])};function jb(d,g){if(d)return typeof d=="function"?Lb()?zb(d,g):"ease-out":xb(d)?Km(d):Array.isArray(d)?d.map(T=>jb(T,g)||Dx.easeOut):Dx[d]}function fS(d,g,T,{delay:S=0,duration:I=300,repeat:B=0,repeatType:M="loop",ease:c="easeOut",times:V}={},X=void 0){const K={[g]:T};V&&(K.offset=V);const te=jb(c,I);Array.isArray(te)&&(K.easing=te);const de={delay:S,duration:I,easing:Array.isArray(te)?"linear":te,fill:"both",iterations:B+1,direction:M==="reverse"?"alternate":"normal"};return X&&(de.pseudoElement=X),d.animate(K,de)}function Bb(d){return typeof d=="function"&&"applyToOptions"in d}function pS({type:d,...g}){return Bb(d)&&Lb()?d.applyToOptions(g):(g.duration??(g.duration=300),g.ease??(g.ease="easeOut"),g)}class mS extends M0{constructor(g){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!g)return;const{element:T,name:S,keyframes:I,pseudoElement:B,allowFlatten:M=!1,finalKeyframe:c,onComplete:V}=g;this.isPseudoElement=!!B,this.allowFlatten=M,this.options=g,p0(typeof g.type!="string");const X=pS(g);this.animation=fS(T,S,I,X,B),X.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!B){const K=S0(I,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(K):cS(T,S,K),this.animation.cancel()}V?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:g}=this;g==="idle"||g==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const g=this.animation.effect?.getComputedTiming?.().duration||0;return qo(Number(g))}get iterationDuration(){const{delay:g=0}=this.options||{};return this.duration+qo(g)}get time(){return qo(Number(this.animation.currentTime)||0)}set time(g){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=ku(g)}get speed(){return this.animation.playbackRate}set speed(g){g<0&&(this.finishedTime=null),this.animation.playbackRate=g}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(g){this.manualStartTime=this.animation.startTime=g}attachTimeline({timeline:g,observe:T}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,g&&uS()?(this.animation.timeline=g,Zo):T(this)}}const Ob={anticipate:mb,backInOut:pb,circInOut:yb};function gS(d){return d in Ob}function yS(d){typeof d.ease=="string"&&gS(d.ease)&&(d.ease=Ob[d.ease])}const b_=10;class _S extends mS{constructor(g){yS(g),Ib(g),super(g),g.startTime!==void 0&&(this.startTime=g.startTime),this.options=g}updateMotionValue(g){const{motionValue:T,onUpdate:S,onComplete:I,element:B,...M}=this.options;if(!T)return;if(g!==void 0){T.set(g);return}const c=new E0({...M,autoplay:!1}),V=Math.max(b_,os.now()-this.startTime),X=Rc(0,b_,V-b_);T.setWithVelocity(c.sample(Math.max(0,V-X)).value,c.sample(V).value,X),c.stop()}}const zx=(d,g)=>g==="zIndex"?!1:!!(typeof d=="number"||Array.isArray(d)||typeof d=="string"&&(Vh.test(d)||d==="0")&&!d.startsWith("url("));function xS(d){const g=d[0];if(d.length===1)return!0;for(let T=0;T<d.length;T++)if(d[T]!==g)return!0}function vS(d,g,T,S){const I=d[0];if(I===null)return!1;if(g==="display"||g==="visibility")return!0;const B=d[d.length-1],M=zx(I,g),c=zx(B,g);return!M||!c?!1:xS(d)||(T==="spring"||Bb(T))&&S}function H_(d){d.duration=0,d.type="keyframes"}const bS=new Set(["opacity","clipPath","filter","transform"]),wS=m0(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function TS(d){const{motionValue:g,name:T,repeatDelay:S,repeatType:I,damping:B,type:M}=d;if(!(g?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:V,transformTemplate:X}=g.owner.getProps();return wS()&&T&&bS.has(T)&&(T!=="transform"||!X)&&!V&&!S&&I!=="mirror"&&B!==0&&M!=="inertia"}const SS=40;class MS extends M0{constructor({autoplay:g=!0,delay:T=0,type:S="keyframes",repeat:I=0,repeatDelay:B=0,repeatType:M="loop",keyframes:c,name:V,motionValue:X,element:K,...te}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=os.now();const de={autoplay:g,delay:T,type:S,repeat:I,repeatDelay:B,repeatType:M,name:V,motionValue:X,element:K,...te},De=K?.KeyframeResolver||A0;this.keyframeResolver=new De(c,(Ze,xe,le)=>this.onKeyframesResolved(Ze,xe,de,!le),V,X,K),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(g,T,S,I){this.keyframeResolver=void 0;const{name:B,type:M,velocity:c,delay:V,isHandoff:X,onUpdate:K}=S;this.resolvedAt=os.now(),vS(g,B,M,c)||((ju.instantAnimations||!V)&&K?.(S0(g,S,T)),g[0]=g[g.length-1],H_(S),S.repeat=0);const de={startTime:I?this.resolvedAt?this.resolvedAt-this.createdAt>SS?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:T,...S,keyframes:g},De=!X&&TS(de),Ze=de.motionValue?.owner?.current,xe=De?new _S({...de,element:Ze}):new E0(de);xe.finished.then(()=>{this.notifyFinished()}).catch(Zo),this.pendingTimeline&&(this.stopTimeline=xe.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=xe}get finished(){return this._animation?this.animation.finished:this._finished}then(g,T){return this.finished.finally(g).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),oS()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(g){this.animation.time=g}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(g){this.animation.speed=g}get startTime(){return this.animation.startTime}attachTimeline(g){return this._animation?this.stopTimeline=this.animation.attachTimeline(g):this.pendingTimeline=g,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}function Fb(d,g,T,S=0,I=1){const B=Array.from(d).sort((X,K)=>X.sortNodePosition(K)).indexOf(g),M=d.size,c=(M-1)*S;return typeof T=="function"?T(B,M):I===1?B*S:c-B*S}const ES=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function AS(d){const g=ES.exec(d);if(!g)return[,];const[,T,S,I]=g;return[`--${T??S}`,I]}function Nb(d,g,T=1){const[S,I]=AS(d);if(!S)return;const B=window.getComputedStyle(g).getPropertyValue(S);if(B){const M=B.trim();return sb(M)?parseFloat(M):M}return x0(I)?Nb(I,g,T+1):I}const CS={type:"spring",stiffness:500,damping:25,restSpeed:10},DS=d=>({type:"spring",stiffness:550,damping:d===0?2*Math.sqrt(550):30,restSpeed:10}),zS={type:"keyframes",duration:.8},PS={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},IS=(d,{keyframes:g})=>g.length>2?zS:Fp.has(d)?d.startsWith("scale")?DS(g[1]):CS:PS,RS=d=>d!==null;function kS(d,{repeat:g,repeatType:T="loop"},S){const I=d.filter(RS),B=g&&T!=="loop"&&g%2===1?0:I.length-1;return I[B]}function C0(d,g){return d?.[g]??d?.default??d}function LS({when:d,delay:g,delayChildren:T,staggerChildren:S,staggerDirection:I,repeat:B,repeatType:M,repeatDelay:c,from:V,elapsed:X,...K}){return!!Object.keys(K).length}const D0=(d,g,T,S={},I,B)=>M=>{const c=C0(S,d)||{},V=c.delay||S.delay||0;let{elapsed:X=0}=S;X=X-ku(V);const K={keyframes:Array.isArray(T)?T:[null,T],ease:"easeOut",velocity:g.getVelocity(),...c,delay:-X,onUpdate:de=>{g.set(de),c.onUpdate&&c.onUpdate(de)},onComplete:()=>{M(),c.onComplete&&c.onComplete()},name:d,motionValue:g,element:B?void 0:I};LS(c)||Object.assign(K,IS(d,K)),K.duration&&(K.duration=ku(K.duration)),K.repeatDelay&&(K.repeatDelay=ku(K.repeatDelay)),K.from!==void 0&&(K.keyframes[0]=K.from);let te=!1;if((K.type===!1||K.duration===0&&!K.repeatDelay)&&(H_(K),K.delay===0&&(te=!0)),(ju.instantAnimations||ju.skipAnimations)&&(te=!0,H_(K),K.delay=0),K.allowFlatten=!c.type&&!c.ease,te&&!B&&g.get()!==void 0){const de=kS(K.keyframes,c);if(de!==void 0){jn.update(()=>{K.onUpdate(de),K.onComplete()});return}}return c.isSync?new E0(K):new MS(K)};function Px(d){const g=[{},{}];return d?.values.forEach((T,S)=>{g[0][S]=T.get(),g[1][S]=T.getVelocity()}),g}function z0(d,g,T,S){if(typeof g=="function"){const[I,B]=Px(S);g=g(T!==void 0?T:d.custom,I,B)}if(typeof g=="string"&&(g=d.variants&&d.variants[g]),typeof g=="function"){const[I,B]=Px(S);g=g(T!==void 0?T:d.custom,I,B)}return g}function Rp(d,g,T){const S=d.getProps();return z0(S,g,T!==void 0?T:S.custom,d)}const Vb=new Set(["width","height","top","left","right","bottom",...Op]),Ix=30,jS=d=>!isNaN(parseFloat(d));class BS{constructor(g,T={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=S=>{const I=os.now();if(this.updatedAt!==I&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(S),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const B of this.dependents)B.dirty()},this.hasAnimated=!1,this.setCurrent(g),this.owner=T.owner}setCurrent(g){this.current=g,this.updatedAt=os.now(),this.canTrackVelocity===null&&g!==void 0&&(this.canTrackVelocity=jS(this.current))}setPrevFrameValue(g=this.current){this.prevFrameValue=g,this.prevUpdatedAt=this.updatedAt}onChange(g){return this.on("change",g)}on(g,T){this.events[g]||(this.events[g]=new g0);const S=this.events[g].add(T);return g==="change"?()=>{S(),jn.read(()=>{this.events.change.getSize()||this.stop()})}:S}clearListeners(){for(const g in this.events)this.events[g].clear()}attach(g,T){this.passiveEffect=g,this.stopPassiveEffect=T}set(g){this.passiveEffect?this.passiveEffect(g,this.updateAndNotify):this.updateAndNotify(g)}setWithVelocity(g,T,S){this.set(T),this.prev=void 0,this.prevFrameValue=g,this.prevUpdatedAt=this.updatedAt-S}jump(g,T=!0){this.updateAndNotify(g),this.prev=g,this.prevUpdatedAt=this.prevFrameValue=void 0,T&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(g){this.dependents||(this.dependents=new Set),this.dependents.add(g)}removeDependent(g){this.dependents&&this.dependents.delete(g)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const g=os.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||g-this.updatedAt>Ix)return 0;const T=Math.min(this.updatedAt-this.prevUpdatedAt,Ix);return cb(parseFloat(this.current)-parseFloat(this.prevFrameValue),T)}start(g){return this.stop(),new Promise(T=>{this.hasAnimated=!0,this.animation=g(T),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function kp(d,g){return new BS(d,g)}const $_=d=>Array.isArray(d);function OS(d,g,T){d.hasValue(g)?d.getValue(g).set(T):d.addValue(g,kp(T))}function FS(d){return $_(d)?d[d.length-1]||0:d}function NS(d,g){const T=Rp(d,g);let{transitionEnd:S={},transition:I={},...B}=T||{};B={...B,...S};for(const M in B){const c=FS(B[M]);OS(d,M,c)}}const Ua=d=>!!(d&&d.getVelocity);function VS(d){return!!(Ua(d)&&d.add)}function X_(d,g){const T=d.getValue("willChange");if(VS(T))return T.add(g);if(!T&&ju.WillChange){const S=new ju.WillChange("auto");d.addValue("willChange",S),S.add(g)}}function P0(d){return d.replace(/([A-Z])/g,g=>`-${g.toLowerCase()}`)}const US="framerAppearId",Ub="data-"+P0(US);function Gb(d){return d.props[Ub]}function GS({protectedKeys:d,needsAnimating:g},T){const S=d.hasOwnProperty(T)&&g[T]!==!0;return g[T]=!1,S}function qb(d,g,{delay:T=0,transitionOverride:S,type:I}={}){let{transition:B=d.getDefaultTransition(),transitionEnd:M,...c}=g;const V=B?.reduceMotion;S&&(B=S);const X=[],K=I&&d.animationState&&d.animationState.getState()[I];for(const te in c){const de=d.getValue(te,d.latestValues[te]??null),De=c[te];if(De===void 0||K&&GS(K,te))continue;const Ze={delay:T,...C0(B||{},te)},xe=de.get();if(xe!==void 0&&!de.isAnimating&&!Array.isArray(De)&&De===xe&&!Ze.velocity)continue;let le=!1;if(window.MotionHandoffAnimation){const Ue=Gb(d);if(Ue){const gt=window.MotionHandoffAnimation(Ue,te,jn);gt!==null&&(Ze.startTime=gt,le=!0)}}X_(d,te);const Xe=V??d.shouldReduceMotion;de.start(D0(te,de,De,Xe&&Vb.has(te)?{type:!1}:Ze,d,le));const Ve=de.animation;Ve&&X.push(Ve)}return M&&Promise.all(X).then(()=>{jn.update(()=>{M&&NS(d,M)})}),X}function Y_(d,g,T={}){const S=Rp(d,g,T.type==="exit"?d.presenceContext?.custom:void 0);let{transition:I=d.getDefaultTransition()||{}}=S||{};T.transitionOverride&&(I=T.transitionOverride);const B=S?()=>Promise.all(qb(d,S,T)):()=>Promise.resolve(),M=d.variantChildren&&d.variantChildren.size?(V=0)=>{const{delayChildren:X=0,staggerChildren:K,staggerDirection:te}=I;return qS(d,g,V,X,K,te,T)}:()=>Promise.resolve(),{when:c}=I;if(c){const[V,X]=c==="beforeChildren"?[B,M]:[M,B];return V().then(()=>X())}else return Promise.all([B(),M(T.delay)])}function qS(d,g,T=0,S=0,I=0,B=1,M){const c=[];for(const V of d.variantChildren)V.notify("AnimationStart",g),c.push(Y_(V,g,{...M,delay:T+(typeof S=="function"?0:S)+Fb(d.variantChildren,V,S,I,B)}).then(()=>V.notify("AnimationComplete",g)));return Promise.all(c)}function ZS(d,g,T={}){d.notify("AnimationStart",g);let S;if(Array.isArray(g)){const I=g.map(B=>Y_(d,B,T));S=Promise.all(I)}else if(typeof g=="string")S=Y_(d,g,T);else{const I=typeof g=="function"?Rp(d,g,T.custom):g;S=Promise.all(qb(d,I,T))}return S.then(()=>{d.notify("AnimationComplete",g)})}const HS={test:d=>d==="auto",parse:d=>d},Zb=d=>g=>g.test(d),Hb=[Bp,Bt,zc,Oh,xT,_T,HS],Rx=d=>Hb.find(Zb(d));function $S(d){return typeof d=="number"?d===0:d!==null?d==="none"||d==="0"||lb(d):!0}const XS=new Set(["brightness","contrast","saturate","opacity"]);function YS(d){const[g,T]=d.slice(0,-1).split("(");if(g==="drop-shadow")return d;const[S]=T.match(v0)||[];if(!S)return d;const I=T.replace(S,"");let B=XS.has(g)?1:0;return S!==T&&(B*=100),g+"("+B+I+")"}const WS=/\b([a-z-]*)\(.*?\)/gu,W_={...Vh,getAnimatableNone:d=>{const g=d.match(WS);return g?g.map(YS).join(" "):d}},kx={...Bp,transform:Math.round},KS={rotate:Oh,rotateX:Oh,rotateY:Oh,rotateZ:Oh,scale:_y,scaleX:_y,scaleY:_y,scaleZ:_y,skew:Oh,skewX:Oh,skewY:Oh,distance:Bt,translateX:Bt,translateY:Bt,translateZ:Bt,x:Bt,y:Bt,z:Bt,perspective:Bt,transformPerspective:Bt,opacity:ag,originX:vx,originY:vx,originZ:Bt},I0={borderWidth:Bt,borderTopWidth:Bt,borderRightWidth:Bt,borderBottomWidth:Bt,borderLeftWidth:Bt,borderRadius:Bt,borderTopLeftRadius:Bt,borderTopRightRadius:Bt,borderBottomRightRadius:Bt,borderBottomLeftRadius:Bt,width:Bt,maxWidth:Bt,height:Bt,maxHeight:Bt,top:Bt,right:Bt,bottom:Bt,left:Bt,inset:Bt,insetBlock:Bt,insetBlockStart:Bt,insetBlockEnd:Bt,insetInline:Bt,insetInlineStart:Bt,insetInlineEnd:Bt,padding:Bt,paddingTop:Bt,paddingRight:Bt,paddingBottom:Bt,paddingLeft:Bt,paddingBlock:Bt,paddingBlockStart:Bt,paddingBlockEnd:Bt,paddingInline:Bt,paddingInlineStart:Bt,paddingInlineEnd:Bt,margin:Bt,marginTop:Bt,marginRight:Bt,marginBottom:Bt,marginLeft:Bt,marginBlock:Bt,marginBlockStart:Bt,marginBlockEnd:Bt,marginInline:Bt,marginInlineStart:Bt,marginInlineEnd:Bt,fontSize:Bt,backgroundPositionX:Bt,backgroundPositionY:Bt,...KS,zIndex:kx,fillOpacity:ag,strokeOpacity:ag,numOctaves:kx},QS={...I0,color:Mr,backgroundColor:Mr,outlineColor:Mr,fill:Mr,stroke:Mr,borderColor:Mr,borderTopColor:Mr,borderRightColor:Mr,borderBottomColor:Mr,borderLeftColor:Mr,filter:W_,WebkitFilter:W_},$b=d=>QS[d];function Xb(d,g){let T=$b(d);return T!==W_&&(T=Vh),T.getAnimatableNone?T.getAnimatableNone(g):void 0}const JS=new Set(["auto","none","0"]);function eM(d,g,T){let S=0,I;for(;S<d.length&&!I;){const B=d[S];typeof B=="string"&&!JS.has(B)&&sg(B).values.length&&(I=d[S]),S++}if(I&&T)for(const B of g)d[B]=Xb(T,I)}class tM extends A0{constructor(g,T,S,I,B){super(g,T,S,I,B,!0)}readKeyframes(){const{unresolvedKeyframes:g,element:T,name:S}=this;if(!T||!T.current)return;super.readKeyframes();for(let K=0;K<g.length;K++){let te=g[K];if(typeof te=="string"&&(te=te.trim(),x0(te))){const de=Nb(te,T.current);de!==void 0&&(g[K]=de),K===g.length-1&&(this.finalKeyframe=te)}}if(this.resolveNoneKeyframes(),!Vb.has(S)||g.length!==2)return;const[I,B]=g,M=Rx(I),c=Rx(B),V=xx(I),X=xx(B);if(V!==X&&Fh[S]){this.needsMeasurement=!0;return}if(M!==c)if(Cx(M)&&Cx(c))for(let K=0;K<g.length;K++){const te=g[K];typeof te=="string"&&(g[K]=parseFloat(te))}else Fh[S]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:g,name:T}=this,S=[];for(let I=0;I<g.length;I++)(g[I]===null||$S(g[I]))&&S.push(I);S.length&&eM(g,S,T)}measureInitialState(){const{element:g,unresolvedKeyframes:T,name:S}=this;if(!g||!g.current)return;S==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Fh[S](g.measureViewportBox(),window.getComputedStyle(g.current)),T[0]=this.measuredOrigin;const I=T[T.length-1];I!==void 0&&g.getValue(S,I).jump(I,!1)}measureEndState(){const{element:g,name:T,unresolvedKeyframes:S}=this;if(!g||!g.current)return;const I=g.getValue(T);I&&I.jump(this.measuredOrigin,!1);const B=S.length-1,M=S[B];S[B]=Fh[T](g.measureViewportBox(),window.getComputedStyle(g.current)),M!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=M),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,V])=>{g.getValue(c).set(V)}),this.resolveNoneKeyframes()}}function iM(d,g,T){if(d==null)return[];if(d instanceof EventTarget)return[d];if(typeof d=="string"){let S=document;const I=T?.[d]??S.querySelectorAll(d);return I?Array.from(I):[]}return Array.from(d).filter(S=>S!=null)}const Yb=(d,g)=>g&&typeof d=="number"?g.transform(d):d;function K_(d){return ob(d)&&"offsetHeight"in d}const{schedule:R0}=vb(queueMicrotask,!1),Ol={x:!1,y:!1};function Wb(){return Ol.x||Ol.y}function nM(d){return d==="x"||d==="y"?Ol[d]?null:(Ol[d]=!0,()=>{Ol[d]=!1}):Ol.x||Ol.y?null:(Ol.x=Ol.y=!0,()=>{Ol.x=Ol.y=!1})}function Kb(d,g){const T=iM(d),S=new AbortController,I={passive:!0,...g,signal:S.signal};return[T,I,()=>S.abort()]}function Lx(d){return!(d.pointerType==="touch"||Wb())}function rM(d,g,T={}){const[S,I,B]=Kb(d,T),M=c=>{if(!Lx(c))return;const{target:V}=c,X=g(V,c);if(typeof X!="function"||!V)return;const K=te=>{Lx(te)&&(X(te),V.removeEventListener("pointerleave",K))};V.addEventListener("pointerleave",K,I)};return S.forEach(c=>{c.addEventListener("pointerenter",M,I)}),B}const Qb=(d,g)=>g?d===g?!0:Qb(d,g.parentElement):!1,k0=d=>d.pointerType==="mouse"?typeof d.button!="number"||d.button<=0:d.isPrimary!==!1,aM=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Jb(d){return aM.has(d.tagName)||d.isContentEditable===!0}const Sy=new WeakSet;function jx(d){return g=>{g.key==="Enter"&&d(g)}}function w_(d,g){d.dispatchEvent(new PointerEvent("pointer"+g,{isPrimary:!0,bubbles:!0}))}const sM=(d,g)=>{const T=d.currentTarget;if(!T)return;const S=jx(()=>{if(Sy.has(T))return;w_(T,"down");const I=jx(()=>{w_(T,"up")}),B=()=>w_(T,"cancel");T.addEventListener("keyup",I,g),T.addEventListener("blur",B,g)});T.addEventListener("keydown",S,g),T.addEventListener("blur",()=>T.removeEventListener("keydown",S),g)};function Bx(d){return k0(d)&&!Wb()}function oM(d,g,T={}){const[S,I,B]=Kb(d,T),M=c=>{const V=c.currentTarget;if(!Bx(c))return;Sy.add(V);const X=g(V,c),K=(De,Ze)=>{window.removeEventListener("pointerup",te),window.removeEventListener("pointercancel",de),Sy.has(V)&&Sy.delete(V),Bx(De)&&typeof X=="function"&&X(De,{success:Ze})},te=De=>{K(De,V===window||V===document||T.useGlobalTarget||Qb(V,De.target))},de=De=>{K(De,!1)};window.addEventListener("pointerup",te,I),window.addEventListener("pointercancel",de,I)};return S.forEach(c=>{(T.useGlobalTarget?window:c).addEventListener("pointerdown",M,I),K_(c)&&(c.addEventListener("focus",X=>sM(X,I)),!Jb(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),B}function e1(d){return ob(d)&&"ownerSVGElement"in d}function lM(d){return e1(d)&&d.tagName==="svg"}const cM=[...Hb,Mr,Vh],uM=d=>cM.find(Zb(d)),Ox=()=>({translate:0,scale:1,origin:0,originPoint:0}),zp=()=>({x:Ox(),y:Ox()}),Fx=()=>({min:0,max:0}),Lr=()=>({x:Fx(),y:Fx()}),Q_={current:null},t1={current:!1},hM=typeof window<"u";function dM(){if(t1.current=!0,!!hM)if(window.matchMedia){const d=window.matchMedia("(prefers-reduced-motion)"),g=()=>Q_.current=d.matches;d.addEventListener("change",g),g()}else Q_.current=!1}const fM=new WeakMap;function Vy(d){return d!==null&&typeof d=="object"&&typeof d.start=="function"}function og(d){return typeof d=="string"||Array.isArray(d)}const L0=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],j0=["initial",...L0];function Uy(d){return Vy(d.animate)||j0.some(g=>og(d[g]))}function i1(d){return!!(Uy(d)||d.variants)}function pM(d,g,T){for(const S in g){const I=g[S],B=T[S];if(Ua(I))d.addValue(S,I);else if(Ua(B))d.addValue(S,kp(I,{owner:d}));else if(B!==I)if(d.hasValue(S)){const M=d.getValue(S);M.liveStyle===!0?M.jump(I):M.hasAnimated||M.set(I)}else{const M=d.getStaticValue(S);d.addValue(S,kp(M!==void 0?M:I,{owner:d}))}}for(const S in T)g[S]===void 0&&d.removeValue(S);return g}const Nx=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let Ry={};function n1(d){Ry=d}function mM(){return Ry}class gM{scrapeMotionValuesFromProps(g,T,S){return{}}constructor({parent:g,props:T,presenceContext:S,reducedMotionConfig:I,blockInitialAnimation:B,visualState:M},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=A0,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const de=os.now();this.renderScheduledAt<de&&(this.renderScheduledAt=de,jn.render(this.render,!1,!0))};const{latestValues:V,renderState:X}=M;this.latestValues=V,this.baseTarget={...V},this.initialValues=T.initial?{...V}:{},this.renderState=X,this.parent=g,this.props=T,this.presenceContext=S,this.depth=g?g.depth+1:0,this.reducedMotionConfig=I,this.options=c,this.blockInitialAnimation=!!B,this.isControllingVariants=Uy(T),this.isVariantNode=i1(T),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(g&&g.current);const{willChange:K,...te}=this.scrapeMotionValuesFromProps(T,{},this);for(const de in te){const De=te[de];V[de]!==void 0&&Ua(De)&&De.set(V[de])}}mount(g){this.current=g,fM.set(g,this),this.projection&&!this.projection.instance&&this.projection.mount(g),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((T,S)=>this.bindToMotionValue(S,T)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(t1.current||dM(),this.shouldReduceMotion=Q_.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Nh(this.notifyUpdate),Nh(this.render),this.valueSubscriptions.forEach(g=>g()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const g in this.events)this.events[g].clear();for(const g in this.features){const T=this.features[g];T&&(T.unmount(),T.isMounted=!1)}this.current=null}addChild(g){this.children.add(g),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(g)}removeChild(g){this.children.delete(g),this.enteringChildren&&this.enteringChildren.delete(g)}bindToMotionValue(g,T){this.valueSubscriptions.has(g)&&this.valueSubscriptions.get(g)();const S=Fp.has(g);S&&this.onBindTransform&&this.onBindTransform();const I=T.on("change",M=>{this.latestValues[g]=M,this.props.onUpdate&&jn.preRender(this.notifyUpdate),S&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let B;typeof window<"u"&&window.MotionCheckAppearSync&&(B=window.MotionCheckAppearSync(this,g,T)),this.valueSubscriptions.set(g,()=>{I(),B&&B(),T.owner&&T.stop()})}sortNodePosition(g){return!this.current||!this.sortInstanceNodePosition||this.type!==g.type?0:this.sortInstanceNodePosition(this.current,g.current)}updateFeatures(){let g="animation";for(g in Ry){const T=Ry[g];if(!T)continue;const{isEnabled:S,Feature:I}=T;if(!this.features[g]&&I&&S(this.props)&&(this.features[g]=new I(this)),this.features[g]){const B=this.features[g];B.isMounted?B.update():(B.mount(),B.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Lr()}getStaticValue(g){return this.latestValues[g]}setStaticValue(g,T){this.latestValues[g]=T}update(g,T){(g.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=g,this.prevPresenceContext=this.presenceContext,this.presenceContext=T;for(let S=0;S<Nx.length;S++){const I=Nx[S];this.propEventSubscriptions[I]&&(this.propEventSubscriptions[I](),delete this.propEventSubscriptions[I]);const B="on"+I,M=g[B];M&&(this.propEventSubscriptions[I]=this.on(I,M))}this.prevMotionValues=pM(this,this.scrapeMotionValuesFromProps(g,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(g){return this.props.variants?this.props.variants[g]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(g){const T=this.getClosestVariantNode();if(T)return T.variantChildren&&T.variantChildren.add(g),()=>T.variantChildren.delete(g)}addValue(g,T){const S=this.values.get(g);T!==S&&(S&&this.removeValue(g),this.bindToMotionValue(g,T),this.values.set(g,T),this.latestValues[g]=T.get())}removeValue(g){this.values.delete(g);const T=this.valueSubscriptions.get(g);T&&(T(),this.valueSubscriptions.delete(g)),delete this.latestValues[g],this.removeValueFromRenderState(g,this.renderState)}hasValue(g){return this.values.has(g)}getValue(g,T){if(this.props.values&&this.props.values[g])return this.props.values[g];let S=this.values.get(g);return S===void 0&&T!==void 0&&(S=kp(T===null?void 0:T,{owner:this}),this.addValue(g,S)),S}readValue(g,T){let S=this.latestValues[g]!==void 0||!this.current?this.latestValues[g]:this.getBaseTargetFromProps(this.props,g)??this.readValueFromInstance(this.current,g,this.options);return S!=null&&(typeof S=="string"&&(sb(S)||lb(S))?S=parseFloat(S):!uM(S)&&Vh.test(T)&&(S=Xb(g,T)),this.setBaseTarget(g,Ua(S)?S.get():S)),Ua(S)?S.get():S}setBaseTarget(g,T){this.baseTarget[g]=T}getBaseTarget(g){const{initial:T}=this.props;let S;if(typeof T=="string"||typeof T=="object"){const B=z0(this.props,T,this.presenceContext?.custom);B&&(S=B[g])}if(T&&S!==void 0)return S;const I=this.getBaseTargetFromProps(this.props,g);return I!==void 0&&!Ua(I)?I:this.initialValues[g]!==void 0&&S===void 0?void 0:this.baseTarget[g]}on(g,T){return this.events[g]||(this.events[g]=new g0),this.events[g].add(T)}notify(g,...T){this.events[g]&&this.events[g].notify(...T)}scheduleRenderMicrotask(){R0.render(this.render)}}class r1 extends gM{constructor(){super(...arguments),this.KeyframeResolver=tM}sortInstanceNodePosition(g,T){return g.compareDocumentPosition(T)&2?1:-1}getBaseTargetFromProps(g,T){const S=g.style;return S?S[T]:void 0}removeValueFromRenderState(g,{vars:T,style:S}){delete T[g],delete S[g]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:g}=this.props;Ua(g)&&(this.childSubscription=g.on("change",T=>{this.current&&(this.current.textContent=`${T}`)}))}}class qh{constructor(g){this.isMounted=!1,this.node=g}update(){}}function a1({top:d,left:g,right:T,bottom:S}){return{x:{min:g,max:T},y:{min:d,max:S}}}function yM({x:d,y:g}){return{top:g.min,right:d.max,bottom:g.max,left:d.min}}function _M(d,g){if(!g)return d;const T=g({x:d.left,y:d.top}),S=g({x:d.right,y:d.bottom});return{top:T.y,left:T.x,bottom:S.y,right:S.x}}function T_(d){return d===void 0||d===1}function J_({scale:d,scaleX:g,scaleY:T}){return!T_(d)||!T_(g)||!T_(T)}function rf(d){return J_(d)||s1(d)||d.z||d.rotate||d.rotateX||d.rotateY||d.skewX||d.skewY}function s1(d){return Vx(d.x)||Vx(d.y)}function Vx(d){return d&&d!=="0%"}function ky(d,g,T){const S=d-T,I=g*S;return T+I}function Ux(d,g,T,S,I){return I!==void 0&&(d=ky(d,I,S)),ky(d,T,S)+g}function e0(d,g=0,T=1,S,I){d.min=Ux(d.min,g,T,S,I),d.max=Ux(d.max,g,T,S,I)}function o1(d,{x:g,y:T}){e0(d.x,g.translate,g.scale,g.originPoint),e0(d.y,T.translate,T.scale,T.originPoint)}const Gx=.999999999999,qx=1.0000000000001;function xM(d,g,T,S=!1){const I=T.length;if(!I)return;g.x=g.y=1;let B,M;for(let c=0;c<I;c++){B=T[c],M=B.projectionDelta;const{visualElement:V}=B.options;V&&V.props.style&&V.props.style.display==="contents"||(S&&B.options.layoutScroll&&B.scroll&&B!==B.root&&Ip(d,{x:-B.scroll.offset.x,y:-B.scroll.offset.y}),M&&(g.x*=M.x.scale,g.y*=M.y.scale,o1(d,M)),S&&rf(B.latestValues)&&Ip(d,B.latestValues))}g.x<qx&&g.x>Gx&&(g.x=1),g.y<qx&&g.y>Gx&&(g.y=1)}function Pp(d,g){d.min=d.min+g,d.max=d.max+g}function Zx(d,g,T,S,I=.5){const B=Wn(d.min,d.max,I);e0(d,g,T,B,S)}function Ip(d,g){Zx(d.x,g.x,g.scaleX,g.scale,g.originX),Zx(d.y,g.y,g.scaleY,g.scale,g.originY)}function l1(d,g){return a1(_M(d.getBoundingClientRect(),g))}function vM(d,g,T){const S=l1(d,T),{scroll:I}=g;return I&&(Pp(S.x,I.offset.x),Pp(S.y,I.offset.y)),S}const bM={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},wM=Op.length;function TM(d,g,T){let S="",I=!0;for(let B=0;B<wM;B++){const M=Op[B],c=d[M];if(c===void 0)continue;let V=!0;if(typeof c=="number")V=c===(M.startsWith("scale")?1:0);else{const X=parseFloat(c);V=M.startsWith("scale")?X===1:X===0}if(!V||T){const X=Yb(c,I0[M]);if(!V){I=!1;const K=bM[M]||M;S+=`${K}(${X}) `}T&&(g[M]=X)}}return S=S.trim(),T?S=T(g,I?"":S):I&&(S="none"),S}function B0(d,g,T){const{style:S,vars:I,transformOrigin:B}=d;let M=!1,c=!1;for(const V in g){const X=g[V];if(Fp.has(V)){M=!0;continue}else if(wb(V)){I[V]=X;continue}else{const K=Yb(X,I0[V]);V.startsWith("origin")?(c=!0,B[V]=K):S[V]=K}}if(g.transform||(M||T?S.transform=TM(g,d.transform,T):S.transform&&(S.transform="none")),c){const{originX:V="50%",originY:X="50%",originZ:K=0}=B;S.transformOrigin=`${V} ${X} ${K}`}}function c1(d,{style:g,vars:T},S,I){const B=d.style;let M;for(M in g)B[M]=g[M];I?.applyProjectionStyles(B,S);for(M in T)B.setProperty(M,T[M])}function Hx(d,g){return g.max===g.min?0:d/(g.max-g.min)*100}const Ym={correct:(d,g)=>{if(!g.target)return d;if(typeof d=="string")if(Bt.test(d))d=parseFloat(d);else return d;const T=Hx(d,g.target.x),S=Hx(d,g.target.y);return`${T}% ${S}%`}},SM={correct:(d,{treeScale:g,projectionDelta:T})=>{const S=d,I=Vh.parse(d);if(I.length>5)return S;const B=Vh.createTransformer(d),M=typeof I[0]!="number"?1:0,c=T.x.scale*g.x,V=T.y.scale*g.y;I[0+M]/=c,I[1+M]/=V;const X=Wn(c,V,.5);return typeof I[2+M]=="number"&&(I[2+M]/=X),typeof I[3+M]=="number"&&(I[3+M]/=X),B(I)}},t0={borderRadius:{...Ym,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ym,borderTopRightRadius:Ym,borderBottomLeftRadius:Ym,borderBottomRightRadius:Ym,boxShadow:SM};function u1(d,{layout:g,layoutId:T}){return Fp.has(d)||d.startsWith("origin")||(g||T!==void 0)&&(!!t0[d]||d==="opacity")}function O0(d,g,T){const S=d.style,I=g?.style,B={};if(!S)return B;for(const M in S)(Ua(S[M])||I&&Ua(I[M])||u1(M,d)||T?.getValue(M)?.liveStyle!==void 0)&&(B[M]=S[M]);return B}function MM(d){return window.getComputedStyle(d)}class EM extends r1{constructor(){super(...arguments),this.type="html",this.renderInstance=c1}readValueFromInstance(g,T){if(Fp.has(T))return this.projection?.isProjecting?V_(T):iS(g,T);{const S=MM(g),I=(wb(T)?S.getPropertyValue(T):S[T])||0;return typeof I=="string"?I.trim():I}}measureInstanceViewportBox(g,{transformPagePoint:T}){return l1(g,T)}build(g,T,S){B0(g,T,S.transformTemplate)}scrapeMotionValuesFromProps(g,T,S){return O0(g,T,S)}}const AM={offset:"stroke-dashoffset",array:"stroke-dasharray"},CM={offset:"strokeDashoffset",array:"strokeDasharray"};function DM(d,g,T=1,S=0,I=!0){d.pathLength=1;const B=I?AM:CM;d[B.offset]=`${-S}`,d[B.array]=`${g} ${T}`}const zM=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function h1(d,{attrX:g,attrY:T,attrScale:S,pathLength:I,pathSpacing:B=1,pathOffset:M=0,...c},V,X,K){if(B0(d,c,X),V){d.style.viewBox&&(d.attrs.viewBox=d.style.viewBox);return}d.attrs=d.style,d.style={};const{attrs:te,style:de}=d;te.transform&&(de.transform=te.transform,delete te.transform),(de.transform||te.transformOrigin)&&(de.transformOrigin=te.transformOrigin??"50% 50%",delete te.transformOrigin),de.transform&&(de.transformBox=K?.transformBox??"fill-box",delete te.transformBox);for(const De of zM)te[De]!==void 0&&(de[De]=te[De],delete te[De]);g!==void 0&&(te.x=g),T!==void 0&&(te.y=T),S!==void 0&&(te.scale=S),I!==void 0&&DM(te,I,B,M,!1)}const d1=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),f1=d=>typeof d=="string"&&d.toLowerCase()==="svg";function PM(d,g,T,S){c1(d,g,void 0,S);for(const I in g.attrs)d.setAttribute(d1.has(I)?I:P0(I),g.attrs[I])}function p1(d,g,T){const S=O0(d,g,T);for(const I in d)if(Ua(d[I])||Ua(g[I])){const B=Op.indexOf(I)!==-1?"attr"+I.charAt(0).toUpperCase()+I.substring(1):I;S[B]=d[I]}return S}class IM extends r1{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Lr}getBaseTargetFromProps(g,T){return g[T]}readValueFromInstance(g,T){if(Fp.has(T)){const S=$b(T);return S&&S.default||0}return T=d1.has(T)?T:P0(T),g.getAttribute(T)}scrapeMotionValuesFromProps(g,T,S){return p1(g,T,S)}build(g,T,S){h1(g,T,this.isSVGTag,S.transformTemplate,S.style)}renderInstance(g,T,S,I){PM(g,T,S,I)}mount(g){this.isSVGTag=f1(g.tagName),super.mount(g)}}const RM=j0.length;function m1(d){if(!d)return;if(!d.isControllingVariants){const T=d.parent?m1(d.parent)||{}:{};return d.props.initial!==void 0&&(T.initial=d.props.initial),T}const g={};for(let T=0;T<RM;T++){const S=j0[T],I=d.props[S];(og(I)||I===!1)&&(g[S]=I)}return g}function g1(d,g){if(!Array.isArray(g))return!1;const T=g.length;if(T!==d.length)return!1;for(let S=0;S<T;S++)if(g[S]!==d[S])return!1;return!0}const kM=[...L0].reverse(),LM=L0.length;function jM(d){return g=>Promise.all(g.map(({animation:T,options:S})=>ZS(d,T,S)))}function BM(d){let g=jM(d),T=$x(),S=!0;const I=V=>(X,K)=>{const te=Rp(d,K,V==="exit"?d.presenceContext?.custom:void 0);if(te){const{transition:de,transitionEnd:De,...Ze}=te;X={...X,...Ze,...De}}return X};function B(V){g=V(d)}function M(V){const{props:X}=d,K=m1(d.parent)||{},te=[],de=new Set;let De={},Ze=1/0;for(let le=0;le<LM;le++){const Xe=kM[le],Ve=T[Xe],Ue=X[Xe]!==void 0?X[Xe]:K[Xe],gt=og(Ue),pt=Xe===V?Ve.isActive:null;pt===!1&&(Ze=le);let Dt=Ue===K[Xe]&&Ue!==X[Xe]&&gt;if(Dt&&S&&d.manuallyAnimateOnMount&&(Dt=!1),Ve.protectedKeys={...De},!Ve.isActive&&pt===null||!Ue&&!Ve.prevProp||Vy(Ue)||typeof Ue=="boolean")continue;const _t=OM(Ve.prevProp,Ue);let Mt=_t||Xe===V&&Ve.isActive&&!Dt&&gt||le>Ze&&gt,Ot=!1;const si=Array.isArray(Ue)?Ue:[Ue];let Gi=si.reduce(I(Xe),{});pt===!1&&(Gi={});const{prevResolvedValues:ki={}}=Ve,Bn={...ki,...Gi},yr=at=>{Mt=!0,de.has(at)&&(Ot=!0,de.delete(at)),Ve.needsAnimating[at]=!0;const Pt=d.getValue(at);Pt&&(Pt.liveStyle=!1)};for(const at in Bn){const Pt=Gi[at],It=ki[at];if(De.hasOwnProperty(at))continue;let ni=!1;$_(Pt)&&$_(It)?ni=!g1(Pt,It):ni=Pt!==It,ni?Pt!=null?yr(at):de.add(at):Pt!==void 0&&de.has(at)?yr(at):Ve.protectedKeys[at]=!0}Ve.prevProp=Ue,Ve.prevResolvedValues=Gi,Ve.isActive&&(De={...De,...Gi}),S&&d.blockInitialAnimation&&(Mt=!1);const On=Dt&&_t;Mt&&(!On||Ot)&&te.push(...si.map(at=>{const Pt={type:Xe};if(typeof at=="string"&&S&&!On&&d.manuallyAnimateOnMount&&d.parent){const{parent:It}=d,ni=Rp(It,at);if(It.enteringChildren&&ni){const{delayChildren:Ee}=ni.transition||{};Pt.delay=Fb(It.enteringChildren,d,Ee)}}return{animation:at,options:Pt}}))}if(de.size){const le={};if(typeof X.initial!="boolean"){const Xe=Rp(d,Array.isArray(X.initial)?X.initial[0]:X.initial);Xe&&Xe.transition&&(le.transition=Xe.transition)}de.forEach(Xe=>{const Ve=d.getBaseTarget(Xe),Ue=d.getValue(Xe);Ue&&(Ue.liveStyle=!0),le[Xe]=Ve??null}),te.push({animation:le})}let xe=!!te.length;return S&&(X.initial===!1||X.initial===X.animate)&&!d.manuallyAnimateOnMount&&(xe=!1),S=!1,xe?g(te):Promise.resolve()}function c(V,X){if(T[V].isActive===X)return Promise.resolve();d.variantChildren?.forEach(te=>te.animationState?.setActive(V,X)),T[V].isActive=X;const K=M(V);for(const te in T)T[te].protectedKeys={};return K}return{animateChanges:M,setActive:c,setAnimateFunction:B,getState:()=>T,reset:()=>{T=$x()}}}function OM(d,g){return typeof g=="string"?g!==d:Array.isArray(g)?!g1(g,d):!1}function tf(d=!1){return{isActive:d,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function $x(){return{animate:tf(!0),whileInView:tf(),whileHover:tf(),whileTap:tf(),whileDrag:tf(),whileFocus:tf(),exit:tf()}}function Xx(d,g){d.min=g.min,d.max=g.max}function Bl(d,g){Xx(d.x,g.x),Xx(d.y,g.y)}function Yx(d,g){d.translate=g.translate,d.scale=g.scale,d.originPoint=g.originPoint,d.origin=g.origin}const y1=1e-4,FM=1-y1,NM=1+y1,_1=.01,VM=0-_1,UM=0+_1;function ls(d){return d.max-d.min}function GM(d,g,T){return Math.abs(d-g)<=T}function Wx(d,g,T,S=.5){d.origin=S,d.originPoint=Wn(g.min,g.max,d.origin),d.scale=ls(T)/ls(g),d.translate=Wn(T.min,T.max,d.origin)-d.originPoint,(d.scale>=FM&&d.scale<=NM||isNaN(d.scale))&&(d.scale=1),(d.translate>=VM&&d.translate<=UM||isNaN(d.translate))&&(d.translate=0)}function tg(d,g,T,S){Wx(d.x,g.x,T.x,S?S.originX:void 0),Wx(d.y,g.y,T.y,S?S.originY:void 0)}function Kx(d,g,T){d.min=T.min+g.min,d.max=d.min+ls(g)}function qM(d,g,T){Kx(d.x,g.x,T.x),Kx(d.y,g.y,T.y)}function Qx(d,g,T){d.min=g.min-T.min,d.max=d.min+ls(g)}function Ly(d,g,T){Qx(d.x,g.x,T.x),Qx(d.y,g.y,T.y)}function Jx(d,g,T,S,I){return d-=g,d=ky(d,1/T,S),I!==void 0&&(d=ky(d,1/I,S)),d}function ZM(d,g=0,T=1,S=.5,I,B=d,M=d){if(zc.test(g)&&(g=parseFloat(g),g=Wn(M.min,M.max,g/100)-M.min),typeof g!="number")return;let c=Wn(B.min,B.max,S);d===B&&(c-=g),d.min=Jx(d.min,g,T,c,I),d.max=Jx(d.max,g,T,c,I)}function ev(d,g,[T,S,I],B,M){ZM(d,g[T],g[S],g[I],g.scale,B,M)}const HM=["x","scaleX","originX"],$M=["y","scaleY","originY"];function tv(d,g,T,S){ev(d.x,g,HM,T?T.x:void 0,S?S.x:void 0),ev(d.y,g,$M,T?T.y:void 0,S?S.y:void 0)}function iv(d){return d.translate===0&&d.scale===1}function x1(d){return iv(d.x)&&iv(d.y)}function nv(d,g){return d.min===g.min&&d.max===g.max}function XM(d,g){return nv(d.x,g.x)&&nv(d.y,g.y)}function rv(d,g){return Math.round(d.min)===Math.round(g.min)&&Math.round(d.max)===Math.round(g.max)}function v1(d,g){return rv(d.x,g.x)&&rv(d.y,g.y)}function av(d){return ls(d.x)/ls(d.y)}function sv(d,g){return d.translate===g.translate&&d.scale===g.scale&&d.originPoint===g.originPoint}function Go(d){return[d("x"),d("y")]}function YM(d,g,T){let S="";const I=d.x.translate/g.x,B=d.y.translate/g.y,M=T?.z||0;if((I||B||M)&&(S=`translate3d(${I}px, ${B}px, ${M}px) `),(g.x!==1||g.y!==1)&&(S+=`scale(${1/g.x}, ${1/g.y}) `),T){const{transformPerspective:X,rotate:K,rotateX:te,rotateY:de,skewX:De,skewY:Ze}=T;X&&(S=`perspective(${X}px) ${S}`),K&&(S+=`rotate(${K}deg) `),te&&(S+=`rotateX(${te}deg) `),de&&(S+=`rotateY(${de}deg) `),De&&(S+=`skewX(${De}deg) `),Ze&&(S+=`skewY(${Ze}deg) `)}const c=d.x.scale*g.x,V=d.y.scale*g.y;return(c!==1||V!==1)&&(S+=`scale(${c}, ${V})`),S||"none"}const b1=["TopLeft","TopRight","BottomLeft","BottomRight"],WM=b1.length,ov=d=>typeof d=="string"?parseFloat(d):d,lv=d=>typeof d=="number"||Bt.test(d);function KM(d,g,T,S,I,B){I?(d.opacity=Wn(0,T.opacity??1,QM(S)),d.opacityExit=Wn(g.opacity??1,0,JM(S))):B&&(d.opacity=Wn(g.opacity??1,T.opacity??1,S));for(let M=0;M<WM;M++){const c=`border${b1[M]}Radius`;let V=cv(g,c),X=cv(T,c);if(V===void 0&&X===void 0)continue;V||(V=0),X||(X=0),V===0||X===0||lv(V)===lv(X)?(d[c]=Math.max(Wn(ov(V),ov(X),S),0),(zc.test(X)||zc.test(V))&&(d[c]+="%")):d[c]=X}(g.rotate||T.rotate)&&(d.rotate=Wn(g.rotate||0,T.rotate||0,S))}function cv(d,g){return d[g]!==void 0?d[g]:d.borderRadius}const QM=w1(0,.5,gb),JM=w1(.5,.95,Zo);function w1(d,g,T){return S=>S<d?0:S>g?1:T(rg(d,g,S))}function eE(d,g,T){const S=Ua(d)?d:kp(d);return S.start(D0("",S,g,T)),S.animation}function lg(d,g,T,S={passive:!0}){return d.addEventListener(g,T,S),()=>d.removeEventListener(g,T)}const tE=(d,g)=>d.depth-g.depth;class iE{constructor(){this.children=[],this.isDirty=!1}add(g){d0(this.children,g),this.isDirty=!0}remove(g){f0(this.children,g),this.isDirty=!0}forEach(g){this.isDirty&&this.children.sort(tE),this.isDirty=!1,this.children.forEach(g)}}function nE(d,g){const T=os.now(),S=({timestamp:I})=>{const B=I-T;B>=g&&(Nh(S),d(B-g))};return jn.setup(S,!0),()=>Nh(S)}function My(d){return Ua(d)?d.get():d}class rE{constructor(){this.members=[]}add(g){d0(this.members,g),g.scheduleRender()}remove(g){if(f0(this.members,g),g===this.prevLead&&(this.prevLead=void 0),g===this.lead){const T=this.members[this.members.length-1];T&&this.promote(T)}}relegate(g){const T=this.members.findIndex(I=>g===I);if(T===0)return!1;let S;for(let I=T;I>=0;I--){const B=this.members[I];if(B.isPresent!==!1){S=B;break}}return S?(this.promote(S),!0):!1}promote(g,T){const S=this.lead;if(g!==S&&(this.prevLead=S,this.lead=g,g.show(),S)){S.instance&&S.scheduleRender(),g.scheduleRender();const I=S.options.layoutDependency,B=g.options.layoutDependency;I!==void 0&&B!==void 0&&I===B||(g.resumeFrom=S,T&&(g.resumeFrom.preserveOpacity=!0),S.snapshot&&(g.snapshot=S.snapshot,g.snapshot.latestValues=S.animationValues||S.latestValues),g.root&&g.root.isUpdating&&(g.isLayoutDirty=!0));const{crossfade:c}=g.options;c===!1&&S.hide()}}exitAnimationComplete(){this.members.forEach(g=>{const{options:T,resumingFrom:S}=g;T.onExitComplete&&T.onExitComplete(),S&&S.options.onExitComplete&&S.options.onExitComplete()})}scheduleRender(){this.members.forEach(g=>{g.instance&&g.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Ey={hasAnimatedSinceResize:!0,hasEverUpdated:!1},S_=["","X","Y","Z"],aE=1e3;let sE=0;function M_(d,g,T,S){const{latestValues:I}=g;I[d]&&(T[d]=I[d],g.setStaticValue(d,0),S&&(S[d]=0))}function T1(d){if(d.hasCheckedOptimisedAppear=!0,d.root===d)return;const{visualElement:g}=d.options;if(!g)return;const T=Gb(g);if(window.MotionHasOptimisedAnimation(T,"transform")){const{layout:I,layoutId:B}=d.options;window.MotionCancelOptimisedAnimation(T,"transform",jn,!(I||B))}const{parent:S}=d;S&&!S.hasCheckedOptimisedAppear&&T1(S)}function S1({attachResizeListener:d,defaultParent:g,measureScroll:T,checkIsScrollRoot:S,resetTransform:I}){return class{constructor(M={},c=g?.()){this.id=sE++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(cE),this.nodes.forEach(fE),this.nodes.forEach(pE),this.nodes.forEach(uE)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=M,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let V=0;V<this.path.length;V++)this.path[V].shouldResetTransform=!0;this.root===this&&(this.nodes=new iE)}addEventListener(M,c){return this.eventHandlers.has(M)||this.eventHandlers.set(M,new g0),this.eventHandlers.get(M).add(c)}notifyListeners(M,...c){const V=this.eventHandlers.get(M);V&&V.notify(...c)}hasListeners(M){return this.eventHandlers.has(M)}mount(M){if(this.instance)return;this.isSVG=e1(M)&&!lM(M),this.instance=M;const{layoutId:c,layout:V,visualElement:X}=this.options;if(X&&!X.current&&X.mount(M),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(V||c)&&(this.isLayoutDirty=!0),d){let K,te=0;const de=()=>this.root.updateBlockedByResize=!1;jn.read(()=>{te=window.innerWidth}),d(M,()=>{const De=window.innerWidth;De!==te&&(te=De,this.root.updateBlockedByResize=!0,K&&K(),K=nE(de,250),Ey.hasAnimatedSinceResize&&(Ey.hasAnimatedSinceResize=!1,this.nodes.forEach(dv)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&X&&(c||V)&&this.addEventListener("didUpdate",({delta:K,hasLayoutChanged:te,hasRelativeLayoutChanged:de,layout:De})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const Ze=this.options.transition||X.getDefaultTransition()||xE,{onLayoutAnimationStart:xe,onLayoutAnimationComplete:le}=X.getProps(),Xe=!this.targetLayout||!v1(this.targetLayout,De),Ve=!te&&de;if(this.options.layoutRoot||this.resumeFrom||Ve||te&&(Xe||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const Ue={...C0(Ze,"layout"),onPlay:xe,onComplete:le};(X.shouldReduceMotion||this.options.layoutRoot)&&(Ue.delay=0,Ue.type=!1),this.startAnimation(Ue),this.setAnimationOrigin(K,Ve)}else te||dv(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=De})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const M=this.getStack();M&&M.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Nh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(mE),this.animationId++)}getTransformTemplate(){const{visualElement:M}=this.options;return M&&M.getProps().transformTemplate}willUpdate(M=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&T1(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let K=0;K<this.path.length;K++){const te=this.path[K];te.shouldResetTransform=!0,te.updateScroll("snapshot"),te.options.layoutRoot&&te.willUpdate(!1)}const{layoutId:c,layout:V}=this.options;if(c===void 0&&!V)return;const X=this.getTransformTemplate();this.prevTransformTemplateValue=X?X(this.latestValues,""):void 0,this.updateSnapshot(),M&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(uv);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(hv);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(dE),this.nodes.forEach(oE),this.nodes.forEach(lE)):this.nodes.forEach(hv),this.clearAllSnapshots();const c=os.now();_a.delta=Rc(0,1e3/60,c-_a.timestamp),_a.timestamp=c,_a.isProcessing=!0,g_.update.process(_a),g_.preRender.process(_a),g_.render.process(_a),_a.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,R0.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(hE),this.sharedNodes.forEach(gE)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,jn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){jn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ls(this.snapshot.measuredBox.x)&&!ls(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let V=0;V<this.path.length;V++)this.path[V].updateScroll();const M=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Lr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,M?M.layoutBox:void 0)}updateScroll(M="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===M&&(c=!1),c&&this.instance){const V=S(this.instance);this.scroll={animationId:this.root.animationId,phase:M,isRoot:V,offset:T(this.instance),wasRoot:this.scroll?this.scroll.isRoot:V}}}resetTransform(){if(!I)return;const M=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!x1(this.projectionDelta),V=this.getTransformTemplate(),X=V?V(this.latestValues,""):void 0,K=X!==this.prevTransformTemplateValue;M&&this.instance&&(c||rf(this.latestValues)||K)&&(I(this.instance,X),this.shouldResetTransform=!1,this.scheduleRender())}measure(M=!0){const c=this.measurePageBox();let V=this.removeElementScroll(c);return M&&(V=this.removeTransform(V)),vE(V),{animationId:this.root.animationId,measuredBox:c,layoutBox:V,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:M}=this.options;if(!M)return Lr();const c=M.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(bE))){const{scroll:X}=this.root;X&&(Pp(c.x,X.offset.x),Pp(c.y,X.offset.y))}return c}removeElementScroll(M){const c=Lr();if(Bl(c,M),this.scroll?.wasRoot)return c;for(let V=0;V<this.path.length;V++){const X=this.path[V],{scroll:K,options:te}=X;X!==this.root&&K&&te.layoutScroll&&(K.wasRoot&&Bl(c,M),Pp(c.x,K.offset.x),Pp(c.y,K.offset.y))}return c}applyTransform(M,c=!1){const V=Lr();Bl(V,M);for(let X=0;X<this.path.length;X++){const K=this.path[X];!c&&K.options.layoutScroll&&K.scroll&&K!==K.root&&Ip(V,{x:-K.scroll.offset.x,y:-K.scroll.offset.y}),rf(K.latestValues)&&Ip(V,K.latestValues)}return rf(this.latestValues)&&Ip(V,this.latestValues),V}removeTransform(M){const c=Lr();Bl(c,M);for(let V=0;V<this.path.length;V++){const X=this.path[V];if(!X.instance||!rf(X.latestValues))continue;J_(X.latestValues)&&X.updateSnapshot();const K=Lr(),te=X.measurePageBox();Bl(K,te),tv(c,X.latestValues,X.snapshot?X.snapshot.layoutBox:void 0,K)}return rf(this.latestValues)&&tv(c,this.latestValues),c}setTargetDelta(M){this.targetDelta=M,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(M){this.options={...this.options,...M,crossfade:M.crossfade!==void 0?M.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==_a.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(M=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const V=!!this.resumingFrom||this!==c;if(!(M||V&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:K,layoutId:te}=this.options;if(!this.layout||!(K||te))return;this.resolvedRelativeTargetAt=_a.timestamp;const de=this.getClosestProjectingParent();de&&this.linkedParentVersion!==de.layoutVersion&&!de.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(de&&de.layout?this.createRelativeTarget(de,this.layout.layoutBox,de.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Lr(),this.targetWithTransforms=Lr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),qM(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Bl(this.target,this.layout.layoutBox),o1(this.target,this.targetDelta)):Bl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,de&&!!de.resumingFrom==!!this.resumingFrom&&!de.options.layoutScroll&&de.target&&this.animationProgress!==1?this.createRelativeTarget(de,this.target,de.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||J_(this.parent.latestValues)||s1(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(M,c,V){this.relativeParent=M,this.linkedParentVersion=M.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Lr(),this.relativeTargetOrigin=Lr(),Ly(this.relativeTargetOrigin,c,V),Bl(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const M=this.getLead(),c=!!this.resumingFrom||this!==M;let V=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(V=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(V=!1),this.resolvedRelativeTargetAt===_a.timestamp&&(V=!1),V)return;const{layout:X,layoutId:K}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(X||K))return;Bl(this.layoutCorrected,this.layout.layoutBox);const te=this.treeScale.x,de=this.treeScale.y;xM(this.layoutCorrected,this.treeScale,this.path,c),M.layout&&!M.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(M.target=M.layout.layoutBox,M.targetWithTransforms=Lr());const{target:De}=M;if(!De){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Yx(this.prevProjectionDelta.x,this.projectionDelta.x),Yx(this.prevProjectionDelta.y,this.projectionDelta.y)),tg(this.projectionDelta,this.layoutCorrected,De,this.latestValues),(this.treeScale.x!==te||this.treeScale.y!==de||!sv(this.projectionDelta.x,this.prevProjectionDelta.x)||!sv(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",De))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(M=!0){if(this.options.visualElement?.scheduleRender(),M){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=zp(),this.projectionDelta=zp(),this.projectionDeltaWithTransform=zp()}setAnimationOrigin(M,c=!1){const V=this.snapshot,X=V?V.latestValues:{},K={...this.latestValues},te=zp();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const de=Lr(),De=V?V.source:void 0,Ze=this.layout?this.layout.source:void 0,xe=De!==Ze,le=this.getStack(),Xe=!le||le.members.length<=1,Ve=!!(xe&&!Xe&&this.options.crossfade===!0&&!this.path.some(_E));this.animationProgress=0;let Ue;this.mixTargetDelta=gt=>{const pt=gt/1e3;fv(te.x,M.x,pt),fv(te.y,M.y,pt),this.setTargetDelta(te),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ly(de,this.layout.layoutBox,this.relativeParent.layout.layoutBox),yE(this.relativeTarget,this.relativeTargetOrigin,de,pt),Ue&&XM(this.relativeTarget,Ue)&&(this.isProjectionDirty=!1),Ue||(Ue=Lr()),Bl(Ue,this.relativeTarget)),xe&&(this.animationValues=K,KM(K,X,this.latestValues,pt,Ve,Xe)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=pt},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(M){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Nh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=jn.update(()=>{Ey.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=kp(0)),this.currentAnimation=eE(this.motionValue,[0,1e3],{...M,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),M.onUpdate&&M.onUpdate(c)},onStop:()=>{},onComplete:()=>{M.onComplete&&M.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const M=this.getStack();M&&M.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(aE),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const M=this.getLead();let{targetWithTransforms:c,target:V,layout:X,latestValues:K}=M;if(!(!c||!V||!X)){if(this!==M&&this.layout&&X&&M1(this.options.animationType,this.layout.layoutBox,X.layoutBox)){V=this.target||Lr();const te=ls(this.layout.layoutBox.x);V.x.min=M.target.x.min,V.x.max=V.x.min+te;const de=ls(this.layout.layoutBox.y);V.y.min=M.target.y.min,V.y.max=V.y.min+de}Bl(c,V),Ip(c,K),tg(this.projectionDeltaWithTransform,this.layoutCorrected,c,K)}}registerSharedNode(M,c){this.sharedNodes.has(M)||this.sharedNodes.set(M,new rE),this.sharedNodes.get(M).add(c);const X=c.options.initialPromotionConfig;c.promote({transition:X?X.transition:void 0,preserveFollowOpacity:X&&X.shouldPreserveFollowOpacity?X.shouldPreserveFollowOpacity(c):void 0})}isLead(){const M=this.getStack();return M?M.lead===this:!0}getLead(){const{layoutId:M}=this.options;return M?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:M}=this.options;return M?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:M}=this.options;if(M)return this.root.sharedNodes.get(M)}promote({needsReset:M,transition:c,preserveFollowOpacity:V}={}){const X=this.getStack();X&&X.promote(this,V),M&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const M=this.getStack();return M?M.relegate(this):!1}resetSkewAndRotation(){const{visualElement:M}=this.options;if(!M)return;let c=!1;const{latestValues:V}=M;if((V.z||V.rotate||V.rotateX||V.rotateY||V.rotateZ||V.skewX||V.skewY)&&(c=!0),!c)return;const X={};V.z&&M_("z",M,X,this.animationValues);for(let K=0;K<S_.length;K++)M_(`rotate${S_[K]}`,M,X,this.animationValues),M_(`skew${S_[K]}`,M,X,this.animationValues);M.render();for(const K in X)M.setStaticValue(K,X[K]),this.animationValues&&(this.animationValues[K]=X[K]);M.scheduleRender()}applyProjectionStyles(M,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){M.visibility="hidden";return}const V=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,M.visibility="",M.opacity="",M.pointerEvents=My(c?.pointerEvents)||"",M.transform=V?V(this.latestValues,""):"none";return}const X=this.getLead();if(!this.projectionDelta||!this.layout||!X.target){this.options.layoutId&&(M.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,M.pointerEvents=My(c?.pointerEvents)||""),this.hasProjected&&!rf(this.latestValues)&&(M.transform=V?V({},""):"none",this.hasProjected=!1);return}M.visibility="";const K=X.animationValues||X.latestValues;this.applyTransformsToTarget();let te=YM(this.projectionDeltaWithTransform,this.treeScale,K);V&&(te=V(K,te)),M.transform=te;const{x:de,y:De}=this.projectionDelta;M.transformOrigin=`${de.origin*100}% ${De.origin*100}% 0`,X.animationValues?M.opacity=X===this?K.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:K.opacityExit:M.opacity=X===this?K.opacity!==void 0?K.opacity:"":K.opacityExit!==void 0?K.opacityExit:0;for(const Ze in t0){if(K[Ze]===void 0)continue;const{correct:xe,applyTo:le,isCSSVariable:Xe}=t0[Ze],Ve=te==="none"?K[Ze]:xe(K[Ze],X);if(le){const Ue=le.length;for(let gt=0;gt<Ue;gt++)M[le[gt]]=Ve}else Xe?this.options.visualElement.renderState.vars[Ze]=Ve:M[Ze]=Ve}this.options.layoutId&&(M.pointerEvents=X===this?My(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(M=>M.currentAnimation?.stop()),this.root.nodes.forEach(uv),this.root.sharedNodes.clear()}}}function oE(d){d.updateLayout()}function lE(d){const g=d.resumeFrom?.snapshot||d.snapshot;if(d.isLead()&&d.layout&&g&&d.hasListeners("didUpdate")){const{layoutBox:T,measuredBox:S}=d.layout,{animationType:I}=d.options,B=g.source!==d.layout.source;I==="size"?Go(K=>{const te=B?g.measuredBox[K]:g.layoutBox[K],de=ls(te);te.min=T[K].min,te.max=te.min+de}):M1(I,g.layoutBox,T)&&Go(K=>{const te=B?g.measuredBox[K]:g.layoutBox[K],de=ls(T[K]);te.max=te.min+de,d.relativeTarget&&!d.currentAnimation&&(d.isProjectionDirty=!0,d.relativeTarget[K].max=d.relativeTarget[K].min+de)});const M=zp();tg(M,T,g.layoutBox);const c=zp();B?tg(c,d.applyTransform(S,!0),g.measuredBox):tg(c,T,g.layoutBox);const V=!x1(M);let X=!1;if(!d.resumeFrom){const K=d.getClosestProjectingParent();if(K&&!K.resumeFrom){const{snapshot:te,layout:de}=K;if(te&&de){const De=Lr();Ly(De,g.layoutBox,te.layoutBox);const Ze=Lr();Ly(Ze,T,de.layoutBox),v1(De,Ze)||(X=!0),K.options.layoutRoot&&(d.relativeTarget=Ze,d.relativeTargetOrigin=De,d.relativeParent=K)}}}d.notifyListeners("didUpdate",{layout:T,snapshot:g,delta:c,layoutDelta:M,hasLayoutChanged:V,hasRelativeLayoutChanged:X})}else if(d.isLead()){const{onExitComplete:T}=d.options;T&&T()}d.options.transition=void 0}function cE(d){d.parent&&(d.isProjecting()||(d.isProjectionDirty=d.parent.isProjectionDirty),d.isSharedProjectionDirty||(d.isSharedProjectionDirty=!!(d.isProjectionDirty||d.parent.isProjectionDirty||d.parent.isSharedProjectionDirty)),d.isTransformDirty||(d.isTransformDirty=d.parent.isTransformDirty))}function uE(d){d.isProjectionDirty=d.isSharedProjectionDirty=d.isTransformDirty=!1}function hE(d){d.clearSnapshot()}function uv(d){d.clearMeasurements()}function hv(d){d.isLayoutDirty=!1}function dE(d){const{visualElement:g}=d.options;g&&g.getProps().onBeforeLayoutMeasure&&g.notify("BeforeLayoutMeasure"),d.resetTransform()}function dv(d){d.finishAnimation(),d.targetDelta=d.relativeTarget=d.target=void 0,d.isProjectionDirty=!0}function fE(d){d.resolveTargetDelta()}function pE(d){d.calcProjection()}function mE(d){d.resetSkewAndRotation()}function gE(d){d.removeLeadSnapshot()}function fv(d,g,T){d.translate=Wn(g.translate,0,T),d.scale=Wn(g.scale,1,T),d.origin=g.origin,d.originPoint=g.originPoint}function pv(d,g,T,S){d.min=Wn(g.min,T.min,S),d.max=Wn(g.max,T.max,S)}function yE(d,g,T,S){pv(d.x,g.x,T.x,S),pv(d.y,g.y,T.y,S)}function _E(d){return d.animationValues&&d.animationValues.opacityExit!==void 0}const xE={duration:.45,ease:[.4,0,.1,1]},mv=d=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(d),gv=mv("applewebkit/")&&!mv("chrome/")?Math.round:Zo;function yv(d){d.min=gv(d.min),d.max=gv(d.max)}function vE(d){yv(d.x),yv(d.y)}function M1(d,g,T){return d==="position"||d==="preserve-aspect"&&!GM(av(g),av(T),.2)}function bE(d){return d!==d.root&&d.scroll?.wasRoot}const wE=S1({attachResizeListener:(d,g)=>lg(d,"resize",g),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body?.scrollLeft||0,y:document.documentElement.scrollTop||document.body?.scrollTop||0}),checkIsScrollRoot:()=>!0}),E_={current:void 0},E1=S1({measureScroll:d=>({x:d.scrollLeft,y:d.scrollTop}),defaultParent:()=>{if(!E_.current){const d=new wE({});d.mount(window),d.setOptions({layoutScroll:!0}),E_.current=d}return E_.current},resetTransform:(d,g)=>{d.style.transform=g!==void 0?g:"none"},checkIsScrollRoot:d=>window.getComputedStyle(d).position==="fixed"}),F0=Se.createContext({transformPagePoint:d=>d,isStatic:!1,reducedMotion:"never"});function _v(d,g){if(typeof d=="function")return d(g);d!=null&&(d.current=g)}function TE(...d){return g=>{let T=!1;const S=d.map(I=>{const B=_v(I,g);return!T&&typeof B=="function"&&(T=!0),B});if(T)return()=>{for(let I=0;I<S.length;I++){const B=S[I];typeof B=="function"?B():_v(d[I],null)}}}}function SE(...d){return Se.useCallback(TE(...d),d)}class ME extends Se.Component{getSnapshotBeforeUpdate(g){const T=this.props.childRef.current;if(T&&g.isPresent&&!this.props.isPresent){const S=T.offsetParent,I=K_(S)&&S.offsetWidth||0,B=K_(S)&&S.offsetHeight||0,M=this.props.sizeRef.current;M.height=T.offsetHeight||0,M.width=T.offsetWidth||0,M.top=T.offsetTop,M.left=T.offsetLeft,M.right=I-M.width-M.left,M.bottom=B-M.height-M.top}return null}componentDidUpdate(){}render(){return this.props.children}}function EE({children:d,isPresent:g,anchorX:T,anchorY:S,root:I}){const B=Se.useId(),M=Se.useRef(null),c=Se.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:V}=Se.useContext(F0),X=d.props?.ref??d?.ref,K=SE(M,X);return Se.useInsertionEffect(()=>{const{width:te,height:de,top:De,left:Ze,right:xe,bottom:le}=c.current;if(g||!M.current||!te||!de)return;const Xe=T==="left"?`left: ${Ze}`:`right: ${xe}`,Ve=S==="bottom"?`bottom: ${le}`:`top: ${De}`;M.current.dataset.motionPopId=B;const Ue=document.createElement("style");V&&(Ue.nonce=V);const gt=I??document.head;return gt.appendChild(Ue),Ue.sheet&&Ue.sheet.insertRule(`
          [data-motion-pop-id="${B}"] {
            position: absolute !important;
            width: ${te}px !important;
            height: ${de}px !important;
            ${Xe}px !important;
            ${Ve}px !important;
          }
        `),()=>{gt.contains(Ue)&&gt.removeChild(Ue)}},[g]),R.jsx(ME,{isPresent:g,childRef:M,sizeRef:c,children:Se.cloneElement(d,{ref:K})})}const AE=({children:d,initial:g,isPresent:T,onExitComplete:S,custom:I,presenceAffectsLayout:B,mode:M,anchorX:c,anchorY:V,root:X})=>{const K=h0(CE),te=Se.useId();let de=!0,De=Se.useMemo(()=>(de=!1,{id:te,initial:g,isPresent:T,custom:I,onExitComplete:Ze=>{K.set(Ze,!0);for(const xe of K.values())if(!xe)return;S&&S()},register:Ze=>(K.set(Ze,!1),()=>K.delete(Ze))}),[T,K,S]);return B&&de&&(De={...De}),Se.useMemo(()=>{K.forEach((Ze,xe)=>K.set(xe,!1))},[T]),Se.useEffect(()=>{!T&&!K.size&&S&&S()},[T]),M==="popLayout"&&(d=R.jsx(EE,{isPresent:T,anchorX:c,anchorY:V,root:X,children:d})),R.jsx(Ny.Provider,{value:De,children:d})};function CE(){return new Map}function A1(d=!0){const g=Se.useContext(Ny);if(g===null)return[!0,null];const{isPresent:T,onExitComplete:S,register:I}=g,B=Se.useId();Se.useEffect(()=>{if(d)return I(B)},[d]);const M=Se.useCallback(()=>d&&S&&S(B),[B,S,d]);return!T&&S?[!1,M]:[!0]}const xy=d=>d.key||"";function xv(d){const g=[];return Se.Children.forEach(d,T=>{Se.isValidElement(T)&&g.push(T)}),g}const C1=({children:d,custom:g,initial:T=!0,onExitComplete:S,presenceAffectsLayout:I=!0,mode:B="sync",propagate:M=!1,anchorX:c="left",anchorY:V="top",root:X})=>{const[K,te]=A1(M),de=Se.useMemo(()=>xv(d),[d]),De=M&&!K?[]:de.map(xy),Ze=Se.useRef(!0),xe=Se.useRef(de),le=h0(()=>new Map),Xe=Se.useRef(new Set),[Ve,Ue]=Se.useState(de),[gt,pt]=Se.useState(de);ab(()=>{Ze.current=!1,xe.current=de;for(let Mt=0;Mt<gt.length;Mt++){const Ot=xy(gt[Mt]);De.includes(Ot)?(le.delete(Ot),Xe.current.delete(Ot)):le.get(Ot)!==!0&&le.set(Ot,!1)}},[gt,De.length,De.join("-")]);const Dt=[];if(de!==Ve){let Mt=[...de];for(let Ot=0;Ot<gt.length;Ot++){const si=gt[Ot],Gi=xy(si);De.includes(Gi)||(Mt.splice(Ot,0,si),Dt.push(si))}return B==="wait"&&Dt.length&&(Mt=Dt),pt(xv(Mt)),Ue(de),null}const{forceRender:_t}=Se.useContext(u0);return R.jsx(R.Fragment,{children:gt.map(Mt=>{const Ot=xy(Mt),si=M&&!K?!1:de===gt||De.includes(Ot),Gi=()=>{if(Xe.current.has(Ot))return;if(Xe.current.add(Ot),le.has(Ot))le.set(Ot,!0);else return;let ki=!0;le.forEach(Bn=>{Bn||(ki=!1)}),ki&&(_t?.(),pt(xe.current),M&&te?.(),S&&S())};return R.jsx(AE,{isPresent:si,initial:!Ze.current||T?void 0:!1,custom:g,presenceAffectsLayout:I,mode:B,root:X,onExitComplete:si?void 0:Gi,anchorX:c,anchorY:V,children:Mt},Ot)})})},D1=Se.createContext({strict:!1}),vv={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let bv=!1;function DE(){if(bv)return;const d={};for(const g in vv)d[g]={isEnabled:T=>vv[g].some(S=>!!T[S])};n1(d),bv=!0}function z1(){return DE(),mM()}function zE(d){const g=z1();for(const T in d)g[T]={...g[T],...d[T]};n1(g)}const PE=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function jy(d){return d.startsWith("while")||d.startsWith("drag")&&d!=="draggable"||d.startsWith("layout")||d.startsWith("onTap")||d.startsWith("onPan")||d.startsWith("onLayout")||PE.has(d)}let P1=d=>!jy(d);function IE(d){typeof d=="function"&&(P1=g=>g.startsWith("on")?!jy(g):d(g))}try{IE(require("@emotion/is-prop-valid").default)}catch{}function RE(d,g,T){const S={};for(const I in d)I==="values"&&typeof d.values=="object"||(P1(I)||T===!0&&jy(I)||!g&&!jy(I)||d.draggable&&I.startsWith("onDrag"))&&(S[I]=d[I]);return S}const Gy=Se.createContext({});function kE(d,g){if(Uy(d)){const{initial:T,animate:S}=d;return{initial:T===!1||og(T)?T:void 0,animate:og(S)?S:void 0}}return d.inherit!==!1?g:{}}function LE(d){const{initial:g,animate:T}=kE(d,Se.useContext(Gy));return Se.useMemo(()=>({initial:g,animate:T}),[wv(g),wv(T)])}function wv(d){return Array.isArray(d)?d.join(" "):d}const N0=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function I1(d,g,T){for(const S in g)!Ua(g[S])&&!u1(S,T)&&(d[S]=g[S])}function jE({transformTemplate:d},g){return Se.useMemo(()=>{const T=N0();return B0(T,g,d),Object.assign({},T.vars,T.style)},[g])}function BE(d,g){const T=d.style||{},S={};return I1(S,T,d),Object.assign(S,jE(d,g)),S}function OE(d,g){const T={},S=BE(d,g);return d.drag&&d.dragListener!==!1&&(T.draggable=!1,S.userSelect=S.WebkitUserSelect=S.WebkitTouchCallout="none",S.touchAction=d.drag===!0?"none":`pan-${d.drag==="x"?"y":"x"}`),d.tabIndex===void 0&&(d.onTap||d.onTapStart||d.whileTap)&&(T.tabIndex=0),T.style=S,T}const R1=()=>({...N0(),attrs:{}});function FE(d,g,T,S){const I=Se.useMemo(()=>{const B=R1();return h1(B,g,f1(S),d.transformTemplate,d.style),{...B.attrs,style:{...B.style}}},[g]);if(d.style){const B={};I1(B,d.style,d),I.style={...B,...I.style}}return I}const NE=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function V0(d){return typeof d!="string"||d.includes("-")?!1:!!(NE.indexOf(d)>-1||/[A-Z]/u.test(d))}function VE(d,g,T,{latestValues:S},I,B=!1,M){const V=(M??V0(d)?FE:OE)(g,S,I,d),X=RE(g,typeof d=="string",B),K=d!==Se.Fragment?{...X,...V,ref:T}:{},{children:te}=g,de=Se.useMemo(()=>Ua(te)?te.get():te,[te]);return Se.createElement(d,{...K,children:de})}function UE({scrapeMotionValuesFromProps:d,createRenderState:g},T,S,I){return{latestValues:GE(T,S,I,d),renderState:g()}}function GE(d,g,T,S){const I={},B=S(d,{});for(const de in B)I[de]=My(B[de]);let{initial:M,animate:c}=d;const V=Uy(d),X=i1(d);g&&X&&!V&&d.inherit!==!1&&(M===void 0&&(M=g.initial),c===void 0&&(c=g.animate));let K=T?T.initial===!1:!1;K=K||M===!1;const te=K?c:M;if(te&&typeof te!="boolean"&&!Vy(te)){const de=Array.isArray(te)?te:[te];for(let De=0;De<de.length;De++){const Ze=z0(d,de[De]);if(Ze){const{transitionEnd:xe,transition:le,...Xe}=Ze;for(const Ve in Xe){let Ue=Xe[Ve];if(Array.isArray(Ue)){const gt=K?Ue.length-1:0;Ue=Ue[gt]}Ue!==null&&(I[Ve]=Ue)}for(const Ve in xe)I[Ve]=xe[Ve]}}}return I}const k1=d=>(g,T)=>{const S=Se.useContext(Gy),I=Se.useContext(Ny),B=()=>UE(d,g,S,I);return T?B():h0(B)},qE=k1({scrapeMotionValuesFromProps:O0,createRenderState:N0}),ZE=k1({scrapeMotionValuesFromProps:p1,createRenderState:R1}),HE=Symbol.for("motionComponentSymbol");function $E(d,g,T){const S=Se.useRef(T);Se.useInsertionEffect(()=>{S.current=T});const I=Se.useRef(null);return Se.useCallback(B=>{B&&d.onMount?.(B),g&&(B?g.mount(B):g.unmount());const M=S.current;if(typeof M=="function")if(B){const c=M(B);typeof c=="function"&&(I.current=c)}else I.current?(I.current(),I.current=null):M(B);else M&&(M.current=B)},[g])}const L1=Se.createContext({});function Qm(d){return d&&typeof d=="object"&&Object.prototype.hasOwnProperty.call(d,"current")}function XE(d,g,T,S,I,B){const{visualElement:M}=Se.useContext(Gy),c=Se.useContext(D1),V=Se.useContext(Ny),X=Se.useContext(F0).reducedMotion,K=Se.useRef(null),te=Se.useRef(!1);S=S||c.renderer,!K.current&&S&&(K.current=S(d,{visualState:g,parent:M,props:T,presenceContext:V,blockInitialAnimation:V?V.initial===!1:!1,reducedMotionConfig:X,isSVG:B}),te.current&&K.current&&(K.current.manuallyAnimateOnMount=!0));const de=K.current,De=Se.useContext(L1);de&&!de.projection&&I&&(de.type==="html"||de.type==="svg")&&YE(K.current,T,I,De);const Ze=Se.useRef(!1);Se.useInsertionEffect(()=>{de&&Ze.current&&de.update(T,V)});const xe=T[Ub],le=Se.useRef(!!xe&&!window.MotionHandoffIsComplete?.(xe)&&window.MotionHasOptimisedAnimation?.(xe));return ab(()=>{te.current=!0,de&&(Ze.current=!0,window.MotionIsMounted=!0,de.updateFeatures(),de.scheduleRenderMicrotask(),le.current&&de.animationState&&de.animationState.animateChanges())}),Se.useEffect(()=>{de&&(!le.current&&de.animationState&&de.animationState.animateChanges(),le.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(xe)}),le.current=!1),de.enteringChildren=void 0)}),de}function YE(d,g,T,S){const{layoutId:I,layout:B,drag:M,dragConstraints:c,layoutScroll:V,layoutRoot:X,layoutCrossfade:K}=g;d.projection=new T(d.latestValues,g["data-framer-portal-id"]?void 0:j1(d.parent)),d.projection.setOptions({layoutId:I,layout:B,alwaysMeasureLayout:!!M||c&&Qm(c),visualElement:d,animationType:typeof B=="string"?B:"both",initialPromotionConfig:S,crossfade:K,layoutScroll:V,layoutRoot:X})}function j1(d){if(d)return d.options.allowProjection!==!1?d.projection:j1(d.parent)}function A_(d,{forwardMotionProps:g=!1,type:T}={},S,I){S&&zE(S);const B=T?T==="svg":V0(d),M=B?ZE:qE;function c(X,K){let te;const de={...Se.useContext(F0),...X,layoutId:WE(X)},{isStatic:De}=de,Ze=LE(X),xe=M(X,De);if(!De&&rb){KE();const le=QE(de);te=le.MeasureLayout,Ze.visualElement=XE(d,xe,de,I,le.ProjectionNode,B)}return R.jsxs(Gy.Provider,{value:Ze,children:[te&&Ze.visualElement?R.jsx(te,{visualElement:Ze.visualElement,...de}):null,VE(d,X,$E(xe,Ze.visualElement,K),xe,De,g,B)]})}c.displayName=`motion.${typeof d=="string"?d:`create(${d.displayName??d.name??""})`}`;const V=Se.forwardRef(c);return V[HE]=d,V}function WE({layoutId:d}){const g=Se.useContext(u0).id;return g&&d!==void 0?g+"-"+d:d}function KE(d,g){Se.useContext(D1).strict}function QE(d){const g=z1(),{drag:T,layout:S}=g;if(!T&&!S)return{};const I={...T,...S};return{MeasureLayout:T?.isEnabled(d)||S?.isEnabled(d)?I.MeasureLayout:void 0,ProjectionNode:I.ProjectionNode}}function JE(d,g){if(typeof Proxy>"u")return A_;const T=new Map,S=(B,M)=>A_(B,M,d,g),I=(B,M)=>S(B,M);return new Proxy(I,{get:(B,M)=>M==="create"?S:(T.has(M)||T.set(M,A_(M,void 0,d,g)),T.get(M))})}const eA=(d,g)=>g.isSVG??V0(d)?new IM(g):new EM(g,{allowProjection:d!==Se.Fragment});class tA extends qh{constructor(g){super(g),g.animationState||(g.animationState=BM(g))}updateAnimationControlsSubscription(){const{animate:g}=this.node.getProps();Vy(g)&&(this.unmountControls=g.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:g}=this.node.getProps(),{animate:T}=this.node.prevProps||{};g!==T&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let iA=0;class nA extends qh{constructor(){super(...arguments),this.id=iA++}update(){if(!this.node.presenceContext)return;const{isPresent:g,onExitComplete:T}=this.node.presenceContext,{isPresent:S}=this.node.prevPresenceContext||{};if(!this.node.animationState||g===S)return;const I=this.node.animationState.setActive("exit",!g);T&&!g&&I.then(()=>{T(this.id)})}mount(){const{register:g,onExitComplete:T}=this.node.presenceContext||{};T&&T(this.id),g&&(this.unmount=g(this.id))}unmount(){}}const rA={animation:{Feature:tA},exit:{Feature:nA}};function mg(d){return{point:{x:d.pageX,y:d.pageY}}}const aA=d=>g=>k0(g)&&d(g,mg(g));function ig(d,g,T,S){return lg(d,g,aA(T),S)}const B1=({current:d})=>d?d.ownerDocument.defaultView:null,Tv=(d,g)=>Math.abs(d-g);function sA(d,g){const T=Tv(d.x,g.x),S=Tv(d.y,g.y);return Math.sqrt(T**2+S**2)}const Sv=new Set(["auto","scroll"]);class O1{constructor(g,T,{transformPagePoint:S,contextWindow:I=window,dragSnapToOrigin:B=!1,distanceThreshold:M=3,element:c}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=De=>{this.handleScroll(De.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const De=D_(this.lastMoveEventInfo,this.history),Ze=this.startEvent!==null,xe=sA(De.offset,{x:0,y:0})>=this.distanceThreshold;if(!Ze&&!xe)return;const{point:le}=De,{timestamp:Xe}=_a;this.history.push({...le,timestamp:Xe});const{onStart:Ve,onMove:Ue}=this.handlers;Ze||(Ve&&Ve(this.lastMoveEvent,De),this.startEvent=this.lastMoveEvent),Ue&&Ue(this.lastMoveEvent,De)},this.handlePointerMove=(De,Ze)=>{this.lastMoveEvent=De,this.lastMoveEventInfo=C_(Ze,this.transformPagePoint),jn.update(this.updatePoint,!0)},this.handlePointerUp=(De,Ze)=>{this.end();const{onEnd:xe,onSessionEnd:le,resumeAnimation:Xe}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&Xe&&Xe(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const Ve=D_(De.type==="pointercancel"?this.lastMoveEventInfo:C_(Ze,this.transformPagePoint),this.history);this.startEvent&&xe&&xe(De,Ve),le&&le(De,Ve)},!k0(g))return;this.dragSnapToOrigin=B,this.handlers=T,this.transformPagePoint=S,this.distanceThreshold=M,this.contextWindow=I||window;const V=mg(g),X=C_(V,this.transformPagePoint),{point:K}=X,{timestamp:te}=_a;this.history=[{...K,timestamp:te}];const{onSessionStart:de}=T;de&&de(g,D_(X,this.history)),this.removeListeners=dg(ig(this.contextWindow,"pointermove",this.handlePointerMove),ig(this.contextWindow,"pointerup",this.handlePointerUp),ig(this.contextWindow,"pointercancel",this.handlePointerUp)),c&&this.startScrollTracking(c)}startScrollTracking(g){let T=g.parentElement;for(;T;){const S=getComputedStyle(T);(Sv.has(S.overflowX)||Sv.has(S.overflowY))&&this.scrollPositions.set(T,{x:T.scrollLeft,y:T.scrollTop}),T=T.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(g){const T=this.scrollPositions.get(g);if(!T)return;const S=g===window,I=S?{x:window.scrollX,y:window.scrollY}:{x:g.scrollLeft,y:g.scrollTop},B={x:I.x-T.x,y:I.y-T.y};B.x===0&&B.y===0||(S?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=B.x,this.lastMoveEventInfo.point.y+=B.y):this.history.length>0&&(this.history[0].x-=B.x,this.history[0].y-=B.y),this.scrollPositions.set(g,I),jn.update(this.updatePoint,!0))}updateHandlers(g){this.handlers=g}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Nh(this.updatePoint)}}function C_(d,g){return g?{point:g(d.point)}:d}function Mv(d,g){return{x:d.x-g.x,y:d.y-g.y}}function D_({point:d},g){return{point:d,delta:Mv(d,F1(g)),offset:Mv(d,oA(g)),velocity:lA(g,.1)}}function oA(d){return d[0]}function F1(d){return d[d.length-1]}function lA(d,g){if(d.length<2)return{x:0,y:0};let T=d.length-1,S=null;const I=F1(d);for(;T>=0&&(S=d[T],!(I.timestamp-S.timestamp>ku(g)));)T--;if(!S)return{x:0,y:0};const B=qo(I.timestamp-S.timestamp);if(B===0)return{x:0,y:0};const M={x:(I.x-S.x)/B,y:(I.y-S.y)/B};return M.x===1/0&&(M.x=0),M.y===1/0&&(M.y=0),M}function cA(d,{min:g,max:T},S){return g!==void 0&&d<g?d=S?Wn(g,d,S.min):Math.max(d,g):T!==void 0&&d>T&&(d=S?Wn(T,d,S.max):Math.min(d,T)),d}function Ev(d,g,T){return{min:g!==void 0?d.min+g:void 0,max:T!==void 0?d.max+T-(d.max-d.min):void 0}}function uA(d,{top:g,left:T,bottom:S,right:I}){return{x:Ev(d.x,T,I),y:Ev(d.y,g,S)}}function Av(d,g){let T=g.min-d.min,S=g.max-d.max;return g.max-g.min<d.max-d.min&&([T,S]=[S,T]),{min:T,max:S}}function hA(d,g){return{x:Av(d.x,g.x),y:Av(d.y,g.y)}}function dA(d,g){let T=.5;const S=ls(d),I=ls(g);return I>S?T=rg(g.min,g.max-S,d.min):S>I&&(T=rg(d.min,d.max-I,g.min)),Rc(0,1,T)}function fA(d,g){const T={};return g.min!==void 0&&(T.min=g.min-d.min),g.max!==void 0&&(T.max=g.max-d.min),T}const i0=.35;function pA(d=i0){return d===!1?d=0:d===!0&&(d=i0),{x:Cv(d,"left","right"),y:Cv(d,"top","bottom")}}function Cv(d,g,T){return{min:Dv(d,g),max:Dv(d,T)}}function Dv(d,g){return typeof d=="number"?d:d[g]||0}const mA=new WeakMap;class gA{constructor(g){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Lr(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=g}start(g,{snapToCursor:T=!1,distanceThreshold:S}={}){const{presenceContext:I}=this.visualElement;if(I&&I.isPresent===!1)return;const B=te=>{T?(this.stopAnimation(),this.snapToCursor(mg(te).point)):this.pauseAnimation()},M=(te,de)=>{this.stopAnimation();const{drag:De,dragPropagation:Ze,onDragStart:xe}=this.getProps();if(De&&!Ze&&(this.openDragLock&&this.openDragLock(),this.openDragLock=nM(De),!this.openDragLock))return;this.latestPointerEvent=te,this.latestPanInfo=de,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Go(Xe=>{let Ve=this.getAxisMotionValue(Xe).get()||0;if(zc.test(Ve)){const{projection:Ue}=this.visualElement;if(Ue&&Ue.layout){const gt=Ue.layout.layoutBox[Xe];gt&&(Ve=ls(gt)*(parseFloat(Ve)/100))}}this.originPoint[Xe]=Ve}),xe&&jn.postRender(()=>xe(te,de)),X_(this.visualElement,"transform");const{animationState:le}=this.visualElement;le&&le.setActive("whileDrag",!0)},c=(te,de)=>{this.latestPointerEvent=te,this.latestPanInfo=de;const{dragPropagation:De,dragDirectionLock:Ze,onDirectionLock:xe,onDrag:le}=this.getProps();if(!De&&!this.openDragLock)return;const{offset:Xe}=de;if(Ze&&this.currentDirection===null){this.currentDirection=yA(Xe),this.currentDirection!==null&&xe&&xe(this.currentDirection);return}this.updateAxis("x",de.point,Xe),this.updateAxis("y",de.point,Xe),this.visualElement.render(),le&&le(te,de)},V=(te,de)=>{this.latestPointerEvent=te,this.latestPanInfo=de,this.stop(te,de),this.latestPointerEvent=null,this.latestPanInfo=null},X=()=>Go(te=>this.getAnimationState(te)==="paused"&&this.getAxisMotionValue(te).animation?.play()),{dragSnapToOrigin:K}=this.getProps();this.panSession=new O1(g,{onSessionStart:B,onStart:M,onMove:c,onSessionEnd:V,resumeAnimation:X},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:K,distanceThreshold:S,contextWindow:B1(this.visualElement),element:this.visualElement.current})}stop(g,T){const S=g||this.latestPointerEvent,I=T||this.latestPanInfo,B=this.isDragging;if(this.cancel(),!B||!I||!S)return;const{velocity:M}=I;this.startAnimation(M);const{onDragEnd:c}=this.getProps();c&&jn.postRender(()=>c(S,I))}cancel(){this.isDragging=!1;const{projection:g,animationState:T}=this.visualElement;g&&(g.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:S}=this.getProps();!S&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),T&&T.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(g,T,S){const{drag:I}=this.getProps();if(!S||!vy(g,I,this.currentDirection))return;const B=this.getAxisMotionValue(g);let M=this.originPoint[g]+S[g];this.constraints&&this.constraints[g]&&(M=cA(M,this.constraints[g],this.elastic[g])),B.set(M)}resolveConstraints(){const{dragConstraints:g,dragElastic:T}=this.getProps(),S=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,I=this.constraints;g&&Qm(g)?this.constraints||(this.constraints=this.resolveRefConstraints()):g&&S?this.constraints=uA(S.layoutBox,g):this.constraints=!1,this.elastic=pA(T),I!==this.constraints&&S&&this.constraints&&!this.hasMutatedConstraints&&Go(B=>{this.constraints!==!1&&this.getAxisMotionValue(B)&&(this.constraints[B]=fA(S.layoutBox[B],this.constraints[B]))})}resolveRefConstraints(){const{dragConstraints:g,onMeasureDragConstraints:T}=this.getProps();if(!g||!Qm(g))return!1;const S=g.current,{projection:I}=this.visualElement;if(!I||!I.layout)return!1;const B=vM(S,I.root,this.visualElement.getTransformPagePoint());let M=hA(I.layout.layoutBox,B);if(T){const c=T(yM(M));this.hasMutatedConstraints=!!c,c&&(M=a1(c))}return M}startAnimation(g){const{drag:T,dragMomentum:S,dragElastic:I,dragTransition:B,dragSnapToOrigin:M,onDragTransitionEnd:c}=this.getProps(),V=this.constraints||{},X=Go(K=>{if(!vy(K,T,this.currentDirection))return;let te=V&&V[K]||{};M&&(te={min:0,max:0});const de=I?200:1e6,De=I?40:1e7,Ze={type:"inertia",velocity:S?g[K]:0,bounceStiffness:de,bounceDamping:De,timeConstant:750,restDelta:1,restSpeed:10,...B,...te};return this.startAxisValueAnimation(K,Ze)});return Promise.all(X).then(c)}startAxisValueAnimation(g,T){const S=this.getAxisMotionValue(g);return X_(this.visualElement,g),S.start(D0(g,S,0,T,this.visualElement,!1))}stopAnimation(){Go(g=>this.getAxisMotionValue(g).stop())}pauseAnimation(){Go(g=>this.getAxisMotionValue(g).animation?.pause())}getAnimationState(g){return this.getAxisMotionValue(g).animation?.state}getAxisMotionValue(g){const T=`_drag${g.toUpperCase()}`,S=this.visualElement.getProps(),I=S[T];return I||this.visualElement.getValue(g,(S.initial?S.initial[g]:void 0)||0)}snapToCursor(g){Go(T=>{const{drag:S}=this.getProps();if(!vy(T,S,this.currentDirection))return;const{projection:I}=this.visualElement,B=this.getAxisMotionValue(T);if(I&&I.layout){const{min:M,max:c}=I.layout.layoutBox[T],V=B.get()||0;B.set(g[T]-Wn(M,c,.5)+V)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:g,dragConstraints:T}=this.getProps(),{projection:S}=this.visualElement;if(!Qm(T)||!S||!this.constraints)return;this.stopAnimation();const I={x:0,y:0};Go(M=>{const c=this.getAxisMotionValue(M);if(c&&this.constraints!==!1){const V=c.get();I[M]=dA({min:V,max:V},this.constraints[M])}});const{transformTemplate:B}=this.visualElement.getProps();this.visualElement.current.style.transform=B?B({},""):"none",S.root&&S.root.updateScroll(),S.updateLayout(),this.resolveConstraints(),Go(M=>{if(!vy(M,g,null))return;const c=this.getAxisMotionValue(M),{min:V,max:X}=this.constraints[M];c.set(Wn(V,X,I[M]))})}addListeners(){if(!this.visualElement.current)return;mA.set(this.visualElement,this);const g=this.visualElement.current,T=ig(g,"pointerdown",V=>{const{drag:X,dragListener:K=!0}=this.getProps(),te=V.target,de=te!==g&&Jb(te);X&&K&&!de&&this.start(V)}),S=()=>{const{dragConstraints:V}=this.getProps();Qm(V)&&V.current&&(this.constraints=this.resolveRefConstraints())},{projection:I}=this.visualElement,B=I.addEventListener("measure",S);I&&!I.layout&&(I.root&&I.root.updateScroll(),I.updateLayout()),jn.read(S);const M=lg(window,"resize",()=>this.scalePositionWithinConstraints()),c=I.addEventListener("didUpdate",(({delta:V,hasLayoutChanged:X})=>{this.isDragging&&X&&(Go(K=>{const te=this.getAxisMotionValue(K);te&&(this.originPoint[K]+=V[K].translate,te.set(te.get()+V[K].translate))}),this.visualElement.render())}));return()=>{M(),T(),B(),c&&c()}}getProps(){const g=this.visualElement.getProps(),{drag:T=!1,dragDirectionLock:S=!1,dragPropagation:I=!1,dragConstraints:B=!1,dragElastic:M=i0,dragMomentum:c=!0}=g;return{...g,drag:T,dragDirectionLock:S,dragPropagation:I,dragConstraints:B,dragElastic:M,dragMomentum:c}}}function vy(d,g,T){return(g===!0||g===d)&&(T===null||T===d)}function yA(d,g=10){let T=null;return Math.abs(d.y)>g?T="y":Math.abs(d.x)>g&&(T="x"),T}class _A extends qh{constructor(g){super(g),this.removeGroupControls=Zo,this.removeListeners=Zo,this.controls=new gA(g)}mount(){const{dragControls:g}=this.node.getProps();g&&(this.removeGroupControls=g.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Zo}update(){const{dragControls:g}=this.node.getProps(),{dragControls:T}=this.node.prevProps||{};g!==T&&(this.removeGroupControls(),g&&(this.removeGroupControls=g.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const zv=d=>(g,T)=>{d&&jn.postRender(()=>d(g,T))};class xA extends qh{constructor(){super(...arguments),this.removePointerDownListener=Zo}onPointerDown(g){this.session=new O1(g,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:B1(this.node)})}createPanHandlers(){const{onPanSessionStart:g,onPanStart:T,onPan:S,onPanEnd:I}=this.node.getProps();return{onSessionStart:zv(g),onStart:zv(T),onMove:S,onEnd:(B,M)=>{delete this.session,I&&jn.postRender(()=>I(B,M))}}}mount(){this.removePointerDownListener=ig(this.node.current,"pointerdown",g=>this.onPointerDown(g))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let z_=!1;class vA extends Se.Component{componentDidMount(){const{visualElement:g,layoutGroup:T,switchLayoutGroup:S,layoutId:I}=this.props,{projection:B}=g;B&&(T.group&&T.group.add(B),S&&S.register&&I&&S.register(B),z_&&B.root.didUpdate(),B.addEventListener("animationComplete",()=>{this.safeToRemove()}),B.setOptions({...B.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),Ey.hasEverUpdated=!0}getSnapshotBeforeUpdate(g){const{layoutDependency:T,visualElement:S,drag:I,isPresent:B}=this.props,{projection:M}=S;return M&&(M.isPresent=B,g.layoutDependency!==T&&M.setOptions({...M.options,layoutDependency:T}),z_=!0,I||g.layoutDependency!==T||T===void 0||g.isPresent!==B?M.willUpdate():this.safeToRemove(),g.isPresent!==B&&(B?M.promote():M.relegate()||jn.postRender(()=>{const c=M.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:g}=this.props.visualElement;g&&(g.root.didUpdate(),R0.postRender(()=>{!g.currentAnimation&&g.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:g,layoutGroup:T,switchLayoutGroup:S}=this.props,{projection:I}=g;z_=!0,I&&(I.scheduleCheckAfterUnmount(),T&&T.group&&T.group.remove(I),S&&S.deregister&&S.deregister(I))}safeToRemove(){const{safeToRemove:g}=this.props;g&&g()}render(){return null}}function N1(d){const[g,T]=A1(),S=Se.useContext(u0);return R.jsx(vA,{...d,layoutGroup:S,switchLayoutGroup:Se.useContext(L1),isPresent:g,safeToRemove:T})}const bA={pan:{Feature:xA},drag:{Feature:_A,ProjectionNode:E1,MeasureLayout:N1}};function Pv(d,g,T){const{props:S}=d;d.animationState&&S.whileHover&&d.animationState.setActive("whileHover",T==="Start");const I="onHover"+T,B=S[I];B&&jn.postRender(()=>B(g,mg(g)))}class wA extends qh{mount(){const{current:g}=this.node;g&&(this.unmount=rM(g,(T,S)=>(Pv(this.node,S,"Start"),I=>Pv(this.node,I,"End"))))}unmount(){}}class TA extends qh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let g=!1;try{g=this.node.current.matches(":focus-visible")}catch{g=!0}!g||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=dg(lg(this.node.current,"focus",()=>this.onFocus()),lg(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Iv(d,g,T){const{props:S}=d;if(d.current instanceof HTMLButtonElement&&d.current.disabled)return;d.animationState&&S.whileTap&&d.animationState.setActive("whileTap",T==="Start");const I="onTap"+(T==="End"?"":T),B=S[I];B&&jn.postRender(()=>B(g,mg(g)))}class SA extends qh{mount(){const{current:g}=this.node;g&&(this.unmount=oM(g,(T,S)=>(Iv(this.node,S,"Start"),(I,{success:B})=>Iv(this.node,I,B?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const n0=new WeakMap,P_=new WeakMap,MA=d=>{const g=n0.get(d.target);g&&g(d)},EA=d=>{d.forEach(MA)};function AA({root:d,...g}){const T=d||document;P_.has(T)||P_.set(T,{});const S=P_.get(T),I=JSON.stringify(g);return S[I]||(S[I]=new IntersectionObserver(EA,{root:d,...g})),S[I]}function CA(d,g,T){const S=AA(g);return n0.set(d,T),S.observe(d),()=>{n0.delete(d),S.unobserve(d)}}const DA={some:0,all:1};class zA extends qh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:g={}}=this.node.getProps(),{root:T,margin:S,amount:I="some",once:B}=g,M={root:T?T.current:void 0,rootMargin:S,threshold:typeof I=="number"?I:DA[I]},c=V=>{const{isIntersecting:X}=V;if(this.isInView===X||(this.isInView=X,B&&!X&&this.hasEnteredView))return;X&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",X);const{onViewportEnter:K,onViewportLeave:te}=this.node.getProps(),de=X?K:te;de&&de(V)};return CA(this.node.current,M,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:g,prevProps:T}=this.node;["amount","margin","root"].some(PA(g,T))&&this.startObserver()}unmount(){}}function PA({viewport:d={}},{viewport:g={}}={}){return T=>d[T]!==g[T]}const IA={inView:{Feature:zA},tap:{Feature:SA},focus:{Feature:TA},hover:{Feature:wA}},RA={layout:{ProjectionNode:E1,MeasureLayout:N1}},kA={...rA,...IA,...bA,...RA},Ri=JE(kA,eA),V1={primary:"bg-primary text-white hover:bg-primary-600 focus:ring-primary/50 shadow-lg shadow-primary/25 hover:shadow-glow transition-all duration-300",secondary:"bg-secondary text-white hover:bg-secondary-600 focus:ring-secondary/50 shadow-lg shadow-secondary/25 hover:shadow-xl hover:shadow-secondary/30 transition-all duration-300",outline:"border border-primary/50 text-primary bg-primary/5 hover:bg-primary hover:text-white focus:ring-primary/50 dark:border-primary/40 dark:text-primary-400 dark:bg-primary/10 dark:hover:bg-primary dark:hover:text-white hover:shadow-glow-sm transition-all duration-300",ghost:"text-dark-600 dark:text-dark-300 hover:bg-dark-100 dark:hover:bg-dark-800 focus:ring-dark-500 transition-all duration-300"},U1={sm:"px-4 py-2 text-sm",md:"px-6 py-3 text-base",lg:"px-8 py-4 text-lg"},Ga=Se.forwardRef(({variant:d="primary",size:g="md",isLoading:T=!1,leftIcon:S,rightIcon:I,className:B="",children:M,...c},V)=>{const K=`
      inline-flex items-center justify-center font-medium rounded-lg
      transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2
      disabled:opacity-50 disabled:cursor-not-allowed
      dark:focus:ring-offset-dark-900
     ${V1[d]} ${U1[g]} ${B}`,te=R.jsxs(R.Fragment,{children:[T&&R.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[R.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),R.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!T&&S&&R.jsx("span",{className:"mr-2",children:S}),M,!T&&I&&R.jsx("span",{className:"ml-2",children:I})]});if(c.as==="link"){const{as:Ze,...xe}=c;return R.jsx(Ic,{ref:V,className:K,...xe,children:te})}const{as:de,...De}=c;return R.jsx("button",{ref:V,className:K,disabled:T,...De,children:te})});Ga.displayName="Button";const LA=Se.forwardRef(({variant:d="primary",size:g="md",isLoading:T=!1,leftIcon:S,rightIcon:I,className:B="",children:M,...c},V)=>{const K=`
      inline-flex items-center justify-center font-medium rounded-lg
      transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2
      disabled:opacity-50 disabled:cursor-not-allowed
     ${V1[d]} ${U1[g]} ${B}`;return R.jsxs(Ri.button,{ref:V,className:K,whileHover:{scale:1.02},whileTap:{scale:.98},disabled:T,...c,children:[T&&R.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[R.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),R.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!T&&S&&R.jsx("span",{className:"mr-2",children:S}),M,!T&&I&&R.jsx("span",{className:"ml-2",children:I})]})});LA.displayName="AnimatedButton";const jA={sm:"max-w-3xl",md:"max-w-5xl",lg:"max-w-7xl",xl:"max-w-[90rem]",full:"max-w-full"},Uh=Se.forwardRef(({size:d="lg",className:g="",children:T,...S},I)=>R.jsx("div",{ref:I,className:`${jA[d]} mx-auto px-4 sm:px-6 lg:px-8 ${g}`,...S,children:T}));Uh.displayName="Container";const BA={none:"",sm:"py-8 md:py-12",md:"py-12 md:py-20",lg:"py-16 md:py-24 lg:py-32",xl:"py-20 md:py-32 lg:py-40"},OA={default:"bg-white dark:bg-dark-900",alt:"bg-dark-50 dark:bg-dark-800/30",dark:"bg-dark-900 text-white",gradient:"bg-gradient-to-br from-primary/5 via-white to-transparent dark:from-primary/10 dark:via-dark-900 dark:to-dark-800","subtle-gradient":"gradient-bg-subtle"},gr=Se.forwardRef(({containerSize:d="lg",padding:g="lg",background:T="default",className:S="",children:I,...B},M)=>R.jsx("section",{ref:M,className:`relative overflow-hidden ${BA[g]} ${OA[T]} ${S}`,...B,children:R.jsx(Uh,{size:d,children:I})}));gr.displayName="Section";function Bu({label:d,title:g,description:T,align:S="center",className:I="",accentLine:B=!1}){const M={left:"text-left",center:"text-center mx-auto",right:"text-right ml-auto"};return R.jsxs("div",{className:`max-w-3xl mb-12 md:mb-16 ${M[S]} ${I}`,children:[d&&!B&&R.jsxs("span",{className:"inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-primary/10 dark:bg-primary/20 text-primary dark:text-primary-400 text-sm font-medium mb-6",children:[R.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-primary dark:bg-primary-400"}),d]}),d&&B&&R.jsxs("div",{className:`flex items-center gap-4 mb-6 ${S==="center"?"justify-center":S==="right"?"justify-end":""}`,children:[R.jsx("div",{className:"h-px w-12 bg-gradient-to-r from-primary to-secondary"}),R.jsx("span",{className:"text-dark-500 dark:text-dark-400 text-sm font-medium tracking-wider uppercase",children:d}),S==="center"&&R.jsx("div",{className:"h-px w-12 bg-gradient-to-l from-primary to-secondary"})]}),R.jsx("h2",{className:"heading-2 text-dark-900 dark:text-white mb-4 text-balance",children:g}),T&&R.jsx("p",{className:"text-lg md:text-xl text-dark-500 dark:text-dark-400 leading-relaxed text-balance",children:T})]})}const G1={default:"bg-white dark:bg-dark-800 shadow-lg shadow-black/5 dark:shadow-black/20",elevated:"bg-white dark:bg-dark-800 shadow-xl shadow-black/10 dark:shadow-black/30",bordered:"bg-white dark:bg-dark-800/80 border border-dark-200 dark:border-dark-700 hover:border-primary/30 dark:hover:border-primary/40 transition-all duration-300",glass:"bg-white/70 dark:bg-dark-800/60 backdrop-blur-xl border border-white/20 dark:border-white/5",premium:"bg-white dark:bg-dark-800/90 border border-dark-200 dark:border-dark-700/50 shadow-premium hover:shadow-premium-hover transition-all duration-300"},q1={none:"",sm:"p-4",md:"p-6",lg:"p-8"},FA=Se.forwardRef(({variant:d="default",hover:g=!1,padding:T="md",className:S="",children:I,...B},M)=>{const c=g?"transition-all duration-300 hover:shadow-premium-hover hover:-translate-y-1":"";return R.jsx("div",{ref:M,className:`rounded-2xl ${G1[d]} ${q1[T]} ${c} ${S}`,...B,children:I})});FA.displayName="Card";const NA=Se.forwardRef(({variant:d="default",padding:g="md",className:T="",children:S,hoverGlow:I=!0,...B},M)=>R.jsx(Ri.div,{ref:M,className:`rounded-2xl ${G1[d]} ${q1[g]} ${T}`,whileHover:{y:-4,boxShadow:I?"0 20px 40px -15px rgba(35, 122, 189, 0.15), 0 10px 20px -10px rgba(0, 0, 0, 0.1)":"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},transition:{duration:.25,ease:[.25,.1,.25,1]},...B,children:S}));NA.displayName="AnimatedCard";function wn({name:d,size:g=24,className:T="",...S}){const I=typeof g=="number"?`${g}px`:g,M={location:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),analytics:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"}),shield:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"}),fuel:R.jsx(R.Fragment,{children:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),bell:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"}),check:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}),arrow:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"}),arrowRight:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"}),menu:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"}),close:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}),sun:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"}),moon:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"}),truck:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"}),chart:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"}),users:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"}),globe:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"}),play:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),calendar:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"}),phone:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"}),mail:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"}),puzzle:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H6a1 1 0 01-1-1v-3a1 1 0 00-1-1H3a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z"}),code:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"}),user:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"}),settings:R.jsxs(R.Fragment,{children:[R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}[d];return M?R.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",style:{width:I,height:I},className:T,...S,children:M}):(console.warn(`Icon "${d}" not found`),null)}const VA={primary:"from-primary-500 via-primary-400 to-primary-600",secondary:"from-secondary-500 via-secondary-400 to-secondary-600",mixed:"from-primary-500 via-primary-300 to-secondary-500"},UA=d=>({float:{animate:{y:[0,-30,0],x:[0,15,0],scale:[1,1.05,1],opacity:d,transition:{duration:6,repeat:1/0,ease:"easeInOut"}}},"float-slow":{animate:{y:[0,-20,10,0],x:[0,20,-10,0],scale:[1,1.08,.95,1],opacity:d,transition:{duration:10,repeat:1/0,ease:"easeInOut"}}},"float-delayed":{animate:{y:[0,20,-15,0],x:[0,-15,25,0],rotate:[0,5,-3,0],opacity:d,transition:{duration:8,repeat:1/0,ease:"easeInOut"}}},pulse:{animate:{scale:[1,1.1,1],opacity:[d*.6,d,d*.6],transition:{duration:4,repeat:1/0,ease:"easeInOut"}}},none:{animate:{opacity:d}}});function xa({size:d=400,color:g="primary",top:T,left:S,right:I,bottom:B,opacity:M=.4,blur:c=80,animation:V="float",delay:X=0,className:K=""}){const te={position:"absolute",width:d,height:d,filter:`blur(${c}px)`,pointerEvents:"none",...T!==void 0&&{top:T},...S!==void 0&&{left:S},...I!==void 0&&{right:I},...B!==void 0&&{bottom:B}},de=UA(M)[V];return R.jsx(Ri.div,{className:`rounded-full bg-gradient-radial ${VA[g]} ${K}`,style:te,initial:{opacity:0,scale:.8},animate:"animate",variants:de,transition:{delay:X}})}const Wm={primary:"stroke-primary-500 fill-none",secondary:"stroke-secondary-500 fill-none",gradient:"stroke-[url(#gradient-accent)] fill-none",muted:"stroke-dark-400 dark:stroke-dark-600 fill-none"};function Ay({shape:d="square",size:g=60,top:T,left:S,right:I,bottom:B,rotate:M=0,opacity:c=.15,color:V="primary",animate:X=!0,delay:K=0,className:te=""}){const de={position:"absolute",width:g,height:g,opacity:c,pointerEvents:"none",transform:`rotate(${M}deg)`,...T!==void 0&&{top:T},...S!==void 0&&{left:S},...I!==void 0&&{right:I},...B!==void 0&&{bottom:B}},De=Math.max(1,g/30),Ze=()=>{switch(d){case"square":return R.jsxs("svg",{viewBox:"0 0 100 100",className:`w-full h-full ${Wm[V]}`,children:[R.jsx("defs",{children:R.jsxs("linearGradient",{id:"gradient-accent",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[R.jsx("stop",{offset:"0%",stopColor:"#237ABD"}),R.jsx("stop",{offset:"100%",stopColor:"#f39536"})]})}),R.jsx("rect",{x:"10",y:"10",width:"80",height:"80",rx:"8",strokeWidth:De})]});case"arc":return R.jsxs("svg",{viewBox:"0 0 100 100",className:`w-full h-full ${Wm[V]}`,children:[R.jsx("defs",{children:R.jsxs("linearGradient",{id:"gradient-accent",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[R.jsx("stop",{offset:"0%",stopColor:"#237ABD"}),R.jsx("stop",{offset:"100%",stopColor:"#f39536"})]})}),R.jsx("path",{d:"M 20 80 A 60 60 0 0 1 80 20",strokeWidth:De,strokeLinecap:"round"})]});case"corner":return R.jsxs("svg",{viewBox:"0 0 100 100",className:`w-full h-full ${Wm[V]}`,children:[R.jsx("defs",{children:R.jsxs("linearGradient",{id:"gradient-accent",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[R.jsx("stop",{offset:"0%",stopColor:"#237ABD"}),R.jsx("stop",{offset:"100%",stopColor:"#f39536"})]})}),R.jsx("path",{d:"M 20 80 L 20 20 L 80 20",strokeWidth:De,strokeLinecap:"round",strokeLinejoin:"round"})]});case"line":return R.jsxs("svg",{viewBox:"0 0 100 100",className:`w-full h-full ${Wm[V]}`,children:[R.jsx("defs",{children:R.jsxs("linearGradient",{id:"gradient-accent",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[R.jsx("stop",{offset:"0%",stopColor:"#237ABD"}),R.jsx("stop",{offset:"100%",stopColor:"#f39536"})]})}),R.jsx("line",{x1:"10",y1:"50",x2:"90",y2:"50",strokeWidth:De,strokeLinecap:"round"})]});case"dots":return R.jsxs("svg",{viewBox:"0 0 100 100",className:`w-full h-full ${Wm[V]}`,children:[R.jsx("defs",{children:R.jsxs("linearGradient",{id:"gradient-accent",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[R.jsx("stop",{offset:"0%",stopColor:"#237ABD"}),R.jsx("stop",{offset:"100%",stopColor:"#f39536"})]})}),R.jsx("circle",{cx:"20",cy:"50",r:"6",className:"fill-current stroke-none"}),R.jsx("circle",{cx:"50",cy:"50",r:"6",className:"fill-current stroke-none"}),R.jsx("circle",{cx:"80",cy:"50",r:"6",className:"fill-current stroke-none"})]});default:return null}};return X?R.jsx(Ri.div,{style:de,className:te,initial:{opacity:0,scale:.8},animate:{opacity:c,scale:1},transition:{duration:.8,delay:K,ease:"easeOut"},children:Ze()}):R.jsx("div",{style:de,className:te,children:Ze()})}function Z1({variant:d="full",className:g="",...T}){return d==="mark"?R.jsx("img",{src:"/images/cypherFuel-logo.png",alt:"CypherFuel",className:g,...T}):R.jsx("img",{src:"/images/cypherFuel-logo.png",alt:"CypherFuel",className:g,...T})}const Rv=[{name:"Features",path:"/features"}];function GA(){const[d,g]=Se.useState(!1),[T,S]=Se.useState(!1),I=Gh();return Se.useEffect(()=>{const B=()=>{S(window.scrollY>10)};return window.addEventListener("scroll",B,{passive:!0}),()=>window.removeEventListener("scroll",B)},[]),Se.useEffect(()=>{g(!1)},[I]),R.jsxs("header",{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${T?"bg-dark-900/95 backdrop-blur-md border-b border-dark-700/50":"bg-transparent"}`,children:[R.jsx(Uh,{children:R.jsxs("nav",{className:"flex items-center justify-between h-16 md:h-20",children:[R.jsx(Ic,{to:"/",className:"flex items-center",children:R.jsx(Z1,{className:"h-8 md:h-10"})}),R.jsx("div",{className:"hidden md:flex items-center gap-8",children:Rv.map(B=>R.jsx(k_,{to:B.path,className:({isActive:M})=>`text-sm font-medium transition-colors link-underline ${M?"text-primary-400":"text-dark-300 hover:text-primary-400"}`,children:B.name},B.path))}),R.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[R.jsx("a",{href:"https://app.cypherfuel.net",className:"text-sm font-medium text-dark-300 hover:text-primary-400 transition-colors",children:"Login"}),R.jsx(Ga,{as:"link",to:"/schedule-demo",size:"sm",children:"Schedule Demo"})]}),R.jsx("div",{className:"flex md:hidden items-center gap-2",children:R.jsx("button",{onClick:()=>g(!d),className:"p-2 rounded-lg text-dark-300 hover:bg-dark-800 transition-colors","aria-label":"Toggle menu",children:R.jsx(wn,{name:d?"close":"menu",size:24})})})]})}),R.jsx(C1,{children:d&&R.jsx(Ri.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"md:hidden bg-dark-900 border-t border-dark-700/50",children:R.jsx(Uh,{children:R.jsxs("div",{className:"py-4 space-y-4",children:[Rv.map(B=>R.jsx(k_,{to:B.path,className:({isActive:M})=>`block py-2 text-base font-medium transition-colors ${M?"text-primary-400":"text-dark-300"}`,children:B.name},B.path)),R.jsxs("div",{className:"pt-4 border-t border-dark-700/50 space-y-3",children:[R.jsx("a",{href:"https://app.cypherfuel.net",className:"block py-2 text-base font-medium text-dark-300 hover:text-primary-400 transition-colors",children:"Login"}),R.jsx(Ga,{as:"link",to:"/schedule-demo",className:"w-full",children:"Schedule Demo"})]})]})})})})]})}const qA={product:{title:"Product",links:[{name:"Features",path:"/features"},{name:"Performance Dashboard",path:"/features/performance-dashboard"},{name:"Fuel Efficiency Scoring",path:"/features/fuel-efficiency-scoring"},{name:"Trip Analytics",path:"/features/trip-analytics"}]},company:{title:"Company",links:[{name:"Contact",path:"/schedule-demo"}]},resources:{title:"Resources",links:[{name:"Documentation",path:"#"},{name:"API Reference",path:"#"},{name:"Support",path:"#"}]},legal:{title:"Legal",links:[{name:"Privacy Policy",path:"/privacy"},{name:"Terms of Service",path:"/terms"}]}},ZA=[{name:"LinkedIn",icon:"globe",href:"#"},{name:"Twitter",icon:"globe",href:"#"},{name:"GitHub",icon:"globe",href:"#"}];function HA(){return R.jsx("footer",{className:"bg-dark-900 text-white border-t border-dark-800",children:R.jsxs(Uh,{children:[R.jsx("div",{className:"py-16 md:py-20",children:R.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-8",children:[R.jsxs("div",{className:"col-span-2",children:[R.jsx(Z1,{className:"h-10 mb-6"}),R.jsx("p",{className:"text-dark-400 text-sm mb-8 max-w-xs leading-relaxed",children:"Fuel optimization platform enabling fleet owners to monitor and improve vehicle fuel consumption through data-driven insights."}),R.jsx("div",{className:"flex gap-3",children:ZA.map(d=>R.jsx("a",{href:d.href,className:"w-10 h-10 rounded-lg bg-dark-800/80 border border-dark-700/50 flex items-center justify-center text-dark-400 hover:bg-primary hover:text-white hover:border-primary transition-all duration-300","aria-label":d.name,children:R.jsx(wn,{name:d.icon,size:18})},d.name))})]}),Object.values(qA).map(d=>R.jsxs("div",{children:[R.jsx("h3",{className:"font-semibold text-white mb-5 text-sm tracking-wide uppercase",children:d.title}),R.jsx("ul",{className:"space-y-3",children:d.links.map(g=>R.jsx("li",{children:R.jsx(Ic,{to:g.path,className:"text-sm text-dark-400 hover:text-primary-400 transition-colors",children:g.name})},g.name))})]},d.title))]})}),R.jsx("div",{className:"py-10 border-t border-dark-800",children:R.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[R.jsxs("div",{children:[R.jsx("h3",{className:"font-semibold text-white mb-1",children:"Stay updated"}),R.jsx("p",{className:"text-sm text-dark-400",children:"Get the latest fuel optimization insights delivered to your inbox."})]}),R.jsxs("form",{className:"flex gap-3 w-full md:w-auto",onSubmit:d=>d.preventDefault(),children:[R.jsx("input",{type:"email",placeholder:"Enter your email",className:"flex-1 md:w-64 px-4 py-3 rounded-lg bg-dark-800/80 border border-dark-700/50 text-white placeholder-dark-500 focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/20 transition-all"}),R.jsx("button",{type:"submit",className:"px-6 py-3 bg-primary text-white rounded-lg font-medium hover:bg-primary-600 hover:shadow-glow-sm transition-all duration-300",children:"Subscribe"})]})]})}),R.jsxs("div",{className:"py-8 border-t border-dark-800 flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-dark-500",children:[R.jsxs("p",{children:[" ",new Date().getFullYear()," CypherFuel. All rights reserved."]}),R.jsx("div",{className:"flex items-center gap-4",children:R.jsxs("span",{className:"flex items-center gap-2",children:[R.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),"All systems operational"]})})]})]})})}function $A(){return R.jsxs("div",{className:"min-h-screen flex flex-col bg-dark-900 text-dark-100",children:[R.jsx(GA,{}),R.jsx("main",{className:"flex-1 pt-16 md:pt-20",children:R.jsx(x2,{})}),R.jsx(HA,{})]})}var Cy={exports:{}};var XA=Cy.exports,kv;function YA(){return kv||(kv=1,(function(d,g){(function(T,S){d.exports=S()})(XA,(function(){var T={},S={};function I(M,c,V){if(S[M]=V,M==="index"){var X="var sharedModule = {}; ("+S.shared+")(sharedModule); ("+S.worker+")(sharedModule);",K={};return S.shared(K),S.index(T,K),typeof window<"u"&&T.setWorkerUrl(window.URL.createObjectURL(new Blob([X],{type:"text/javascript"}))),T}}I("shared",["exports"],(function(M){function c(n,e,i,o){return new(i||(i=Promise))((function(u,p){function m(C){try{w(o.next(C))}catch(P){p(P)}}function v(C){try{w(o.throw(C))}catch(P){p(P)}}function w(C){var P;C.done?u(C.value):(P=C.value,P instanceof i?P:new i((function(L){L(P)}))).then(m,v)}w((o=o.apply(n,e||[])).next())}))}function V(n,e){this.x=n,this.y=e}function X(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var K,te;typeof SuppressedError=="function"&&SuppressedError,V.prototype={clone(){return new V(this.x,this.y)},add(n){return this.clone()._add(n)},sub(n){return this.clone()._sub(n)},multByPoint(n){return this.clone()._multByPoint(n)},divByPoint(n){return this.clone()._divByPoint(n)},mult(n){return this.clone()._mult(n)},div(n){return this.clone()._div(n)},rotate(n){return this.clone()._rotate(n)},rotateAround(n,e){return this.clone()._rotateAround(n,e)},matMult(n){return this.clone()._matMult(n)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(n){return this.x===n.x&&this.y===n.y},dist(n){return Math.sqrt(this.distSqr(n))},distSqr(n){const e=n.x-this.x,i=n.y-this.y;return e*e+i*i},angle(){return Math.atan2(this.y,this.x)},angleTo(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith(n){return this.angleWithSep(n.x,n.y)},angleWithSep(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult(n){const e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add(n){return this.x+=n.x,this.y+=n.y,this},_sub(n){return this.x-=n.x,this.y-=n.y,this},_mult(n){return this.x*=n,this.y*=n,this},_div(n){return this.x/=n,this.y/=n,this},_multByPoint(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint(n){return this.x/=n.x,this.y/=n.y,this},_unit(){return this._div(this.mag()),this},_perp(){const n=this.y;return this.y=this.x,this.x=-n,this},_rotate(n){const e=Math.cos(n),i=Math.sin(n),o=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=o,this},_rotateAround(n,e){const i=Math.cos(n),o=Math.sin(n),u=e.y+o*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-o*(this.y-e.y),this.y=u,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:V},V.convert=function(n){if(n instanceof V)return n;if(Array.isArray(n))return new V(+n[0],+n[1]);if(n.x!==void 0&&n.y!==void 0)return new V(+n.x,+n.y);throw new Error("Expected [x, y] or {x, y} point format")};var de=(function(){if(te)return K;function n(e,i,o,u){this.cx=3*e,this.bx=3*(o-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(u-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=i,this.p2x=o,this.p2y=u}return te=1,K=n,n.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,i){if(i===void 0&&(i=1e-6),e<0)return 0;if(e>1)return 1;for(var o=e,u=0;u<8;u++){var p=this.sampleCurveX(o)-e;if(Math.abs(p)<i)return o;var m=this.sampleCurveDerivativeX(o);if(Math.abs(m)<1e-6)break;o-=p/m}var v=0,w=1;for(o=e,u=0;u<20&&(p=this.sampleCurveX(o),!(Math.abs(p-e)<i));u++)e>p?v=o:w=o,o=.5*(w-v)+v;return o},solve:function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))}},K})(),De=X(de);let Ze,xe;function le(){return Ze==null&&(Ze=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ze}function Xe(){if(xe==null&&(xe=!1,le())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let o=0;o<25;o++){const u=4*o;e.fillStyle=`rgb(${u},${u+1},${u+2})`,e.fillRect(o%5,Math.floor(o/5),1,1)}const i=e.getImageData(0,0,5,5).data;for(let o=0;o<100;o++)if(o%4!=3&&i[o]!==o){xe=!0;break}}}return xe||!1}var Ve=1e-6,Ue=typeof Float32Array<"u"?Float32Array:Array;function gt(){var n=new Ue(9);return Ue!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function pt(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Dt(){var n=new Ue(3);return Ue!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function _t(n){var e=n[0],i=n[1],o=n[2];return Math.sqrt(e*e+i*i+o*o)}function Mt(n,e,i){var o=new Ue(3);return o[0]=n,o[1]=e,o[2]=i,o}function Ot(n,e,i){return n[0]=e[0]+i[0],n[1]=e[1]+i[1],n[2]=e[2]+i[2],n}function si(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n}function Gi(n,e,i){var o=e[0],u=e[1],p=e[2],m=i[0],v=i[1],w=i[2];return n[0]=u*w-p*v,n[1]=p*m-o*w,n[2]=o*v-u*m,n}var ki,Bn=_t;function yr(n,e,i){var o=e[0],u=e[1],p=e[2],m=e[3];return n[0]=i[0]*o+i[4]*u+i[8]*p+i[12]*m,n[1]=i[1]*o+i[5]*u+i[9]*p+i[13]*m,n[2]=i[2]*o+i[6]*u+i[10]*p+i[14]*m,n[3]=i[3]*o+i[7]*u+i[11]*p+i[15]*m,n}function On(){var n=new Ue(4);return Ue!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function Je(n,e,i,o){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",p=Math.PI/360;e*=p,o*=p,i*=p;var m=Math.sin(e),v=Math.cos(e),w=Math.sin(i),C=Math.cos(i),P=Math.sin(o),L=Math.cos(o);switch(u){case"xyz":n[0]=m*C*L+v*w*P,n[1]=v*w*L-m*C*P,n[2]=v*C*P+m*w*L,n[3]=v*C*L-m*w*P;break;case"xzy":n[0]=m*C*L-v*w*P,n[1]=v*w*L-m*C*P,n[2]=v*C*P+m*w*L,n[3]=v*C*L+m*w*P;break;case"yxz":n[0]=m*C*L+v*w*P,n[1]=v*w*L-m*C*P,n[2]=v*C*P-m*w*L,n[3]=v*C*L+m*w*P;break;case"yzx":n[0]=m*C*L+v*w*P,n[1]=v*w*L+m*C*P,n[2]=v*C*P-m*w*L,n[3]=v*C*L-m*w*P;break;case"zxy":n[0]=m*C*L-v*w*P,n[1]=v*w*L+m*C*P,n[2]=v*C*P+m*w*L,n[3]=v*C*L-m*w*P;break;case"zyx":n[0]=m*C*L-v*w*P,n[1]=v*w*L+m*C*P,n[2]=v*C*P-m*w*L,n[3]=v*C*L+m*w*P;break;default:throw new Error("Unknown angle order "+u)}return n}function at(){var n=new Ue(2);return Ue!=Float32Array&&(n[0]=0,n[1]=0),n}function Pt(n,e){var i=new Ue(2);return i[0]=n,i[1]=e,i}Dt(),ki=new Ue(4),Ue!=Float32Array&&(ki[0]=0,ki[1]=0,ki[2]=0,ki[3]=0),Dt(),Mt(1,0,0),Mt(0,1,0),On(),On(),gt(),at();const It=8192;function ni(n,e,i){return e*(It/(n.tileSize*Math.pow(2,i-n.tileID.overscaledZ)))}function Ee(n,e){return(n%e+e)%e}function ot(n,e,i){return n*(1-i)+e*i}function St(n){if(n<=0)return 0;if(n>=1)return 1;const e=n*n,i=e*n;return 4*(n<.5?i:3*(n-e)+i-.75)}function zt(n,e,i,o){const u=new De(n,e,i,o);return p=>u.solve(p)}const Ht=zt(.25,.1,.25,1);function Nt(n,e,i){return Math.min(i,Math.max(e,n))}function hi(n,e,i){const o=i-e,u=((n-e)%o+o)%o+e;return u===e?i:u}function Li(n,...e){for(const i of e)for(const o in i)n[o]=i[o];return n}let Xi=1;function va(n,e,i){const o={};for(const u in n)o[u]=e.call(this,n[u],u,n);return o}function Kr(n,e,i){const o={};for(const u in n)e.call(this,n[u],u,n)&&(o[u]=n[u]);return o}function Qr(n){return Array.isArray(n)?n.map(Qr):typeof n=="object"&&n?va(n,Qr):n}const kc={};function sn(n){kc[n]||(typeof console<"u"&&console.warn(n),kc[n]=!0)}function jr(n,e,i){return(i.y-n.y)*(e.x-n.x)>(e.y-n.y)*(i.x-n.x)}function Jr(n){return typeof WorkerGlobalScope<"u"&&n!==void 0&&n instanceof WorkerGlobalScope}let on=null;function cs(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap}const ho="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function fo(n,e,i,o,u){return c(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const p=new VideoFrame(n,{timestamp:0});try{const m=p?.format;if(!m||!m.startsWith("BGR")&&!m.startsWith("RGB"))throw new Error(`Unrecognized format ${m}`);const v=m.startsWith("BGR"),w=new Uint8ClampedArray(o*u*4);if(yield p.copyTo(w,(function(C,P,L,O,F){const q=4*Math.max(-P,0),Z=(Math.max(0,L)-L)*O*4+q,$=4*O,ee=Math.max(0,P),ue=Math.max(0,L);return{rect:{x:ee,y:ue,width:Math.min(C.width,P+O)-ee,height:Math.min(C.height,L+F)-ue},layout:[{offset:Z,stride:$}]}})(n,e,i,o,u)),v)for(let C=0;C<w.length;C+=4){const P=w[C];w[C]=w[C+2],w[C+2]=P}return w}finally{p.close()}}))}let ba,Os;function $o(n,e,i,o){return n.addEventListener(e,i,o),{unsubscribe:()=>{n.removeEventListener(e,i,o)}}}function Qn(n){return n*Math.PI/180}function ea(n){return n/Math.PI*180}const Fs={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Nl={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Ns="AbortError";class Vl extends Error{constructor(e=Ns){super(e instanceof Error?e.message:e),this.name=Ns,e instanceof Error&&e.stack&&(this.stack=e.stack)}}function Ce(n){return n.name===Ns}const Y={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function W(n){return Y.REGISTERED_PROTOCOLS[n.substring(0,n.indexOf("://"))]}const J="global-dispatcher";class pe extends Error{constructor(e,i,o,u){super(`AJAXError: ${i} (${e}): ${o}`),this.status=e,this.statusText=i,this.url=o,this.body=u}}const ve=()=>Jr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Pe=function(n,e){if(/:\/\//.test(n.url)&&!/^https?:|^file:/.test(n.url)){const o=W(n.url);if(o)return o(n,e);if(Jr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,targetMapId:J},e)}if(!(/^file:/.test(i=n.url)||/^file:/.test(ve())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(o,u){return c(this,void 0,void 0,(function*(){const p=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,cache:o.cache,referrer:ve(),signal:u.signal});let m,v;o.type!=="json"||p.headers.has("Accept")||p.headers.set("Accept","application/json");try{m=yield fetch(p)}catch(C){throw Ce(C)?C:new pe(0,C.message,o.url,new Blob)}if(!m.ok){const C=yield m.blob();throw new pe(m.status,m.statusText,o.url,C)}v=o.type==="arrayBuffer"||o.type==="image"?m.arrayBuffer():o.type==="json"?m.json():m.text();const w=yield v;return u.signal.throwIfAborted(),{data:w,cacheControl:m.headers.get("Cache-Control"),expires:m.headers.get("Expires")}}))})(n,e);if(Jr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,mustQueue:!0,targetMapId:J},e)}var i;return(function(o,u){return new Promise(((p,m)=>{var v;const w=new XMLHttpRequest;w.open(o.method||"GET",o.url,!0),o.type!=="arrayBuffer"&&o.type!=="image"||(w.responseType="arraybuffer");for(const C in o.headers)w.setRequestHeader(C,o.headers[C]);o.type==="json"&&(w.responseType="text",!((v=o.headers)===null||v===void 0)&&v.Accept||w.setRequestHeader("Accept","application/json")),w.withCredentials=o.credentials==="include",w.onerror=()=>{m(new Error(w.statusText))},w.onload=()=>{if(!u.signal.aborted)if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){let C=w.response;if(o.type==="json")try{C=JSON.parse(w.response)}catch(P){return void m(P)}p({data:C,cacheControl:w.getResponseHeader("Cache-Control"),expires:w.getResponseHeader("Expires")})}else{const C=new Blob([w.response],{type:w.getResponseHeader("Content-Type")});m(new pe(w.status,w.statusText,o.url,C))}},u.signal.addEventListener("abort",(()=>{w.abort(),m(new Vl(u.signal.reason))})),w.send(o.body)}))})(n,e)};function ke(n){if(!n||n.indexOf("://")<=0||n.indexOf("data:image/")===0||n.indexOf("blob:")===0)return!0;const e=new URL(n),i=window.location;return e.protocol===i.protocol&&e.host===i.host}function ze(n,e,i){i[n]&&i[n].indexOf(e)!==-1||(i[n]=i[n]||[],i[n].push(e))}function Re(n,e,i){if(i&&i[n]){const o=i[n].indexOf(e);o!==-1&&i[n].splice(o,1)}}class nt{constructor(e,i={}){Li(this,i),this.type=e}}class $e extends nt{constructor(e,i={}){super("error",Li({error:e},i))}}class lt{on(e,i){return this._listeners=this._listeners||{},ze(e,i,this._listeners),{unsubscribe:()=>{this.off(e,i)}}}off(e,i){return Re(e,i,this._listeners),Re(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},ze(e,i,this._oneTimeListeners),this):new Promise((o=>this.once(e,o)))}fire(e,i){typeof e=="string"&&(e=new nt(e,i||{}));const o=e.type;if(this.listens(o)){e.target=this;const u=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const v of u)v.call(this,e);const p=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const v of p)Re(o,v,this._oneTimeListeners),v.call(this,e);const m=this._eventedParent;m&&(Li(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),m.fire(e))}else e instanceof $e&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var Te={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const Ut=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function wi(n,e){const i={};for(const o in n)o!=="ref"&&(i[o]=n[o]);return Ut.forEach((o=>{o in e&&(i[o]=e[o])})),i}function At(n,e){if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let i=0;i<n.length;i++)if(!At(n[i],e[i]))return!1;return!0}if(typeof n=="object"&&n!==null&&e!==null){if(typeof e!="object"||Object.keys(n).length!==Object.keys(e).length)return!1;for(const i in n)if(!At(n[i],e[i]))return!1;return!0}return n===e}function Rt(n,e){n.push(e)}function Wt(n,e,i){Rt(i,{command:"addSource",args:[n,e[n]]})}function qi(n,e,i){Rt(e,{command:"removeSource",args:[n]}),i[n]=!0}function Zi(n,e,i,o){qi(n,i,o),Wt(n,e,i)}function Fn(n,e,i){let o;for(o in n[i])if(Object.prototype.hasOwnProperty.call(n[i],o)&&o!=="data"&&!At(n[i][o],e[i][o]))return!1;for(o in e[i])if(Object.prototype.hasOwnProperty.call(e[i],o)&&o!=="data"&&!At(n[i][o],e[i][o]))return!1;return!0}function Nn(n,e,i,o,u,p){n=n||{},e=e||{};for(const m in n)Object.prototype.hasOwnProperty.call(n,m)&&(At(n[m],e[m])||i.push({command:p,args:[o,m,e[m],u]}));for(const m in e)Object.prototype.hasOwnProperty.call(e,m)&&!Object.prototype.hasOwnProperty.call(n,m)&&(At(n[m],e[m])||i.push({command:p,args:[o,m,e[m],u]}))}function ln(n){return n.id}function Dn(n,e){return n[e.id]=e,n}class tt{constructor(e,i,o,u){this.message=(e?`${e}: `:"")+o,u&&(this.identifier=u),i!=null&&i.__line__&&(this.line=i.__line__)}}function Tn(n,...e){for(const i of e)for(const o in i)n[o]=i[o];return n}class Er extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}class Br{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[o,u]of i)this.bindings[o]=u}concat(e){return new Br(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const ci={kind:"null"},ht={kind:"number"},qt={kind:"string"},Jt={kind:"boolean"},ta={kind:"color"},Ou={kind:"projectionDefinition"},us={kind:"object"},Xt={kind:"value"},Xo={kind:"collator"},hs={kind:"formatted"},Vs={kind:"padding"},ds={kind:"colorArray"},fs={kind:"numberArray"},fn={kind:"resolvedImage"},Ul={kind:"variableAnchorOffsetCollection"};function _r(n,e){return{kind:"array",itemType:n,N:e}}function di(n){if(n.kind==="array"){const e=di(n.itemType);return typeof n.N=="number"?`array<${e}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${e}>`}return n.kind}const Us=[ci,ht,qt,Jt,ta,Ou,hs,us,_r(Xt),Vs,fs,ds,fn,Ul];function Gl(n,e){if(e.kind==="error")return null;if(n.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Gl(n.itemType,e.itemType))&&(typeof n.N!="number"||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if(n.kind==="value"){for(const i of Us)if(!Gl(i,e))return null}}return`Expected ${di(n)} but found ${di(e)} instead.`}function ql(n,e){return e.some((i=>i.kind===n.kind))}function po(n,e){return e.some((i=>i==="null"?n===null:i==="array"?Array.isArray(n):i==="object"?n&&!Array.isArray(n)&&typeof n=="object":i===typeof n))}function qa(n,e){return n.kind==="array"&&e.kind==="array"?n.itemType.kind===e.itemType.kind&&typeof n.N=="number":n.kind===e.kind}const Lc=.96422,ps=.82521,wa=4/29,_i=6/29,Zh=3*_i*_i,lf=_i*_i*_i,Yo=Math.PI/180,Hh=180/Math.PI;function jc(n){return(n%=360)<0&&(n+=360),n}function cf([n,e,i,o]){let u,p;const m=Bc((.2225045*(n=Ar(n))+.7168786*(e=Ar(e))+.0606169*(i=Ar(i)))/1);n===e&&e===i?u=p=m:(u=Bc((.4360747*n+.3850649*e+.1430804*i)/Lc),p=Bc((.0139322*n+.0971045*e+.7141733*i)/ps));const v=116*m-16;return[v<0?0:v,500*(u-m),200*(m-p),o]}function Ar(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Bc(n){return n>lf?Math.pow(n,1/3):n/Zh+wa}function Fu([n,e,i,o]){let u=(n+16)/116,p=isNaN(e)?u:u+e/500,m=isNaN(i)?u:u-i/200;return u=1*mo(u),p=Lc*mo(p),m=ps*mo(m),[Oc(3.1338561*p-1.6168667*u-.4906146*m),Oc(-.9787684*p+1.9161415*u+.033454*m),Oc(.0719453*p-.2289914*u+1.4052427*m),o]}function Oc(n){return(n=n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055)<0?0:n>1?1:n}function mo(n){return n>_i?n*n*n:Zh*(n-wa)}const uf=Object.hasOwn||function(n,e){return Object.prototype.hasOwnProperty.call(n,e)};function Zl(n,e){return uf(n,e)?n[e]:void 0}function Gs(n){return parseInt(n.padEnd(2,n),16)/255}function hf(n,e){return Wo(e?n/100:n,0,1)}function Wo(n,e,i){return Math.min(Math.max(e,n),i)}function Nu(n){return!n.some(Number.isNaN)}const Ko={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function go(n,e,i){return n+i*(e-n)}function Hl(n,e,i){return n.map(((o,u)=>go(o,e[u],i)))}class Qt{constructor(e,i,o,u=1,p=!0){this.r=e,this.g=i,this.b=o,this.a=u,p||(this.r*=u,this.g*=u,this.b*=u,u||this.overwriteGetter("rgb",[e,i,o,u]))}static parse(e){if(e instanceof Qt)return e;if(typeof e!="string")return;const i=(function(o){if((o=o.toLowerCase().trim())==="transparent")return[0,0,0,0];const u=Zl(Ko,o);if(u){const[m,v,w]=u;return[m/255,v/255,w/255,1]}if(o.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(o)){const m=o.length<6?1:2;let v=1;return[Gs(o.slice(v,v+=m)),Gs(o.slice(v,v+=m)),Gs(o.slice(v,v+=m)),Gs(o.slice(v,v+m)||"ff")]}if(o.startsWith("rgb")){const m=o.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[v,w,C,P,L,O,F,q,Z,$,ee,ue]=m,ie=[P||" ",F||" ",$].join("");if(ie==="  "||ie==="  /"||ie===",,"||ie===",,,"){const re=[C,O,Z].join(""),fe=re==="%%%"?100:re===""?255:0;if(fe){const _e=[Wo(+w/fe,0,1),Wo(+L/fe,0,1),Wo(+q/fe,0,1),ee?hf(+ee,ue):1];if(Nu(_e))return _e}}return}}const p=o.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(p){const[m,v,w,C,P,L,O,F,q]=p,Z=[w||" ",P||" ",O].join("");if(Z==="  "||Z==="  /"||Z===",,"||Z===",,,"){const $=[+v,Wo(+C,0,100),Wo(+L,0,100),F?hf(+F,q):1];if(Nu($))return(function([ee,ue,ie,re]){function fe(_e){const je=(_e+ee/30)%12,Qe=ue*Math.min(ie,1-ie);return ie-Qe*Math.max(-1,Math.min(je-3,9-je,1))}return ee=jc(ee),ue/=100,ie/=100,[fe(0),fe(8),fe(4),re]})($)}}})(e);return i?new Qt(...i,!1):void 0}get rgb(){const{r:e,g:i,b:o,a:u}=this,p=u||1/0;return this.overwriteGetter("rgb",[e/p,i/p,o/p,u])}get hcl(){return this.overwriteGetter("hcl",(function(e){const[i,o,u,p]=cf(e),m=Math.sqrt(o*o+u*u);return[Math.round(1e4*m)?jc(Math.atan2(u,o)*Hh):NaN,m,i,p]})(this.rgb))}get lab(){return this.overwriteGetter("lab",cf(this.rgb))}overwriteGetter(e,i){return Object.defineProperty(this,e,{value:i}),i}toString(){const[e,i,o,u]=this.rgb;return`rgba(${[e,i,o].map((p=>Math.round(255*p))).join(",")},${u})`}static interpolate(e,i,o,u="rgb"){switch(u){case"rgb":{const[p,m,v,w]=Hl(e.rgb,i.rgb,o);return new Qt(p,m,v,w,!1)}case"hcl":{const[p,m,v,w]=e.hcl,[C,P,L,O]=i.hcl;let F,q;if(isNaN(p)||isNaN(C))isNaN(p)?isNaN(C)?F=NaN:(F=C,v!==1&&v!==0||(q=P)):(F=p,L!==1&&L!==0||(q=m));else{let ie=C-p;C>p&&ie>180?ie-=360:C<p&&p-C>180&&(ie+=360),F=p+o*ie}const[Z,$,ee,ue]=(function([ie,re,fe,_e]){return ie=isNaN(ie)?0:ie*Yo,Fu([fe,Math.cos(ie)*re,Math.sin(ie)*re,_e])})([F,q??go(m,P,o),go(v,L,o),go(w,O,o)]);return new Qt(Z,$,ee,ue,!1)}case"lab":{const[p,m,v,w]=Fu(Hl(e.lab,i.lab,o));return new Qt(p,m,v,w,!1)}}}}Qt.black=new Qt(0,0,0,1),Qt.white=new Qt(1,1,1,1),Qt.transparent=new Qt(0,0,0,0),Qt.red=new Qt(1,0,0,1);class Za{constructor(e,i,o){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const $h=["bottom","center","top"];class Fc{constructor(e,i,o,u,p,m){this.text=e,this.image=i,this.scale=o,this.fontStack=u,this.textColor=p,this.verticalAlign=m}}class Zn{constructor(e){this.sections=e}static fromString(e){return new Zn([new Fc(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((e=>e.text.length!==0||e.image&&e.image.name.length!==0))}static factory(e){return e instanceof Zn?e:Zn.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map((e=>e.text)).join("")}}class zn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof zn)return e;if(typeof e=="number")return new zn([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const i of e)if(typeof i!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new zn(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,o){return new zn(Hl(e.values,i.values,o))}}class Qi{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Qi)return e;if(typeof e=="number")return new Qi([e]);if(Array.isArray(e)){for(const i of e)if(typeof i!="number")return;return new Qi(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,o){return new Qi(Hl(e.values,i.values,o))}}class Vt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Vt)return e;if(typeof e=="string"){const o=Qt.parse(e);return o?new Vt([o]):void 0}if(!Array.isArray(e))return;const i=[];for(const o of e){if(typeof o!="string")return;const u=Qt.parse(o);if(!u)return;i.push(u)}return new Vt(i)}toString(){return JSON.stringify(this.values)}static interpolate(e,i,o,u="rgb"){const p=[];if(e.values.length!=i.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${i.values.length}), cannot interpolate.`);for(let m=0;m<e.values.length;m++)p.push(Qt.interpolate(e.values[m],i.values[m],o,u));return new Vt(p)}}class ji extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const Ta=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class pn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof pn)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let i=0;i<e.length;i+=2){const o=e[i],u=e[i+1];if(typeof o!="string"||!Ta.has(o)||!Array.isArray(u)||u.length!==2||typeof u[0]!="number"||typeof u[1]!="number")return}return new pn(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,o){const u=e.values,p=i.values;if(u.length!==p.length)throw new ji(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${i.toString()}`);const m=[];for(let v=0;v<u.length;v+=2){if(u[v]!==p[v])throw new ji(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${u[v]}, to[${v}]: ${p[v]}`);m.push(u[v]);const[w,C]=u[v+1],[P,L]=p[v+1];m.push([go(w,P,o),go(C,L,o)])}return new pn(m)}}class Cr{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Cr({name:e,available:!1}):null}}class Hn{constructor(e,i,o){this.from=e,this.to=i,this.transition=o}static interpolate(e,i,o){return new Hn(e,i,o)}static parse(e){return e instanceof Hn?e:Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number"?new Hn(e[0],e[1],e[2]):typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number"?new Hn(e.from,e.to,e.transition):typeof e=="string"?new Hn(e,e,1):void 0}}function ia(n,e,i,o){return typeof n=="number"&&n>=0&&n<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[n,e,i,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[n,e,i,o]:[n,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ms(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Hn||n instanceof Qt||n instanceof Za||n instanceof Zn||n instanceof zn||n instanceof Qi||n instanceof Vt||n instanceof pn||n instanceof Cr)return!0;if(Array.isArray(n)){for(const e of n)if(!ms(e))return!1;return!0}if(typeof n=="object"){for(const e in n)if(!ms(n[e]))return!1;return!0}return!1}function Ji(n){if(n===null)return ci;if(typeof n=="string")return qt;if(typeof n=="boolean")return Jt;if(typeof n=="number")return ht;if(n instanceof Qt)return ta;if(n instanceof Hn)return Ou;if(n instanceof Za)return Xo;if(n instanceof Zn)return hs;if(n instanceof zn)return Vs;if(n instanceof Qi)return fs;if(n instanceof Vt)return ds;if(n instanceof pn)return Ul;if(n instanceof Cr)return fn;if(Array.isArray(n)){const e=n.length;let i;for(const o of n){const u=Ji(o);if(i){if(i===u)continue;i=Xt;break}i=u}return _r(i||Xt,e)}return us}function yo(n){const e=typeof n;return n===null?"":e==="string"||e==="number"||e==="boolean"?String(n):n instanceof Qt||n instanceof Hn||n instanceof Zn||n instanceof zn||n instanceof Qi||n instanceof Vt||n instanceof pn||n instanceof Cr?n.toString():JSON.stringify(n)}class na{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ms(e[1]))return i.error("invalid value");const o=e[1];let u=Ji(o);const p=i.expectedType;return u.kind!=="array"||u.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(u=p),new na(u,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Qo={string:qt,number:ht,boolean:Jt,object:us};class Dr{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let o,u=1;const p=e[0];if(p==="array"){let v,w;if(e.length>2){const C=e[1];if(typeof C!="string"||!(C in Qo)||C==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);v=Qo[C],u++}else v=Xt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);w=e[2],u++}o=_r(v,w)}else{if(!Qo[p])throw new Error(`Types doesn't contain name = ${p}`);o=Qo[p]}const m=[];for(;u<e.length;u++){const v=i.parse(e[u],u,Xt);if(!v)return null;m.push(v)}return new Dr(o,m)}evaluate(e){for(let i=0;i<this.args.length;i++){const o=this.args[i].evaluate(e);if(!Gl(this.type,Ji(o)))return o;if(i===this.args.length-1)throw new ji(`Expected value to be of type ${di(this.type)}, but found ${di(Ji(o))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Vn={"to-boolean":Jt,"to-color":ta,"to-number":ht,"to-string":qt};class zr{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const o=e[0];if(!Vn[o])throw new Error(`Can't parse ${o} as it is not part of the known types`);if((o==="to-boolean"||o==="to-string")&&e.length!==2)return i.error("Expected one argument.");const u=Vn[o],p=[];for(let m=1;m<e.length;m++){const v=i.parse(e[m],m,Xt);if(!v)return null;p.push(v)}return new zr(u,p)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let i,o;for(const u of this.args){if(i=u.evaluate(e),o=null,i instanceof Qt)return i;if(typeof i=="string"){const p=e.parseColor(i);if(p)return p}else if(Array.isArray(i)&&(o=i.length<3||i.length>4?`Invalid rgba value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:ia(i[0],i[1],i[2],i[3]),!o))return new Qt(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new ji(o||`Could not parse color from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"padding":{let i;for(const o of this.args){i=o.evaluate(e);const u=zn.parse(i);if(u)return u}throw new ji(`Could not parse padding from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"numberArray":{let i;for(const o of this.args){i=o.evaluate(e);const u=Qi.parse(i);if(u)return u}throw new ji(`Could not parse numberArray from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"colorArray":{let i;for(const o of this.args){i=o.evaluate(e);const u=Vt.parse(i);if(u)return u}throw new ji(`Could not parse colorArray from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"variableAnchorOffsetCollection":{let i;for(const o of this.args){i=o.evaluate(e);const u=pn.parse(i);if(u)return u}throw new ji(`Could not parse variableAnchorOffsetCollection from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"number":{let i=null;for(const o of this.args){if(i=o.evaluate(e),i===null)return 0;const u=Number(i);if(!isNaN(u))return u}throw new ji(`Could not convert ${JSON.stringify(i)} to number.`)}case"formatted":return Zn.fromString(yo(this.args[0].evaluate(e)));case"resolvedImage":return Cr.fromString(yo(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return yo(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Nc=["Unknown","Point","LineString","Polygon"];class Jo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Nc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let i=this._parseColorCache.get(e);return i||(i=Qt.parse(e),this._parseColorCache.set(e,i)),i}}class el{constructor(e,i,o=[],u,p=new Br,m=[]){this.registry=e,this.path=o,this.key=o.map((v=>`[${v}]`)).join(""),this.scope=p,this.errors=m,this.expectedType=u,this._isConstant=i}parse(e,i,o,u,p={}){return i?this.concat(i,o,u)._parse(e,p):this._parse(e,p)}_parse(e,i){function o(u,p,m){return m==="assert"?new Dr(p,[u]):m==="coerce"?new zr(p,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[u];if(p){let m=p.parse(e,this);if(!m)return null;if(this.expectedType){const v=this.expectedType,w=m.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||w.kind!=="value"){if(v.kind==="projectionDefinition"&&["string","array"].includes(w.kind)||["color","formatted","resolvedImage"].includes(v.kind)&&["value","string"].includes(w.kind)||["padding","numberArray"].includes(v.kind)&&["value","number","array"].includes(w.kind)||v.kind==="colorArray"&&["value","string","array"].includes(w.kind)||v.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(w.kind))m=o(m,v,i.typeAnnotation||"coerce");else if(this.checkSubtype(v,w))return null}else m=o(m,v,i.typeAnnotation||"assert")}if(!(m instanceof na)&&m.type.kind!=="resolvedImage"&&this._isConstant(m)){const v=new Jo;try{m=new na(m.type,m.evaluate(v))}catch(w){return this.error(w.message),null}}return m}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,o){const u=typeof e=="number"?this.path.concat(e):this.path,p=o?this.scope.concat(o):this.scope;return new el(this.registry,this._isConstant,u,i||null,p,this.errors)}error(e,...i){const o=`${this.key}${i.map((u=>`[${u}]`)).join("")}`;this.errors.push(new Er(o,e))}checkSubtype(e,i){const o=Gl(e,i);return o&&this.error(o),o}}class Ci{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const o=[];for(let p=1;p<e.length-1;p+=2){const m=e[p];if(typeof m!="string")return i.error(`Expected string, but found ${typeof m} instead.`,p);if(/[^a-zA-Z0-9_]/.test(m))return i.error("Variable names must contain only alphanumeric characters or '_'.",p);const v=i.parse(e[p+1],p+1);if(!v)return null;o.push([m,v])}const u=i.parse(e[e.length-1],e.length-1,i.expectedType,o);return u?new Ci(o,u):null}outputDefined(){return this.result.outputDefined()}}class _o{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const o=e[1];return i.scope.has(o)?new _o(o,i.scope.get(o)):i.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class ri{constructor(e,i,o){this.type=e,this.index=i,this.input=o}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,ht),u=i.parse(e[2],2,_r(i.expectedType||Xt));return o&&u?new ri(u.type.itemType,o,u):null}evaluate(e){const i=this.index.evaluate(e),o=this.input.evaluate(e);if(i<0)throw new ji(`Array index out of bounds: ${i} < 0.`);if(i>=o.length)throw new ji(`Array index out of bounds: ${i} > ${o.length-1}.`);if(i!==Math.floor(i))throw new ji(`Array index must be an integer, but found ${i} instead.`);return o[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Yt{constructor(e,i){this.type=Jt,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,Xt),u=i.parse(e[2],2,Xt);return o&&u?ql(o.type,[Jt,qt,ht,ci,Xt])?new Yt(o,u):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${di(o.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!o)return!1;if(!po(i,["boolean","string","number","null"]))throw new ji(`Expected first argument to be of type boolean, string, number or null, but found ${di(Ji(i))} instead.`);if(!po(o,["string","array"]))throw new ji(`Expected second argument to be of type array or string, but found ${di(Ji(o))} instead.`);return o.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class tl{constructor(e,i,o){this.type=ht,this.needle=e,this.haystack=i,this.fromIndex=o}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,Xt),u=i.parse(e[2],2,Xt);if(!o||!u)return null;if(!ql(o.type,[Jt,qt,ht,ci,Xt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${di(o.type)} instead`);if(e.length===4){const p=i.parse(e[3],3,ht);return p?new tl(o,u,p):null}return new tl(o,u)}evaluate(e){const i=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!po(i,["boolean","string","number","null"]))throw new ji(`Expected first argument to be of type boolean, string, number or null, but found ${di(Ji(i))} instead.`);let u;if(this.fromIndex&&(u=this.fromIndex.evaluate(e)),po(o,["string"])){const p=o.indexOf(i,u);return p===-1?-1:[...o.slice(0,p)].length}if(po(o,["array"]))return o.indexOf(i,u);throw new ji(`Expected second argument to be of type array or string, but found ${di(Ji(o))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class fi{constructor(e,i,o,u,p,m){this.inputType=e,this.type=i,this.input=o,this.cases=u,this.outputs=p,this.otherwise=m}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let o,u;i.expectedType&&i.expectedType.kind!=="value"&&(u=i.expectedType);const p={},m=[];for(let C=2;C<e.length-1;C+=2){let P=e[C];const L=e[C+1];Array.isArray(P)||(P=[P]);const O=i.concat(C);if(P.length===0)return O.error("Expected at least one branch label.");for(const q of P){if(typeof q!="number"&&typeof q!="string")return O.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return O.error("Numeric branch labels must be integer values.");if(o){if(O.checkSubtype(o,Ji(q)))return null}else o=Ji(q);if(p[String(q)]!==void 0)return O.error("Branch labels must be unique.");p[String(q)]=m.length}const F=i.parse(L,C,u);if(!F)return null;u=u||F.type,m.push(F)}const v=i.parse(e[1],1,Xt);if(!v)return null;const w=i.parse(e[e.length-1],e.length-1,u);return w?v.type.kind!=="value"&&i.concat(1).checkSubtype(o,v.type)?null:new fi(o,u,v,p,m,w):null}evaluate(e){const i=this.input.evaluate(e);return(Ji(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class Vc{constructor(e,i,o){this.type=e,this.branches=i,this.otherwise=o}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let o;i.expectedType&&i.expectedType.kind!=="value"&&(o=i.expectedType);const u=[];for(let m=1;m<e.length-1;m+=2){const v=i.parse(e[m],m,Jt);if(!v)return null;const w=i.parse(e[m+1],m+1,o);if(!w)return null;u.push([v,w]),o=o||w.type}const p=i.parse(e[e.length-1],e.length-1,o);if(!p)return null;if(!o)throw new Error("Can't infer output type");return new Vc(o,u,p)}evaluate(e){for(const[i,o]of this.branches)if(i.evaluate(e))return o.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,o]of this.branches)e(i),e(o);e(this.otherwise)}outputDefined(){return this.branches.every((([e,i])=>i.outputDefined()))&&this.otherwise.outputDefined()}}class Sa{constructor(e,i,o,u){this.type=e,this.input=i,this.beginIndex=o,this.endIndex=u}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,Xt),u=i.parse(e[2],2,ht);if(!o||!u)return null;if(!ql(o.type,[_r(Xt),qt,Xt]))return i.error(`Expected first argument to be of type array or string, but found ${di(o.type)} instead`);if(e.length===4){const p=i.parse(e[3],3,ht);return p?new Sa(o.type,o,u,p):null}return new Sa(o.type,o,u)}evaluate(e){const i=this.input.evaluate(e),o=this.beginIndex.evaluate(e);let u;if(this.endIndex&&(u=this.endIndex.evaluate(e)),po(i,["string"]))return[...i].slice(o,u).join("");if(po(i,["array"]))return i.slice(o,u);throw new ji(`Expected first argument to be of type array or string, but found ${di(Ji(i))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function xo(n,e){const i=n.length-1;let o,u,p=0,m=i,v=0;for(;p<=m;)if(v=Math.floor((p+m)/2),o=n[v],u=n[v+1],o<=e){if(v===i||e<u)return v;p=v+1}else{if(!(o>e))throw new ji("Input is not a number.");m=v-1}return 0}class vo{constructor(e,i,o){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[u,p]of o)this.labels.push(u),this.outputs.push(p)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const o=i.parse(e[1],1,ht);if(!o)return null;const u=[];let p=null;i.expectedType&&i.expectedType.kind!=="value"&&(p=i.expectedType);for(let m=1;m<e.length;m+=2){const v=m===1?-1/0:e[m],w=e[m+1],C=m,P=m+1;if(typeof v!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(u.length&&u[u.length-1][0]>=v)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const L=i.parse(w,P,p);if(!L)return null;p=p||L.type,u.push([v,L])}return new vo(p,o,u)}evaluate(e){const i=this.labels,o=this.outputs;if(i.length===1)return o[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return o[0].evaluate(e);const p=i.length;return u>=i[p-1]?o[p-1].evaluate(e):o[xo(i,u)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function df(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Uc,Xh,Np=(function(){if(Xh)return Uc;function n(e,i,o,u){this.cx=3*e,this.bx=3*(o-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(u-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=i,this.p2x=o,this.p2y=u}return Xh=1,Uc=n,n.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,i){if(i===void 0&&(i=1e-6),e<0)return 0;if(e>1)return 1;for(var o=e,u=0;u<8;u++){var p=this.sampleCurveX(o)-e;if(Math.abs(p)<i)return o;var m=this.sampleCurveDerivativeX(o);if(Math.abs(m)<1e-6)break;o-=p/m}var v=0,w=1;for(o=e,u=0;u<20&&(p=this.sampleCurveX(o),!(Math.abs(p-e)<i));u++)e>p?v=o:w=o,o=.5*(w-v)+v;return o},solve:function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))}},Uc})(),Yh=df(Np);class Pr{constructor(e,i,o,u,p){this.type=e,this.operator=i,this.interpolation=o,this.input=u,this.labels=[],this.outputs=[];for(const[m,v]of p)this.labels.push(m),this.outputs.push(v)}static interpolationFactor(e,i,o,u){let p=0;if(e.name==="exponential")p=gs(i,e.base,o,u);else if(e.name==="linear")p=gs(i,1,o,u);else if(e.name==="cubic-bezier"){const m=e.controlPoints;p=new Yh(m[0],m[1],m[2],m[3]).solve(gs(i,1,o,u))}return p}static parse(e,i){let[o,u,p,...m]=e;if(!Array.isArray(u)||u.length===0)return i.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const C=u[1];if(typeof C!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:C}}else{if(u[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const C=u.slice(1);if(C.length!==4||C.some((P=>typeof P!="number"||P<0||P>1)))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:C}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(p=i.parse(p,2,ht),!p)return null;const v=[];let w=null;o!=="interpolate-hcl"&&o!=="interpolate-lab"||i.expectedType==ds?i.expectedType&&i.expectedType.kind!=="value"&&(w=i.expectedType):w=ta;for(let C=0;C<m.length;C+=2){const P=m[C],L=m[C+1],O=C+3,F=C+4;if(typeof P!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(v.length&&v[v.length-1][0]>=P)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);const q=i.parse(L,F,w);if(!q)return null;w=w||q.type,v.push([P,q])}return qa(w,ht)||qa(w,Ou)||qa(w,ta)||qa(w,Vs)||qa(w,fs)||qa(w,ds)||qa(w,Ul)||qa(w,_r(ht))?new Pr(w,o,u,p,v):i.error(`Type ${di(w)} is not interpolatable.`)}evaluate(e){const i=this.labels,o=this.outputs;if(i.length===1)return o[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return o[0].evaluate(e);const p=i.length;if(u>=i[p-1])return o[p-1].evaluate(e);const m=xo(i,u),v=Pr.interpolationFactor(this.interpolation,u,i[m],i[m+1]),w=o[m].evaluate(e),C=o[m+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return go(w,C,v);case"color":return Qt.interpolate(w,C,v);case"padding":return zn.interpolate(w,C,v);case"colorArray":return Vt.interpolate(w,C,v);case"numberArray":return Qi.interpolate(w,C,v);case"variableAnchorOffsetCollection":return pn.interpolate(w,C,v);case"array":return Hl(w,C,v);case"projectionDefinition":return Hn.interpolate(w,C,v)}case"interpolate-hcl":switch(this.type.kind){case"color":return Qt.interpolate(w,C,v,"hcl");case"colorArray":return Vt.interpolate(w,C,v,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Qt.interpolate(w,C,v,"lab");case"colorArray":return Vt.interpolate(w,C,v,"lab")}}}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function gs(n,e,i,o){const u=o-i,p=n-i;return u===0?0:e===1?p/u:(Math.pow(e,p)-1)/(Math.pow(e,u)-1)}const en={color:Qt.interpolate,number:go,padding:zn.interpolate,numberArray:Qi.interpolate,colorArray:Vt.interpolate,variableAnchorOffsetCollection:pn.interpolate,array:Hl};class il{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let o=null;const u=i.expectedType;u&&u.kind!=="value"&&(o=u);const p=[];for(const v of e.slice(1)){const w=i.parse(v,1+p.length,o,void 0,{typeAnnotation:"omit"});if(!w)return null;o=o||w.type,p.push(w)}if(!o)throw new Error("No output type");const m=u&&p.some((v=>Gl(u,v.type)));return new il(m?Xt:o,p)}evaluate(e){let i,o=null,u=0;for(const p of this.args)if(u++,o=p.evaluate(e),o&&o instanceof Cr&&!o.available&&(i||(i=o.name),o=null,u===this.args.length&&(o=i)),o!==null)break;return o}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}function Gc(n,e){return n==="=="||n==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function qc(n,e,i,o){return o.compare(e,i)===0}function mn(n,e,i){const o=n!=="=="&&n!=="!=";return class H1{constructor(p,m,v){this.type=Jt,this.lhs=p,this.rhs=m,this.collator=v,this.hasUntypedArgument=p.type.kind==="value"||m.type.kind==="value"}static parse(p,m){if(p.length!==3&&p.length!==4)return m.error("Expected two or three arguments.");const v=p[0];let w=m.parse(p[1],1,Xt);if(!w)return null;if(!Gc(v,w.type))return m.concat(1).error(`"${v}" comparisons are not supported for type '${di(w.type)}'.`);let C=m.parse(p[2],2,Xt);if(!C)return null;if(!Gc(v,C.type))return m.concat(2).error(`"${v}" comparisons are not supported for type '${di(C.type)}'.`);if(w.type.kind!==C.type.kind&&w.type.kind!=="value"&&C.type.kind!=="value")return m.error(`Cannot compare types '${di(w.type)}' and '${di(C.type)}'.`);o&&(w.type.kind==="value"&&C.type.kind!=="value"?w=new Dr(C.type,[w]):w.type.kind!=="value"&&C.type.kind==="value"&&(C=new Dr(w.type,[C])));let P=null;if(p.length===4){if(w.type.kind!=="string"&&C.type.kind!=="string"&&w.type.kind!=="value"&&C.type.kind!=="value")return m.error("Cannot use collator to compare non-string types.");if(P=m.parse(p[3],3,Xo),!P)return null}return new H1(w,C,P)}evaluate(p){const m=this.lhs.evaluate(p),v=this.rhs.evaluate(p);if(o&&this.hasUntypedArgument){const w=Ji(m),C=Ji(v);if(w.kind!==C.kind||w.kind!=="string"&&w.kind!=="number")throw new ji(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${w.kind}, ${C.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const w=Ji(m),C=Ji(v);if(w.kind!=="string"||C.kind!=="string")return e(p,m,v)}return this.collator?i(p,m,v,this.collator.evaluate(p)):e(p,m,v)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}}}const ff=mn("==",(function(n,e,i){return e===i}),qc),Vu=mn("!=",(function(n,e,i){return e!==i}),(function(n,e,i,o){return!qc(0,e,i,o)})),pf=mn("<",(function(n,e,i){return e<i}),(function(n,e,i,o){return o.compare(e,i)<0})),Vp=mn(">",(function(n,e,i){return e>i}),(function(n,e,i,o){return o.compare(e,i)>0})),$l=mn("<=",(function(n,e,i){return e<=i}),(function(n,e,i,o){return o.compare(e,i)<=0})),Uu=mn(">=",(function(n,e,i){return e>=i}),(function(n,e,i,o){return o.compare(e,i)>=0}));class Xl{constructor(e,i,o){this.type=Xo,this.locale=o,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const o=e[1];if(typeof o!="object"||Array.isArray(o))return i.error("Collator options argument must be an object.");const u=i.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,Jt);if(!u)return null;const p=i.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,Jt);if(!p)return null;let m=null;return o.locale&&(m=i.parse(o.locale,1,qt),!m)?null:new Xl(u,p,m)}evaluate(e){return new Za(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Wh{constructor(e,i,o,u,p){this.type=qt,this.number=e,this.locale=i,this.currency=o,this.minFractionDigits=u,this.maxFractionDigits=p}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const o=i.parse(e[1],1,ht);if(!o)return null;const u=e[2];if(typeof u!="object"||Array.isArray(u))return i.error("NumberFormat options argument must be an object.");let p=null;if(u.locale&&(p=i.parse(u.locale,1,qt),!p))return null;let m=null;if(u.currency&&(m=i.parse(u.currency,1,qt),!m))return null;let v=null;if(u["min-fraction-digits"]&&(v=i.parse(u["min-fraction-digits"],1,ht),!v))return null;let w=null;return u["max-fraction-digits"]&&(w=i.parse(u["max-fraction-digits"],1,ht),!w)?null:new Wh(o,p,m,v,w)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Zc{constructor(e){this.type=hs,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const o=e[1];if(!Array.isArray(o)&&typeof o=="object")return i.error("First argument must be an image or text section.");const u=[];let p=!1;for(let m=1;m<=e.length-1;++m){const v=e[m];if(p&&typeof v=="object"&&!Array.isArray(v)){p=!1;let w=null;if(v["font-scale"]&&(w=i.parse(v["font-scale"],1,ht),!w))return null;let C=null;if(v["text-font"]&&(C=i.parse(v["text-font"],1,_r(qt)),!C))return null;let P=null;if(v["text-color"]&&(P=i.parse(v["text-color"],1,ta),!P))return null;let L=null;if(v["vertical-align"]){if(typeof v["vertical-align"]=="string"&&!$h.includes(v["vertical-align"]))return i.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${v["vertical-align"]}' instead.`);if(L=i.parse(v["vertical-align"],1,qt),!L)return null}const O=u[u.length-1];O.scale=w,O.font=C,O.textColor=P,O.verticalAlign=L}else{const w=i.parse(e[m],1,Xt);if(!w)return null;const C=w.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,u.push({content:w,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Zc(u)}evaluate(e){return new Zn(this.sections.map((i=>{const o=i.content.evaluate(e);return Ji(o)===fn?new Fc("",o,null,null,null,i.verticalAlign?i.verticalAlign.evaluate(e):null):new Fc(yo(o),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null,i.verticalAlign?i.verticalAlign.evaluate(e):null)})))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor),i.verticalAlign&&e(i.verticalAlign)}outputDefined(){return!1}}class Yl{constructor(e){this.type=fn,this.input=e}static parse(e,i){if(e.length!==2)return i.error("Expected two arguments.");const o=i.parse(e[1],1,qt);return o?new Yl(o):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),o=Cr.fromString(i);return o&&e.availableImages&&(o.available=e.availableImages.indexOf(i)>-1),o}eachChild(e){e(this.input)}outputDefined(){return!1}}class Wl{constructor(e){this.type=ht,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const o=i.parse(e[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${di(o.type)} instead.`):new Wl(o):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string")return[...i].length;if(Array.isArray(i))return i.length;throw new ji(`Expected value to be of type string or array, but found ${di(Ji(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Sn=8192;function Kl(n,e){const i=(180+n[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(i*u*Sn),Math.round(o*u*Sn)]}function Ql(n,e){const i=Math.pow(2,e.z);return[(u=(n[0]/Sn+e.x)/i,360*u-180),(o=(n[1]/Sn+e.y)/i,360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90)];var o,u}function Jl(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function bo(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function mf(n,e,i){const o=n[0]-e[0],u=n[1]-e[1],p=n[0]-i[0],m=n[1]-i[1];return o*m-p*u==0&&o*p<=0&&u*m<=0}function Hc(n,e,i,o){return(u=[o[0]-i[0],o[1]-i[1]])[0]*(p=[e[0]-n[0],e[1]-n[1]])[1]-u[1]*p[0]!=0&&!(!qu(n,e,i,o)||!qu(i,o,n,e));var u,p}function gf(n,e,i){for(const o of i)for(let u=0;u<o.length-1;++u)if(Hc(n,e,o[u],o[u+1]))return!0;return!1}function Ha(n,e,i=!1){let o=!1;for(const v of e)for(let w=0;w<v.length-1;w++){if(mf(n,v[w],v[w+1]))return i;(p=v[w])[1]>(u=n)[1]!=(m=v[w+1])[1]>u[1]&&u[0]<(m[0]-p[0])*(u[1]-p[1])/(m[1]-p[1])+p[0]&&(o=!o)}var u,p,m;return o}function Gu(n,e){for(const i of e)if(Ha(n,i))return!0;return!1}function yf(n,e){for(const i of n)if(!Ha(i,e))return!1;for(let i=0;i<n.length-1;++i)if(gf(n[i],n[i+1],e))return!1;return!0}function _f(n,e){for(const i of e)if(yf(n,i))return!0;return!1}function qu(n,e,i,o){const u=o[0]-i[0],p=o[1]-i[1],m=(n[0]-i[0])*p-u*(n[1]-i[1]),v=(e[0]-i[0])*p-u*(e[1]-i[1]);return m>0&&v<0||m<0&&v>0}function Zu(n,e,i){const o=[];for(let u=0;u<n.length;u++){const p=[];for(let m=0;m<n[u].length;m++){const v=Kl(n[u][m],i);Jl(e,v),p.push(v)}o.push(p)}return o}function nl(n,e,i){const o=[];for(let u=0;u<n.length;u++){const p=Zu(n[u],e,i);o.push(p)}return o}function ec(n,e,i,o){if(n[0]<i[0]||n[0]>i[2]){const u=.5*o;let p=n[0]-i[0]>u?-o:i[0]-n[0]>u?o:0;p===0&&(p=n[0]-i[2]>u?-o:i[2]-n[0]>u?o:0),n[0]+=p}Jl(e,n)}function xf(n,e,i,o){const u=Math.pow(2,o.z)*Sn,p=[o.x*Sn,o.y*Sn],m=[];for(const v of n)for(const w of v){const C=[w.x+p[0],w.y+p[1]];ec(C,e,i,u),m.push(C)}return m}function $c(n,e,i,o){const u=Math.pow(2,o.z)*Sn,p=[o.x*Sn,o.y*Sn],m=[];for(const w of n){const C=[];for(const P of w){const L=[P.x+p[0],P.y+p[1]];Jl(e,L),C.push(L)}m.push(C)}if(e[2]-e[0]<=u/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const w of m)for(const C of w)ec(C,e,i,u)}var v;return m}class wo{constructor(e,i){this.type=Jt,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ms(e[1])){const o=e[1];if(o.type==="FeatureCollection"){const u=[];for(const p of o.features){const{type:m,coordinates:v}=p.geometry;m==="Polygon"&&u.push(v),m==="MultiPolygon"&&u.push(...v)}if(u.length)return new wo(o,{type:"MultiPolygon",coordinates:u})}else if(o.type==="Feature"){const u=o.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new wo(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new wo(o,o)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(i,o){const u=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],m=i.canonicalID();if(o.type==="Polygon"){const v=Zu(o.coordinates,p,m),w=xf(i.geometry(),u,p,m);if(!bo(u,p))return!1;for(const C of w)if(!Ha(C,v))return!1}if(o.type==="MultiPolygon"){const v=nl(o.coordinates,p,m),w=xf(i.geometry(),u,p,m);if(!bo(u,p))return!1;for(const C of w)if(!Gu(C,v))return!1}return!0})(e,this.geometries);if(e.geometryType()==="LineString")return(function(i,o){const u=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],m=i.canonicalID();if(o.type==="Polygon"){const v=Zu(o.coordinates,p,m),w=$c(i.geometry(),u,p,m);if(!bo(u,p))return!1;for(const C of w)if(!yf(C,v))return!1}if(o.type==="MultiPolygon"){const v=nl(o.coordinates,p,m),w=$c(i.geometry(),u,p,m);if(!bo(u,p))return!1;for(const C of w)if(!_f(C,v))return!1}return!0})(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Kh=class{constructor(n=[],e=(i,o)=>i<o?-1:i>o?1:0){if(this.data=n,this.length=this.data.length,this.compare=e,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:e,compare:i}=this,o=e[n];for(;n>0;){const u=n-1>>1,p=e[u];if(i(o,p)>=0)break;e[n]=p,n=u}e[n]=o}_down(n){const{data:e,compare:i}=this,o=this.length>>1,u=e[n];for(;n<o;){let p=1+(n<<1);const m=p+1;if(m<this.length&&i(e[m],e[p])<0&&(p=m),i(e[p],u)>=0)break;e[n]=e[p],n=p}e[n]=u}};function Xc(n,e,i=0,o=n.length-1,u=Qh){for(;o>i;){if(o-i>600){const w=o-i+1,C=e-i+1,P=Math.log(w),L=.5*Math.exp(2*P/3),O=.5*Math.sqrt(P*L*(w-L)/w)*(C-w/2<0?-1:1);Xc(n,e,Math.max(i,Math.floor(e-C*L/w+O)),Math.min(o,Math.floor(e+(w-C)*L/w+O)),u)}const p=n[e];let m=i,v=o;for(To(n,i,e),u(n[o],p)>0&&To(n,i,o);m<v;){for(To(n,m,v),m++,v--;u(n[m],p)<0;)m++;for(;u(n[v],p)>0;)v--}u(n[i],p)===0?To(n,i,v):(v++,To(n,v,o)),v<=e&&(i=v+1),e<=v&&(o=v-1)}}function To(n,e,i){const o=n[e];n[e]=n[i],n[i]=o}function Qh(n,e){return n<e?-1:n>e?1:0}function Yc(n,e){if(n.length<=1)return[n];const i=[];let o,u;for(const p of n){const m=Up(p);m!==0&&(p.area=Math.abs(m),u===void 0&&(u=m<0),u===m<0?(o&&i.push(o),o=[p]):o.push(p))}if(o&&i.push(o),e>1)for(let p=0;p<i.length;p++)i[p].length<=e||(Xc(i[p],e,1,i[p].length-1,vf),i[p]=i[p].slice(0,e));return i}function vf(n,e){return e.area-n.area}function Up(n){let e=0;for(let i,o,u=0,p=n.length,m=p-1;u<p;m=u++)i=n[u],o=n[m],e+=(o.x-i.x)*(i.y+o.y);return e}const bf=1/298.257223563,Wc=bf*(2-bf),wf=Math.PI/180;class Jh{constructor(e){const i=6378.137*wf*1e3,o=Math.cos(e*wf),u=1/(1-Wc*(1-o*o)),p=Math.sqrt(u);this.kx=i*p*o,this.ky=i*p*u*(1-Wc)}distance(e,i){const o=this.wrap(e[0]-i[0])*this.kx,u=(e[1]-i[1])*this.ky;return Math.sqrt(o*o+u*u)}pointOnLine(e,i){let o,u,p,m,v=1/0;for(let w=0;w<e.length-1;w++){let C=e[w][0],P=e[w][1],L=this.wrap(e[w+1][0]-C)*this.kx,O=(e[w+1][1]-P)*this.ky,F=0;L===0&&O===0||(F=(this.wrap(i[0]-C)*this.kx*L+(i[1]-P)*this.ky*O)/(L*L+O*O),F>1?(C=e[w+1][0],P=e[w+1][1]):F>0&&(C+=L/this.kx*F,P+=O/this.ky*F)),L=this.wrap(i[0]-C)*this.kx,O=(i[1]-P)*this.ky;const q=L*L+O*O;q<v&&(v=q,o=C,u=P,p=w,m=F)}return{point:[o,u],index:p,t:Math.max(0,Math.min(1,m))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function Or(n,e){return e[0]-n[0]}function So(n){return n[1]-n[0]+1}function Ma(n,e){return n[1]>=n[0]&&n[1]<e}function Kc(n,e){if(n[0]>n[1])return[null,null];const i=So(n);if(e){if(i===2)return[n,null];const u=Math.floor(i/2);return[[n[0],n[0]+u],[n[0]+u,n[1]]]}if(i===1)return[n,null];const o=Math.floor(i/2)-1;return[[n[0],n[0]+o],[n[0]+o+1,n[1]]]}function Hu(n,e){if(!Ma(e,n.length))return[1/0,1/0,-1/0,-1/0];const i=[1/0,1/0,-1/0,-1/0];for(let o=e[0];o<=e[1];++o)Jl(i,n[o]);return i}function $u(n){const e=[1/0,1/0,-1/0,-1/0];for(const i of n)for(const o of i)Jl(e,o);return e}function Qc(n){return n[0]!==-1/0&&n[1]!==-1/0&&n[2]!==1/0&&n[3]!==1/0}function Xu(n,e,i){if(!Qc(n)||!Qc(e))return NaN;let o=0,u=0;return n[2]<e[0]&&(o=e[0]-n[2]),n[0]>e[2]&&(o=n[0]-e[2]),n[1]>e[3]&&(u=n[1]-e[3]),n[3]<e[1]&&(u=e[1]-n[3]),i.distance([0,0],[o,u])}function Ea(n,e,i){const o=i.pointOnLine(e,n);return i.distance(n,o.point)}function Jc(n,e,i,o,u){const p=Math.min(Ea(n,[i,o],u),Ea(e,[i,o],u)),m=Math.min(Ea(i,[n,e],u),Ea(o,[n,e],u));return Math.min(p,m)}function eu(n,e,i,o,u){if(!Ma(e,n.length)||!Ma(o,i.length))return 1/0;let p=1/0;for(let m=e[0];m<e[1];++m){const v=n[m],w=n[m+1];for(let C=o[0];C<o[1];++C){const P=i[C],L=i[C+1];if(Hc(v,w,P,L))return 0;p=Math.min(p,Jc(v,w,P,L,u))}}return p}function Yu(n,e,i,o,u){if(!Ma(e,n.length)||!Ma(o,i.length))return NaN;let p=1/0;for(let m=e[0];m<=e[1];++m)for(let v=o[0];v<=o[1];++v)if(p=Math.min(p,u.distance(n[m],i[v])),p===0)return p;return p}function Tf(n,e,i){if(Ha(n,e,!0))return 0;let o=1/0;for(const u of e){const p=u[0],m=u[u.length-1];if(p!==m&&(o=Math.min(o,Ea(n,[m,p],i)),o===0))return o;const v=i.pointOnLine(u,n);if(o=Math.min(o,i.distance(n,v.point)),o===0)return o}return o}function rl(n,e,i,o){if(!Ma(e,n.length))return NaN;for(let p=e[0];p<=e[1];++p)if(Ha(n[p],i,!0))return 0;let u=1/0;for(let p=e[0];p<e[1];++p){const m=n[p],v=n[p+1];for(const w of i)for(let C=0,P=w.length,L=P-1;C<P;L=C++){const O=w[L],F=w[C];if(Hc(m,v,O,F))return 0;u=Math.min(u,Jc(m,v,O,F,o))}}return u}function al(n,e){for(const i of n)for(const o of i)if(Ha(o,e,!0))return!0;return!1}function ed(n,e,i,o=1/0){const u=$u(n),p=$u(e);if(o!==1/0&&Xu(u,p,i)>=o)return o;if(bo(u,p)){if(al(n,e))return 0}else if(al(e,n))return 0;let m=1/0;for(const v of n)for(let w=0,C=v.length,P=C-1;w<C;P=w++){const L=v[P],O=v[w];for(const F of e)for(let q=0,Z=F.length,$=Z-1;q<Z;$=q++){const ee=F[$],ue=F[q];if(Hc(L,O,ee,ue))return 0;m=Math.min(m,Jc(L,O,ee,ue,i))}}return m}function xi(n,e,i,o,u,p){if(!p)return;const m=Xu(Hu(o,p),u,i);m<e&&n.push([m,p,[0,0]])}function ys(n,e,i,o,u,p,m){if(!p||!m)return;const v=Xu(Hu(o,p),Hu(u,m),i);v<e&&n.push([v,p,m])}function tu(n,e,i,o,u=1/0){let p=Math.min(o.distance(n[0],i[0][0]),u);if(p===0)return p;const m=new Kh([[0,[0,n.length-1],[0,0]]],Or),v=$u(i);for(;m.length>0;){const w=m.pop();if(w[0]>=p)continue;const C=w[1],P=e?50:100;if(So(C)<=P){if(!Ma(C,n.length))return NaN;if(e){const L=rl(n,C,i,o);if(isNaN(L)||L===0)return L;p=Math.min(p,L)}else for(let L=C[0];L<=C[1];++L){const O=Tf(n[L],i,o);if(p=Math.min(p,O),p===0)return 0}}else{const L=Kc(C,e);xi(m,p,o,n,v,L[0]),xi(m,p,o,n,v,L[1])}}return p}function iu(n,e,i,o,u,p=1/0){let m=Math.min(p,u.distance(n[0],i[0]));if(m===0)return m;const v=new Kh([[0,[0,n.length-1],[0,i.length-1]]],Or);for(;v.length>0;){const w=v.pop();if(w[0]>=m)continue;const C=w[1],P=w[2],L=e?50:100,O=o?50:100;if(So(C)<=L&&So(P)<=O){if(!Ma(C,n.length)&&Ma(P,i.length))return NaN;let F;if(e&&o)F=eu(n,C,i,P,u),m=Math.min(m,F);else if(e&&!o){const q=n.slice(C[0],C[1]+1);for(let Z=P[0];Z<=P[1];++Z)if(F=Ea(i[Z],q,u),m=Math.min(m,F),m===0)return m}else if(!e&&o){const q=i.slice(P[0],P[1]+1);for(let Z=C[0];Z<=C[1];++Z)if(F=Ea(n[Z],q,u),m=Math.min(m,F),m===0)return m}else F=Yu(n,C,i,P,u),m=Math.min(m,F)}else{const F=Kc(C,e),q=Kc(P,o);ys(v,m,u,n,i,F[0],q[0]),ys(v,m,u,n,i,F[0],q[1]),ys(v,m,u,n,i,F[1],q[0]),ys(v,m,u,n,i,F[1],q[1])}}return m}function Wu(n){return n.type==="MultiPolygon"?n.coordinates.map((e=>({type:"Polygon",coordinates:e}))):n.type==="MultiLineString"?n.coordinates.map((e=>({type:"LineString",coordinates:e}))):n.type==="MultiPoint"?n.coordinates.map((e=>({type:"Point",coordinates:e}))):[n]}class sl{constructor(e,i){this.type=ht,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ms(e[1])){const o=e[1];if(o.type==="FeatureCollection")return new sl(o,o.features.map((u=>Wu(u.geometry))).flat());if(o.type==="Feature")return new sl(o,Wu(o.geometry));if("type"in o&&"coordinates"in o)return new sl(o,Wu(o))}return i.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(i,o){const u=i.geometry(),p=u.flat().map((w=>Ql([w.x,w.y],i.canonical)));if(u.length===0)return NaN;const m=new Jh(p[0][1]);let v=1/0;for(const w of o){switch(w.type){case"Point":v=Math.min(v,iu(p,!1,[w.coordinates],!1,m,v));break;case"LineString":v=Math.min(v,iu(p,!1,w.coordinates,!0,m,v));break;case"Polygon":v=Math.min(v,tu(p,!1,w.coordinates,m,v))}if(v===0)return v}return v})(e,this.geometries);if(e.geometryType()==="LineString")return(function(i,o){const u=i.geometry(),p=u.flat().map((w=>Ql([w.x,w.y],i.canonical)));if(u.length===0)return NaN;const m=new Jh(p[0][1]);let v=1/0;for(const w of o){switch(w.type){case"Point":v=Math.min(v,iu(p,!0,[w.coordinates],!1,m,v));break;case"LineString":v=Math.min(v,iu(p,!0,w.coordinates,!0,m,v));break;case"Polygon":v=Math.min(v,tu(p,!0,w.coordinates,m,v))}if(v===0)return v}return v})(e,this.geometries);if(e.geometryType()==="Polygon")return(function(i,o){const u=i.geometry();if(u.length===0||u[0].length===0)return NaN;const p=Yc(u,0).map((w=>w.map((C=>C.map((P=>Ql([P.x,P.y],i.canonical))))))),m=new Jh(p[0][0][0][1]);let v=1/0;for(const w of o)for(const C of p){switch(w.type){case"Point":v=Math.min(v,tu([w.coordinates],!1,C,m,v));break;case"LineString":v=Math.min(v,tu(w.coordinates,!0,C,m,v));break;case"Polygon":v=Math.min(v,ed(C,w.coordinates,m,v))}if(v===0)return v}return v})(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class nu{constructor(e){this.type=Xt,this.key=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const o=e[1];return o==null?i.error("Global state property must be defined."):typeof o!="string"?i.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new nu(o)}evaluate(e){var i;const o=(i=e.globals)===null||i===void 0?void 0:i.globalState;return o&&Object.keys(o).length!==0?Zl(o,this.key):null}eachChild(){}outputDefined(){return!1}}const tc={"==":ff,"!=":Vu,">":Vp,"<":pf,">=":Uu,"<=":$l,array:Dr,at:ri,boolean:Dr,case:Vc,coalesce:il,collator:Xl,format:Zc,image:Yl,in:Yt,"index-of":tl,interpolate:Pr,"interpolate-hcl":Pr,"interpolate-lab":Pr,length:Wl,let:Ci,literal:na,match:fi,number:Dr,"number-format":Wh,object:Dr,slice:Sa,step:vo,string:Dr,"to-boolean":zr,"to-color":zr,"to-number":zr,"to-string":zr,var:_o,within:wo,distance:sl,"global-state":nu};class ra{constructor(e,i,o,u){this.name=e,this.type=i,this._evaluate=o,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,i){const o=e[0],u=ra.definitions[o];if(!u)return i.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(u)?u[0]:u.type,m=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,v=m.filter((([C])=>!Array.isArray(C)||C.length===e.length-1));let w=null;for(const[C,P]of v){w=new el(i.registry,Ir,i.path,null,i.scope);const L=[];let O=!1;for(let F=1;F<e.length;F++){const q=e[F],Z=Array.isArray(C)?C[F-1]:C.type,$=w.parse(q,1+L.length,Z);if(!$){O=!0;break}L.push($)}if(!O)if(Array.isArray(C)&&C.length!==L.length)w.error(`Expected ${C.length} arguments, but found ${L.length} instead.`);else{for(let F=0;F<L.length;F++){const q=Array.isArray(C)?C[F]:C.type,Z=L[F];w.concat(F+1).checkSubtype(q,Z.type)}if(w.errors.length===0)return new ra(o,p,P,L)}}if(v.length===1)i.errors.push(...w.errors);else{const C=(v.length?v:m).map((([L])=>{return O=L,Array.isArray(O)?`(${O.map(di).join(", ")})`:`(${di(O.type)}...)`;var O})).join(" | "),P=[];for(let L=1;L<e.length;L++){const O=i.parse(e[L],1+P.length);if(!O)return null;P.push(di(O.type))}i.error(`Expected arguments of type ${C}, but found (${P.join(", ")}) instead.`)}return null}static register(e,i){ra.definitions=i;for(const o in i)e[o]=ra}}function td(n,[e,i,o,u]){e=e.evaluate(n),i=i.evaluate(n),o=o.evaluate(n);const p=u?u.evaluate(n):1,m=ia(e,i,o,p);if(m)throw new ji(m);return new Qt(e/255,i/255,o/255,p,!1)}function Ku(n,e){return n in e}function aa(n,e){const i=e[n];return i===void 0?null:i}function _s(n){return{type:n}}function Ir(n){if(n instanceof _o)return Ir(n.boundExpression);if(n instanceof ra&&n.name==="error"||n instanceof Xl||n instanceof wo||n instanceof sl||n instanceof nu)return!1;const e=n instanceof zr||n instanceof Dr;let i=!0;return n.eachChild((o=>{i=e?i&&Ir(o):i&&o instanceof na})),!!i&&qs(n)&&ll(n,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function qs(n){if(n instanceof ra&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof wo||n instanceof sl)return!1;let e=!0;return n.eachChild((i=>{e&&!qs(i)&&(e=!1)})),e}function ol(n){if(n instanceof ra&&n.name==="feature-state")return!1;let e=!0;return n.eachChild((i=>{e&&!ol(i)&&(e=!1)})),e}function ll(n,e){if(n instanceof ra&&e.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild((o=>{i&&!ll(o,e)&&(i=!1)})),i}function ru(n){return{result:"success",value:n}}function Mo(n){return{result:"error",value:n}}function Aa(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function id(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function ic(n){return!!n.expression&&n.expression.interpolated}function Kt(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Qu(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&Ji(n)===us}function sa(n){return n}function Ju(n,e){const i=n.stops&&typeof n.stops[0][0]=="object",o=i||!(i||n.property!==void 0),u=n.type||(ic(e)?"exponential":"interval"),p=(function(P){switch(P.type){case"color":return Qt.parse;case"padding":return zn.parse;case"numberArray":return Qi.parse;case"colorArray":return Vt.parse;default:return null}})(e);if(p&&((n=Tn({},n)).stops&&(n.stops=n.stops.map((P=>[P[0],p(P[1])]))),n.default=p(n.default?n.default:e.default)),n.colorSpace&&(m=n.colorSpace)!=="rgb"&&m!=="hcl"&&m!=="lab")throw new Error(`Unknown color space: "${n.colorSpace}"`);var m;const v=(function(P){switch(P){case"exponential":return Eo;case"interval":return eh;case"categorical":return Sf;case"identity":return nd;default:throw new Error(`Unknown function type "${P}"`)}})(u);let w,C;if(u==="categorical"){w=Object.create(null);for(const P of n.stops)w[P[0]]=P[1];C=typeof n.stops[0][0]}if(i){const P={},L=[];for(let q=0;q<n.stops.length;q++){const Z=n.stops[q],$=Z[0].zoom;P[$]===void 0&&(P[$]={zoom:$,type:n.type,property:n.property,default:n.default,stops:[]},L.push($)),P[$].stops.push([Z[0].value,Z[1]])}const O=[];for(const q of L)O.push([P[q].zoom,Ju(P[q],e)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:Pr.interpolationFactor.bind(void 0,F),zoomStops:O.map((q=>q[0])),evaluate:({zoom:q},Z)=>Eo({stops:O,base:n.base},e,q).evaluate(q,Z)}}if(o){const P=u==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:Pr.interpolationFactor.bind(void 0,P),zoomStops:n.stops.map((L=>L[0])),evaluate:({zoom:L})=>v(n,e,L,w,C)}}return{kind:"source",evaluate(P,L){const O=L&&L.properties?L.properties[n.property]:void 0;return O===void 0?oa(n.default,e.default):v(n,e,O,w,C)}}}function oa(n,e,i){return n!==void 0?n:e!==void 0?e:i!==void 0?i:void 0}function Sf(n,e,i,o,u){return oa(typeof i===u?o[i]:void 0,n.default,e.default)}function eh(n,e,i){if(Kt(i)!=="number")return oa(n.default,e.default);const o=n.stops.length;if(o===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[o-1][0])return n.stops[o-1][1];const u=xo(n.stops.map((p=>p[0])),i);return n.stops[u][1]}function Eo(n,e,i){const o=n.base!==void 0?n.base:1;if(Kt(i)!=="number")return oa(n.default,e.default);const u=n.stops.length;if(u===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[u-1][0])return n.stops[u-1][1];const p=xo(n.stops.map((P=>P[0])),i),m=(function(P,L,O,F){const q=F-O,Z=P-O;return q===0?0:L===1?Z/q:(Math.pow(L,Z)-1)/(Math.pow(L,q)-1)})(i,o,n.stops[p][0],n.stops[p+1][0]),v=n.stops[p][1],w=n.stops[p+1][1],C=en[e.type]||sa;return typeof v.evaluate=="function"?{evaluate(...P){const L=v.evaluate.apply(void 0,P),O=w.evaluate.apply(void 0,P);if(L!==void 0&&O!==void 0)return C(L,O,m,n.colorSpace)}}:C(v,w,m,n.colorSpace)}function nd(n,e,i){switch(e.type){case"color":i=Qt.parse(i);break;case"formatted":i=Zn.fromString(i.toString());break;case"resolvedImage":i=Cr.fromString(i.toString());break;case"padding":i=zn.parse(i);break;case"colorArray":i=Vt.parse(i);break;case"numberArray":i=Qi.parse(i);break;default:Kt(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0)}return oa(i,n.default,e.default)}ra.register(tc,{error:[{kind:"error"},[qt],(n,[e])=>{throw new ji(e.evaluate(n))}],typeof:[qt,[Xt],(n,[e])=>di(Ji(e.evaluate(n)))],"to-rgba":[_r(ht,4),[ta],(n,[e])=>{const[i,o,u,p]=e.evaluate(n).rgb;return[255*i,255*o,255*u,p]}],rgb:[ta,[ht,ht,ht],td],rgba:[ta,[ht,ht,ht,ht],td],has:{type:Jt,overloads:[[[qt],(n,[e])=>Ku(e.evaluate(n),n.properties())],[[qt,us],(n,[e,i])=>Ku(e.evaluate(n),i.evaluate(n))]]},get:{type:Xt,overloads:[[[qt],(n,[e])=>aa(e.evaluate(n),n.properties())],[[qt,us],(n,[e,i])=>aa(e.evaluate(n),i.evaluate(n))]]},"feature-state":[Xt,[qt],(n,[e])=>aa(e.evaluate(n),n.featureState||{})],properties:[us,[],n=>n.properties()],"geometry-type":[qt,[],n=>n.geometryType()],id:[Xt,[],n=>n.id()],zoom:[ht,[],n=>n.globals.zoom],"heatmap-density":[ht,[],n=>n.globals.heatmapDensity||0],elevation:[ht,[],n=>n.globals.elevation||0],"line-progress":[ht,[],n=>n.globals.lineProgress||0],accumulated:[Xt,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[ht,_s(ht),(n,e)=>{let i=0;for(const o of e)i+=o.evaluate(n);return i}],"*":[ht,_s(ht),(n,e)=>{let i=1;for(const o of e)i*=o.evaluate(n);return i}],"-":{type:ht,overloads:[[[ht,ht],(n,[e,i])=>e.evaluate(n)-i.evaluate(n)],[[ht],(n,[e])=>-e.evaluate(n)]]},"/":[ht,[ht,ht],(n,[e,i])=>e.evaluate(n)/i.evaluate(n)],"%":[ht,[ht,ht],(n,[e,i])=>e.evaluate(n)%i.evaluate(n)],ln2:[ht,[],()=>Math.LN2],pi:[ht,[],()=>Math.PI],e:[ht,[],()=>Math.E],"^":[ht,[ht,ht],(n,[e,i])=>Math.pow(e.evaluate(n),i.evaluate(n))],sqrt:[ht,[ht],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[ht,[ht],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[ht,[ht],(n,[e])=>Math.log(e.evaluate(n))],log2:[ht,[ht],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[ht,[ht],(n,[e])=>Math.sin(e.evaluate(n))],cos:[ht,[ht],(n,[e])=>Math.cos(e.evaluate(n))],tan:[ht,[ht],(n,[e])=>Math.tan(e.evaluate(n))],asin:[ht,[ht],(n,[e])=>Math.asin(e.evaluate(n))],acos:[ht,[ht],(n,[e])=>Math.acos(e.evaluate(n))],atan:[ht,[ht],(n,[e])=>Math.atan(e.evaluate(n))],min:[ht,_s(ht),(n,e)=>Math.min(...e.map((i=>i.evaluate(n))))],max:[ht,_s(ht),(n,e)=>Math.max(...e.map((i=>i.evaluate(n))))],abs:[ht,[ht],(n,[e])=>Math.abs(e.evaluate(n))],round:[ht,[ht],(n,[e])=>{const i=e.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[ht,[ht],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[ht,[ht],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[Jt,[qt,Xt],(n,[e,i])=>n.properties()[e.value]===i.value],"filter-id-==":[Jt,[Xt],(n,[e])=>n.id()===e.value],"filter-type-==":[Jt,[qt],(n,[e])=>n.geometryType()===e.value],"filter-<":[Jt,[qt,Xt],(n,[e,i])=>{const o=n.properties()[e.value],u=i.value;return typeof o==typeof u&&o<u}],"filter-id-<":[Jt,[Xt],(n,[e])=>{const i=n.id(),o=e.value;return typeof i==typeof o&&i<o}],"filter->":[Jt,[qt,Xt],(n,[e,i])=>{const o=n.properties()[e.value],u=i.value;return typeof o==typeof u&&o>u}],"filter-id->":[Jt,[Xt],(n,[e])=>{const i=n.id(),o=e.value;return typeof i==typeof o&&i>o}],"filter-<=":[Jt,[qt,Xt],(n,[e,i])=>{const o=n.properties()[e.value],u=i.value;return typeof o==typeof u&&o<=u}],"filter-id-<=":[Jt,[Xt],(n,[e])=>{const i=n.id(),o=e.value;return typeof i==typeof o&&i<=o}],"filter->=":[Jt,[qt,Xt],(n,[e,i])=>{const o=n.properties()[e.value],u=i.value;return typeof o==typeof u&&o>=u}],"filter-id->=":[Jt,[Xt],(n,[e])=>{const i=n.id(),o=e.value;return typeof i==typeof o&&i>=o}],"filter-has":[Jt,[Xt],(n,[e])=>e.value in n.properties()],"filter-has-id":[Jt,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[Jt,[_r(qt)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[Jt,[_r(Xt)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[Jt,[qt,_r(Xt)],(n,[e,i])=>i.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[Jt,[qt,_r(Xt)],(n,[e,i])=>(function(o,u,p,m){for(;p<=m;){const v=p+m>>1;if(u[v]===o)return!0;u[v]>o?m=v-1:p=v+1}return!1})(n.properties()[e.value],i.value,0,i.value.length-1)],all:{type:Jt,overloads:[[[Jt,Jt],(n,[e,i])=>e.evaluate(n)&&i.evaluate(n)],[_s(Jt),(n,e)=>{for(const i of e)if(!i.evaluate(n))return!1;return!0}]]},any:{type:Jt,overloads:[[[Jt,Jt],(n,[e,i])=>e.evaluate(n)||i.evaluate(n)],[_s(Jt),(n,e)=>{for(const i of e)if(i.evaluate(n))return!0;return!1}]]},"!":[Jt,[Jt],(n,[e])=>!e.evaluate(n)],"is-supported-script":[Jt,[qt],(n,[e])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(e.evaluate(n))}],upcase:[qt,[qt],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[qt,[qt],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[qt,_s(Xt),(n,e)=>e.map((i=>yo(i.evaluate(n)))).join("")],"resolved-locale":[qt,[Xo],(n,[e])=>e.evaluate(n).resolvedLocale()]});class th{constructor(e,i,o){this.expression=e,this._warningHistory={},this._evaluator=new Jo,this._defaultValue=i?(function(u){if(u.type==="color"&&Qu(u.default))return new Qt(0,0,0,0);switch(u.type){case"color":return Qt.parse(u.default)||null;case"padding":return zn.parse(u.default)||null;case"numberArray":return Qi.parse(u.default)||null;case"colorArray":return Vt.parse(u.default)||null;case"variableAnchorOffsetCollection":return pn.parse(u.default)||null;case"projectionDefinition":return Hn.parse(u.default)||null;default:return u.default===void 0?null:u.default}})(i):null,this._enumValues=i&&i.type==="enum"?i.values:null,this._globalState=o}evaluateWithoutErrorHandling(e,i,o,u,p,m){return this._globalState&&(e=Jn(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=o,this._evaluator.canonical=u,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)}evaluate(e,i,o,u,p,m){this._globalState&&(e=Jn(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=o||null,this._evaluator.canonical=u,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=m||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new ji(`Expected value to be one of ${Object.keys(this._enumValues).map((w=>JSON.stringify(w))).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function Ao(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in tc}function nc(n,e,i){const o=new el(tc,Ir,[],e?(function(p){const m={color:ta,string:qt,number:ht,enum:qt,boolean:Jt,formatted:hs,padding:Vs,numberArray:fs,colorArray:ds,projectionDefinition:Ou,resolvedImage:fn,variableAnchorOffsetCollection:Ul};return p.type==="array"?_r(m[p.value]||Xt,p.length):m[p.type]})(e):void 0),u=o.parse(n,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?ru(new th(u,e,i)):Mo(o.errors)}class Rr{constructor(e,i,o){this.kind=e,this._styleExpression=i,this.isStateDependent=e!=="constant"&&!ol(i.expression),this.globalStateRefs=$n(i.expression),this._globalState=o}evaluateWithoutErrorHandling(e,i,o,u,p,m){return this._globalState&&(e=Jn(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,i,o,u,p,m)}evaluate(e,i,o,u,p,m){return this._globalState&&(e=Jn(e,this._globalState)),this._styleExpression.evaluate(e,i,o,u,p,m)}}class Co{constructor(e,i,o,u,p){this.kind=e,this.zoomStops=o,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!ol(i.expression),this.globalStateRefs=$n(i.expression),this.interpolationType=u,this._globalState=p}evaluateWithoutErrorHandling(e,i,o,u,p,m){return this._globalState&&(e=Jn(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,i,o,u,p,m)}evaluate(e,i,o,u,p,m){return this._globalState&&(e=Jn(e,this._globalState)),this._styleExpression.evaluate(e,i,o,u,p,m)}interpolationFactor(e,i,o){return this.interpolationType?Pr.interpolationFactor(this.interpolationType,e,i,o):0}}function Do(n,e,i){const o=nc(n,e,i);if(o.result==="error")return o;const u=o.value.expression,p=qs(u);if(!p&&!Aa(e))return Mo([new Er("","data expressions not supported")]);const m=ll(u,["zoom"]);if(!m&&!id(e))return Mo([new Er("","zoom expressions not supported")]);const v=zo(u);return v||m?v instanceof Er?Mo([v]):v instanceof Pr&&!ic(e)?Mo([new Er("",'"interpolate" expressions cannot be used with this property')]):ru(v?new Co(p?"camera":"composite",o.value,v.labels,v instanceof Pr?v.interpolation:void 0,i):new Rr(p?"constant":"source",o.value,i)):Mo([new Er("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class cl{constructor(e,i){this._parameters=e,this._specification=i,Tn(this,Ju(this._parameters,this._specification))}static deserialize(e){return new cl(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function zo(n){let e=null;if(n instanceof Ci)e=zo(n.result);else if(n instanceof il){for(const i of n.args)if(e=zo(i),e)break}else(n instanceof vo||n instanceof Pr)&&n.input instanceof ra&&n.input.name==="zoom"&&(e=n);return e instanceof Er||n.eachChild((i=>{const o=zo(i);o instanceof Er?e=o:!e&&o?e=new Er("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&o&&e!==o&&(e=new Er("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function $n(n,e=new Set){return n instanceof nu&&e.add(n.key),n.eachChild((i=>{$n(i,e)})),e}function Jn(n,e){const{zoom:i,heatmapDensity:o,elevation:u,lineProgress:p,isSupportedScript:m,accumulated:v}=n??{};return{zoom:i,heatmapDensity:o,elevation:u,lineProgress:p,isSupportedScript:m,accumulated:v,globalState:e}}function xs(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!xs(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const vs={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Fr(n,e){if(n==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};xs(n)||(n=ul(n));const i=nc(n,vs,e);if(i.result==="error")throw new Error(i.value.map((o=>`${o.key}: ${o.message}`)).join(", "));return{filter:(o,u,p)=>i.value.evaluate(o,u,{},p),needGeometry:rd(n),getGlobalStateRefs:()=>$n(i.value.expression)}}function Zs(n,e){return n<e?-1:n>e?1:0}function rd(n){if(!Array.isArray(n))return!1;if(n[0]==="within"||n[0]==="distance")return!0;for(let e=1;e<n.length;e++)if(rd(n[e]))return!0;return!1}function ul(n){if(!n)return!0;const e=n[0];return n.length<=1?e!=="any":e==="=="?rc(n[1],n[2],"=="):e==="!="?Bi(rc(n[1],n[2],"==")):e==="<"||e===">"||e==="<="||e===">="?rc(n[1],n[2],e):e==="any"?(i=n.slice(1),["any"].concat(i.map(ul))):e==="all"?["all"].concat(n.slice(1).map(ul)):e==="none"?["all"].concat(n.slice(1).map(ul).map(Bi)):e==="in"?ad(n[1],n.slice(2)):e==="!in"?Bi(ad(n[1],n.slice(2))):e==="has"?er(n[1]):e!=="!has"||Bi(er(n[1]));var i}function rc(n,e,i){switch(n){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,n,e]}}function ad(n,e){if(e.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((i=>typeof i!=typeof e[0]))?["filter-in-large",n,["literal",e.sort(Zs)]]:["filter-in-small",n,["literal",e]]}}function er(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Bi(n){return["!",n]}function ui(n){const e=typeof n;if(e==="number"||e==="boolean"||e==="string"||n==null)return JSON.stringify(n);if(Array.isArray(n)){let u="[";for(const p of n)u+=`${ui(p)},`;return`${u}]`}const i=Object.keys(n).sort();let o="{";for(let u=0;u<i.length;u++)o+=`${JSON.stringify(i[u])}:${ui(n[i[u]])},`;return`${o}}`}function Hs(n){let e="";for(const i of Ut)e+=`/${ui(n[i])}`;return e}function la(n){const e=n.value;return e?[new tt(n.key,e,"constants have been deprecated as of v8")]:[]}function cn(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function Nr(n){if(Array.isArray(n))return n.map(Nr);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const i in n)e[i]=Nr(n[i]);return e}return cn(n)}function Vr(n){const e=n.key,i=n.value,o=n.valueSpec||{},u=n.objectElementValidators||{},p=n.style,m=n.styleSpec,v=n.validateSpec;let w=[];const C=Kt(i);if(C!=="object")return[new tt(e,i,`object expected, ${C} found`)];for(const P in i){const L=P.split(".")[0],O=Zl(o,L)||o["*"];let F;if(Zl(u,L))F=u[L];else if(Zl(o,L)){if(i[P]===void 0)continue;F=v}else if(u["*"])F=u["*"];else{if(!o["*"]){w.push(new tt(e,i[P],`unknown property "${P}"`));continue}F=v}w=w.concat(F({key:(e&&`${e}.`)+P,value:i[P],valueSpec:O,style:p,styleSpec:m,object:i,objectKey:P,validateSpec:v},i))}for(const P in o)u[P]||o[P].required&&o[P].default===void 0&&i[P]===void 0&&w.push(new tt(e,i,`missing required property "${P}"`));return w}function au(n){const e=n.value,i=n.valueSpec,o=n.style,u=n.styleSpec,p=n.key,m=n.arrayElementValidator||n.validateSpec;if(Kt(e)!=="array")return[new tt(p,e,`array expected, ${Kt(e)} found`)];if(i.length&&e.length!==i.length)return[new tt(p,e,`array length ${i.length} expected, length ${e.length} found`)];let v={type:i.value,values:i.values};u.$version<7&&(v.function=i.function),Kt(i.value)==="object"&&(v=i.value);let w=[];for(let C=0;C<e.length;C++)w=w.concat(m({array:e,arrayIndex:C,value:e[C],valueSpec:v,validateSpec:n.validateSpec,style:o,styleSpec:u,key:`${p}[${C}]`}));return w}function bs(n){const e=n.key,i=n.value,o=n.valueSpec;let u=Kt(i);return u==="number"&&i!=i&&(u="NaN"),u!=="number"?[new tt(e,i,`number expected, ${u} found`)]:"minimum"in o&&i<o.minimum?[new tt(e,i,`${i} is less than the minimum value ${o.minimum}`)]:"maximum"in o&&i>o.maximum?[new tt(e,i,`${i} is greater than the maximum value ${o.maximum}`)]:[]}function ws(n){const e=n.valueSpec,i=cn(n.value.type);let o,u,p,m={};const v=i!=="categorical"&&n.value.property===void 0,w=!v,C=Kt(n.value.stops)==="array"&&Kt(n.value.stops[0])==="array"&&Kt(n.value.stops[0][0])==="object",P=Vr({key:n.key,value:n.value,valueSpec:n.styleSpec.function,validateSpec:n.validateSpec,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(F){if(i==="identity")return[new tt(F.key,F.value,'identity function may not have a "stops" property')];let q=[];const Z=F.value;return q=q.concat(au({key:F.key,value:Z,valueSpec:F.valueSpec,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:L})),Kt(Z)==="array"&&Z.length===0&&q.push(new tt(F.key,Z,"array must have at least one stop")),q},default:function(F){return F.validateSpec({key:F.key,value:F.value,valueSpec:e,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec})}}});return i==="identity"&&v&&P.push(new tt(n.key,n.value,'missing required property "property"')),i==="identity"||n.value.stops||P.push(new tt(n.key,n.value,'missing required property "stops"')),i==="exponential"&&n.valueSpec.expression&&!ic(n.valueSpec)&&P.push(new tt(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(w&&!Aa(n.valueSpec)?P.push(new tt(n.key,n.value,"property functions not supported")):v&&!id(n.valueSpec)&&P.push(new tt(n.key,n.value,"zoom functions not supported"))),i!=="categorical"&&!C||n.value.property!==void 0||P.push(new tt(n.key,n.value,'"property" property is required')),P;function L(F){let q=[];const Z=F.value,$=F.key;if(Kt(Z)!=="array")return[new tt($,Z,`array expected, ${Kt(Z)} found`)];if(Z.length!==2)return[new tt($,Z,`array length 2 expected, length ${Z.length} found`)];if(C){if(Kt(Z[0])!=="object")return[new tt($,Z,`object expected, ${Kt(Z[0])} found`)];if(Z[0].zoom===void 0)return[new tt($,Z,"object stop key must have zoom")];if(Z[0].value===void 0)return[new tt($,Z,"object stop key must have value")];if(p&&p>cn(Z[0].zoom))return[new tt($,Z[0].zoom,"stop zoom values must appear in ascending order")];cn(Z[0].zoom)!==p&&(p=cn(Z[0].zoom),u=void 0,m={}),q=q.concat(Vr({key:`${$}[0]`,value:Z[0],valueSpec:{zoom:{}},validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:bs,value:O}}))}else q=q.concat(O({key:`${$}[0]`,value:Z[0],validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec},Z));return Ao(Nr(Z[1]))?q.concat([new tt(`${$}[1]`,Z[1],"expressions are not allowed in function stops.")]):q.concat(F.validateSpec({key:`${$}[1]`,value:Z[1],valueSpec:e,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec}))}function O(F,q){const Z=Kt(F.value),$=cn(F.value),ee=F.value!==null?F.value:q;if(o){if(Z!==o)return[new tt(F.key,ee,`${Z} stop domain type must match previous stop domain type ${o}`)]}else o=Z;if(Z!=="number"&&Z!=="string"&&Z!=="boolean")return[new tt(F.key,ee,"stop domain value must be a number, string, or boolean")];if(Z!=="number"&&i!=="categorical"){let ue=`number expected, ${Z} found`;return Aa(e)&&i===void 0&&(ue+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new tt(F.key,ee,ue)]}return i!=="categorical"||Z!=="number"||isFinite($)&&Math.floor($)===$?i!=="categorical"&&Z==="number"&&u!==void 0&&$<u?[new tt(F.key,ee,"stop domain values must appear in ascending order")]:(u=$,i==="categorical"&&$ in m?[new tt(F.key,ee,"stop domain values must be unique")]:(m[$]=!0,[])):[new tt(F.key,ee,`integer expected, found ${$}`)]}}function Ts(n){const e=(n.expressionContext==="property"?Do:nc)(Nr(n.value),n.valueSpec);if(e.result==="error")return e.value.map((o=>new tt(`${n.key}${o.key}`,n.value,o.message)));const i=e.value.expression||e.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!i.outputDefined())return[new tt(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!ol(i))return[new tt(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter"&&!ol(i))return[new tt(n.key,n.value,'"feature-state" data expressions are not supported with filters.')];if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!ll(i,["zoom","feature-state"]))return[new tt(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!qs(i))return[new tt(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function $s(n){const e=n.key,i=n.value,o=Kt(i);return o!=="string"?[new tt(e,i,`color expected, ${o} found`)]:Qt.parse(String(i))?[]:[new tt(e,i,`color expected, "${i}" found`)]}function Xs(n){const e=n.key,i=n.value,o=n.valueSpec,u=[];return Array.isArray(o.values)?o.values.indexOf(cn(i))===-1&&u.push(new tt(e,i,`expected one of [${o.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(o.values).indexOf(cn(i))===-1&&u.push(new tt(e,i,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(i)} found`)),u}function Ca(n){return xs(Nr(n.value))?Ts(Tn({},n,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ss(n)}function Ss(n){const e=n.value,i=n.key;if(Kt(e)!=="array")return[new tt(i,e,`array expected, ${Kt(e)} found`)];const o=n.styleSpec;let u,p=[];if(e.length<1)return[new tt(i,e,"filter array must have at least 1 element")];switch(p=p.concat(Xs({key:`${i}[0]`,value:e[0],valueSpec:o.filter_operator,style:n.style,styleSpec:n.styleSpec})),cn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&cn(e[1])==="$type"&&p.push(new tt(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&p.push(new tt(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=Kt(e[1]),u!=="string"&&p.push(new tt(`${i}[1]`,e[1],`string expected, ${u} found`)));for(let m=2;m<e.length;m++)u=Kt(e[m]),cn(e[1])==="$type"?p=p.concat(Xs({key:`${i}[${m}]`,value:e[m],valueSpec:o.geometry_type,style:n.style,styleSpec:n.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&p.push(new tt(`${i}[${m}]`,e[m],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let m=1;m<e.length;m++)p=p.concat(Ss({key:`${i}[${m}]`,value:e[m],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":u=Kt(e[1]),e.length!==2?p.push(new tt(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="string"&&p.push(new tt(`${i}[1]`,e[1],`string expected, ${u} found`))}return p}function Ys(n,e){const i=n.key,o=n.validateSpec,u=n.style,p=n.styleSpec,m=n.value,v=n.objectKey,w=p[`${e}_${n.layerType}`];if(!w)return[];const C=v.match(/^(.*)-transition$/);if(e==="paint"&&C&&w[C[1]]&&w[C[1]].transition)return o({key:i,value:m,valueSpec:p.transition,style:u,styleSpec:p});const P=n.valueSpec||w[v];if(!P)return[new tt(i,m,`unknown property "${v}"`)];let L;if(Kt(m)==="string"&&Aa(P)&&!P.tokens&&(L=/^{([^}]+)}$/.exec(m)))return[new tt(i,m,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const O=[];return n.layerType==="symbol"&&v==="text-font"&&Qu(Nr(m))&&cn(m.type)==="identity"&&O.push(new tt(i,m,'"text-font" does not support identity functions')),O.concat(o({key:n.key,value:m,valueSpec:P,style:u,styleSpec:p,expressionContext:"property",propertyType:e,propertyKey:v}))}function Ms(n){return Ys(n,"paint")}function ih(n){return Ys(n,"layout")}function nh(n){let e=[];const i=n.value,o=n.key,u=n.style,p=n.styleSpec;if(Kt(i)!=="object")return[new tt(o,i,`object expected, ${Kt(i)} found`)];i.type||i.ref||e.push(new tt(o,i,'either "type" or "ref" is required'));let m=cn(i.type);const v=cn(i.ref);if(i.id){const w=cn(i.id);for(let C=0;C<n.arrayIndex;C++){const P=u.layers[C];cn(P.id)===w&&e.push(new tt(o,i.id,`duplicate layer id "${i.id}", previously used at line ${P.id.__line__}`))}}if("ref"in i){let w;["type","source","source-layer","filter","layout"].forEach((C=>{C in i&&e.push(new tt(o,i[C],`"${C}" is prohibited for ref layers`))})),u.layers.forEach((C=>{cn(C.id)===v&&(w=C)})),w?w.ref?e.push(new tt(o,i.ref,"ref cannot reference another ref layer")):m=cn(w.type):e.push(new tt(o,i.ref,`ref layer "${v}" not found`))}else if(m!=="background")if(i.source){const w=u.sources&&u.sources[i.source],C=w&&cn(w.type);w?C==="vector"&&m==="raster"?e.push(new tt(o,i.source,`layer "${i.id}" requires a raster source`)):C!=="raster-dem"&&m==="hillshade"||C!=="raster-dem"&&m==="color-relief"?e.push(new tt(o,i.source,`layer "${i.id}" requires a raster-dem source`)):C==="raster"&&m!=="raster"?e.push(new tt(o,i.source,`layer "${i.id}" requires a vector source`)):C!=="vector"||i["source-layer"]?C==="raster-dem"&&m!=="hillshade"&&m!=="color-relief"?e.push(new tt(o,i.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):m!=="line"||!i.paint||!i.paint["line-gradient"]||C==="geojson"&&w.lineMetrics||e.push(new tt(o,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new tt(o,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new tt(o,i.source,`source "${i.source}" not found`))}else e.push(new tt(o,i,'missing required property "source"'));return e=e.concat(Vr({key:o,value:i,valueSpec:p.layer,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,objectElementValidators:{"*":()=>[],type:()=>n.validateSpec({key:`${o}.type`,value:i.type,valueSpec:p.layer.type,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,object:i,objectKey:"type"}),filter:Ca,layout:w=>Vr({layer:i,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":C=>ih(Tn({layerType:m},C))}}),paint:w=>Vr({layer:i,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":C=>Ms(Tn({layerType:m},C))}})}})),e}function ca(n){const e=n.value,i=n.key,o=Kt(e);return o!=="string"?[new tt(i,e,`string expected, ${o} found`)]:[]}const ac={promoteId:function({key:n,value:e}){if(Kt(e)==="string")return ca({key:n,value:e});{const i=[];for(const o in e)i.push(...ca({key:`${n}.${o}`,value:e[o]}));return i}}};function Ws(n){const e=n.value,i=n.key,o=n.styleSpec,u=n.style,p=n.validateSpec;if(!e.type)return[new tt(i,e,'"type" is required')];const m=cn(e.type);let v;switch(m){case"vector":case"raster":return v=Vr({key:i,value:e,valueSpec:o[`source_${m.replace("-","_")}`],style:n.style,styleSpec:o,objectElementValidators:ac,validateSpec:p}),v;case"raster-dem":return v=(function(w){var C;const P=(C=w.sourceName)!==null&&C!==void 0?C:"",L=w.value,O=w.styleSpec,F=O.source_raster_dem,q=w.style;let Z=[];const $=Kt(L);if(L===void 0)return Z;if($!=="object")return Z.push(new tt("source_raster_dem",L,`object expected, ${$} found`)),Z;const ee=cn(L.encoding)==="custom",ue=["redFactor","greenFactor","blueFactor","baseShift"],ie=w.value.encoding?`"${w.value.encoding}"`:"Default";for(const re in L)!ee&&ue.includes(re)?Z.push(new tt(re,L[re],`In "${P}": "${re}" is only valid when "encoding" is set to "custom". ${ie} encoding found`)):F[re]?Z=Z.concat(w.validateSpec({key:re,value:L[re],valueSpec:F[re],validateSpec:w.validateSpec,style:q,styleSpec:O})):Z.push(new tt(re,L[re],`unknown property "${re}"`));return Z})({sourceName:i,value:e,style:n.style,styleSpec:o,validateSpec:p}),v;case"geojson":if(v=Vr({key:i,value:e,valueSpec:o.source_geojson,style:u,styleSpec:o,validateSpec:p,objectElementValidators:ac}),e.cluster)for(const w in e.clusterProperties){const[C,P]=e.clusterProperties[w],L=typeof C=="string"?[C,["accumulated"],["get",w]]:C;v.push(...Ts({key:`${i}.${w}.map`,value:P,expressionContext:"cluster-map"})),v.push(...Ts({key:`${i}.${w}.reduce`,value:L,expressionContext:"cluster-reduce"}))}return v;case"video":return Vr({key:i,value:e,valueSpec:o.source_video,style:u,validateSpec:p,styleSpec:o});case"image":return Vr({key:i,value:e,valueSpec:o.source_image,style:u,validateSpec:p,styleSpec:o});case"canvas":return[new tt(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xs({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Pn(n){const e=n.value,i=n.styleSpec,o=i.light,u=n.style;let p=[];const m=Kt(e);if(e===void 0)return p;if(m!=="object")return p=p.concat([new tt("light",e,`object expected, ${m} found`)]),p;for(const v in e){const w=v.match(/^(.*)-transition$/);p=p.concat(w&&o[w[1]]&&o[w[1]].transition?n.validateSpec({key:v,value:e[v],valueSpec:i.transition,validateSpec:n.validateSpec,style:u,styleSpec:i}):o[v]?n.validateSpec({key:v,value:e[v],valueSpec:o[v],validateSpec:n.validateSpec,style:u,styleSpec:i}):[new tt(v,e[v],`unknown property "${v}"`)])}return p}function su(n){const e=n.value,i=n.styleSpec,o=i.sky,u=n.style,p=Kt(e);if(e===void 0)return[];if(p!=="object")return[new tt("sky",e,`object expected, ${p} found`)];let m=[];for(const v in e)m=m.concat(o[v]?n.validateSpec({key:v,value:e[v],valueSpec:o[v],style:u,styleSpec:i}):[new tt(v,e[v],`unknown property "${v}"`)]);return m}function rh(n){const e=n.value,i=n.styleSpec,o=i.terrain,u=n.style;let p=[];const m=Kt(e);if(e===void 0)return p;if(m!=="object")return p=p.concat([new tt("terrain",e,`object expected, ${m} found`)]),p;for(const v in e)p=p.concat(o[v]?n.validateSpec({key:v,value:e[v],valueSpec:o[v],validateSpec:n.validateSpec,style:u,styleSpec:i}):[new tt(v,e[v],`unknown property "${v}"`)]);return p}function sd(n){let e=[];const i=n.value,o=n.key;if(Array.isArray(i)){const u=[],p=[];for(const m in i)i[m].id&&u.includes(i[m].id)&&e.push(new tt(o,i,`all the sprites' ids must be unique, but ${i[m].id} is duplicated`)),u.push(i[m].id),i[m].url&&p.includes(i[m].url)&&e.push(new tt(o,i,`all the sprites' URLs must be unique, but ${i[m].url} is duplicated`)),p.push(i[m].url),e=e.concat(Vr({key:`${o}[${m}]`,value:i[m],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:n.validateSpec}));return e}return ca({key:o,value:i})}function Mf(n){return!!n&&n.constructor===Object}function od(n){return Mf(n.value)?[]:[new tt(n.key,n.value,`object expected, ${Kt(n.value)} found`)]}const Mn={"*":()=>[],array:au,boolean:function(n){const e=n.value,i=n.key,o=Kt(e);return o!=="boolean"?[new tt(i,e,`boolean expected, ${o} found`)]:[]},number:bs,color:$s,constants:la,enum:Xs,filter:Ca,function:ws,layer:nh,object:Vr,source:Ws,light:Pn,sky:su,terrain:rh,projection:function(n){const e=n.value,i=n.styleSpec,o=i.projection,u=n.style,p=Kt(e);if(e===void 0)return[];if(p!=="object")return[new tt("projection",e,`object expected, ${p} found`)];let m=[];for(const v in e)m=m.concat(o[v]?n.validateSpec({key:v,value:e[v],valueSpec:o[v],style:u,styleSpec:i}):[new tt(v,e[v],`unknown property "${v}"`)]);return m},projectionDefinition:function(n){const e=n.key;let i=n.value;i=i instanceof String?i.valueOf():i;const o=Kt(i);return o!=="array"||(function(u){return Array.isArray(u)&&u.length===3&&typeof u[0]=="string"&&typeof u[1]=="string"&&typeof u[2]=="number"})(i)||(function(u){return!!["interpolate","step","literal"].includes(u[0])})(i)?["array","string"].includes(o)?[]:[new tt(e,i,`projection expected, invalid type "${o}" found`)]:[new tt(e,i,`projection expected, invalid array ${JSON.stringify(i)} found`)]},string:ca,formatted:function(n){return ca(n).length===0?[]:Ts(n)},resolvedImage:function(n){return ca(n).length===0?[]:Ts(n)},padding:function(n){const e=n.key,i=n.value;if(Kt(i)==="array"){if(i.length<1||i.length>4)return[new tt(e,i,`padding requires 1 to 4 values; ${i.length} values found`)];const o={type:"number"};let u=[];for(let p=0;p<i.length;p++)u=u.concat(n.validateSpec({key:`${e}[${p}]`,value:i[p],validateSpec:n.validateSpec,valueSpec:o}));return u}return bs({key:e,value:i,valueSpec:{}})},numberArray:function(n){const e=n.key,i=n.value;if(Kt(i)==="array"){const o={type:"number"};if(i.length<1)return[new tt(e,i,"array length at least 1 expected, length 0 found")];let u=[];for(let p=0;p<i.length;p++)u=u.concat(n.validateSpec({key:`${e}[${p}]`,value:i[p],validateSpec:n.validateSpec,valueSpec:o}));return u}return bs({key:e,value:i,valueSpec:{}})},colorArray:function(n){const e=n.key,i=n.value;if(Kt(i)==="array"){if(i.length<1)return[new tt(e,i,"array length at least 1 expected, length 0 found")];let o=[];for(let u=0;u<i.length;u++)o=o.concat($s({key:`${e}[${u}]`,value:i[u]}));return o}return $s({key:e,value:i})},variableAnchorOffsetCollection:function(n){const e=n.key,i=n.value,o=Kt(i),u=n.styleSpec;if(o!=="array"||i.length<1||i.length%2!=0)return[new tt(e,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let p=[];for(let m=0;m<i.length;m+=2)p=p.concat(Xs({key:`${e}[${m}]`,value:i[m],valueSpec:u.layout_symbol["text-anchor"]})),p=p.concat(au({key:`${e}[${m+1}]`,value:i[m+1],valueSpec:{length:2,value:"number"},validateSpec:n.validateSpec,style:n.style,styleSpec:u}));return p},sprite:sd,state:od,fontFaces:function(n){const e=n.key,i=n.value,o=n.validateSpec,u=n.styleSpec,p=n.style;if(!Mf(i))return[new tt(e,i,`object expected, ${Kt(i)} found`)];const m=[];for(const v in i){const w=i[v],C=Kt(w);if(C==="string")m.push(...ca({key:`${e}.${v}`,value:w}));else if(C==="array"){const P={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[L,O]of w.entries())m.push(...Vr({key:`${e}.${v}[${L}]`,value:O,valueSpec:P,styleSpec:u,style:p,validateSpec:o}))}else m.push(new tt(`${e}.${v}`,w,`string or array expected, ${C} found`))}return m}};function Es(n){const e=n.value,i=n.valueSpec,o=n.styleSpec;return n.validateSpec=Es,i.expression&&Qu(cn(e))?ws(n):i.expression&&Ao(Nr(e))?Ts(n):i.type&&Mn[i.type]?Mn[i.type](n):Vr(Tn({},n,{valueSpec:i.type?o[i.type]:i}))}function sc(n){const e=n.value,i=n.key,o=ca(n);return o.length||(e.indexOf("{fontstack}")===-1&&o.push(new tt(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&o.push(new tt(i,e,'"glyphs" url must include a "{range}" token'))),o}function xr(n,e=Te){let i=[];return i=i.concat(Es({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,validateSpec:Es,objectElementValidators:{glyphs:sc,"*":()=>[]}})),n.constants&&(i=i.concat(la({key:"constants",value:n.constants}))),hl(i)}function ua(n){return function(e){return n(Object.assign({},e,{validateSpec:Es}))}}function hl(n){return[].concat(n).sort(((e,i)=>e.line-i.line))}function vr(n){return function(...e){return hl(n.apply(this,e))}}xr.source=vr(ua(Ws)),xr.sprite=vr(ua(sd)),xr.glyphs=vr(ua(sc)),xr.light=vr(ua(Pn)),xr.sky=vr(ua(su)),xr.terrain=vr(ua(rh)),xr.state=vr(ua(od)),xr.layer=vr(ua(nh)),xr.filter=vr(ua(Ca)),xr.paintProperty=vr(ua(Ms)),xr.layoutProperty=vr(ua(ih));const Gp={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class oc{constructor(e,i){this._globalState=i,this.setValue(e)}evaluate(){var e;return(e=this._literalValue)!==null&&e!==void 0?e:this._compiledValue.evaluate({})}setValue(e){if(e==null||e==="visible"||e==="none")return this._literalValue=e==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const i=nc(e,Gp,this._globalState);if(i.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(i.value.map((o=>`${o.key}: ${o.message}`)).join(", "));this._literalValue=void 0,this._compiledValue=i.value,this._globalStateRefs=$n(i.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const ou=Te,Xn=xr,$a=Xn.light,ah=Xn.sky,sh=Xn.paintProperty,Ef=Xn.layoutProperty;function Xa(n,e){let i=!1;if(e&&e.length)for(const o of e)n.fire(new $e(new Error(o.message))),i=!0;return i}class Po{constructor(e,i,o){const u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const m=new Int32Array(this.arrayBuffer);e=m[0],this.d=(i=m[1])+2*(o=m[2]);for(let w=0;w<this.d*this.d;w++){const C=m[3+w],P=m[3+w+1];u.push(C===P?null:m.subarray(C,P))}const v=m[3+u.length+1];this.keys=m.subarray(m[3+u.length],v),this.bboxes=m.subarray(v),this.insert=this._insertReadonly}else{this.d=i+2*o;for(let m=0;m<this.d*this.d;m++)u.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=e,this.padding=o,this.scale=i/e,this.uid=0;const p=o/i*e;this.min=-p,this.max=e+p}insert(e,i,o,u,p){this._forEachCell(i,o,u,p,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(p)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,i,o,u,p,m){this.cells[p].push(m)}query(e,i,o,u,p){const m=this.min,v=this.max;if(e<=m&&i<=m&&v<=o&&v<=u&&!p)return Array.prototype.slice.call(this.keys);{const w=[];return this._forEachCell(e,i,o,u,this._queryCell,w,{},p),w}}_queryCell(e,i,o,u,p,m,v,w){const C=this.cells[p];if(C!==null){const P=this.keys,L=this.bboxes;for(let O=0;O<C.length;O++){const F=C[O];if(v[F]===void 0){const q=4*F;(w?w(L[q+0],L[q+1],L[q+2],L[q+3]):e<=L[q+2]&&i<=L[q+3]&&o>=L[q+0]&&u>=L[q+1])?(v[F]=!0,m.push(P[F])):v[F]=!1}}}}_forEachCell(e,i,o,u,p,m,v,w){const C=this._convertToCellCoord(e),P=this._convertToCellCoord(i),L=this._convertToCellCoord(o),O=this._convertToCellCoord(u);for(let F=C;F<=L;F++)for(let q=P;q<=O;q++){const Z=this.d*q+F;if((!w||w(this._convertFromCellCoord(F),this._convertFromCellCoord(q),this._convertFromCellCoord(F+1),this._convertFromCellCoord(q+1)))&&p.call(this,e,i,o,u,Z,m,v,w))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,i=3+this.cells.length+1+1;let o=0;for(let m=0;m<this.cells.length;m++)o+=this.cells[m].length;const u=new Int32Array(i+o+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;let p=i;for(let m=0;m<e.length;m++){const v=e[m];u[3+m]=p,u.set(v,p),p+=v.length}return u[3+e.length]=p,u.set(this.keys,p),p+=this.keys.length,u[3+e.length+1]=p,u.set(this.bboxes,p),p+=this.bboxes.length,u.buffer}static serialize(e,i){const o=e.toArrayBuffer();return i&&i.push(o),{buffer:o}}static deserialize(e){return new Po(e.buffer)}}const Ur={};function wt(n,e,i={}){if(Ur[n])throw new Error(`${n} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:n,writeable:!1}),Ur[n]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}wt("Object",Object),wt("Set",Set),wt("TransferableGridIndex",Po),wt("Color",Qt),wt("Error",Error),wt("AJAXError",pe),wt("ResolvedImage",Cr),wt("StylePropertyFunction",cl),wt("StyleExpression",th,{omit:["_evaluator"]}),wt("ZoomDependentExpression",Co),wt("ZoomConstantExpression",Rr),wt("CompoundExpression",ra,{omit:["_evaluate"]});for(const n in tc)tc[n]._classRegistryKey||wt(`Expression_${n}`,tc[n]);function lu(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function oh(n){return n.$name||n.constructor._classRegistryKey}function Da(n){return!(function(e){if(e===null||typeof e!="object")return!1;const i=oh(e);return!(!i||i==="Object")})(n)&&(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob||n instanceof Error||lu(n)||cs(n)||ArrayBuffer.isView(n)||n instanceof ImageData)}function Ya(n,e){if(Da(n))return(lu(n)||cs(n))&&e&&e.push(n),ArrayBuffer.isView(n)&&e&&e.push(n.buffer),n instanceof ImageData&&e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const p=[];for(const m of n)p.push(Ya(m,e));return p}if(typeof n!="object")throw new Error("can't serialize object of type "+typeof n);const i=oh(n);if(!i)throw new Error(`can't serialize object of unregistered class ${n.constructor.name}`);if(!Ur[i])throw new Error(`${i} is not registered.`);const{klass:o}=Ur[i],u=o.serialize?o.serialize(n,e):{};if(o.serialize){if(e&&u===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const p in n){if(!n.hasOwnProperty(p)||Ur[i].omit.indexOf(p)>=0)continue;const m=n[p];u[p]=Ur[i].shallow.indexOf(p)>=0?m:Ya(m,e)}n instanceof Error&&(u.message=n.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return i!=="Object"&&(u.$name=i),u}function lc(n){if(Da(n))return n;if(Array.isArray(n))return n.map(lc);if(typeof n!="object")throw new Error("can't deserialize object of type "+typeof n);const e=oh(n)||"Object";if(!Ur[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:i}=Ur[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(n);const o=Object.create(i.prototype);for(const u of Object.keys(n)){if(u==="$name")continue;const p=n[u];o[u]=Ur[e].shallow.indexOf(u)>=0?p:lc(p)}return o}class lh{constructor(){this.first=!0}update(e,i){const o=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=o,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=o,!0):(this.lastFloorZoom>o?(this.lastIntegerZoom=o+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<o&&(this.lastIntegerZoom=o,this.lastIntegerZoomTime=i),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=o,!0))}}function As(n){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(n))}function dl(n){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(n))}function cu(n){return/\s/u.test(String.fromCodePoint(n))}function Cs(n){for(const e of n)if(dl(e.codePointAt(0)))return!0;return!1}function ch(n){for(const e of n)if(!ld(e.codePointAt(0)))return!1;return!0}function uu(n){const e=n.map((i=>{try{return new RegExp(`\\p{sc=${i}}`,"u").source}catch{return null}})).filter((i=>i));return new RegExp(e.join("|"),"u")}const Ds=uu(["Arab","Dupl","Mong","Ougr","Syrc"]);function ld(n){return!Ds.test(String.fromCodePoint(n))}function zs(n){return!(dl(n)||(e=n,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(e))));var e}const uh=uu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function hu(n){return uh.test(String.fromCodePoint(n))}function Ps(n,e){return!(!e&&hu(n)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(n)))}function Ks(n){for(const e of n)if(hu(e.codePointAt(0)))return!0;return!1}const za=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(n){this.pluginStatus=n.pluginStatus,this.pluginURL=n.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(n){if(za.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=n.applyArabicShaping,this.processBidirectionalText=n.processBidirectionalText,this.processStyledBidirectionalText=n.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(n,e){return c(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(n.pluginStatus!=="loading")return this.setState(n),n;const i=n.pluginURL,o=new Promise((p=>{this.loadScriptResolve=p}));e(i);const u=new Promise((p=>setTimeout((()=>p()),this.TIMEOUT)));if(yield Promise.race([o,u]),this.isParsed()){const p={pluginStatus:"loaded",pluginURL:i};return this.setState(p),p}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${i}`)}))}};class Mi{constructor(e,i){this.isSupportedScript=cd,this.zoom=e,i?(this.now=i.now||0,this.fadeDuration=i.fadeDuration||0,this.zoomHistory=i.zoomHistory||new lh,this.transition=i.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new lh,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,i=e-Math.floor(e),o=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*o}:{fromScale:.5,toScale:1,t:1-(1-o)*i}}}function cd(n){return(function(e,i){for(const o of e)if(!Ps(o.codePointAt(0),i))return!1;return!0})(n,za.getRTLTextPluginStatus()==="loaded")}const Qs="-transition";class Io{constructor(e,i,o){this.property=e,this.value=i,this.expression=(function(u,p,m){if(Qu(u))return new cl(u,p);if(Ao(u)){const v=Do(u,p,m);if(v.result==="error")throw new Error(v.value.map((w=>`${w.key}: ${w.message}`)).join(", "));return v.value}{let v=u;return p.type==="color"&&typeof u=="string"?v=Qt.parse(u):p.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?p.type!=="numberArray"||typeof u!="number"&&!Array.isArray(u)?p.type!=="colorArray"||typeof u!="string"&&!Array.isArray(u)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(u)?v=pn.parse(u):p.type==="projectionDefinition"&&typeof u=="string"&&(v=Hn.parse(u)):v=Vt.parse(u):v=Qi.parse(u):v=zn.parse(u),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>v}}})(i===void 0?e.specification.default:i,e.specification,o)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(e,i,o){return this.property.possiblyEvaluate(this,e,i,o)}}class du{constructor(e,i){this.property=e,this.value=new Io(e,void 0,i)}transitioned(e,i){return new fl(this.property,this.value,i,Li({},e.transition,this.transition),e.now)}untransitioned(){return new fl(this.property,this.value,null,{},0)}}class hh{constructor(e,i){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._globalState=i}getValue(e){return Qr(this._values[e].value.value)}setValue(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new du(this._values[e].property,this._globalState)),this._values[e].value=new Io(this._values[e].property,i===null?void 0:Qr(i),this._globalState)}getTransition(e){return Qr(this._values[e].transition)}setTransition(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new du(this._values[e].property,this._globalState)),this._values[e].transition=Qr(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const o=this.getValue(i);o!==void 0&&(e[i]=o);const u=this.getTransition(i);u!==void 0&&(e[`${i}${Qs}`]=u)}return e}transitioned(e,i){const o=new fu(this._properties);for(const u of Object.keys(this._values))o._values[u]=this._values[u].transitioned(e,i._values[u]);return o}untransitioned(){const e=new fu(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class fl{constructor(e,i,o,u,p){this.property=e,this.value=i,this.begin=p+u.delay||0,this.end=this.begin+u.duration||0,e.specification.transition&&(u.delay||u.duration)&&(this.prior=o)}possiblyEvaluate(e,i,o){const u=e.now||0,p=this.value.possiblyEvaluate(e,i,o),m=this.prior;if(m){if(u>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(u<this.begin)return m.possiblyEvaluate(e,i,o);{const v=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,i,o),p,St(v))}}return p}}class fu{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,o){const u=new pl(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].possiblyEvaluate(e,i,o);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class ud{constructor(e,i){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._globalState=i}hasValue(e){return this._values[e].value!==void 0}getValue(e){return Qr(this._values[e].value)}setValue(e,i){this._values[e]=new Io(this._values[e].property,i===null?void 0:Qr(i),this._globalState)}serialize(){const e={};for(const i of Object.keys(this._values)){const o=this.getValue(i);o!==void 0&&(e[i]=o)}return e}possiblyEvaluate(e,i,o){const u=new pl(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].possiblyEvaluate(e,i,o);return u}}class ha{constructor(e,i,o){this.property=e,this.value=i,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,o,u){return this.property.evaluate(this.value,this.parameters,e,i,o,u)}}class pl{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Tt{constructor(e){this.specification=e}possiblyEvaluate(e,i){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(i)}interpolate(e,i,o){const u=en[this.specification.type];return u?u(e,i,o):e}}class Ct{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,o,u){return new ha(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},o,u)}:e.expression,i)}interpolate(e,i,o){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new ha(this,{kind:"constant",value:void 0},e.parameters);const u=en[this.specification.type];if(u){const p=u(e.value.value,i.value.value,o);return new ha(this,{kind:"constant",value:p},e.parameters)}return e}evaluate(e,i,o,u,p,m){return e.kind==="constant"?e.value:e.evaluate(i,o,u,p,m)}}class Pa extends Ct{possiblyEvaluate(e,i,o,u){if(e.value===void 0)return new ha(this,{kind:"constant",value:void 0},i);if(e.expression.kind==="constant"){const p=e.expression.evaluate(i,null,{},o,u),m=e.property.specification.type==="resolvedImage"&&typeof p!="string"?p.name:p,v=this._calculate(m,m,m,i);return new ha(this,{kind:"constant",value:v},i)}if(e.expression.kind==="camera"){const p=this._calculate(e.expression.evaluate({zoom:i.zoom-1}),e.expression.evaluate({zoom:i.zoom}),e.expression.evaluate({zoom:i.zoom+1}),i);return new ha(this,{kind:"constant",value:p},i)}return new ha(this,e.expression,i)}evaluate(e,i,o,u,p,m){if(e.kind==="source"){const v=e.evaluate(i,o,u,p,m);return this._calculate(v,v,v,i)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(i.zoom)-1},o,u),e.evaluate({zoom:Math.floor(i.zoom)},o,u),e.evaluate({zoom:Math.floor(i.zoom)+1},o,u),i):e.value}_calculate(e,i,o,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:o,to:i}}interpolate(e){return e}}class cc{constructor(e){this.specification=e}possiblyEvaluate(e,i,o,u){if(e.value!==void 0){if(e.expression.kind==="constant"){const p=e.expression.evaluate(i,null,{},o,u);return this._calculate(p,p,p,i)}return this._calculate(e.expression.evaluate(new Mi(Math.floor(i.zoom-1),i)),e.expression.evaluate(new Mi(Math.floor(i.zoom),i)),e.expression.evaluate(new Mi(Math.floor(i.zoom+1),i)),i)}}_calculate(e,i,o,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:o,to:i}}interpolate(e){return e}}class pu{constructor(e){this.specification=e}possiblyEvaluate(e,i,o,u){return!!e.expression.evaluate(i,null,{},o,u)}interpolate(){return!1}}class En{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in e){const o=e[i];o.specification.overridable&&this.overridableProperties.push(i);const u=this.defaultPropertyValues[i]=new Io(o,void 0,void 0),p=this.defaultTransitionablePropertyValues[i]=new du(o,void 0);this.defaultTransitioningPropertyValues[i]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=u.possiblyEvaluate({})}}}wt("DataDrivenProperty",Ct),wt("DataConstantProperty",Tt),wt("CrossFadedDataDrivenProperty",Pa),wt("CrossFadedProperty",cc),wt("ColorRampProperty",pu);class un extends lt{constructor(e,i,o){if(super(),this.id=e.id,this.type=e.type,this._globalState=o,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},this._visibilityExpression=(function(u,p){return new oc(u,p)})(this.visibility,o),e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter,this._featureFilter=Fr(e.filter,o)),i.layout&&(this._unevaluatedLayout=new ud(i.layout,o)),i.paint)){this._transitionablePaint=new hh(i.paint,o);for(const u in e.paint)this.setPaintProperty(u,e.paint[u],{validate:!1});for(const u in e.layout)this.setLayoutProperty(u,e.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new pl(i.paint)}}setFilter(e){this.filter=e,this._featureFilter=Fr(e,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}getLayoutAffectingGlobalStateRefs(){const e=new Set;for(const i of this._visibilityExpression.getGlobalStateRefs())e.add(i);if(this._unevaluatedLayout)for(const i in this._unevaluatedLayout._values){const o=this._unevaluatedLayout._values[i];for(const u of o.getGlobalStateRefs())e.add(u)}for(const i of this._featureFilter.getGlobalStateRefs())e.add(i);return e}getPaintAffectingGlobalStateRefs(){var e;const i=new globalThis.Map;if(this._transitionablePaint)for(const o in this._transitionablePaint._values){const u=this._transitionablePaint._values[o].value;for(const p of u.getGlobalStateRefs()){const m=(e=i.get(p))!==null&&e!==void 0?e:[];m.push({name:o,value:u.value}),i.set(p,m)}}return i}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(e,i,o={}){if(i==null||!this._validate(Ef,`layers.${this.id}.layout.${e}`,e,i,o))return e==="visibility"?(this.visibility=i,this._visibilityExpression.setValue(i),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(e,i)}getPaintProperty(e){return e.endsWith(Qs)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,o={}){if(i!=null&&this._validate(sh,`layers.${this.id}.paint.${e}`,e,i,o))return!1;if(e.endsWith(Qs))return this._transitionablePaint.setTransition(e.slice(0,-11),i||void 0),!1;{const u=this._transitionablePaint._values[e],p=u.property.specification["property-type"]==="cross-faded-data-driven",m=u.value.isDataDriven(),v=u.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const w=this._transitionablePaint._values[e].value;return w.isDataDriven()||m||p||this._handleOverridablePaintPropertyUpdate(e,v,w)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,i,o){return!1}isHidden(e=this.minzoom,i=!1){return!!(this.minzoom&&e<(i?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&e>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(e,i){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Kr(e,((i,o)=>!(i===void 0||o==="layout"&&!Object.keys(i).length||o==="paint"&&!Object.keys(i).length)))}_validate(e,i,o,u,p={}){return(!p||p.validate!==!1)&&Xa(this,e.call(Xn,{key:i,layerType:this.type,objectKey:o,value:u,styleSpec:Te,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof ha&&Aa(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}}let gn;var mu={get paint(){return gn=gn||new En({"raster-opacity":new Tt(Te.paint_raster["raster-opacity"]),"raster-hue-rotate":new Tt(Te.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Tt(Te.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Tt(Te.paint_raster["raster-brightness-max"]),"raster-saturation":new Tt(Te.paint_raster["raster-saturation"]),"raster-contrast":new Tt(Te.paint_raster["raster-contrast"]),"raster-resampling":new Tt(Te.paint_raster["raster-resampling"]),"raster-fade-duration":new Tt(Te.paint_raster["raster-fade-duration"])})}};class Js extends un{constructor(e,i){super(e,mu,i)}}const ii={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ti{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ei{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function tn(n,e=1){let i=0,o=0;return{members:n.map((u=>{const p=ii[u.type].BYTES_PER_ELEMENT,m=i=Ia(i,Math.max(e,p)),v=u.components||1;return o=Math.max(o,p),i+=p*v,{name:u.name,type:u.type,components:v,offset:m}})),size:Ia(i,Math.max(o,e)),alignment:e}}function Ia(n,e){return Math.ceil(n/e)*e}class Wa extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const u=2*e;return this.int16[u+0]=i,this.int16[u+1]=o,e}}Wa.prototype.bytesPerElement=4,wt("StructArrayLayout2i4",Wa);class ml extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o)}emplace(e,i,o,u){const p=3*e;return this.int16[p+0]=i,this.int16[p+1]=o,this.int16[p+2]=u,e}}ml.prototype.bytesPerElement=6,wt("StructArrayLayout3i6",ml);class gl extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,o,u)}emplace(e,i,o,u,p){const m=4*e;return this.int16[m+0]=i,this.int16[m+1]=o,this.int16[m+2]=u,this.int16[m+3]=p,e}}gl.prototype.bytesPerElement=8,wt("StructArrayLayout4i8",gl);class eo extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,p,m){const v=this.length;return this.resize(v+1),this.emplace(v,e,i,o,u,p,m)}emplace(e,i,o,u,p,m,v){const w=6*e;return this.int16[w+0]=i,this.int16[w+1]=o,this.int16[w+2]=u,this.int16[w+3]=p,this.int16[w+4]=m,this.int16[w+5]=v,e}}eo.prototype.bytesPerElement=12,wt("StructArrayLayout2i4i12",eo);class hd extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,p,m){const v=this.length;return this.resize(v+1),this.emplace(v,e,i,o,u,p,m)}emplace(e,i,o,u,p,m,v){const w=4*e,C=8*e;return this.int16[w+0]=i,this.int16[w+1]=o,this.uint8[C+4]=u,this.uint8[C+5]=p,this.uint8[C+6]=m,this.uint8[C+7]=v,e}}hd.prototype.bytesPerElement=8,wt("StructArrayLayout2i4ub8",hd);class Yi extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const u=2*e;return this.float32[u+0]=i,this.float32[u+1]=o,e}}Yi.prototype.bytesPerElement=8,wt("StructArrayLayout2f8",Yi);class Ka extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,p,m,v,w,C,P){const L=this.length;return this.resize(L+1),this.emplace(L,e,i,o,u,p,m,v,w,C,P)}emplace(e,i,o,u,p,m,v,w,C,P,L){const O=10*e;return this.uint16[O+0]=i,this.uint16[O+1]=o,this.uint16[O+2]=u,this.uint16[O+3]=p,this.uint16[O+4]=m,this.uint16[O+5]=v,this.uint16[O+6]=w,this.uint16[O+7]=C,this.uint16[O+8]=P,this.uint16[O+9]=L,e}}Ka.prototype.bytesPerElement=20,wt("StructArrayLayout10ui20",Ka);class uc extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,p,m,v,w){const C=this.length;return this.resize(C+1),this.emplace(C,e,i,o,u,p,m,v,w)}emplace(e,i,o,u,p,m,v,w,C){const P=8*e;return this.uint16[P+0]=i,this.uint16[P+1]=o,this.uint16[P+2]=u,this.uint16[P+3]=p,this.uint16[P+4]=m,this.uint16[P+5]=v,this.uint16[P+6]=w,this.uint16[P+7]=C,e}}uc.prototype.bytesPerElement=16,wt("StructArrayLayout8ui16",uc);class hc extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,p,m,v,w,C,P,L,O){const F=this.length;return this.resize(F+1),this.emplace(F,e,i,o,u,p,m,v,w,C,P,L,O)}emplace(e,i,o,u,p,m,v,w,C,P,L,O,F){const q=12*e;return this.int16[q+0]=i,this.int16[q+1]=o,this.int16[q+2]=u,this.int16[q+3]=p,this.uint16[q+4]=m,this.uint16[q+5]=v,this.uint16[q+6]=w,this.uint16[q+7]=C,this.int16[q+8]=P,this.int16[q+9]=L,this.int16[q+10]=O,this.int16[q+11]=F,e}}hc.prototype.bytesPerElement=24,wt("StructArrayLayout4i4ui4i24",hc);class gu extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o)}emplace(e,i,o,u){const p=3*e;return this.float32[p+0]=i,this.float32[p+1]=o,this.float32[p+2]=u,e}}gu.prototype.bytesPerElement=12,wt("StructArrayLayout3f12",gu);class yu extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}yu.prototype.bytesPerElement=4,wt("StructArrayLayout1ul4",yu);class _u extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,p,m,v,w,C){const P=this.length;return this.resize(P+1),this.emplace(P,e,i,o,u,p,m,v,w,C)}emplace(e,i,o,u,p,m,v,w,C,P){const L=10*e,O=5*e;return this.int16[L+0]=i,this.int16[L+1]=o,this.int16[L+2]=u,this.int16[L+3]=p,this.int16[L+4]=m,this.int16[L+5]=v,this.uint32[O+3]=w,this.uint16[L+8]=C,this.uint16[L+9]=P,e}}_u.prototype.bytesPerElement=20,wt("StructArrayLayout6i1ul2ui20",_u);class Ro extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,p,m){const v=this.length;return this.resize(v+1),this.emplace(v,e,i,o,u,p,m)}emplace(e,i,o,u,p,m,v){const w=6*e;return this.int16[w+0]=i,this.int16[w+1]=o,this.int16[w+2]=u,this.int16[w+3]=p,this.int16[w+4]=m,this.int16[w+5]=v,e}}Ro.prototype.bytesPerElement=12,wt("StructArrayLayout2i2i2i12",Ro);class to extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,p){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,o,u,p)}emplace(e,i,o,u,p,m){const v=4*e,w=8*e;return this.float32[v+0]=i,this.float32[v+1]=o,this.float32[v+2]=u,this.int16[w+6]=p,this.int16[w+7]=m,e}}to.prototype.bytesPerElement=16,wt("StructArrayLayout2f1f2i16",to);class dr extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,p,m){const v=this.length;return this.resize(v+1),this.emplace(v,e,i,o,u,p,m)}emplace(e,i,o,u,p,m,v){const w=16*e,C=4*e,P=8*e;return this.uint8[w+0]=i,this.uint8[w+1]=o,this.float32[C+1]=u,this.float32[C+2]=p,this.int16[P+6]=m,this.int16[P+7]=v,e}}dr.prototype.bytesPerElement=16,wt("StructArrayLayout2ub2f2i16",dr);class nn extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o)}emplace(e,i,o,u){const p=3*e;return this.uint16[p+0]=i,this.uint16[p+1]=o,this.uint16[p+2]=u,e}}nn.prototype.bytesPerElement=6,wt("StructArrayLayout3ui6",nn);class Is extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,u,p,m,v,w,C,P,L,O,F,q,Z,$,ee){const ue=this.length;return this.resize(ue+1),this.emplace(ue,e,i,o,u,p,m,v,w,C,P,L,O,F,q,Z,$,ee)}emplace(e,i,o,u,p,m,v,w,C,P,L,O,F,q,Z,$,ee,ue){const ie=24*e,re=12*e,fe=48*e;return this.int16[ie+0]=i,this.int16[ie+1]=o,this.uint16[ie+2]=u,this.uint16[ie+3]=p,this.uint32[re+2]=m,this.uint32[re+3]=v,this.uint32[re+4]=w,this.uint16[ie+10]=C,this.uint16[ie+11]=P,this.uint16[ie+12]=L,this.float32[re+7]=O,this.float32[re+8]=F,this.uint8[fe+36]=q,this.uint8[fe+37]=Z,this.uint8[fe+38]=$,this.uint32[re+10]=ee,this.int16[ie+22]=ue,e}}Is.prototype.bytesPerElement=48,wt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Is);class yl extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,u,p,m,v,w,C,P,L,O,F,q,Z,$,ee,ue,ie,re,fe,_e,je,Qe,We,it,mt,ut){const Ye=this.length;return this.resize(Ye+1),this.emplace(Ye,e,i,o,u,p,m,v,w,C,P,L,O,F,q,Z,$,ee,ue,ie,re,fe,_e,je,Qe,We,it,mt,ut)}emplace(e,i,o,u,p,m,v,w,C,P,L,O,F,q,Z,$,ee,ue,ie,re,fe,_e,je,Qe,We,it,mt,ut,Ye){const qe=32*e,bt=16*e;return this.int16[qe+0]=i,this.int16[qe+1]=o,this.int16[qe+2]=u,this.int16[qe+3]=p,this.int16[qe+4]=m,this.int16[qe+5]=v,this.int16[qe+6]=w,this.int16[qe+7]=C,this.uint16[qe+8]=P,this.uint16[qe+9]=L,this.uint16[qe+10]=O,this.uint16[qe+11]=F,this.uint16[qe+12]=q,this.uint16[qe+13]=Z,this.uint16[qe+14]=$,this.uint16[qe+15]=ee,this.uint16[qe+16]=ue,this.uint16[qe+17]=ie,this.uint16[qe+18]=re,this.uint16[qe+19]=fe,this.uint16[qe+20]=_e,this.uint16[qe+21]=je,this.uint16[qe+22]=Qe,this.uint32[bt+12]=We,this.float32[bt+13]=it,this.float32[bt+14]=mt,this.uint16[qe+30]=ut,this.uint16[qe+31]=Ye,e}}yl.prototype.bytesPerElement=64,wt("StructArrayLayout8i15ui1ul2f2ui64",yl);class _l extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}_l.prototype.bytesPerElement=4,wt("StructArrayLayout1f4",_l);class dc extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o)}emplace(e,i,o,u){const p=3*e;return this.uint16[6*e+0]=i,this.float32[p+1]=o,this.float32[p+2]=u,e}}dc.prototype.bytesPerElement=12,wt("StructArrayLayout1ui2f12",dc);class Qa extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o)}emplace(e,i,o,u){const p=4*e;return this.uint32[2*e+0]=i,this.uint16[p+2]=o,this.uint16[p+3]=u,e}}Qa.prototype.bytesPerElement=8,wt("StructArrayLayout1ul2ui8",Qa);class y extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const u=2*e;return this.uint16[u+0]=i,this.uint16[u+1]=o,e}}y.prototype.bytesPerElement=4,wt("StructArrayLayout2ui4",y);class t extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}t.prototype.bytesPerElement=2,wt("StructArrayLayout1ui2",t);class a extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,o,u)}emplace(e,i,o,u,p){const m=4*e;return this.float32[m+0]=i,this.float32[m+1]=o,this.float32[m+2]=u,this.float32[m+3]=p,e}}a.prototype.bytesPerElement=16,wt("StructArrayLayout4f16",a);class l extends Ti{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new V(this.anchorPointX,this.anchorPointY)}}l.prototype.size=20;class f extends _u{get(e){return new l(this,e)}}wt("CollisionBoxArray",f);class x extends Ti{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}x.prototype.size=48;class b extends Is{get(e){return new x(this,e)}}wt("PlacedSymbolArray",b);class E extends Ti{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}E.prototype.size=64;class D extends yl{get(e){return new E(this,e)}}wt("SymbolInstanceArray",D);class k extends _l{getoffsetX(e){return this.float32[1*e+0]}}wt("GlyphOffsetArray",k);class j extends ml{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}wt("SymbolLineVertexArray",j);class U extends Ti{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}U.prototype.size=12;class N extends dc{get(e){return new U(this,e)}}wt("TextAnchorOffsetArray",N);class H extends Ti{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}H.prototype.size=8;class Q extends Qa{get(e){return new H(this,e)}}wt("FeatureIndexArray",Q);class ae extends Wa{}class oe extends Wa{}class se extends Wa{}class he extends eo{}class ye extends hd{}class ce extends Yi{}class ge extends Ka{}class be extends uc{}class me extends hc{}class Me extends gu{}class Fe extends yu{}class Le extends Ro{}class Be extends dr{}class Oe extends nn{}class dt extends y{}const ft=tn([{name:"a_pos",components:2,type:"Int16"}],4),{members:rt}=ft;class yt{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,i,o,u){const p=this.segments[this.segments.length-1];return e>yt.MAX_VERTEX_ARRAY_LENGTH&&sn(`Max vertices per segment is ${yt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${yt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!p||p.vertexLength+e>yt.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==u?this.createNewSegment(i,o,u):p}createNewSegment(e,i,o){const u={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0,vaos:{}};return o!==void 0&&(u.sortKey=o),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(u),u}getOrCreateLatestSegment(e,i,o){return this.prepareSegment(0,e,i,o)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,o,u){return new yt([{vertexOffset:e,primitiveOffset:i,vertexLength:o,primitiveLength:u,vaos:{},sortKey:0}])}}function $t(n,e){return 256*(n=Nt(Math.floor(n),0,255))+Nt(Math.floor(e),0,255)}yt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,wt("SegmentVector",yt);const Si=tn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Ui=tn([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var Oi,Wi,Di,hn={exports:{}},Ki={exports:{}},tr={exports:{}},yn=(function(){if(Di)return hn.exports;Di=1;var n=(Oi||(Oi=1,Ki.exports=function(i,o){var u,p,m,v,w,C,P,L;for(p=i.length-(u=3&i.length),m=o,w=3432918353,C=461845907,L=0;L<p;)P=255&i.charCodeAt(L)|(255&i.charCodeAt(++L))<<8|(255&i.charCodeAt(++L))<<16|(255&i.charCodeAt(++L))<<24,++L,m=27492+(65535&(v=5*(65535&(m=(m^=P=(65535&(P=(P=(65535&P)*w+(((P>>>16)*w&65535)<<16)&4294967295)<<15|P>>>17))*C+(((P>>>16)*C&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(P=0,u){case 3:P^=(255&i.charCodeAt(L+2))<<16;case 2:P^=(255&i.charCodeAt(L+1))<<8;case 1:m^=P=(65535&(P=(P=(65535&(P^=255&i.charCodeAt(L)))*w+(((P>>>16)*w&65535)<<16)&4294967295)<<15|P>>>17))*C+(((P>>>16)*C&65535)<<16)&4294967295}return m^=i.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}),Ki.exports),e=(Wi||(Wi=1,tr.exports=function(i,o){for(var u,p=i.length,m=o^p,v=0;p>=4;)u=1540483477*(65535&(u=255&i.charCodeAt(v)|(255&i.charCodeAt(++v))<<8|(255&i.charCodeAt(++v))<<16|(255&i.charCodeAt(++v))<<24))+((1540483477*(u>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),p-=4,++v;switch(p){case 3:m^=(255&i.charCodeAt(v+2))<<16;case 2:m^=(255&i.charCodeAt(v+1))<<8;case 1:m=1540483477*(65535&(m^=255&i.charCodeAt(v)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}),tr.exports);return hn.exports=n,hn.exports.murmur3=n,hn.exports.murmur2=e,hn.exports})(),_n=X(yn);class ir{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,o,u){this.ids.push(Rs(e)),this.positions.push(i,o,u)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const i=Rs(e);let o=0,u=this.ids.length-1;for(;o<u;){const m=o+u>>1;this.ids[m]>=i?u=m:o=m+1}const p=[];for(;this.ids[o]===i;)p.push({index:this.positions[3*o],start:this.positions[3*o+1],end:this.positions[3*o+2]}),o++;return p}static serialize(e,i){const o=new Float64Array(e.ids),u=new Uint32Array(e.positions);return ks(o,u,0,o.length-1),i&&i.push(o.buffer,u.buffer),{ids:o,positions:u}}static deserialize(e){const i=new ir;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function Rs(n){const e=+n;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:_n(String(n))}function ks(n,e,i,o){for(;i<o;){const u=n[i+o>>1];let p=i-1,m=o+1;for(;;){do p++;while(n[p]<u);do m--;while(n[m]>u);if(p>=m)break;Ja(n,p,m),Ja(e,3*p,3*m),Ja(e,3*p+1,3*m+1),Ja(e,3*p+2,3*m+2)}m-i<o-m?(ks(n,e,i,m),i=m+1):(ks(n,e,m+1,o),o=m)}}function Ja(n,e,i){const o=n[e];n[e]=n[i],n[i]=o}wt("FeaturePositionMap",ir);class Gr{constructor(e,i){this.gl=e.gl,this.location=i}}class xl extends Gr{constructor(e,i){super(e,i),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class fc extends Gr{constructor(e,i){super(e,i),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class es extends Gr{constructor(e,i){super(e,i),this.current=Qt.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const qr=new Float32Array(16);function da(n){return[$t(255*n.r,255*n.g),$t(255*n.b,255*n.a)]}class Ra{constructor(e,i,o){this.value=e,this.uniformNames=i.map((u=>`u_${u}`)),this.type=o}setUniform(e,i,o){e.set(o.constantOr(this.value))}getBinding(e,i,o){return this.type==="color"?new es(e,i):new xl(e,i)}}class ka{constructor(e,i){this.uniformNames=i.map((o=>`u_${o}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=e.tlbr}setConstantDashPositions(e,i){this.dashTo=[0,e.y,e.height,e.width],this.dashFrom=[0,i.y,i.height,i.width]}setUniform(e,i,o,u){let p=null;u==="u_pattern_to"?p=this.patternTo:u==="u_pattern_from"?p=this.patternFrom:u==="u_dasharray_to"?p=this.dashTo:u==="u_dasharray_from"?p=this.dashFrom:u==="u_pixel_ratio_to"?p=this.pixelRatioTo:u==="u_pixel_ratio_from"&&(p=this.pixelRatioFrom),p!==null&&e.set(p)}getBinding(e,i,o){return o.substr(0,9)==="u_pattern"||o.substr(0,12)==="u_dasharray_"?new fc(e,i):new xl(e,i)}}class Ei{constructor(e,i,o,u){this.expression=e,this.type=o,this.maxValue=0,this.paintVertexAttributes=i.map((p=>({name:`a_${p}`,type:"Float32",components:o==="color"?2:1,offset:0}))),this.paintVertexArray=new u}populatePaintArray(e,i,o){const u=this.paintVertexArray.length,p=this.expression.evaluate(new Mi(0,o),i,{},o.canonical,[],o.formattedSection);this.paintVertexArray.resize(e),this._setPaintValue(u,e,p)}updatePaintArray(e,i,o,u,p){const m=this.expression.evaluate(new Mi(0,p),o,u);this._setPaintValue(e,i,m)}_setPaintValue(e,i,o){if(this.type==="color"){const u=da(o);for(let p=e;p<i;p++)this.paintVertexArray.emplace(p,u[0],u[1])}else{for(let u=e;u<i;u++)this.paintVertexArray.emplace(u,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Fi{constructor(e,i,o,u,p,m){this.expression=e,this.uniformNames=i.map((v=>`u_${v}_t`)),this.type=o,this.useIntegerZoom=u,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=i.map((v=>({name:`a_${v}`,type:"Float32",components:o==="color"?4:2,offset:0}))),this.paintVertexArray=new m}populatePaintArray(e,i,o){const u=this.expression.evaluate(new Mi(this.zoom,o),i,{},o.canonical,[],o.formattedSection),p=this.expression.evaluate(new Mi(this.zoom+1,o),i,{},o.canonical,[],o.formattedSection),m=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(m,e,u,p)}updatePaintArray(e,i,o,u,p){const m=this.expression.evaluate(new Mi(this.zoom,p),o,u),v=this.expression.evaluate(new Mi(this.zoom+1,p),o,u);this._setPaintValue(e,i,m,v)}_setPaintValue(e,i,o,u){if(this.type==="color"){const p=da(o),m=da(u);for(let v=e;v<i;v++)this.paintVertexArray.emplace(v,p[0],p[1],m[0],m[1])}else{for(let p=e;p<i;p++)this.paintVertexArray.emplace(p,o,u);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i){const o=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,u=Nt(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);e.set(u)}getBinding(e,i,o){return new xl(e,i)}}class In{constructor(e,i,o,u,p,m){this.expression=e,this.type=i,this.useIntegerZoom=o,this.zoom=u,this.layerId=m,this.zoomInPaintVertexArray=new p,this.zoomOutPaintVertexArray=new p}populatePaintArray(e,i,o){const u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,this.getPositionIds(i),o)}updatePaintArray(e,i,o,u,p){this._setPaintValues(e,i,this.getPositionIds(o),p)}_setPaintValues(e,i,o,u){const p=this.getPositions(u);if(!p||!o)return;const m=p[o.min],v=p[o.mid],w=p[o.max];if(m&&v&&w)for(let C=e;C<i;C++)this.emplace(this.zoomInPaintVertexArray,C,v,m),this.emplace(this.zoomOutPaintVertexArray,C,v,w)}upload(e){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const i=this.getVertexAttributes();this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,i,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,i,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Un extends In{getPositions(e){return e.imagePositions}getPositionIds(e){return e.patterns&&e.patterns[this.layerId]}getVertexAttributes(){return Si.members}emplace(e,i,o,u){e.emplace(i,o.tlbr[0],o.tlbr[1],o.tlbr[2],o.tlbr[3],u.tlbr[0],u.tlbr[1],u.tlbr[2],u.tlbr[3],o.pixelRatio,u.pixelRatio)}}class dh extends In{getPositions(e){return e.dashPositions}getPositionIds(e){return e.dashes&&e.dashes[this.layerId]}getVertexAttributes(){return Ui.members}emplace(e,i,o,u){e.emplace(i,0,o.y,o.height,o.width,0,u.y,u.height,u.width)}}class fh{constructor(e,i,o){this.binders={},this._buffers=[];const u=[];for(const p in e.paint._values){if(!o(p))continue;const m=e.paint.get(p);if(!(m instanceof ha&&Aa(m.property.specification)))continue;const v=Af(p,e.type),w=m.value,C=m.property.specification.type,P=m.property.useIntegerZoom,L=m.property.specification["property-type"],O=L==="cross-faded"||L==="cross-faded-data-driven";if(w.kind==="constant")this.binders[p]=O?new ka(w.value,v):new Ra(w.value,v,C),u.push(`/u_${p}`);else if(w.kind==="source"||O){const F=Lo(p,C,"source");this.binders[p]=O?p==="line-dasharray"?new dh(w,C,P,i,F,e.id):new Un(w,C,P,i,F,e.id):new Ei(w,v,C,F),u.push(`/a_${p}`)}else{const F=Lo(p,C,"composite");this.binders[p]=new Fi(w,v,C,P,i,F),u.push(`/z_${p}`)}}this.cacheKey=u.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof Ei||i instanceof Fi?i.maxValue:0}populatePaintArrays(e,i,o){for(const u in this.binders){const p=this.binders[u];(p instanceof Ei||p instanceof Fi||p instanceof In)&&p.populatePaintArray(e,i,o)}}setConstantPatternPositions(e,i){for(const o in this.binders){const u=this.binders[o];u instanceof ka&&u.setConstantPatternPositions(e,i)}}setConstantDashPositions(e,i){for(const o in this.binders){const u=this.binders[o];u instanceof ka&&u.setConstantDashPositions(e,i)}}updatePaintArrays(e,i,o,u,p){let m=!1;for(const v in e){const w=i.getPositions(v);for(const C of w){const P=o.feature(C.index);for(const L in this.binders){const O=this.binders[L];if((O instanceof Ei||O instanceof Fi||O instanceof In)&&O.expression.isStateDependent===!0){const F=u.paint.get(L);O.expression=F.value,O.updatePaintArray(C.start,C.end,P,e[v],p),m=!0}}}}return m}defines(){const e=[];for(const i in this.binders){const o=this.binders[i];(o instanceof Ra||o instanceof ka)&&e.push(...o.uniformNames.map((u=>`#define HAS_UNIFORM_${u}`)))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const o=this.binders[i];if(o instanceof Ei||o instanceof Fi)for(let u=0;u<o.paintVertexAttributes.length;u++)e.push(o.paintVertexAttributes[u].name);else if(o instanceof In){const u=o.getVertexAttributes();for(const p of u)e.push(p.name)}}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const o=this.binders[i];if(o instanceof Ra||o instanceof ka||o instanceof Fi)for(const u of o.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,i){const o=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof Ra||p instanceof ka||p instanceof Fi){for(const m of p.uniformNames)if(i[m]){const v=p.getBinding(e,i[m],m);o.push({name:m,property:u,binding:v})}}}return o}setUniforms(e,i,o,u){for(const{name:p,property:m,binding:v}of i)this.binders[m].setUniform(v,u,o.get(m),p)}updatePaintBuffers(e){this._buffers=[];for(const i in this.binders){const o=this.binders[i];if(e&&o instanceof In){const u=e.fromScale===2?o.zoomInPaintVertexBuffer:o.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(o instanceof Ei||o instanceof Fi)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(e){for(const i in this.binders){const o=this.binders[i];(o instanceof Ei||o instanceof Fi||o instanceof In)&&o.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof Ei||i instanceof Fi||i instanceof In)&&i.destroy()}}}class ko{constructor(e,i,o=()=>!0){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new fh(u,i,o);this.needsUpload=!1,this._featureMap=new ir,this._bufferOffset=0}populatePaintArrays(e,i,o,u){for(const p in this.programConfigurations)this.programConfigurations[p].populatePaintArrays(e,i,u);i.id!==void 0&&this._featureMap.add(i.id,o,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,o,u){for(const p of o)this.needsUpload=this.programConfigurations[p.id].updatePaintArrays(e,this._featureMap,i,p,u)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Af(n,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}function Lo(n,e,i){const o={color:{source:Yi,composite:a},number:{source:_l,composite:Yi}},u=(function(p){return{"line-pattern":{source:ge,composite:ge},"fill-pattern":{source:ge,composite:ge},"fill-extrusion-pattern":{source:ge,composite:ge},"line-dasharray":{source:be,composite:be}}[p]})(n);return u&&u[i]||o[e][i]}wt("ConstantBinder",Ra),wt("CrossFadedConstantBinder",ka),wt("SourceExpressionBinder",Ei),wt("CrossFadedPatternBinder",Un),wt("CrossFadedDasharrayBinder",dh),wt("CompositeExpressionBinder",Fi),wt("ProgramConfiguration",fh,{omit:["_buffers"]}),wt("ProgramConfigurationSet",ko);const ph=Math.pow(2,14)-1,io=-ph-1;function no(n){const e=It/n.extent,i=n.loadGeometry();for(let o=0;o<i.length;o++){const u=i[o];for(let p=0;p<u.length;p++){const m=u[p],v=Math.round(m.x*e),w=Math.round(m.y*e);m.x=Nt(v,io,ph),m.y=Nt(w,io,ph),(v<m.x||v>m.x+1||w<m.y||w>m.y+1)&&sn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function ts(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?no(n):[]}}const mh=-32768;function xu(n,e,i,o,u){n.emplaceBack(mh+8*e+o,mh+8*i+u)}class vu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new oe,this.indexArray=new Oe,this.segments=new yt,this.programConfigurations=new ko(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,o){const u=this.layers[0],p=[];let m=null,v=!1,w=u.type==="heatmap";if(u.type==="circle"){const P=u;m=P.layout.get("circle-sort-key"),v=!m.isConstant(),w=w||P.paint.get("circle-pitch-alignment")==="map"}const C=w?i.subdivisionGranularity.circle:1;for(const{feature:P,id:L,index:O,sourceLayerIndex:F}of e){const q=this.layers[0]._featureFilter.needGeometry,Z=ts(P,q);if(!this.layers[0]._featureFilter.filter(new Mi(this.zoom),Z,o))continue;const $=v?m.evaluate(Z,{},o):void 0,ee={id:L,properties:P.properties,type:P.type,sourceLayerIndex:F,index:O,geometry:q?Z.geometry:no(P),patterns:{},sortKey:$};p.push(ee)}v&&p.sort(((P,L)=>P.sortKey-L.sortKey));for(const P of p){const{geometry:L,index:O,sourceLayerIndex:F}=P,q=e[O].feature;this.addFeature(P,L,O,o,C),i.featureIndex.insert(q,L,O,F,this.index)}}update(e,i,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:o})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,rt),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,o,u,p=1){let m;switch(p){case 1:m=[0,7];break;case 3:m=[0,2,5,7];break;case 5:m=[0,1,3,4,6,7];break;case 7:m=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${p}; valid values are 1, 3, 5, 7.`)}const v=m.length;for(const w of i)for(const C of w){const P=C.x,L=C.y;if(P<0||P>=It||L<0||L>=It)continue;const O=this.segments.prepareSegment(v*v,this.layoutVertexArray,this.indexArray,e.sortKey),F=O.vertexLength;for(let q=0;q<v;q++)for(let Z=0;Z<v;Z++)xu(this.layoutVertexArray,P,L,m[Z],m[q]);for(let q=0;q<v-1;q++)for(let Z=0;Z<v-1;Z++){const $=F+q*v+Z,ee=F+(q+1)*v+Z;this.indexArray.emplaceBack($,ee+1,$+1),this.indexArray.emplaceBack($,ee,ee+1)}O.vertexLength+=v*v,O.primitiveLength+=(v-1)*(v-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{imagePositions:{},canonical:u})}}function bu(n,e){for(let i=0;i<n.length;i++)if(jo(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(jo(n,e[i]))return!0;return!!fr(n,e)}function Cf(n,e,i){return!!jo(n,e)||!!zf(e,n,i)}function Df(n,e){if(n.length===1)return Zp(e,n[0]);for(let i=0;i<e.length;i++){const o=e[i];for(let u=0;u<o.length;u++)if(jo(n,o[u]))return!0}for(let i=0;i<n.length;i++)if(Zp(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(fr(n,e[i]))return!0;return!1}function nr(n,e,i){if(n.length>1){if(fr(n,e))return!0;for(let o=0;o<e.length;o++)if(zf(e[o],n,i))return!0}for(let o=0;o<n.length;o++)if(zf(n[o],e,i))return!0;return!1}function fr(n,e){if(n.length===0||e.length===0)return!1;for(let i=0;i<n.length-1;i++){const o=n[i],u=n[i+1];for(let p=0;p<e.length-1;p++)if(gg(o,u,e[p],e[p+1]))return!0}return!1}function gg(n,e,i,o){return jr(n,i,o)!==jr(e,i,o)&&jr(n,e,i)!==jr(n,e,o)}function zf(n,e,i){const o=i*i;if(e.length===1)return n.distSqr(e[0])<o;for(let u=1;u<e.length;u++)if(qp(n,e[u-1],e[u])<o)return!0;return!1}function qp(n,e,i){const o=e.distSqr(i);if(o===0)return n.distSqr(e);const u=((n.x-e.x)*(i.x-e.x)+(n.y-e.y)*(i.y-e.y))/o;return n.distSqr(u<0?e:u>1?i:i.sub(e)._mult(u)._add(e))}function Zp(n,e){let i,o,u,p=!1;for(let m=0;m<n.length;m++){i=n[m];for(let v=0,w=i.length-1;v<i.length;w=v++)o=i[v],u=i[w],o.y>e.y!=u.y>e.y&&e.x<(u.x-o.x)*(e.y-o.y)/(u.y-o.y)+o.x&&(p=!p)}return p}function jo(n,e){let i=!1;for(let o=0,u=n.length-1;o<n.length;u=o++){const p=n[o],m=n[u];p.y>e.y!=m.y>e.y&&e.x<(m.x-p.x)*(e.y-p.y)/(m.y-p.y)+p.x&&(i=!i)}return i}function yg(n,e,i){const o=i[0],u=i[2];if(n.x<o.x&&e.x<o.x||n.x>u.x&&e.x>u.x||n.y<o.y&&e.y<o.y||n.y>u.y&&e.y>u.y)return!1;const p=jr(n,e,i[0]);return p!==jr(n,e,i[1])||p!==jr(n,e,i[2])||p!==jr(n,e,i[3])}function vl(n,e,i){const o=e.paint.get(n).value;return o.kind==="constant"?o.value:i.programConfigurations.get(e.id).getMaxValue(n)}function dd(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Pf(n,e,i,o,u){if(!e[0]&&!e[1])return n;const p=V.convert(e)._mult(u);i==="viewport"&&p._rotate(-o);const m=[];for(let v=0;v<n.length;v++)m.push(n[v].sub(p));return m}function If(n){const e=[];for(let i=0;i<n.length;i++){const o=n[i],u=e.at(-1);(i===0||u&&!o.equals(u))&&e.push(o)}return e}function Hp({queryGeometry:n,size:e},i){return Cf(n,i,e)}function _g({queryGeometry:n,size:e,transform:i,unwrappedTileID:o,getElevation:u},p){return Cf(n,p,e*(i.projectTileCoordinates(p.x,p.y,o,u).signedDistanceFromCamera/i.cameraToCenterDistance))}function xg({queryGeometry:n,size:e,transform:i,unwrappedTileID:o,getElevation:u},p){const m=i.projectTileCoordinates(p.x,p.y,o,u).signedDistanceFromCamera,v=e*(i.cameraToCenterDistance/m);return Cf(n,fd(p,i,o,u),v)}function vg({queryGeometry:n,size:e,transform:i,unwrappedTileID:o,getElevation:u},p){return Cf(n,fd(p,i,o,u),e)}function Rf({queryGeometry:n,size:e,transform:i,unwrappedTileID:o,getElevation:u,pitchAlignment:p="map",pitchScale:m="map"},v){const w=p==="map"?m==="map"?Hp:_g:m==="map"?xg:vg,C={queryGeometry:n,size:e,transform:i,unwrappedTileID:o,getElevation:u};for(const P of v)for(const L of P)if(w(C,L))return!0;return!1}function fd(n,e,i,o){const u=e.projectTileCoordinates(n.x,n.y,i,o).point;return new V((.5*u.x+.5)*e.width,(.5*-u.y+.5)*e.height)}let kf,$p;wt("CircleBucket",vu,{omit:["layers"]});var Xp={get paint(){return $p=$p||new En({"circle-radius":new Ct(Te.paint_circle["circle-radius"]),"circle-color":new Ct(Te.paint_circle["circle-color"]),"circle-blur":new Ct(Te.paint_circle["circle-blur"]),"circle-opacity":new Ct(Te.paint_circle["circle-opacity"]),"circle-translate":new Tt(Te.paint_circle["circle-translate"]),"circle-translate-anchor":new Tt(Te.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Tt(Te.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Tt(Te.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ct(Te.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ct(Te.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ct(Te.paint_circle["circle-stroke-opacity"])})},get layout(){return kf=kf||new En({"circle-sort-key":new Ct(Te.layout_circle["circle-sort-key"])})}};class Lf extends un{constructor(e,i){super(e,Xp,i)}createBucket(e){return new vu(e)}queryRadius(e){const i=e;return vl("circle-radius",this,i)+vl("circle-stroke-width",this,i)+dd(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:o,geometry:u,transform:p,pixelsToTileUnits:m,unwrappedTileID:v,getElevation:w}){const C=Pf(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-p.bearingInRadians,m),P=this.paint.get("circle-radius").evaluate(i,o)+this.paint.get("circle-stroke-width").evaluate(i,o),L=this.paint.get("circle-pitch-scale"),O=this.paint.get("circle-pitch-alignment");let F,q;return O==="map"?(F=C,q=P*m):(F=(function(Z,$,ee,ue){return Z.map((ie=>fd(ie,$,ee,ue)))})(C,p,v,w),q=P),Rf({queryGeometry:F,size:q,transform:p,unwrappedTileID:v,getElevation:w,pitchAlignment:O,pitchScale:L},u)}}class jf extends vu{}let Yp;wt("HeatmapBucket",jf,{omit:["layers"]});var Wp={get paint(){return Yp=Yp||new En({"heatmap-radius":new Ct(Te.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ct(Te.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Tt(Te.paint_heatmap["heatmap-intensity"]),"heatmap-color":new pu(Te.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Tt(Te.paint_heatmap["heatmap-opacity"])})}};function Bf(n,{width:e,height:i},o,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*i*o)throw new RangeError(`mismatched image size. expected: ${u.length} but got: ${e*i*o}`)}else u=new Uint8Array(e*i*o);return n.width=e,n.height=i,n.data=u,n}function Bo(n,{width:e,height:i},o){if(e===n.width&&i===n.height)return;const u=Bf({},{width:e,height:i},o);pd(n,u,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,e),height:Math.min(n.height,i)},o),n.width=e,n.height=i,n.data=u.data}function pd(n,e,i,o,u,p){if(u.width===0||u.height===0)return e;if(u.width>n.width||u.height>n.height||i.x>n.width-u.width||i.y>n.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||o.x>e.width-u.width||o.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const m=n.data,v=e.data;if(m===v)throw new Error("srcData equals dstData, so image is already copied");for(let w=0;w<u.height;w++){const C=((i.y+w)*n.width+i.x)*p,P=((o.y+w)*e.width+o.x)*p;for(let L=0;L<u.width*p;L++)v[P+L]=m[C+L]}return e}class md{constructor(e,i){Bf(this,e,1,i)}resize(e){Bo(this,e,1)}clone(){return new md({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,o,u,p){pd(e,i,o,u,p,1)}}class Zr{constructor(e,i){Bf(this,e,4,i)}resize(e){Bo(this,e,4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Zr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,o,u,p){pd(e,i,o,u,p,4)}setPixel(e,i,o){const u=4*(e*this.width+i);this.data[u+0]=Math.round(255*o.r/o.a),this.data[u+1]=Math.round(255*o.g/o.a),this.data[u+2]=Math.round(255*o.b/o.a),this.data[u+3]=Math.round(255*o.a)}}function Oo(n){const e={},i=n.resolution||256,o=n.clips?n.clips.length:1,u=n.image||new Zr({width:i,height:o});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const p=(m,v,w)=>{e[n.evaluationKey]=w;const C=n.expression.evaluate(e);u.setPixel(m/4/i,v/4,C)};if(n.clips)for(let m=0,v=0;m<o;++m,v+=4*i)for(let w=0,C=0;w<i;w++,C+=4){const P=w/(i-1),{start:L,end:O}=n.clips[m];p(v,C,L*(1-P)+O*P)}else for(let m=0,v=0;m<i;m++,v+=4)p(0,v,m/(i-1));return u}wt("AlphaImage",md),wt("RGBAImage",Zr);const gd="big-fb";class bg extends un{createBucket(e){return new jf(e)}constructor(e,i){super(e,Wp,i),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Oo({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(gd)&&this.heatmapFbos.delete(gd)}queryRadius(e){return vl("heatmap-radius",this,e)}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:o,geometry:u,transform:p,pixelsToTileUnits:m,unwrappedTileID:v,getElevation:w}){return Rf({queryGeometry:e,size:this.paint.get("heatmap-radius").evaluate(i,o)*m,transform:p,unwrappedTileID:v,getElevation:w},u)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let yd;var _d={get paint(){return yd=yd||new En({"hillshade-illumination-direction":new Tt(Te.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Tt(Te.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Tt(Te.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Tt(Te.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Tt(Te.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Tt(Te.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Tt(Te.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Tt(Te.paint_hillshade["hillshade-method"])})}};class xn extends un{constructor(e,i){super(e,_d,i),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,i=this.paint.get("hillshade-illumination-altitude").values,o=this.paint.get("hillshade-highlight-color").values,u=this.paint.get("hillshade-shadow-color").values;const p=Math.max(e.length,i.length,o.length,u.length);e=e.concat(Array(p-e.length).fill(e.at(-1))),i=i.concat(Array(p-i.length).fill(i.at(-1))),o=o.concat(Array(p-o.length).fill(o.at(-1))),u=u.concat(Array(p-u.length).fill(u.at(-1)));const m=i.map(Qn);return{directionRadians:e.map(Qn),altitudeRadians:m,shadowColor:u,highlightColor:o}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let wg;var qy={get paint(){return wg=wg||new En({"color-relief-opacity":new Tt(Te["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new pu(Te["paint_color-relief"]["color-relief-color"])})}};class Of{constructor(e,i,o,u){this.context=e,this.format=o,this.texture=e.gl.createTexture(),this.update(i,u)}update(e,i,o){const{width:u,height:p}=e,m=!(this.size&&this.size[0]===u&&this.size[1]===p||o),{context:v}=this,{gl:w}=v;if(this.useMipmap=!!(i&&i.useMipmap),w.bindTexture(w.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!i||i.premultiply!==!1)),m)this.size=[u,p],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||cs(e)?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,e):w.texImage2D(w.TEXTURE_2D,0,this.format,u,p,0,this.format,w.UNSIGNED_BYTE,e.data);else{const{x:C,y:P}=o||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||cs(e)?w.texSubImage2D(w.TEXTURE_2D,0,C,P,w.RGBA,w.UNSIGNED_BYTE,e):w.texSubImage2D(w.TEXTURE_2D,0,C,P,u,p,w.RGBA,w.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&w.generateMipmap(w.TEXTURE_2D),v.pixelStoreUnpackFlipY.setDefault(),v.pixelStoreUnpack.setDefault(),v.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,i,o){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),o!==p.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(o=p.LINEAR),e!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,e),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,o||e),this.filter=e),i!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,i),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class gh{constructor(e,i,o,u=1,p=1,m=1,v=0){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(o&&!["mapbox","terrarium","custom"].includes(o))return void sn(`"${o}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=i.height;const w=this.dim=i.height-2;switch(this.data=new Uint32Array(i.data.buffer),o){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=u,this.greenFactor=p,this.blueFactor=m,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let C=0;C<w;C++)this.data[this._idx(-1,C)]=this.data[this._idx(0,C)],this.data[this._idx(w,C)]=this.data[this._idx(w-1,C)],this.data[this._idx(C,-1)]=this.data[this._idx(C,0)],this.data[this._idx(C,w)]=this.data[this._idx(C,w-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(w,-1)]=this.data[this._idx(w-1,0)],this.data[this._idx(-1,w)]=this.data[this._idx(0,w-1)],this.data[this._idx(w,w)]=this.data[this._idx(w-1,w-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let C=0;C<w;C++)for(let P=0;P<w;P++){const L=this.get(C,P);L>this.max&&(this.max=L),L<this.min&&(this.min=L)}}get(e,i){const o=new Uint8Array(this.data.buffer),u=4*this._idx(e,i);return this.unpack(o[u],o[u+1],o[u+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${e}, y: ${i}, dim: ${this.dim}`);return(i+1)*this.stride+(e+1)}unpack(e,i,o){return e*this.redFactor+i*this.greenFactor+o*this.blueFactor-this.baseShift}pack(e){return bl(e,this.getUnpackVector())}getPixels(){return new Zr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,i,o){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=i*this.dim,p=i*this.dim+this.dim,m=o*this.dim,v=o*this.dim+this.dim;switch(i){case-1:u=p-1;break;case 1:p=u+1}switch(o){case-1:m=v-1;break;case 1:v=m+1}const w=-i*this.dim,C=-o*this.dim;for(let P=m;P<v;P++)for(let L=u;L<p;L++)this.data[this._idx(L,P)]=e.data[this._idx(L+w,P+C)]}}function bl(n,e){const i=e[0],o=e[1],u=e[2],p=e[3],m=Math.min(i,o,u),v=Math.round((n+p)/m);return{r:Math.floor(v*m/i)%256,g:Math.floor(v*m/o)%256,b:Math.floor(v*m/u)%256}}wt("DEMData",gh);class Tg extends un{constructor(e,i){super(e,qy,i)}_createColorRamp(e){const i={elevationStops:[],colorStops:[]},o=this._transitionablePaint._values["color-relief-color"].value.expression;if(o instanceof Rr&&o._styleExpression.expression instanceof Pr){this.colorRampExpression=o;const m=o._styleExpression.expression;i.elevationStops=m.labels,i.colorStops=[];for(const v of i.elevationStops)i.colorStops.push(m.evaluate({globals:{elevation:v}}))}if(i.elevationStops.length<1&&(i.elevationStops=[0],i.colorStops=[Qt.transparent]),i.elevationStops.length<2&&(i.elevationStops.push(i.elevationStops[0]+1),i.colorStops.push(i.colorStops[0])),i.elevationStops.length<=e)return i;const u={elevationStops:[],colorStops:[]},p=(i.elevationStops.length-1)/(e-1);for(let m=0;m<i.elevationStops.length-.5;m+=p)u.elevationStops.push(i.elevationStops[Math.round(m)]),u.colorStops.push(i.colorStops[Math.round(m)]);return sn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${e}, provided: ${i.elevationStops.length}`),u}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(e,i,o){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const u=this._createColorRamp(i),p=new Zr({width:u.colorStops.length,height:1}),m=new Zr({width:u.colorStops.length,height:1});for(let v=0;v<u.elevationStops.length;v++){const w=bl(u.elevationStops[v],o);m.setPixel(0,v,new Qt(w.r/255,w.g/255,w.b/255,1)),p.setPixel(0,v,u.colorStops[v])}return this.colorRampTextures={elevationTexture:new Of(e,m,e.gl.RGBA),colorTexture:new Of(e,p,e.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const Sg=tn([{name:"a_pos",components:2,type:"Int16"}],4),{members:xd}=Sg;function is(n,e,i){const o=i.patternDependencies;let u=!1;for(const p of e){const m=p.paint.get(`${n}-pattern`);m.isConstant()||(u=!0);const v=m.constantOr(null);v&&(u=!0,o[v.to]=!0,o[v.from]=!0)}return u}function Ff(n,e,i,o,u){const{zoom:p}=o,m=u.patternDependencies;for(const v of e){const w=v.paint.get(`${n}-pattern`).value;if(w.kind!=="constant"){let C=w.evaluate({zoom:p-1},i,{},u.availableImages),P=w.evaluate({zoom:p},i,{},u.availableImages),L=w.evaluate({zoom:p+1},i,{},u.availableImages);C=C&&C.name?C.name:C,P=P&&P.name?P.name:P,L=L&&L.name?L.name:L,m[C]=!0,m[P]=!0,m[L]=!0,i.patterns[v.id]={min:C,mid:P,max:L}}}return i}function Nf(n,e,i,o,u){let p;if(u===(function(m,v,w,C){let P=0;for(let L=v,O=w-C;L<w;L+=C)P+=(m[O]-m[L])*(m[L+1]+m[O+1]),O=L;return P})(n,e,i,o)>0)for(let m=e;m<i;m+=o)p=fa(m/o|0,n[m],n[m+1],p);else for(let m=i-o;m>=e;m-=o)p=fa(m/o|0,n[m],n[m+1],p);return p&&La(p,p.next)&&(pa(p),p=p.next),p}function pc(n,e){if(!n)return n;e||(e=n);let i,o=n;do if(i=!1,o.steiner||!La(o,o.next)&&vi(o.prev,o,o.next)!==0)o=o.next;else{if(pa(o),o=e=o.prev,o===o.next)break;i=!0}while(i||o!==e);return e}function wu(n,e,i,o,u,p,m){if(!n)return;!m&&p&&(function(w,C,P,L){let O=w;do O.z===0&&(O.z=ar(O.x,O.y,C,P,L)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next;while(O!==w);O.prevZ.nextZ=null,O.prevZ=null,(function(F){let q,Z=1;do{let $,ee=F;F=null;let ue=null;for(q=0;ee;){q++;let ie=ee,re=0;for(let _e=0;_e<Z&&(re++,ie=ie.nextZ,ie);_e++);let fe=Z;for(;re>0||fe>0&&ie;)re!==0&&(fe===0||!ie||ee.z<=ie.z)?($=ee,ee=ee.nextZ,re--):($=ie,ie=ie.nextZ,fe--),ue?ue.nextZ=$:F=$,$.prevZ=ue,ue=$;ee=ie}ue.nextZ=null,Z*=2}while(q>1)})(O)})(n,o,u,p);let v=n;for(;n.prev!==n.next;){const w=n.prev,C=n.next;if(p?Vf(n,o,u,p):Kp(n))e.push(w.i,n.i,C.i),pa(n),n=C.next,v=C.next;else if((n=C)===v){m?m===1?wu(n=Mg(pc(n),e),e,i,o,u,p,2):m===2&&wl(n,e,i,o,u,p):wu(pc(n),e,i,o,u,p,1);break}}}function Kp(n){const e=n.prev,i=n,o=n.next;if(vi(e,i,o)>=0)return!1;const u=e.x,p=i.x,m=o.x,v=e.y,w=i.y,C=o.y,P=Math.min(u,p,m),L=Math.min(v,w,C),O=Math.max(u,p,m),F=Math.max(v,w,C);let q=o.next;for(;q!==e;){if(q.x>=P&&q.x<=O&&q.y>=L&&q.y<=F&&yh(u,v,p,w,m,C,q.x,q.y)&&vi(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function Vf(n,e,i,o){const u=n.prev,p=n,m=n.next;if(vi(u,p,m)>=0)return!1;const v=u.x,w=p.x,C=m.x,P=u.y,L=p.y,O=m.y,F=Math.min(v,w,C),q=Math.min(P,L,O),Z=Math.max(v,w,C),$=Math.max(P,L,O),ee=ar(F,q,e,i,o),ue=ar(Z,$,e,i,o);let ie=n.prevZ,re=n.nextZ;for(;ie&&ie.z>=ee&&re&&re.z<=ue;){if(ie.x>=F&&ie.x<=Z&&ie.y>=q&&ie.y<=$&&ie!==u&&ie!==m&&yh(v,P,w,L,C,O,ie.x,ie.y)&&vi(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,re.x>=F&&re.x<=Z&&re.y>=q&&re.y<=$&&re!==u&&re!==m&&yh(v,P,w,L,C,O,re.x,re.y)&&vi(re.prev,re,re.next)>=0))return!1;re=re.nextZ}for(;ie&&ie.z>=ee;){if(ie.x>=F&&ie.x<=Z&&ie.y>=q&&ie.y<=$&&ie!==u&&ie!==m&&yh(v,P,w,L,C,O,ie.x,ie.y)&&vi(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;re&&re.z<=ue;){if(re.x>=F&&re.x<=Z&&re.y>=q&&re.y<=$&&re!==u&&re!==m&&yh(v,P,w,L,C,O,re.x,re.y)&&vi(re.prev,re,re.next)>=0)return!1;re=re.nextZ}return!0}function Mg(n,e){let i=n;do{const o=i.prev,u=i.next.next;!La(o,u)&&em(o,i,i.next,u)&&wd(o,u)&&wd(u,o)&&(e.push(o.i,i.i,u.i),pa(i),pa(i.next),i=n=u),i=i.next}while(i!==n);return pc(i)}function wl(n,e,i,o,u,p){let m=n;do{let v=m.next.next;for(;v!==m.prev;){if(m.i!==v.i&&An(m,v)){let w=Td(m,v);return m=pc(m,m.next),w=pc(w,w.next),wu(m,e,i,o,u,p,0),void wu(w,e,i,o,u,p,0)}v=v.next}m=m.next}while(m!==n)}function rr(n,e){let i=n.x-e.x;return i===0&&(i=n.y-e.y,i===0)&&(i=(n.next.y-n.y)/(n.next.x-n.x)-(e.next.y-e.y)/(e.next.x-e.x)),i}function Qp(n,e){const i=(function(u,p){let m=p;const v=u.x,w=u.y;let C,P=-1/0;if(La(u,m))return m;do{if(La(u,m.next))return m.next;if(w<=m.y&&w>=m.next.y&&m.next.y!==m.y){const Z=m.x+(w-m.y)*(m.next.x-m.x)/(m.next.y-m.y);if(Z<=v&&Z>P&&(P=Z,C=m.x<m.next.x?m:m.next,Z===v))return C}m=m.next}while(m!==p);if(!C)return null;const L=C,O=C.x,F=C.y;let q=1/0;m=C;do{if(v>=m.x&&m.x>=O&&v!==m.x&&Jp(w<F?v:P,w,O,F,w<F?P:v,w,m.x,m.y)){const Z=Math.abs(w-m.y)/(v-m.x);wd(m,u)&&(Z<q||Z===q&&(m.x>C.x||m.x===C.x&&Eg(C,m)))&&(C=m,q=Z)}m=m.next}while(m!==L);return C})(n,e);if(!i)return e;const o=Td(i,n);return pc(o,o.next),pc(i,i.next)}function Eg(n,e){return vi(n.prev,n,e.prev)<0&&vi(e.next,n,n.next)<0}function ar(n,e,i,o,u){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*u|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-o)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Zy(n){let e=n,i=n;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==n);return i}function Jp(n,e,i,o,u,p,m,v){return(u-m)*(e-v)>=(n-m)*(p-v)&&(n-m)*(o-v)>=(i-m)*(e-v)&&(i-m)*(p-v)>=(u-m)*(o-v)}function yh(n,e,i,o,u,p,m,v){return!(n===m&&e===v)&&Jp(n,e,i,o,u,p,m,v)}function An(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!(function(i,o){let u=i;do{if(u.i!==i.i&&u.next.i!==i.i&&u.i!==o.i&&u.next.i!==o.i&&em(u,u.next,i,o))return!0;u=u.next}while(u!==i);return!1})(n,e)&&(wd(n,e)&&wd(e,n)&&(function(i,o){let u=i,p=!1;const m=(i.x+o.x)/2,v=(i.y+o.y)/2;do u.y>v!=u.next.y>v&&u.next.y!==u.y&&m<(u.next.x-u.x)*(v-u.y)/(u.next.y-u.y)+u.x&&(p=!p),u=u.next;while(u!==i);return p})(n,e)&&(vi(n.prev,n,e.prev)||vi(n,e.prev,e))||La(n,e)&&vi(n.prev,n,n.next)>0&&vi(e.prev,e,e.next)>0)}function vi(n,e,i){return(e.y-n.y)*(i.x-e.x)-(e.x-n.x)*(i.y-e.y)}function La(n,e){return n.x===e.x&&n.y===e.y}function em(n,e,i,o){const u=bd(vi(n,e,i)),p=bd(vi(n,e,o)),m=bd(vi(i,o,n)),v=bd(vi(i,o,e));return u!==p&&m!==v||!(u!==0||!vd(n,i,e))||!(p!==0||!vd(n,o,e))||!(m!==0||!vd(i,n,o))||!(v!==0||!vd(i,e,o))}function vd(n,e,i){return e.x<=Math.max(n.x,i.x)&&e.x>=Math.min(n.x,i.x)&&e.y<=Math.max(n.y,i.y)&&e.y>=Math.min(n.y,i.y)}function bd(n){return n>0?1:n<0?-1:0}function wd(n,e){return vi(n.prev,n,n.next)<0?vi(n,e,n.next)>=0&&vi(n,n.prev,e)>=0:vi(n,e,n.prev)<0||vi(n,n.next,e)<0}function Td(n,e){const i=Uf(n.i,n.x,n.y),o=Uf(e.i,e.x,e.y),u=n.next,p=e.prev;return n.next=e,e.prev=n,i.next=u,u.prev=i,o.next=i,i.prev=o,p.next=o,o.prev=p,o}function fa(n,e,i,o){const u=Uf(n,e,i);return o?(u.next=o.next,u.prev=o,o.next.prev=u,o.next=u):(u.prev=u,u.next=u),u}function pa(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Uf(n,e,i){return{i:n,x:e,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class pr{constructor(e,i){if(i>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=i}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class Sd{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}Sd.noSubdivision=new Sd({fill:new pr(0,0),line:new pr(0,0),tile:new pr(0,0),stencil:new pr(0,0),circle:1}),wt("SubdivisionGranularityExpression",pr),wt("SubdivisionGranularitySetting",Sd);const ja=-32768,ro=32767;class Tl{constructor(e,i){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=It/e,this._canonical=i}_getKey(e,i){return(e+=32768)<<16|i+32768}_vertexToIndex(e,i){if(e<-32768||i<-32768||e>32767||i>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const o=0|Math.round(e),u=0|Math.round(i),p=this._getKey(o,u);if(this._vertexDictionary.has(p))return this._vertexDictionary.get(p);const m=this._vertexBuffer.length/2;return this._vertexDictionary.set(p,m),this._vertexBuffer.push(o,u),m}_subdivideTrianglesScanline(e){if(this._granularity<2)return(function(u,p){const m=[];for(let v=0;v<p.length;v+=3){const w=p[v],C=p[v+1],P=p[v+2],L=u[2*w],O=u[2*w+1];(u[2*C]-L)*(u[2*P+1]-O)-(u[2*C+1]-O)*(u[2*P]-L)>0?(m.push(w),m.push(P),m.push(C)):(m.push(w),m.push(C),m.push(P))}return m})(this._vertexBuffer,e);const i=[],o=e.length;for(let u=0;u<o;u+=3){const p=[e[u+0],e[u+1],e[u+2]],m=[this._vertexBuffer[2*e[u+0]+0],this._vertexBuffer[2*e[u+0]+1],this._vertexBuffer[2*e[u+1]+0],this._vertexBuffer[2*e[u+1]+1],this._vertexBuffer[2*e[u+2]+0],this._vertexBuffer[2*e[u+2]+1]];let v=1/0,w=1/0,C=-1/0,P=-1/0;for(let Z=0;Z<3;Z++){const $=m[2*Z],ee=m[2*Z+1];v=Math.min(v,$),C=Math.max(C,$),w=Math.min(w,ee),P=Math.max(P,ee)}if(v===C||w===P)continue;const L=Math.floor(v/this._granularityCellSize),O=Math.ceil(C/this._granularityCellSize),F=Math.floor(w/this._granularityCellSize),q=Math.ceil(P/this._granularityCellSize);if(L!==O||F!==q)for(let Z=F;Z<q;Z++){const $=this._scanlineGenerateVertexRingForCellRow(Z,m,p);ao(this._vertexBuffer,$,i)}else i.push(...p)}return i}_scanlineGenerateVertexRingForCellRow(e,i,o){const u=e*this._granularityCellSize,p=u+this._granularityCellSize,m=[];for(let v=0;v<3;v++){const w=i[2*v],C=i[2*v+1],P=i[2*(v+1)%6],L=i[(2*(v+1)+1)%6],O=i[2*(v+2)%6],F=i[(2*(v+2)+1)%6],q=P-w,Z=L-C,$=q===0,ee=Z===0,ue=(u-C)/Z,ie=(p-C)/Z,re=Math.min(ue,ie),fe=Math.max(ue,ie);if(!ee&&(re>=1||fe<=0)||ee&&(C<u||C>p)){L>=u&&L<=p&&m.push(o[(v+1)%3]);continue}!ee&&re>0&&m.push(this._vertexToIndex(w+q*re,C+Z*re));const _e=w+q*Math.max(re,0),je=w+q*Math.min(fe,1);$||this._generateIntraEdgeVertices(m,w,C,P,L,_e,je),!ee&&fe<1&&m.push(this._vertexToIndex(w+q*fe,C+Z*fe)),(ee||L>=u&&L<=p)&&m.push(o[(v+1)%3]),!ee&&(L<=u||L>=p)&&this._generateInterEdgeVertices(m,w,C,P,L,O,F,je,u,p)}return m}_generateIntraEdgeVertices(e,i,o,u,p,m,v){const w=u-i,C=p-o,P=C===0,L=P?Math.min(i,u):Math.min(m,v),O=P?Math.max(i,u):Math.max(m,v),F=Math.floor(L/this._granularityCellSize)+1,q=Math.ceil(O/this._granularityCellSize)-1;if(P?i<u:m<v)for(let Z=F;Z<=q;Z++){const $=Z*this._granularityCellSize;e.push(this._vertexToIndex($,o+C*($-i)/w))}else for(let Z=q;Z>=F;Z--){const $=Z*this._granularityCellSize;e.push(this._vertexToIndex($,o+C*($-i)/w))}}_generateInterEdgeVertices(e,i,o,u,p,m,v,w,C,P){const L=p-o,O=m-u,F=v-p,q=(C-p)/F,Z=(P-p)/F,$=Math.min(q,Z),ee=Math.max(q,Z),ue=u+O*$;let ie=Math.floor(Math.min(ue,w)/this._granularityCellSize)+1,re=Math.ceil(Math.max(ue,w)/this._granularityCellSize)-1,fe=w<ue;const _e=F===0;if(_e&&(v===C||v===P))return;if(_e||$>=1||ee<=0){const Qe=o-v,We=m+(i-m)*Math.min((C-v)/Qe,(P-v)/Qe);ie=Math.floor(Math.min(We,w)/this._granularityCellSize)+1,re=Math.ceil(Math.max(We,w)/this._granularityCellSize)-1,fe=w<We}const je=L>0?P:C;if(fe)for(let Qe=ie;Qe<=re;Qe++)e.push(this._vertexToIndex(Qe*this._granularityCellSize,je));else for(let Qe=re;Qe>=ie;Qe--)e.push(this._vertexToIndex(Qe*this._granularityCellSize,je))}_generateOutline(e){const i=[];for(const o of e){const u=Sl(o,this._granularity,!0),p=this._pointArrayToIndices(u),m=[];for(let v=1;v<p.length;v++)m.push(p[v-1]),m.push(p[v]);i.push(m)}return i}_handlePoles(e){let i=!1,o=!1;this._canonical&&(this._canonical.y===0&&(i=!0),this._canonical.y===(1<<this._canonical.z)-1&&(o=!0)),(i||o)&&this._fillPoles(e,i,o)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let i=0;i<e.length;i+=2){const o=e[i+1];o===ja&&(e[i+1]=-32767),o===ro&&(e[i+1]=32766)}}_generatePoleQuad(e,i,o,u,p,m){u>p!=(m===ja)?(e.push(i),e.push(o),e.push(this._vertexToIndex(u,m)),e.push(o),e.push(this._vertexToIndex(p,m)),e.push(this._vertexToIndex(u,m))):(e.push(o),e.push(i),e.push(this._vertexToIndex(u,m)),e.push(this._vertexToIndex(p,m)),e.push(o),e.push(this._vertexToIndex(u,m)))}_fillPoles(e,i,o){const u=this._vertexBuffer,p=It,m=e.length;for(let v=2;v<m;v+=3){const w=e[v-2],C=e[v-1],P=e[v],L=u[2*w],O=u[2*w+1],F=u[2*C],q=u[2*C+1],Z=u[2*P],$=u[2*P+1];i&&(O===0&&q===0&&this._generatePoleQuad(e,w,C,L,F,ja),q===0&&$===0&&this._generatePoleQuad(e,C,P,F,Z,ja),$===0&&O===0&&this._generatePoleQuad(e,P,w,Z,L,ja)),o&&(O===p&&q===p&&this._generatePoleQuad(e,w,C,L,F,ro),q===p&&$===p&&this._generatePoleQuad(e,C,P,F,Z,ro),$===p&&O===p&&this._generatePoleQuad(e,P,w,Z,L,ro))}}_initializeVertices(e){for(let i=0;i<e.length;i+=2)this._vertexToIndex(e[i],e[i+1])}subdividePolygonInternal(e,i){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:o,holeIndices:u}=(function(v){const w=[],C=[];for(const P of v)if(P.length!==0){P!==v[0]&&w.push(C.length/2);for(let L=0;L<P.length;L++)C.push(P[L].x),C.push(P[L].y)}return{flattened:C,holeIndices:w}})(e);let p;this._initializeVertices(o);try{const v=(function(C,P,L=2){const O=P&&P.length,F=O?P[0]*L:C.length;let q=Nf(C,0,F,L,!0);const Z=[];if(!q||q.next===q.prev)return Z;let $,ee,ue;if(O&&(q=(function(ie,re,fe,_e){const je=[];for(let Qe=0,We=re.length;Qe<We;Qe++){const it=Nf(ie,re[Qe]*_e,Qe<We-1?re[Qe+1]*_e:ie.length,_e,!1);it===it.next&&(it.steiner=!0),je.push(Zy(it))}je.sort(rr);for(let Qe=0;Qe<je.length;Qe++)fe=Qp(je[Qe],fe);return fe})(C,P,q,L)),C.length>80*L){$=C[0],ee=C[1];let ie=$,re=ee;for(let fe=L;fe<F;fe+=L){const _e=C[fe],je=C[fe+1];_e<$&&($=_e),je<ee&&(ee=je),_e>ie&&(ie=_e),je>re&&(re=je)}ue=Math.max(ie-$,re-ee),ue=ue!==0?32767/ue:0}return wu(q,Z,L,$,ee,ue,0),Z})(o,u),w=this._convertIndices(o,v);p=this._subdivideTrianglesScanline(w)}catch(v){console.error(v)}let m=[];return i&&(m=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(p),{verticesFlattened:this._vertexBuffer,indicesTriangles:p,indicesLineList:m}}_convertIndices(e,i){const o=[];for(let u=0;u<i.length;u++)o.push(this._vertexToIndex(e[2*i[u]],e[2*i[u]+1]));return o}_pointArrayToIndices(e){const i=[];for(let o=0;o<e.length;o++){const u=e[o];i.push(this._vertexToIndex(u.x,u.y))}return i}}function Gf(n,e,i,o=!0){return new Tl(i,e).subdividePolygonInternal(n,o)}function Sl(n,e,i=!1){if(!n||n.length<1)return[];if(n.length<2)return[];const o=n[0],u=n[n.length-1],p=i&&(o.x!==u.x||o.y!==u.y);if(e<2)return p?[...n,n[0]]:[...n];const m=Math.floor(It/e),v=[];v.push(new V(n[0].x,n[0].y));const w=n.length,C=p?w:w-1;for(let P=0;P<C;P++){const L=n[P],O=P<w-1?n[P+1]:n[0],F=L.x,q=L.y,Z=O.x,$=O.y,ee=F!==Z,ue=q!==$;if(!ee&&!ue)continue;const ie=Z-F,re=$-q,fe=Math.abs(ie),_e=Math.abs(re);let je=F,Qe=q;for(;;){const it=ie>0?(Math.floor(je/m)+1)*m:(Math.ceil(je/m)-1)*m,mt=re>0?(Math.floor(Qe/m)+1)*m:(Math.ceil(Qe/m)-1)*m,ut=Math.abs(je-it),Ye=Math.abs(Qe-mt),qe=Math.abs(je-Z),bt=Math.abs(Qe-$),xt=ee?ut/fe:Number.POSITIVE_INFINITY,Et=ue?Ye/_e:Number.POSITIVE_INFINITY;if((qe<=ut||!ee)&&(bt<=Ye||!ue))break;if(xt<Et&&ee||!ue){je=it,Qe+=re*xt;const vt=new V(je,Math.round(Qe));v[v.length-1].x===vt.x&&v[v.length-1].y===vt.y||v.push(vt)}else{je+=ie*Et,Qe=mt;const vt=new V(Math.round(je),Qe);v[v.length-1].x===vt.x&&v[v.length-1].y===vt.y||v.push(vt)}}const We=new V(Z,$);v[v.length-1].x===We.x&&v[v.length-1].y===We.y||v.push(We)}return v}function ao(n,e,i){if(e.length===0)throw new Error("Subdivision vertex ring is empty.");let o=0,u=n[2*e[0]];for(let w=1;w<e.length;w++){const C=n[2*e[w]];C<u&&(u=C,o=w)}const p=e.length;let m=o,v=(m+1)%p;for(;;){const w=m-1>=0?m-1:p-1,C=(v+1)%p,P=n[2*e[w]],L=n[2*e[C]],O=n[2*e[m]],F=n[2*e[m]+1],q=n[2*e[v]+1];let Z=!1;if(P<L)Z=!0;else if(P>L)Z=!1;else{const $=q-F,ee=-(n[2*e[v]]-O),ue=F<q?1:-1;((P-O)*$+(n[2*e[w]+1]-F)*ee)*ue>((L-O)*$+(n[2*e[C]+1]-F)*ee)*ue&&(Z=!0)}if(Z){const $=e[w],ee=e[m],ue=e[v];$!==ee&&$!==ue&&ee!==ue&&i.push(ue,ee,$),m--,m<0&&(m=p-1)}else{const $=e[C],ee=e[m],ue=e[v];$!==ee&&$!==ue&&ee!==ue&&i.push(ue,ee,$),v++,v>=p&&(v=0)}if(w===C)break}}function tm(n,e,i,o,u,p,m,v,w){const C=u.length/2,P=m&&v&&w;if(C<yt.MAX_VERTEX_ARRAY_LENGTH){const L=e.prepareSegment(C,i,o),O=L.vertexLength;for(let Z=0;Z<p.length;Z+=3)o.emplaceBack(O+p[Z],O+p[Z+1],O+p[Z+2]);let F,q;L.vertexLength+=C,L.primitiveLength+=p.length/3,P&&(q=m.prepareSegment(C,i,v),F=q.vertexLength,q.vertexLength+=C);for(let Z=0;Z<u.length;Z+=2)n(u[Z],u[Z+1]);if(P)for(let Z=0;Z<w.length;Z++){const $=w[Z];for(let ee=1;ee<$.length;ee+=2)v.emplaceBack(F+$[ee-1],F+$[ee]);q.primitiveLength+=$.length/2}}else(function(L,O,F,q,Z,$){const ee=[];for(let _e=0;_e<q.length/2;_e++)ee.push(-1);const ue={count:0};let ie=0,re=L.getOrCreateLatestSegment(O,F),fe=re.vertexLength;for(let _e=2;_e<Z.length;_e+=3){const je=Z[_e-2],Qe=Z[_e-1],We=Z[_e];let it=ee[je]<ie,mt=ee[Qe]<ie,ut=ee[We]<ie;re.vertexLength+((it?1:0)+(mt?1:0)+(ut?1:0))>yt.MAX_VERTEX_ARRAY_LENGTH&&(re=L.createNewSegment(O,F),ie=ue.count,it=!0,mt=!0,ut=!0,fe=0);const Ye=Fo(ee,q,$,ue,je,it,re),qe=Fo(ee,q,$,ue,Qe,mt,re),bt=Fo(ee,q,$,ue,We,ut,re);F.emplaceBack(fe+Ye-ie,fe+qe-ie,fe+bt-ie),re.primitiveLength++}})(e,i,o,u,p,n),P&&(function(L,O,F,q,Z,$){const ee=[];for(let _e=0;_e<q.length/2;_e++)ee.push(-1);const ue={count:0};let ie=0,re=L.getOrCreateLatestSegment(O,F),fe=re.vertexLength;for(let _e=0;_e<Z.length;_e++){const je=Z[_e];for(let Qe=1;Qe<Z[_e].length;Qe+=2){const We=je[Qe-1],it=je[Qe];let mt=ee[We]<ie,ut=ee[it]<ie;re.vertexLength+((mt?1:0)+(ut?1:0))>yt.MAX_VERTEX_ARRAY_LENGTH&&(re=L.createNewSegment(O,F),ie=ue.count,mt=!0,ut=!0,fe=0);const Ye=Fo(ee,q,$,ue,We,mt,re),qe=Fo(ee,q,$,ue,it,ut,re);F.emplaceBack(fe+Ye-ie,fe+qe-ie),re.primitiveLength++}}})(m,i,v,u,w,n),e.forceNewSegmentOnNextPrepare(),m?.forceNewSegmentOnNextPrepare()}function Fo(n,e,i,o,u,p,m){if(p){const v=o.count;return i(e[2*u],e[2*u+1]),n[u]=o.count,o.count++,m.vertexLength++,v}return n[u]}class Tu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new se,this.indexArray=new Oe,this.indexArray2=new dt,this.programConfigurations=new ko(e.layers,e.zoom),this.segments=new yt,this.segments2=new yt,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,o){this.hasDependencies=is("fill",this.layers,i);const u=this.layers[0].layout.get("fill-sort-key"),p=!u.isConstant(),m=[];for(const{feature:v,id:w,index:C,sourceLayerIndex:P}of e){const L=this.layers[0]._featureFilter.needGeometry,O=ts(v,L);if(!this.layers[0]._featureFilter.filter(new Mi(this.zoom),O,o))continue;const F=p?u.evaluate(O,{},o,i.availableImages):void 0,q={id:w,properties:v.properties,type:v.type,sourceLayerIndex:P,index:C,geometry:L?O.geometry:no(v),patterns:{},sortKey:F};m.push(q)}p&&m.sort(((v,w)=>v.sortKey-w.sortKey));for(const v of m){const{geometry:w,index:C,sourceLayerIndex:P}=v;if(this.hasDependencies){const L=Ff("fill",this.layers,v,{zoom:this.zoom},i);this.patternFeatures.push(L)}else this.addFeature(v,w,C,o,{},i.subdivisionGranularity);i.featureIndex.insert(e[C].feature,w,C,P,this.index)}}update(e,i,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:o})}addFeatures(e,i,o){for(const u of this.patternFeatures)this.addFeature(u,u.geometry,u.index,i,o,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xd),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,o,u,p,m){for(const v of Yc(i,500)){const w=Gf(v,u,m.fill.getGranularityForZoomLevel(u.z)),C=this.layoutVertexArray;tm(((P,L)=>{C.emplaceBack(P,L)}),this.segments,this.layoutVertexArray,this.indexArray,w.verticesFlattened,w.indicesTriangles,this.segments2,this.indexArray2,w.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{imagePositions:p,canonical:u})}}let _h,Su;wt("FillBucket",Tu,{omit:["layers","patternFeatures"]});var Ag={get paint(){return Su=Su||new En({"fill-antialias":new Tt(Te.paint_fill["fill-antialias"]),"fill-opacity":new Ct(Te.paint_fill["fill-opacity"]),"fill-color":new Ct(Te.paint_fill["fill-color"]),"fill-outline-color":new Ct(Te.paint_fill["fill-outline-color"]),"fill-translate":new Tt(Te.paint_fill["fill-translate"]),"fill-translate-anchor":new Tt(Te.paint_fill["fill-translate-anchor"]),"fill-pattern":new Pa(Te.paint_fill["fill-pattern"])})},get layout(){return _h=_h||new En({"fill-sort-key":new Ct(Te.layout_fill["fill-sort-key"])})}};class Cg extends un{constructor(e,i){super(e,Ag,i)}recalculate(e,i){super.recalculate(e,i);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Tu(e)}queryRadius(){return dd(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:i,transform:o,pixelsToTileUnits:u}){return Df(Pf(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-o.bearingInRadians,u),i)}isTileClipped(){return!0}}const Md=tn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Dg=tn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:qf}=Md;class xh{constructor(e,i,o,u,p){this.properties={},this.extent=o,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=p,e.readFields(Hy,this,i)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const i=e.readVarint()+e.pos,o=[];let u,p=1,m=0,v=0,w=0;for(;e.pos<i;){if(m<=0){const C=e.readVarint();p=7&C,m=C>>3}if(m--,p===1||p===2)v+=e.readSVarint(),w+=e.readSVarint(),p===1&&(u&&o.push(u),u=[]),u&&u.push(new V(v,w));else{if(p!==7)throw new Error(`unknown command ${p}`);u&&u.push(u[0].clone())}}return u&&o.push(u),o}bbox(){const e=this._pbf;e.pos=this._geometry;const i=e.readVarint()+e.pos;let o=1,u=0,p=0,m=0,v=1/0,w=-1/0,C=1/0,P=-1/0;for(;e.pos<i;){if(u<=0){const L=e.readVarint();o=7&L,u=L>>3}if(u--,o===1||o===2)p+=e.readSVarint(),m+=e.readSVarint(),p<v&&(v=p),p>w&&(w=p),m<C&&(C=m),m>P&&(P=m);else if(o!==7)throw new Error(`unknown command ${o}`)}return[v,C,w,P]}toGeoJSON(e,i,o){const u=this.extent*Math.pow(2,o),p=this.extent*e,m=this.extent*i,v=this.loadGeometry();function w(O){return[360*(O.x+p)/u-180,360/Math.PI*Math.atan(Math.exp((1-2*(O.y+m)/u)*Math.PI))-90]}function C(O){return O.map(w)}let P;if(this.type===1){const O=[];for(const q of v)O.push(q[0]);const F=C(O);P=O.length===1?{type:"Point",coordinates:F[0]}:{type:"MultiPoint",coordinates:F}}else if(this.type===2){const O=v.map(C);P=O.length===1?{type:"LineString",coordinates:O[0]}:{type:"MultiLineString",coordinates:O}}else{if(this.type!==3)throw new Error("unknown feature type");{const O=zg(v),F=[];for(const q of O)F.push(q.map(C));P=F.length===1?{type:"Polygon",coordinates:F[0]}:{type:"MultiPolygon",coordinates:F}}}const L={type:"Feature",geometry:P,properties:this.properties};return this.id!=null&&(L.id=this.id),L}}function Hy(n,e,i){n===1?e.id=i.readVarint():n===2?(function(o,u){const p=o.readVarint()+o.pos;for(;o.pos<p;){const m=u._keys[o.readVarint()],v=u._values[o.readVarint()];u.properties[m]=v}})(i,e):n===3?e.type=i.readVarint():n===4&&(e._geometry=i.pos)}function zg(n){const e=n.length;if(e<=1)return[n];const i=[];let o,u;for(let p=0;p<e;p++){const m=Ni(n[p]);m!==0&&(u===void 0&&(u=m<0),u===m<0?(o&&i.push(o),o=[n[p]]):o&&o.push(n[p]))}return o&&i.push(o),i}function Ni(n){let e=0;for(let i,o,u=0,p=n.length,m=p-1;u<p;m=u++)i=n[u],o=n[m],e+=(o.x-i.x)*(i.y+o.y);return e}xh.types=["Unknown","Point","LineString","Polygon"];class rn{constructor(e,i){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(mi,this,i),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const i=this._pbf.readVarint()+this._pbf.pos;return new xh(this._pbf,i,this.extent,this._keys,this._values)}}function mi(n,e,i){n===15?e.version=i.readVarint():n===1?e.name=i.readString():n===5?e.extent=i.readVarint():n===2?e._features.push(i.pos):n===3?e._keys.push(i.readString()):n===4&&e._values.push((function(o){let u=null;const p=o.readVarint()+o.pos;for(;o.pos<p;){const m=o.readVarint()>>3;u=m===1?o.readString():m===2?o.readFloat():m===3?o.readDouble():m===4?o.readVarint64():m===5?o.readVarint():m===6?o.readSVarint():m===7?o.readBoolean():null}if(u==null)throw new Error("unknown feature value");return u})(i))}class gi{constructor(e,i){this.layers=e.readFields(Hi,{},i)}}function Hi(n,e,i){if(n===3){const o=new rn(i,i.readVarint()+i.pos);o.length&&(e[o.name]=o)}}const ma=Math.pow(2,13);function Ls(n,e,i,o,u,p,m,v){n.emplaceBack(e,i,2*Math.floor(o*ma)+m,u*ma*2,p*ma*2,Math.round(v))}class mc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new he,this.centroidVertexArray=new ae,this.indexArray=new Oe,this.programConfigurations=new ko(e.layers,e.zoom),this.segments=new yt,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,o){this.features=[],this.hasDependencies=is("fill-extrusion",this.layers,i);for(const{feature:u,id:p,index:m,sourceLayerIndex:v}of e){const w=this.layers[0]._featureFilter.needGeometry,C=ts(u,w);if(!this.layers[0]._featureFilter.filter(new Mi(this.zoom),C,o))continue;const P={id:p,sourceLayerIndex:v,index:m,geometry:w?C.geometry:no(u),properties:u.properties,type:u.type,patterns:{}};this.hasDependencies?this.features.push(Ff("fill-extrusion",this.layers,P,{zoom:this.zoom},i)):this.addFeature(P,P.geometry,m,o,{},i.subdivisionGranularity),i.featureIndex.insert(u,P.geometry,m,v,this.index,!0)}}addFeatures(e,i,o){for(const u of this.features){const{geometry:p}=u;this.addFeature(u,p,u.index,i,o,e.subdivisionGranularity)}}update(e,i,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:o})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,qf),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Dg.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,i,o,u,p,m){for(const v of Yc(i,500)){const w={x:0,y:0,sampleCount:0},C=this.layoutVertexArray.length;this.processPolygon(w,u,e,v,m);const P=this.layoutVertexArray.length-C,L=Math.floor(w.x/w.sampleCount),O=Math.floor(w.y/w.sampleCount);for(let F=0;F<P;F++)this.centroidVertexArray.emplaceBack(L,O)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{imagePositions:p,canonical:u})}processPolygon(e,i,o,u,p){if(u.length<1||Rn(u[0]))return;for(const L of u)L.length!==0&&im(e,L);const m={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},v=p.fill.getGranularityForZoomLevel(i.z),w=xh.types[o.type]==="Polygon";for(const L of u){if(L.length===0||Rn(L))continue;const O=Sl(L,v,w);this._generateSideFaces(O,m)}if(!w)return;const C=Gf(u,i,v,!1),P=this.layoutVertexArray;tm(((L,O)=>{Ls(P,L,O,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,C.verticesFlattened,C.indicesTriangles)}_generateSideFaces(e,i){let o=0;for(let u=1;u<e.length;u++){const p=e[u],m=e[u-1];if(Ml(p,m))continue;i.segment.vertexLength+4>yt.MAX_VERTEX_ARRAY_LENGTH&&(i.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const v=p.sub(m)._perp()._unit(),w=m.dist(p);o+w>32768&&(o=0),Ls(this.layoutVertexArray,p.x,p.y,v.x,v.y,0,0,o),Ls(this.layoutVertexArray,p.x,p.y,v.x,v.y,0,1,o),o+=w,Ls(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,0,o),Ls(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,1,o);const C=i.segment.vertexLength;this.indexArray.emplaceBack(C,C+2,C+1),this.indexArray.emplaceBack(C+1,C+2,C+3),i.segment.vertexLength+=4,i.segment.primitiveLength+=2}}}function im(n,e){for(let i=0;i<e.length;i++){const o=e[i];i===e.length-1&&e[0].x===o.x&&e[0].y===o.y||(n.x+=o.x,n.y+=o.y,n.sampleCount++)}}function Ml(n,e){return n.x===e.x&&(n.x<0||n.x>It)||n.y===e.y&&(n.y<0||n.y>It)}function Rn(n){return n.every((e=>e.x<0))||n.every((e=>e.x>It))||n.every((e=>e.y<0))||n.every((e=>e.y>It))}let El;wt("FillExtrusionBucket",mc,{omit:["layers","features"]});var Mu={get paint(){return El=El||new En({"fill-extrusion-opacity":new Tt(Te["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ct(Te["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Tt(Te["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Tt(Te["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Pa(Te["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ct(Te["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ct(Te["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Tt(Te["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class nm extends un{constructor(e,i){super(e,Mu,i)}createBucket(e){return new mc(e)}queryRadius(){return dd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:o,geometry:u,transform:p,pixelsToTileUnits:m,pixelPosMatrix:v}){const w=Pf(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-p.bearingInRadians,m),C=this.paint.get("fill-extrusion-height").evaluate(i,o),P=this.paint.get("fill-extrusion-base").evaluate(i,o),L=(function(F,q){const Z=[];for(const $ of F){const ee=[$.x,$.y,0,1];yr(ee,ee,q),Z.push(new V(ee[0]/ee[3],ee[1]/ee[3]))}return Z})(w,v),O=(function(F,q,Z,$){const ee=[],ue=[],ie=$[8]*q,re=$[9]*q,fe=$[10]*q,_e=$[11]*q,je=$[8]*Z,Qe=$[9]*Z,We=$[10]*Z,it=$[11]*Z;for(const mt of F){const ut=[],Ye=[];for(const qe of mt){const bt=qe.x,xt=qe.y,Et=$[0]*bt+$[4]*xt+$[12],vt=$[1]*bt+$[5]*xt+$[13],jt=$[2]*bt+$[6]*xt+$[14],bi=$[3]*bt+$[7]*xt+$[15],li=jt+fe,vn=bi+_e,Yr=Et+je,cr=vt+Qe,bn=jt+We,dn=bi+it,Ii=new V((Et+ie)/vn,(vt+re)/vn);Ii.z=li/vn,ut.push(Ii);const kn=new V(Yr/dn,cr/dn);kn.z=bn/dn,Ye.push(kn)}ee.push(ut),ue.push(Ye)}return[ee,ue]})(u,P,C,v);return(function(F,q,Z){let $=1/0;Df(Z,q)&&($=Eu(Z,q[0]));for(let ee=0;ee<q.length;ee++){const ue=q[ee],ie=F[ee];for(let re=0;re<ue.length-1;re++){const fe=ue[re],_e=[fe,ue[re+1],ie[re+1],ie[re],fe];bu(Z,_e)&&($=Math.min($,Eu(Z,_e)))}}return $!==1/0&&$})(O[0],O[1],L)}}function kr(n,e){return n.x*e.x+n.y*e.y}function Eu(n,e){if(n.length===1){let i=0;const o=e[i++];let u;for(;!u||o.equals(u);)if(u=e[i++],!u)return 1/0;for(;i<e.length;i++){const p=e[i],m=n[0],v=u.sub(o),w=p.sub(o),C=m.sub(o),P=kr(v,v),L=kr(v,w),O=kr(w,w),F=kr(C,v),q=kr(C,w),Z=P*O-L*L,$=(O*F-L*q)/Z,ee=(P*q-L*F)/Z,ue=o.z*(1-$-ee)+u.z*$+p.z*ee;if(isFinite(ue))return ue}return 1/0}{let i=1/0;for(const o of e)i=Math.min(i,o.z);return i}}const Ed=tn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ba}=Ed,rm=tn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Zf}=rm,Pg=Math.cos(Math.PI/180*37.5),Ad=Math.pow(2,14)/.5;class vh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((i=>{this.gradients[i.id]={}})),this.layoutVertexArray=new ye,this.layoutVertexArray2=new ce,this.indexArray=new Oe,this.programConfigurations=new ko(e.layers,e.zoom),this.segments=new yt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,o){this.hasDependencies=is("line",this.layers,i)||this.hasLineDasharray(this.layers);const u=this.layers[0].layout.get("line-sort-key"),p=!u.isConstant(),m=[];for(const{feature:v,id:w,index:C,sourceLayerIndex:P}of e){const L=this.layers[0]._featureFilter.needGeometry,O=ts(v,L);if(!this.layers[0]._featureFilter.filter(new Mi(this.zoom),O,o))continue;const F=p?u.evaluate(O,{},o):void 0,q={id:w,properties:v.properties,type:v.type,sourceLayerIndex:P,index:C,geometry:L?O.geometry:no(v),patterns:{},dashes:{},sortKey:F};m.push(q)}p&&m.sort(((v,w)=>v.sortKey-w.sortKey));for(const v of m){const{geometry:w,index:C,sourceLayerIndex:P}=v;this.hasDependencies?(is("line",this.layers,i)?Ff("line",this.layers,v,{zoom:this.zoom},i):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,v,this.zoom,i),this.patternFeatures.push(v)):this.addFeature(v,w,C,o,{},{},i.subdivisionGranularity),i.featureIndex.insert(e[C].feature,w,C,P,this.index)}}update(e,i,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:o,dashPositions:u})}addFeatures(e,i,o,u){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,i,o,u,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Zf)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ba),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,o,u,p,m,v){const w=this.layers[0].layout,C=w.get("line-join").evaluate(e,{}),P=w.get("line-cap"),L=w.get("line-miter-limit"),O=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const F of i)this.addLine(F,e,C,P,L,O,u,v);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{imagePositions:p,dashPositions:m,canonical:u})}addLine(e,i,o,u,p,m,v,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=Sl(e,v?w.line.getGranularityForZoomLevel(v.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ie=0;ie<e.length-1;ie++)this.totalDistance+=e[ie].dist(e[ie+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C=xh.types[i.type]==="Polygon";let P=e.length;for(;P>=2&&e[P-1].equals(e[P-2]);)P--;let L=0;for(;L<P-1&&e[L].equals(e[L+1]);)L++;if(P<(C?3:2))return;o==="bevel"&&(p=1.05);const O=this.overscaling<=16?122880/(512*this.overscaling):0,F=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let q,Z,$,ee,ue;this.e1=this.e2=-1,C&&(q=e[P-2],ue=e[L].sub(q)._unit()._perp());for(let ie=L;ie<P;ie++){if($=ie===P-1?C?e[L+1]:void 0:e[ie+1],$&&e[ie].equals($))continue;ue&&(ee=ue),q&&(Z=q),q=e[ie],ue=$?$.sub(q)._unit()._perp():ee,ee=ee||ue;let re=ee.add(ue);re.x===0&&re.y===0||re._unit();const fe=ee.x*ue.x+ee.y*ue.y,_e=re.x*ue.x+re.y*ue.y,je=_e!==0?1/_e:1/0,Qe=2*Math.sqrt(2-2*_e),We=_e<Pg&&Z&&$,it=ee.x*ue.y-ee.y*ue.x>0;if(We&&ie>L){const Ye=q.dist(Z);if(Ye>2*O){const qe=q.sub(q.sub(Z)._mult(O/Ye)._round());this.updateDistance(Z,qe),this.addCurrentVertex(qe,ee,0,0,F),Z=qe}}const mt=Z&&$;let ut=mt?o:C?"butt":u;if(mt&&ut==="round"&&(je<m?ut="miter":je<=2&&(ut="fakeround")),ut==="miter"&&je>p&&(ut="bevel"),ut==="bevel"&&(je>2&&(ut="flipbevel"),je<p&&(ut="miter")),Z&&this.updateDistance(Z,q),ut==="miter")re._mult(je),this.addCurrentVertex(q,re,0,0,F);else if(ut==="flipbevel"){if(je>100)re=ue.mult(-1);else{const Ye=je*ee.add(ue).mag()/ee.sub(ue).mag();re._perp()._mult(Ye*(it?-1:1))}this.addCurrentVertex(q,re,0,0,F),this.addCurrentVertex(q,re.mult(-1),0,0,F)}else if(ut==="bevel"||ut==="fakeround"){const Ye=-Math.sqrt(je*je-1),qe=it?Ye:0,bt=it?0:Ye;if(Z&&this.addCurrentVertex(q,ee,qe,bt,F),ut==="fakeround"){const xt=Math.round(180*Qe/Math.PI/20);for(let Et=1;Et<xt;Et++){let vt=Et/xt;if(vt!==.5){const bi=vt-.5;vt+=vt*bi*(vt-1)*((1.0904+fe*(fe*(3.55645-1.43519*fe)-3.2452))*bi*bi+(.848013+fe*(.215638*fe-1.06021)))}const jt=ue.sub(ee)._mult(vt)._add(ee)._unit()._mult(it?-1:1);this.addHalfVertex(q,jt.x,jt.y,!1,it,0,F)}}$&&this.addCurrentVertex(q,ue,-qe,-bt,F)}else if(ut==="butt")this.addCurrentVertex(q,re,0,0,F);else if(ut==="square"){const Ye=Z?1:-1;this.addCurrentVertex(q,re,Ye,Ye,F)}else ut==="round"&&(Z&&(this.addCurrentVertex(q,ee,0,0,F),this.addCurrentVertex(q,ee,1,1,F,!0)),$&&(this.addCurrentVertex(q,ue,-1,-1,F,!0),this.addCurrentVertex(q,ue,0,0,F)));if(We&&ie<P-1){const Ye=q.dist($);if(Ye>2*O){const qe=q.add($.sub(q)._mult(O/Ye)._round());this.updateDistance(q,qe),this.addCurrentVertex(qe,ue,0,0,F),q=qe}}}}addCurrentVertex(e,i,o,u,p,m=!1){const v=i.y*u-i.x,w=-i.y-i.x*u;this.addHalfVertex(e,i.x+i.y*o,i.y-i.x*o,m,!1,o,p),this.addHalfVertex(e,v,w,m,!0,-u,p),this.distance>Ad/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,i,o,u,p,m))}addHalfVertex({x:e,y:i},o,u,p,m,v,w){const C=.5*(this.lineClips?this.scaledDistance*(Ad-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(p?1:0),(i<<1)+(m?1:0),Math.round(63*o)+128,Math.round(63*u)+128,1+(v===0?0:v<0?-1:1)|(63&C)<<2,C>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const P=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,P,this.e2),w.primitiveLength++),m?this.e2=P:this.e1=P}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}hasLineDasharray(e){for(const i of e){const o=i.paint.get("line-dasharray");if(o&&!o.isConstant())return!0}return!1}addLineDashDependencies(e,i,o,u){for(const p of e){const m=p.paint.get("line-dasharray");if(!m||m.value.kind==="constant")continue;const v=p.layout.get("line-cap")==="round",w={dasharray:m.value.evaluate({zoom:o-1},i,{}),round:v},C={dasharray:m.value.evaluate({zoom:o},i,{}),round:v},P={dasharray:m.value.evaluate({zoom:o+1},i,{}),round:v},L=`${w.dasharray.join(",")},${w.round}`,O=`${C.dasharray.join(",")},${C.round}`,F=`${P.dasharray.join(",")},${P.round}`;u.dashDependencies[L]=w,u.dashDependencies[O]=C,u.dashDependencies[F]=P,i.dashes[p.id]={min:L,mid:O,max:F}}}}let Al,sr;wt("LineBucket",vh,{omit:["layers","patternFeatures"]});var Cl={get paint(){return sr=sr||new En({"line-opacity":new Ct(Te.paint_line["line-opacity"]),"line-color":new Ct(Te.paint_line["line-color"]),"line-translate":new Tt(Te.paint_line["line-translate"]),"line-translate-anchor":new Tt(Te.paint_line["line-translate-anchor"]),"line-width":new Ct(Te.paint_line["line-width"]),"line-gap-width":new Ct(Te.paint_line["line-gap-width"]),"line-offset":new Ct(Te.paint_line["line-offset"]),"line-blur":new Ct(Te.paint_line["line-blur"]),"line-dasharray":new Pa(Te.paint_line["line-dasharray"]),"line-pattern":new Pa(Te.paint_line["line-pattern"]),"line-gradient":new pu(Te.paint_line["line-gradient"])})},get layout(){return Al=Al||new En({"line-cap":new Tt(Te.layout_line["line-cap"]),"line-join":new Ct(Te.layout_line["line-join"]),"line-miter-limit":new Tt(Te.layout_line["line-miter-limit"]),"line-round-limit":new Tt(Te.layout_line["line-round-limit"]),"line-sort-key":new Ct(Te.layout_line["line-sort-key"])})}};class bh extends Ct{possiblyEvaluate(e,i){return i=new Mi(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(e,i)}evaluate(e,i,o,u){return i=Li({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(e,i,o,u)}}let js;class am extends un{constructor(e,i){super(e,Cl,i),this.gradientVersion=0,js||(js=new bh(Cl.paint.properties["line-width"].specification),js.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const i=this.gradientExpression();this.stepInterpolant=!!(function(o){return o._styleExpression!==void 0})(i)&&i._styleExpression.expression instanceof vo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,i){super.recalculate(e,i),this.paint._values["line-floorwidth"]=js.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new vh(e)}queryRadius(e){const i=e,o=Hf(vl("line-width",this,i),vl("line-gap-width",this,i)),u=vl("line-offset",this,i);return o/2+Math.abs(u)+dd(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:o,geometry:u,transform:p,pixelsToTileUnits:m}){const v=Pf(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-p.bearingInRadians,m),w=m/2*Hf(this.paint.get("line-width").evaluate(i,o),this.paint.get("line-gap-width").evaluate(i,o)),C=this.paint.get("line-offset").evaluate(i,o);return C&&(u=(function(P,L){const O=[];for(let F=0;F<P.length;F++){const q=If(P[F]),Z=[];for(let $=0;$<q.length;$++){const ee=q[$],ue=q[$-1],ie=q[$+1],re=$===0?new V(0,0):ee.sub(ue)._unit()._perp(),fe=$===q.length-1?new V(0,0):ie.sub(ee)._unit()._perp(),_e=re._add(fe)._unit(),je=_e.x*fe.x+_e.y*fe.y;je!==0&&_e._mult(1/je),Z.push(_e._mult(L)._add(ee))}O.push(Z)}return O})(u,C*m)),(function(P,L,O){for(let F=0;F<L.length;F++){const q=L[F];if(P.length>=3){for(let Z=0;Z<q.length;Z++)if(jo(P,q[Z]))return!0}if(nr(P,q,O))return!0}return!1})(v,u,w)}isTileClipped(){return!0}}function Hf(n,e){return e>0?e+2*n:n}const Ig=tn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Cd=tn([{name:"a_projected_pos",components:3,type:"Float32"}],4);tn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const sm=tn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);tn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Oa=tn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Rg=tn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Fa(n,e,i){return n.sections.forEach((o=>{o.text=(function(u,p,m){const v=p.layout.get("text-transform").evaluate(m,{});return v==="uppercase"?u=u.toLocaleUpperCase():v==="lowercase"&&(u=u.toLocaleLowerCase()),za.applyArabicShaping&&(u=za.applyArabicShaping(u)),u})(o.text,e,i)})),n}tn([{name:"triangle",components:3,type:"Uint16"}]),tn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),tn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),tn([{type:"Float32",name:"offsetX"}]),tn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),tn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var Yn=24;const wh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},$y={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},gc={40:!0};function Dd(n,e,i,o,u,p){if("fontStack"in e){const m=i[e.fontStack],v=m&&m[n];return v?v.metrics.advance*e.scale+u:0}{const m=o[e.imageName];return m?m.displaySize[0]*e.scale*Yn/p+u:0}}function $f(n,e,i,o){const u=Math.pow(n-e,2);return o?n<e?u/2:2*u:u+Math.abs(i)*i}function Th(n,e,i){let o=0;return n===10&&(o-=1e4),i&&(o+=150),n!==40&&n!==65288||(o+=50),e!==41&&e!==65289||(o+=50),o}function om(n,e,i,o,u,p){let m=null,v=$f(e,i,u,p);for(const w of o){const C=$f(e-w.x,i,u,p)+w.badness;C<=v&&(m=w,v=C)}return{index:n,x:e,priorBreak:m,badness:v}}function lm(n){return n?lm(n.priorBreak).concat(n.index):[]}class Au{constructor(e="",i=[],o=[]){this.text=e,this.sections=i,this.sectionIndex=o,this.imageSectionID=null}static fromFeature(e,i){const o=new Au;for(let u=0;u<e.sections.length;u++){const p=e.sections[u];p.image?o.addImageSection(p):o.addTextSection(p,i)}return o}length(){return[...this.text].length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}verticalizePunctuation(){this.text=(function(e){let i="",o={premature:!0,value:void 0};const u=e[Symbol.iterator]();let p=u.next();const m=e[Symbol.iterator]();m.next();let v=m.next();for(;!p.done;)i+=!v.done&&zs(v.value.codePointAt(0))&&!wh[v.value]||!o.premature&&zs(o.value.codePointAt(0))&&!wh[o.value]||!wh[p.value]?p.value:wh[p.value],o={value:p.value,premature:!1},p=u.next(),v=m.next();return i})(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const e=this.text.match(/^\s*/),i=e?e[0].length:0,o=this.text.match(/\S\s*$/),u=o?o[0].length-1:0;this.text=this.text.substring(i,this.text.length-u),this.sectionIndex=this.sectionIndex.slice(i,this.sectionIndex.length-u)}substring(e,i){const o=[...this.text].slice(e,i).join(""),u=this.sectionIndex.slice(e,i);return new Au(o,this.sections,u)}toCodeUnitIndex(e){return[...this.text].slice(0,e).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,i)=>Math.max(e,this.sections[i].scale)),0)}getMaxImageSize(e){let i=0,o=0;for(let u=0;u<this.length();u++){const p=this.getSection(u);if("imageName"in p){const m=e[p.imageName];if(!m)continue;const v=m.displaySize;i=Math.max(i,v[0]),o=Math.max(o,v[1])}}return{maxImageWidth:i,maxImageHeight:o}}addTextSection(e,i){this.text+=e.text,this.sections.push({scale:e.scale||1,verticalAlign:e.verticalAlign||"bottom",fontStack:e.fontStack||i});const o=this.sections.length-1;this.sectionIndex.push(...[...e.text].map((()=>o)))}addImageSection(e){const i=e.image?e.image.name:"";if(i.length===0)return void sn("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCharCode(o),this.sections.push({scale:1,verticalAlign:e.verticalAlign||"bottom",imageName:i}),this.sectionIndex.push(this.sections.length-1)):sn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(e,i,o,u,p){const m=[],v=this.determineAverageLineWidth(e,i,o,u,p),w=this.hasZeroWidthSpaces();let C=0,P=0;const L=this.text[Symbol.iterator]();let O=L.next();const F=this.text[Symbol.iterator]();F.next();let q=F.next();const Z=this.text[Symbol.iterator]();Z.next(),Z.next();let $=Z.next();for(;!O.done;){const ee=this.getSection(P),ue=O.value.codePointAt(0);if(cu(ue)||(C+=Dd(ue,ee,o,u,e,p)),!q.done){const ie=As(ue),re=q.value.codePointAt(0);($y[ue]||ie||"imageName"in ee||!$.done&&gc[re])&&m.push(om(P+1,C,v,m,Th(ue,re,ie&&w),!1))}P++,O=L.next(),q=F.next(),$=Z.next()}return lm(om(this.length(),C,v,m,0,!0))}determineAverageLineWidth(e,i,o,u,p){let m=0,v=0;for(const w of this.text){const C=this.getSection(v);m+=Dd(w.codePointAt(0),C,o,u,e,p),v++}return m/Math.max(1,Math.ceil(m/i))}}const Xf=4294967296,zd=1/Xf,Yf=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Wf{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,i,o=this.length){for(;this.pos<o;){const u=this.readVarint(),p=u>>3,m=this.pos;this.type=7&u,e(p,i,this),this.pos===m&&this.skip(u)}return i}readMessage(e,i){return this.readFields(e,i,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Xf;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Xf;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const i=this.buf;let o,u;return u=i[this.pos++],o=127&u,u<128?o:(u=i[this.pos++],o|=(127&u)<<7,u<128?o:(u=i[this.pos++],o|=(127&u)<<14,u<128?o:(u=i[this.pos++],o|=(127&u)<<21,u<128?o:(u=i[this.pos],o|=(15&u)<<28,(function(p,m,v){const w=v.buf;let C,P;if(P=w[v.pos++],C=(112&P)>>4,P<128||(P=w[v.pos++],C|=(127&P)<<3,P<128)||(P=w[v.pos++],C|=(127&P)<<10,P<128)||(P=w[v.pos++],C|=(127&P)<<17,P<128)||(P=w[v.pos++],C|=(127&P)<<24,P<128)||(P=w[v.pos++],C|=(1&P)<<31,P<128))return Sh(p,C,m);throw new Error("Expected varint not more than 10 bytes")})(o,e,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2==1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,i=this.pos;return this.pos=e,e-i>=12&&Yf?Yf.decode(this.buf.subarray(i,e)):(function(o,u,p){let m="",v=u;for(;v<p;){const w=o[v];let C,P,L,O=null,F=w>239?4:w>223?3:w>191?2:1;if(v+F>p)break;F===1?w<128&&(O=w):F===2?(C=o[v+1],(192&C)==128&&(O=(31&w)<<6|63&C,O<=127&&(O=null))):F===3?(C=o[v+1],P=o[v+2],(192&C)==128&&(192&P)==128&&(O=(15&w)<<12|(63&C)<<6|63&P,(O<=2047||O>=55296&&O<=57343)&&(O=null))):F===4&&(C=o[v+1],P=o[v+2],L=o[v+3],(192&C)==128&&(192&P)==128&&(192&L)==128&&(O=(15&w)<<18|(63&C)<<12|(63&P)<<6|63&L,(O<=65535||O>=1114112)&&(O=null))),O===null?(O=65533,F=1):O>65535&&(O-=65536,m+=String.fromCharCode(O>>>10&1023|55296),O=56320|1023&O),m+=String.fromCharCode(O),v+=F}return m})(this.buf,i,e)}readBytes(){const e=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,e);return this.pos=e,i}readPackedVarint(e=[],i){const o=this.readPackedEnd();for(;this.pos<o;)e.push(this.readVarint(i));return e}readPackedSVarint(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(e){const i=7&e;if(i===0)for(;this.buf[this.pos++]>127;);else if(i===2)this.pos=this.readVarint()+this.pos;else if(i===5)this.pos+=4;else{if(i!==1)throw new Error(`Unimplemented type: ${i}`);this.pos+=8}}writeTag(e,i){this.writeVarint(e<<3|i)}realloc(e){let i=this.length||16;for(;i<this.pos+e;)i*=2;if(i!==this.length){const o=new Uint8Array(i);o.set(this.buf),this.buf=o,this.dataView=new DataView(o.buffer),this.length=i}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*zd),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*zd),!0),this.pos+=8}writeVarint(e){(e=+e||0)>268435455||e<0?(function(i,o){let u,p;if(i>=0?(u=i%4294967296|0,p=i/4294967296|0):(u=~(-i%4294967296),p=~(-i/4294967296),4294967295^u?u=u+1|0:(u=0,p=p+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),(function(m,v,w){w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,w.buf[w.pos]=127&(m>>>=7)})(u,0,o),(function(m,v){const w=(7&m)<<4;v.buf[v.pos++]|=w|((m>>>=3)?128:0),m&&(v.buf[v.pos++]=127&m|((m>>>=7)?128:0),m&&(v.buf[v.pos++]=127&m|((m>>>=7)?128:0),m&&(v.buf[v.pos++]=127&m|((m>>>=7)?128:0),m&&(v.buf[v.pos++]=127&m|((m>>>=7)?128:0),m&&(v.buf[v.pos++]=127&m)))))})(p,o)})(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))}writeSVarint(e){this.writeVarint(e<0?2*-e-1:2*e)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(4*e.length),this.pos++;const i=this.pos;this.pos=(function(u,p,m){for(let v,w,C=0;C<p.length;C++){if(v=p.charCodeAt(C),v>55295&&v<57344){if(!w){v>56319||C+1===p.length?(u[m++]=239,u[m++]=191,u[m++]=189):w=v;continue}if(v<56320){u[m++]=239,u[m++]=191,u[m++]=189,w=v;continue}v=w-55296<<10|v-56320|65536,w=null}else w&&(u[m++]=239,u[m++]=191,u[m++]=189,w=null);v<128?u[m++]=v:(v<2048?u[m++]=v>>6|192:(v<65536?u[m++]=v>>12|224:(u[m++]=v>>18|240,u[m++]=v>>12&63|128),u[m++]=v>>6&63|128),u[m++]=63&v|128)}return m})(this.buf,e,this.pos);const o=this.pos-i;o>=128&&kg(i,o,this),this.pos=i-1,this.writeVarint(o),this.pos+=o}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const i=e.length;this.writeVarint(i),this.realloc(i);for(let o=0;o<i;o++)this.buf[this.pos++]=e[o]}writeRawMessage(e,i){this.pos++;const o=this.pos;e(i,this);const u=this.pos-o;u>=128&&kg(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u}writeMessage(e,i,o){this.writeTag(e,2),this.writeRawMessage(i,o)}writePackedVarint(e,i){i.length&&this.writeMessage(e,Lg,i)}writePackedSVarint(e,i){i.length&&this.writeMessage(e,jg,i)}writePackedBoolean(e,i){i.length&&this.writeMessage(e,Bg,i)}writePackedFloat(e,i){i.length&&this.writeMessage(e,Mh,i)}writePackedDouble(e,i){i.length&&this.writeMessage(e,Kf,i)}writePackedFixed32(e,i){i.length&&this.writeMessage(e,Og,i)}writePackedSFixed32(e,i){i.length&&this.writeMessage(e,Fg,i)}writePackedFixed64(e,i){i.length&&this.writeMessage(e,Ng,i)}writePackedSFixed64(e,i){i.length&&this.writeMessage(e,Vg,i)}writeBytesField(e,i){this.writeTag(e,2),this.writeBytes(i)}writeFixed32Field(e,i){this.writeTag(e,5),this.writeFixed32(i)}writeSFixed32Field(e,i){this.writeTag(e,5),this.writeSFixed32(i)}writeFixed64Field(e,i){this.writeTag(e,1),this.writeFixed64(i)}writeSFixed64Field(e,i){this.writeTag(e,1),this.writeSFixed64(i)}writeVarintField(e,i){this.writeTag(e,0),this.writeVarint(i)}writeSVarintField(e,i){this.writeTag(e,0),this.writeSVarint(i)}writeStringField(e,i){this.writeTag(e,2),this.writeString(i)}writeFloatField(e,i){this.writeTag(e,5),this.writeFloat(i)}writeDoubleField(e,i){this.writeTag(e,1),this.writeDouble(i)}writeBooleanField(e,i){this.writeVarintField(e,+i)}}function Sh(n,e,i){return i?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}function kg(n,e,i){const o=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(o);for(let u=i.pos-1;u>=n;u--)i.buf[u+o]=i.buf[u]}function Lg(n,e){for(let i=0;i<n.length;i++)e.writeVarint(n[i])}function jg(n,e){for(let i=0;i<n.length;i++)e.writeSVarint(n[i])}function Mh(n,e){for(let i=0;i<n.length;i++)e.writeFloat(n[i])}function Kf(n,e){for(let i=0;i<n.length;i++)e.writeDouble(n[i])}function Bg(n,e){for(let i=0;i<n.length;i++)e.writeBoolean(n[i])}function Og(n,e){for(let i=0;i<n.length;i++)e.writeFixed32(n[i])}function Fg(n,e){for(let i=0;i<n.length;i++)e.writeSFixed32(n[i])}function Ng(n,e){for(let i=0;i<n.length;i++)e.writeFixed64(n[i])}function Vg(n,e){for(let i=0;i<n.length;i++)e.writeSFixed64(n[i])}function Ug(n,e,i){n===1&&i.readMessage(Qf,e)}function Qf(n,e,i){if(n===3){const{id:o,bitmap:u,width:p,height:m,left:v,top:w,advance:C}=i.readMessage(Gg,{});e.push({id:o,bitmap:new md({width:p+6,height:m+6},u),metrics:{width:p,height:m,left:v,top:w,advance:C}})}}function Gg(n,e,i){n===1?e.id=i.readVarint():n===2?e.bitmap=i.readBytes():n===3?e.width=i.readVarint():n===4?e.height=i.readVarint():n===5?e.left=i.readSVarint():n===6?e.top=i.readSVarint():n===7&&(e.advance=i.readVarint())}function cm(n){let e=0,i=0;for(const m of n)e+=m.w*m.h,i=Math.max(i,m.w);n.sort(((m,v)=>v.h-m.h));const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let u=0,p=0;for(const m of n)for(let v=o.length-1;v>=0;v--){const w=o[v];if(!(m.w>w.w||m.h>w.h)){if(m.x=w.x,m.y=w.y,p=Math.max(p,m.y+m.h),u=Math.max(u,m.x+m.w),m.w===w.w&&m.h===w.h){const C=o.pop();C&&v<o.length&&(o[v]=C)}else m.h===w.h?(w.x+=m.w,w.w-=m.w):m.w===w.w?(w.y+=m.h,w.h-=m.h):(o.push({x:w.x+m.w,y:w.y,w:w.w-m.w,h:m.h}),w.y+=m.h,w.h-=m.h);break}}return{w:u,h:p,fill:e/(u*p)||0}}class Vi{constructor(e,{pixelRatio:i,version:o,stretchX:u,stretchY:p,content:m,textFitWidth:v,textFitHeight:w}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=u,this.stretchY=p,this.content=m,this.version=o,this.textFitWidth=v,this.textFitHeight=w}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Jf{constructor(e,i){const o={},u={};this.haveRenderCallbacks=[];const p=[];this.addImages(e,o,p),this.addImages(i,u,p);const{w:m,h:v}=cm(p),w=new Zr({width:m||1,height:v||1});for(const C in e){const P=e[C],L=o[C].paddedRect;Zr.copy(P.data,w,{x:0,y:0},{x:L.x+1,y:L.y+1},P.data)}for(const C in i){const P=i[C],L=u[C].paddedRect,O=L.x+1,F=L.y+1,q=P.data.width,Z=P.data.height;Zr.copy(P.data,w,{x:0,y:0},{x:O,y:F},P.data),Zr.copy(P.data,w,{x:0,y:Z-1},{x:O,y:F-1},{width:q,height:1}),Zr.copy(P.data,w,{x:0,y:0},{x:O,y:F+Z},{width:q,height:1}),Zr.copy(P.data,w,{x:q-1,y:0},{x:O-1,y:F},{width:1,height:Z}),Zr.copy(P.data,w,{x:0,y:0},{x:O+q,y:F},{width:1,height:Z})}this.image=w,this.iconPositions=o,this.patternPositions=u}addImages(e,i,o){for(const u in e){const p=e[u],m={x:0,y:0,w:p.data.width+2,h:p.data.height+2};o.push(m),i[u]=new Vi(m,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,i){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const o in e.updatedImages)this.patchUpdatedImage(this.iconPositions[o],e.getImage(o),i),this.patchUpdatedImage(this.patternPositions[o],e.getImage(o),i)}patchUpdatedImage(e,i,o){if(!e||!i||e.version===i.version)return;e.version=i.version;const[u,p]=e.tl;o.update(i.data,void 0,{x:u,y:p})}}var yc;function Pd(n,e,i,o,u,p,m,v,w,C,P,L,O,F,q){const Z=Au.fromFeature(n,u);let $;L===M.az.vertical&&Z.verticalizePunctuation();let ee=Z.determineLineBreaks(C,p,e,o,F);const{processBidirectionalText:ue,processStyledBidirectionalText:ie}=za;if(ue&&Z.sections.length===1){$=[],ee=ee.map((je=>Z.toCodeUnitIndex(je)));const _e=ue(Z.toString(),ee);for(const je of _e){const Qe=[...je].map((()=>0));$.push(new Au(je,Z.sections,Qe))}}else if(ie){$=[],ee=ee.map((We=>Z.toCodeUnitIndex(We)));let _e=0;const je=[];for(const We of Z.text)je.push(...Array(We.length).fill(Z.sectionIndex[_e])),_e++;const Qe=ie(Z.text,je,ee);for(const We of Qe){const it=[];let mt="";for(const ut of We[0])it.push(We[1][mt.length]),mt+=ut;$.push(new Au(We[0],Z.sections,it))}}else $=(function(_e,je){const Qe=[];let We=0;for(const it of je)Qe.push(_e.substring(We,it)),We=it;return We<_e.length()&&Qe.push(_e.substring(We,_e.length())),Qe})(Z,ee);const re=[],fe={positionedLines:re,text:Z.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:L,iconsInText:!1,verticalizable:!1};return(function(_e,je,Qe,We,it,mt,ut,Ye,qe,bt,xt,Et){let vt=0,jt=0,bi=0,li=0;const vn=Ye==="right"?1:Ye==="left"?0:.5,Yr=Yn/Et;let cr=0;for(const Ii of it){Ii.trim();const kn=Ii.getMaxScale(),qn={positionedGlyphs:[],lineOffset:0};_e.positionedLines[cr]=qn;const an=qn.positionedGlyphs;let as=0;if(!Ii.length()){jt+=mt,++cr;continue}const Wr=Xy(We,Ii,Yr);let ss=0;for(const Tr of Ii.text){const Cn=Ii.getSection(ss),ur=Tr.codePointAt(0),Ln=ep(qe,xt,ur),Sr={glyph:ur,imageName:null,x:vt,y:jt+-17,vertical:Ln,scale:1,fontStack:"",sectionIndex:Ii.getSectionIndex(ss),metrics:null,rect:null};let Pu;if("fontStack"in Cn){if(Pu=Eh(Cn,ur,Ln,Wr,je,Qe),!Pu)continue;Sr.fontStack=Cn.fontStack}else{if(_e.iconsInText=!0,Cn.scale*=Yr,Pu=hm(Cn,Ln,kn,Wr,We),!Pu)continue;as=Math.max(as,Pu.imageOffset),Sr.imageName=Cn.imageName}const{rect:kl,metrics:Zm,baselineOffset:jh}=Pu;Sr.y+=jh,Sr.scale=Cn.scale,Sr.metrics=Zm,Sr.rect=kl,an.push(Sr),Ln?(_e.verticalizable=!0,vt+=("imageName"in Cn?Zm.advance:Yn)*Cn.scale+bt):vt+=Zm.advance*Cn.scale+bt,ss++}an.length!==0&&(bi=Math.max(vt-bt,bi),tp(an,0,an.length-1,vn)),vt=0,qn.lineOffset=Math.max(as,(kn-1)*Yn);const Uo=mt*kn+as;jt+=Uo,li=Math.max(Uo,li),++cr}const{horizontalAlign:bn,verticalAlign:dn}=um(ut);(function(Ii,kn,qn,an,as,Wr,ss,Uo,Tr){const Cn=(kn-qn)*as;let ur=0;ur=Wr!==ss?-Uo*an- -17:-an*Tr*ss+.5*ss;for(const Ln of Ii)for(const Sr of Ln.positionedGlyphs)Sr.x+=Cn,Sr.y+=ur})(_e.positionedLines,vn,bn,dn,bi,li,mt,jt,it.length),_e.top+=-dn*jt,_e.bottom=_e.top+jt,_e.left+=-bn*bi,_e.right=_e.left+bi})(fe,e,i,o,$,m,v,w,L,C,O,q),!(function(_e){for(const je of _e)if(je.positionedGlyphs.length!==0)return!1;return!0})(re)&&fe}function um(n){let e=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function Xy(n,e,i){const o=e.getMaxScale()*Yn,{maxImageWidth:u,maxImageHeight:p}=e.getMaxImageSize(n),m=Math.max(o,p*i);return{verticalLineContentWidth:Math.max(o,u*i),horizontalLineContentHeight:m}}function qg(n){switch(n){case"top":return 0;case"center":return .5;default:return 1}}function ep(n,e,i){return!(n===M.az.horizontal||!e&&!dl(i)||e&&(cu(i)||(o=i,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(o)))));var o}function Eh(n,e,i,o,u,p){const m=p[n.fontStack],v=(function(C,P,L,O){if(C&&C.rect)return C;const F=P[L.fontStack],q=F&&F[O];return q?{rect:null,metrics:q.metrics}:null})(m&&m[e],u,n,e);if(v===null)return null;let w;if(i)w=o.verticalLineContentWidth-n.scale*Yn;else{const C=qg(n.verticalAlign);w=(o.horizontalLineContentHeight-n.scale*Yn)*C}return{rect:v.rect,metrics:v.metrics,baselineOffset:w}}function hm(n,e,i,o,u){const p=u[n.imageName];if(!p)return null;const m=p.paddedRect,v=p.displaySize,w={width:v[0],height:v[1],left:1,top:-3,advance:e?v[1]:v[0]};let C;if(e)C=o.verticalLineContentWidth-v[1]*n.scale;else{const P=qg(n.verticalAlign);C=(o.horizontalLineContentHeight-v[1]*n.scale)*P}return{rect:m,metrics:w,baselineOffset:C,imageOffset:(e?v[0]:v[1])*n.scale-Yn*i}}function tp(n,e,i,o){if(o===0)return;const u=n[i],p=(n[i].x+u.metrics.advance*u.scale)*o;for(let m=e;m<=i;m++)n[m].x-=p}function dm(n,e,i){const{horizontalAlign:o,verticalAlign:u}=um(i),p=e[0]-n.displaySize[0]*o,m=e[1]-n.displaySize[1]*u;return{image:n,top:m,bottom:m+n.displaySize[1],left:p,right:p+n.displaySize[0]}}function Dl(n){var e,i;let o=n.left,u=n.top,p=n.right-o,m=n.bottom-u;const v=(e=n.image.textFitWidth)!==null&&e!==void 0?e:"stretchOrShrink",w=(i=n.image.textFitHeight)!==null&&i!==void 0?i:"stretchOrShrink",C=(n.image.content[2]-n.image.content[0])/(n.image.content[3]-n.image.content[1]);if(w==="proportional"){if(v==="stretchOnly"&&p/m<C||v==="proportional"){const P=Math.ceil(m*C);o*=P/p,p=P}}else if(v==="proportional"&&w==="stretchOnly"&&C!==0&&p/m>C){const P=Math.ceil(p/C);u*=P/m,m=P}return{x1:o,y1:u,x2:o+p,y2:u+m}}function so(n,e,i,o,u,p){const m=n.image;let v;if(m.content){const $=m.content,ee=m.pixelRatio||1;v=[$[0]/ee,$[1]/ee,m.displaySize[0]-$[2]/ee,m.displaySize[1]-$[3]/ee]}const w=e.left*p,C=e.right*p;let P,L,O,F;i==="width"||i==="both"?(F=u[0]+w-o[3],L=u[0]+C+o[1]):(F=u[0]+(w+C-m.displaySize[0])/2,L=F+m.displaySize[0]);const q=e.top*p,Z=e.bottom*p;return i==="height"||i==="both"?(P=u[1]+q-o[0],O=u[1]+Z+o[2]):(P=u[1]+(q+Z-m.displaySize[1])/2,O=P+m.displaySize[1]),{image:m,top:P,right:L,bottom:O,left:F,collisionPadding:v}}wt("ImagePosition",Vi),wt("ImageAtlas",Jf),M.az=void 0,(yc=M.az||(M.az={}))[yc.none=0]="none",yc[yc.horizontal=1]="horizontal",yc[yc.vertical=2]="vertical",yc[yc.horizontalOnly=3]="horizontalOnly";const ns=128,_c=32640;function fm(n,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new Mi(n+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:u}=i;let p=0;for(;p<o.length&&o[p]<=n;)p++;p=Math.max(0,p-1);let m=p;for(;m<o.length&&o[m]<n+1;)m++;m=Math.min(o.length-1,m);const v=o[p],w=o[m];return i.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:w,interpolationType:u}:{kind:"camera",minZoom:v,maxZoom:w,minSize:i.evaluate(new Mi(v)),maxSize:i.evaluate(new Mi(w)),interpolationType:u}}}function ip(n,e,i){let o="never";const u=n.get(e);return u?o=u:n.get(i)&&(o="always"),o}const Zg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Id(n,e,i,o,u,p,m,v,w,C,P,L,O){const F=v?Math.min(_c,Math.round(v[0])):0,q=v?Math.min(_c,Math.round(v[1])):0;n.emplaceBack(e,i,Math.round(32*o),Math.round(32*u),p,m,(F<<1)+(w?1:0),q,16*C,16*P,256*L,256*O)}function pm(n,e,i){n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i)}function mm(n){for(const e of n.sections)if(Ks(e.text))return!0;return!1}class np{constructor(e){this.layoutVertexArray=new me,this.indexArray=new Oe,this.programConfigurations=e,this.segments=new yt,this.dynamicLayoutVertexArray=new Me,this.opacityVertexArray=new Fe,this.hasVisibleVertices=!1,this.placedSymbolArray=new b}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,i,o,u){this.isEmpty()||(o&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ig.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Cd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Zg,!0),this.opacityVertexBuffer.itemSize=1),(o||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}wt("SymbolBuffers",np);class rp{constructor(e,i,o){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new o,this.segments=new yt,this.collisionVertexArray=new Be}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,sm.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}wt("CollisionBuffers",rp);class Ah{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((m=>m.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=fm(this.zoom,i["text-size"]),this.iconSizeData=fm(this.zoom,i["icon-size"]);const o=this.layers[0].layout,u=o.get("symbol-sort-key"),p=o.get("symbol-z-order");this.canOverlap=ip(o,"text-overlap","text-allow-overlap")!=="never"||ip(o,"icon-overlap","icon-allow-overlap")!=="never"||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&!u.isConstant(),this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,o.get("symbol-placement")==="point"&&(this.writingModes=o.get("text-writing-mode").map((m=>M.az[m]))),this.stateDependentLayerIds=this.layers.filter((m=>m.isStateDependent())).map((m=>m.id)),this.sourceID=e.sourceID}createArrays(){this.text=new np(new ko(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new np(new ko(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new k,this.lineVertexArray=new j,this.symbolInstances=new D,this.textAnchorOffsets=new N}calculateGlyphDependencies(e,i,o,u,p){for(const m of e)if(i[m.codePointAt(0)]=!0,(o||u)&&p){const v=wh[m];v&&(i[v.codePointAt(0)]=!0)}}populate(e,i,o){const u=this.layers[0],p=u.layout,m=p.get("text-font"),v=p.get("text-field"),w=p.get("icon-image"),C=(v.value.kind!=="constant"||v.value.value instanceof Zn&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),P=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,L=p.get("symbol-sort-key");if(this.features=[],!C&&!P)return;const O=i.iconDependencies,F=i.glyphDependencies,q=i.availableImages,Z=new Mi(this.zoom);for(const{feature:$,id:ee,index:ue,sourceLayerIndex:ie}of e){const re=u._featureFilter.needGeometry,fe=ts($,re);if(!u._featureFilter.filter(Z,fe,o))continue;let _e,je;if(re||(fe.geometry=no($)),C){const We=u.getValueAndResolveTokens("text-field",fe,o,q),it=Zn.factory(We),mt=this.hasRTLText=this.hasRTLText||mm(it);(!mt||za.getRTLTextPluginStatus()==="unavailable"||mt&&za.isParsed())&&(_e=Fa(it,u,fe))}if(P){const We=u.getValueAndResolveTokens("icon-image",fe,o,q);je=We instanceof Cr?We:Cr.fromString(We)}if(!_e&&!je)continue;const Qe=this.sortFeaturesByKey?L.evaluate(fe,{},o):void 0;if(this.features.push({id:ee,text:_e,icon:je,index:ue,sourceLayerIndex:ie,geometry:fe.geometry,properties:$.properties,type:xh.types[$.type],sortKey:Qe}),je&&(O[je.name]=!0),_e){const We=m.evaluate(fe,{},o).join(","),it=p.get("text-rotation-alignment")!=="viewport"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(M.az.vertical)>=0;for(const mt of _e.sections)if(mt.image)O[mt.image.name]=!0;else{const ut=Cs(_e.toString()),Ye=mt.fontStack||We,qe=F[Ye]=F[Ye]||{};this.calculateGlyphDependencies(mt.text,qe,it,this.allowVerticalPlacement,ut)}}}p.get("symbol-placement")==="line"&&(this.features=(function($){const ee={},ue={},ie=[];let re=0;function fe(We){ie.push($[We]),re++}function _e(We,it,mt){const ut=ue[We];return delete ue[We],ue[it]=ut,ie[ut].geometry[0].pop(),ie[ut].geometry[0]=ie[ut].geometry[0].concat(mt[0]),ut}function je(We,it,mt){const ut=ee[it];return delete ee[it],ee[We]=ut,ie[ut].geometry[0].shift(),ie[ut].geometry[0]=mt[0].concat(ie[ut].geometry[0]),ut}function Qe(We,it,mt){const ut=mt?it[0][it[0].length-1]:it[0][0];return`${We}:${ut.x}:${ut.y}`}for(let We=0;We<$.length;We++){const it=$[We],mt=it.geometry,ut=it.text?it.text.toString():null;if(!ut){fe(We);continue}const Ye=Qe(ut,mt),qe=Qe(ut,mt,!0);if(Ye in ue&&qe in ee&&ue[Ye]!==ee[qe]){const bt=je(Ye,qe,mt),xt=_e(Ye,qe,ie[bt].geometry);delete ee[Ye],delete ue[qe],ue[Qe(ut,ie[xt].geometry,!0)]=xt,ie[bt].geometry=null}else Ye in ue?_e(Ye,qe,mt):qe in ee?je(Ye,qe,mt):(fe(We),ee[Ye]=re-1,ue[qe]=re-1)}return ie.filter((We=>We.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort((($,ee)=>$.sortKey-ee.sortKey))}update(e,i,o){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,{imagePositions:o}),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,{imagePositions:o}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const o=this.lineVertexArray.length;if(e.segment!==void 0){let u=e.dist(i[e.segment+1]),p=e.dist(i[e.segment]);const m={};for(let v=e.segment+1;v<i.length;v++)m[v]={x:i[v].x,y:i[v].y,tileUnitDistanceFromAnchor:u},v<i.length-1&&(u+=i[v+1].dist(i[v]));for(let v=e.segment||0;v>=0;v--)m[v]={x:i[v].x,y:i[v].y,tileUnitDistanceFromAnchor:p},v>0&&(p+=i[v-1].dist(i[v]));for(let v=0;v<i.length;v++){const w=m[v];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(e,i,o,u,p,m,v,w,C,P,L,O){const F=e.indexArray,q=e.layoutVertexArray,Z=e.segments.prepareSegment(4*i.length,q,F,this.canOverlap?m.sortKey:void 0),$=this.glyphOffsetArray.length,ee=Z.vertexLength,ue=this.allowVerticalPlacement&&v===M.az.vertical?Math.PI/2:0,ie=m.text&&m.text.sections;for(let re=0;re<i.length;re++){const{tl:fe,tr:_e,bl:je,br:Qe,tex:We,pixelOffsetTL:it,pixelOffsetBR:mt,minFontScaleX:ut,minFontScaleY:Ye,glyphOffset:qe,isSDF:bt,sectionIndex:xt}=i[re],Et=Z.vertexLength,vt=qe[1];Id(q,w.x,w.y,fe.x,vt+fe.y,We.x,We.y,o,bt,it.x,it.y,ut,Ye),Id(q,w.x,w.y,_e.x,vt+_e.y,We.x+We.w,We.y,o,bt,mt.x,it.y,ut,Ye),Id(q,w.x,w.y,je.x,vt+je.y,We.x,We.y+We.h,o,bt,it.x,mt.y,ut,Ye),Id(q,w.x,w.y,Qe.x,vt+Qe.y,We.x+We.w,We.y+We.h,o,bt,mt.x,mt.y,ut,Ye),pm(e.dynamicLayoutVertexArray,w,ue),F.emplaceBack(Et,Et+2,Et+1),F.emplaceBack(Et+1,Et+2,Et+3),Z.vertexLength+=4,Z.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(qe[0]),re!==i.length-1&&xt===i[re+1].sectionIndex||e.programConfigurations.populatePaintArrays(q.length,m,m.index,{imagePositions:{},canonical:O,formattedSection:ie&&ie[xt]})}e.placedSymbolArray.emplaceBack(w.x,w.y,$,this.glyphOffsetArray.length-$,ee,C,P,w.segment,o?o[0]:0,o?o[1]:0,u[0],u[1],v,0,!1,0,L)}_addCollisionDebugVertex(e,i,o,u,p,m){return i.emplaceBack(0,0),e.emplaceBack(o.x,o.y,u,p,Math.round(m.x),Math.round(m.y))}addCollisionDebugVertices(e,i,o,u,p,m,v){const w=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),C=w.vertexLength,P=p.layoutVertexArray,L=p.collisionVertexArray,O=v.anchorX,F=v.anchorY;this._addCollisionDebugVertex(P,L,m,O,F,new V(e,i)),this._addCollisionDebugVertex(P,L,m,O,F,new V(o,i)),this._addCollisionDebugVertex(P,L,m,O,F,new V(o,u)),this._addCollisionDebugVertex(P,L,m,O,F,new V(e,u)),w.vertexLength+=4;const q=p.indexArray;q.emplaceBack(C,C+1),q.emplaceBack(C+1,C+2),q.emplaceBack(C+2,C+3),q.emplaceBack(C+3,C),w.primitiveLength+=4}addDebugCollisionBoxes(e,i,o,u){for(let p=e;p<i;p++){const m=this.collisionBoxArray.get(p);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,u?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,o)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new rp(Le,Oa.members,dt),this.iconCollisionBox=new rp(Le,Oa.members,dt);for(let e=0;e<this.symbolInstances.length;e++){const i=this.symbolInstances.get(e);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}}_deserializeCollisionBoxesForSymbol(e,i,o,u,p,m,v,w,C){const P={};for(let L=i;L<o;L++){const O=e.get(L);P.textBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.textFeatureIndex=O.featureIndex;break}for(let L=u;L<p;L++){const O=e.get(L);P.verticalTextBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.verticalTextFeatureIndex=O.featureIndex;break}for(let L=m;L<v;L++){const O=e.get(L);P.iconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.iconFeatureIndex=O.featureIndex;break}for(let L=w;L<C;L++){const O=e.get(L);P.verticalIconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.verticalIconFeatureIndex=O.featureIndex;break}return P}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const o=e.placedSymbolArray.get(i),u=o.vertexStartIndex+4*o.numGlyphs;for(let p=o.vertexStartIndex;p<u;p+=4)e.indexArray.emplaceBack(p,p+2,p+1),e.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),o=Math.cos(e),u=[],p=[],m=[];for(let v=0;v<this.symbolInstances.length;++v){m.push(v);const w=this.symbolInstances.get(v);u.push(0|Math.round(i*w.anchorX+o*w.anchorY)),p.push(w.featureIndex)}return m.sort(((v,w)=>u[v]-u[w]||p[w]-p[v])),m}addToSortKeyRanges(e,i){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===i?o.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const o=this.symbolInstances.get(i);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach(((u,p,m)=>{u>=0&&m.indexOf(u)===p&&this.addIndicesForPlacedSymbol(this.text,u)})),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ap,sp;wt("SymbolBucket",Ah,{omit:["layers","collisionBoxArray","features","compareText"]}),Ah.MAX_GLYPHS=65535,Ah.addDynamicAttributes=pm;var gm={get paint(){return sp=sp||new En({"icon-opacity":new Ct(Te.paint_symbol["icon-opacity"]),"icon-color":new Ct(Te.paint_symbol["icon-color"]),"icon-halo-color":new Ct(Te.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ct(Te.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ct(Te.paint_symbol["icon-halo-blur"]),"icon-translate":new Tt(Te.paint_symbol["icon-translate"]),"icon-translate-anchor":new Tt(Te.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ct(Te.paint_symbol["text-opacity"]),"text-color":new Ct(Te.paint_symbol["text-color"],{runtimeType:ta,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new Ct(Te.paint_symbol["text-halo-color"]),"text-halo-width":new Ct(Te.paint_symbol["text-halo-width"]),"text-halo-blur":new Ct(Te.paint_symbol["text-halo-blur"]),"text-translate":new Tt(Te.paint_symbol["text-translate"]),"text-translate-anchor":new Tt(Te.paint_symbol["text-translate-anchor"])})},get layout(){return ap=ap||new En({"symbol-placement":new Tt(Te.layout_symbol["symbol-placement"]),"symbol-spacing":new Tt(Te.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Tt(Te.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ct(Te.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Tt(Te.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Tt(Te.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Tt(Te.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Tt(Te.layout_symbol["icon-ignore-placement"]),"icon-optional":new Tt(Te.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Tt(Te.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ct(Te.layout_symbol["icon-size"]),"icon-text-fit":new Tt(Te.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Tt(Te.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ct(Te.layout_symbol["icon-image"]),"icon-rotate":new Ct(Te.layout_symbol["icon-rotate"]),"icon-padding":new Ct(Te.layout_symbol["icon-padding"]),"icon-keep-upright":new Tt(Te.layout_symbol["icon-keep-upright"]),"icon-offset":new Ct(Te.layout_symbol["icon-offset"]),"icon-anchor":new Ct(Te.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Tt(Te.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Tt(Te.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Tt(Te.layout_symbol["text-rotation-alignment"]),"text-field":new Ct(Te.layout_symbol["text-field"]),"text-font":new Ct(Te.layout_symbol["text-font"]),"text-size":new Ct(Te.layout_symbol["text-size"]),"text-max-width":new Ct(Te.layout_symbol["text-max-width"]),"text-line-height":new Tt(Te.layout_symbol["text-line-height"]),"text-letter-spacing":new Ct(Te.layout_symbol["text-letter-spacing"]),"text-justify":new Ct(Te.layout_symbol["text-justify"]),"text-radial-offset":new Ct(Te.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Tt(Te.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ct(Te.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ct(Te.layout_symbol["text-anchor"]),"text-max-angle":new Tt(Te.layout_symbol["text-max-angle"]),"text-writing-mode":new Tt(Te.layout_symbol["text-writing-mode"]),"text-rotate":new Ct(Te.layout_symbol["text-rotate"]),"text-padding":new Tt(Te.layout_symbol["text-padding"]),"text-keep-upright":new Tt(Te.layout_symbol["text-keep-upright"]),"text-transform":new Ct(Te.layout_symbol["text-transform"]),"text-offset":new Ct(Te.layout_symbol["text-offset"]),"text-allow-overlap":new Tt(Te.layout_symbol["text-allow-overlap"]),"text-overlap":new Tt(Te.layout_symbol["text-overlap"]),"text-ignore-placement":new Tt(Te.layout_symbol["text-ignore-placement"]),"text-optional":new Tt(Te.layout_symbol["text-optional"])})}};class Hg{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:ci,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}wt("FormatSectionOverride",Hg,{omit:["defaultValue"]});class xc extends un{constructor(e,i){super(e,gm,i)}recalculate(e,i){if(super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const o=this.layout.get("text-writing-mode");if(o){const u=[];for(const p of o)u.indexOf(p)<0&&u.push(p);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,i,o,u){const p=this.layout.get(e).evaluate(i,{},o,u),m=this._unevaluatedLayout._values[e];return m.isDataDriven()||Ao(m.value)||!p?p:(function(v,w){return w.replace(/{([^{}]+)}/g,((C,P)=>v&&P in v?String(v[P]):""))})(i.properties,p)}createBucket(e){return new Ah(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of gm.paint.overridableProperties){if(!xc.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),o=new Hg(i),u=new th(o,i.property.specification);let p=null;p=i.value.kind==="constant"||i.value.kind==="source"?new Rr("source",u):new Co("composite",u,i.value.zoomStops),this.paint._values[e]=new ha(i.property,p,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,o){return!(!this.layout||i.isDataDriven()||o.isDataDriven())&&xc.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const o=e.get("text-field"),u=gm.paint.properties[i];let p=!1;const m=v=>{for(const w of v)if(u.overrides&&u.overrides.hasOverride(w))return void(p=!0)};if(o.value.kind==="constant"&&o.value.value instanceof Zn)m(o.value.value.sections);else if(o.value.kind==="source"||o.value.kind==="composite"){const v=C=>{p||(C instanceof na&&Ji(C.value)===hs?m(C.value.sections):C instanceof Zc?m(C.sections):C.eachChild(v))},w=o.value;w._styleExpression&&v(w._styleExpression.expression)}return p}}let $g;var Xg={get paint(){return $g=$g||new En({"background-color":new Tt(Te.paint_background["background-color"]),"background-pattern":new cc(Te.paint_background["background-pattern"]),"background-opacity":new Tt(Te.paint_background["background-opacity"])})}};class yi extends un{constructor(e,i){super(e,Xg,i)}}class ym extends un{constructor(e,i){super(e,{},i),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class op{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const _m={once:!0},lp=63710088e-1;class No{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new No(hi(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,o=this.lat*i,u=e.lat*i,p=Math.sin(o)*Math.sin(u)+Math.cos(o)*Math.cos(u)*Math.cos((e.lng-this.lng)*i);return lp*Math.acos(Math.min(p,1))}static convert(e){if(e instanceof No)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new No(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new No(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ch=2*Math.PI*lp;function Rd(n){return Ch*Math.cos(n*Math.PI/180)}function Yg(n){return(180+n)/360}function xm(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function Wg(n,e){return n/Rd(e)}function Kg(n){return 360*n-180}function kd(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function vm(n,e){return n*Rd(kd(e))}class zi{constructor(e,i,o=0){this.x=+e,this.y=+i,this.z=+o}static fromLngLat(e,i=0){const o=No.convert(e);return new zi(Yg(o.lng),xm(o.lat),Wg(i,o.lat))}toLngLat(){return new No(Kg(this.x),kd(this.y))}toAltitude(){return vm(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ch*(e=kd(this.y),1/Math.cos(e*Math.PI/180));var e}}function cp(n,e,i){var o=2*Math.PI*6378137/256/Math.pow(2,i);return[n*o-2*Math.PI*6378137/2,e*o-2*Math.PI*6378137/2]}class mr{constructor(e,i,o){if(!(function(u,p,m){return!(u<0||u>25||m<0||m>=Math.pow(2,u)||p<0||p>=Math.pow(2,u))})(e,i,o))throw new Error(`x=${i}, y=${o}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=i,this.y=o,this.key=Dh(0,e,e,i,o)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i,o){const u=(m=this.y,v=this.z,w=cp(256*(p=this.x),256*(m=Math.pow(2,v)-m-1),v),C=cp(256*(p+1),256*(m+1),v),w[0]+","+w[1]+","+C[0]+","+C[1]);var p,m,v,w,C;const P=(function(L,O,F){let q,Z="";for(let $=L;$>0;$--)q=1<<$-1,Z+=(O&q?1:0)+(F&q?2:0);return Z})(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,i>1?"@2x":"").replace(/{quadkey}/g,P).replace(/{bbox-epsg-3857}/g,u)}isChildOf(e){const i=this.z-e.z;return i>0&&e.x===this.x>>i&&e.y===this.y>>i}getTilePoint(e){const i=Math.pow(2,this.z);return new V((e.x*i-this.x)*It,(e.y*i-this.y)*It)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Qg{constructor(e,i){this.wrap=e,this.canonical=i,this.key=Dh(e,i.z,i.z,i.x,i.y)}}class Na{constructor(e,i,o,u,p){if(this.terrainRttPosMatrix32f=null,e<o)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${o}`);this.overscaledZ=e,this.wrap=i,this.canonical=new mr(o,+u,+p),this.key=Dh(i,e,o,u,p)}clone(){return new Na(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-e;return e>this.canonical.z?new Na(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Na(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(e,i){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-e;return e>this.canonical.z?Dh(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y):Dh(this.wrap*+i,e,e,this.canonical.x>>o,this.canonical.y>>o)}isChildOf(e){if(e.wrap!==this.wrap||this.overscaledZ-e.overscaledZ<=0)return!1;if(e.overscaledZ===0)return this.overscaledZ>0;const i=this.canonical.z-e.canonical.z;return!(i<0)&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new Na(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,o=2*this.canonical.x,u=2*this.canonical.y;return[new Na(i,this.wrap,i,o,u),new Na(i,this.wrap,i,o+1,u),new Na(i,this.wrap,i,o,u+1),new Na(i,this.wrap,i,o+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Na(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Na(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Qg(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new zi(e.x-this.wrap,e.y))}}function Dh(n,e,i,o,u){(n*=2)<0&&(n=-1*n-1);const p=1<<i;return(p*p*n+p*u+o).toString(36)+i.toString(36)+e.toString(36)}function Ld(n,e){return e?n.properties[e]:n.id}function bm(n,e){const i={id:n.id};if(e.removeAllProperties&&(delete n.removeProperties,delete n.addOrUpdateProperties,delete e.removeProperties),e.removeProperties)for(const o of e.removeProperties){const u=n.addOrUpdateProperties.findIndex((p=>p.key===o));u>-1&&n.addOrUpdateProperties.splice(u,1)}return(n.removeAllProperties||e.removeAllProperties)&&(i.removeAllProperties=!0),(n.removeProperties||e.removeProperties)&&(i.removeProperties=[...n.removeProperties||[],...e.removeProperties||[]]),(n.addOrUpdateProperties||e.addOrUpdateProperties)&&(i.addOrUpdateProperties=[...n.addOrUpdateProperties||[],...e.addOrUpdateProperties||[]]),(n.newGeometry||e.newGeometry)&&(i.newGeometry=e.newGeometry||n.newGeometry),i}function jd(n){var e,i;if(!n)return{};const o={};return o.removeAll=n.removeAll,o.remove=new Set(n.remove||[]),o.add=new Map((e=n.add)===null||e===void 0?void 0:e.map((u=>[u.id,u]))),o.update=new Map((i=n.update)===null||i===void 0?void 0:i.map((u=>[u.id,u]))),o}wt("CanonicalTileID",mr),wt("OverscaledTileID",Na,{omit:["terrainRttPosMatrix32f"]});class vc{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(e){return this.minX=Math.min(this.minX,e.x),this.minY=Math.min(this.minY,e.y),this.maxX=Math.max(this.maxX,e.x),this.maxY=Math.max(this.maxY,e.y),this}expandBy(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(e){return this.expandBy(-e)}map(e){const i=new vc;return i.extend(e(new V(this.minX,this.minY))),i.extend(e(new V(this.maxX,this.minY))),i.extend(e(new V(this.minX,this.maxY))),i.extend(e(new V(this.maxX,this.maxY))),i}static fromPoints(e){const i=new vc;for(const o of e)i.extend(o);return i}contains(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(e){return!this.empty()&&!e.empty()&&e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY}intersects(e){return!this.empty()&&!e.empty()&&e.minX<=this.maxX&&e.maxX>=this.minX&&e.minY<=this.maxY&&e.maxY>=this.minY}}class wm{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const o=e[i];this._stringToNumber[o]=i,this._numberToString[i]=o}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class up{constructor(e,i,o,u,p){this.type="Feature",this._vectorTileFeature=e,this._x=o,this._y=u,this._z=i,this.properties=e.properties,this.id=p}projectPoint(e,i,o,u){return[360*(e.x+i)/u-180,360/Math.PI*Math.atan(Math.exp((1-2*(e.y+o)/u)*Math.PI))-90]}projectLine(e,i,o,u){return e.map((p=>this.projectPoint(p,i,o,u)))}get geometry(){if(this._geometry)return this._geometry;const e=this._vectorTileFeature,i=e.extent*Math.pow(2,this._z),o=e.extent*this._x,u=e.extent*this._y,p=e.loadGeometry();switch(e.type){case 1:{const m=[];for(const w of p)m.push(w[0]);const v=this.projectLine(m,o,u,i);this._geometry=m.length===1?{type:"Point",coordinates:v[0]}:{type:"MultiPoint",coordinates:v};break}case 2:{const m=p.map((v=>this.projectLine(v,o,u,i)));this._geometry=m.length===1?{type:"LineString",coordinates:m[0]}:{type:"MultiLineString",coordinates:m};break}case 3:{const m=zg(p),v=[];for(const w of m)v.push(w.map((C=>this.projectLine(C,o,u,i))));this._geometry=v.length===1?{type:"Polygon",coordinates:v[0]}:{type:"MultiPolygon",coordinates:v};break}default:throw new Error(`unknown feature type: ${e.type}`)}return this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&i!=="_x"&&i!=="_y"&&i!=="_z"&&(e[i]=this[i]);return e}}class bc{_name;dataBuffer;nullabilityBuffer;_size;constructor(e,i,o){this._name=e,this.dataBuffer=i,typeof o=="number"?this._size=o:(this.nullabilityBuffer=o,this._size=o.size())}getValue(e){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(e)?null:this.getValueFromBuffer(e)}has(e){return this.nullabilityBuffer&&this.nullabilityBuffer.get(e)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class hp extends bc{}class dp extends hp{getValueFromBuffer(e){return this.dataBuffer[e]}}class Tm extends hp{getValueFromBuffer(e){return this.dataBuffer[e]}}class Sm extends bc{delta;constructor(e,i,o,u){super(e,i,u),this.delta=o}}class Mm extends Sm{constructor(e,i,o,u){super(e,Int32Array.of(i),o,u)}getValueFromBuffer(e){return this.dataBuffer[0]+e*this.delta}}class Em extends bc{constructor(e,i,o){super(e,Int32Array.of(i),o)}getValueFromBuffer(e){return this.dataBuffer[0]}}class wc{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(e,i,o,u,p=4096){this._name=e,this._geometryVector=i,this._idVector=o,this._propertyVectors=u,this._extent=p}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(e){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((i=>[i.name,i])))),this.propertyVectorsMap.get(e)}*[Symbol.iterator](){const e=this.geometryVector[Symbol.iterator]();let i=0;for(;i<this.numFeatures;){let o;this.idVector&&(o=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(i)):this.idVector.getValue(i));const u=e?.next().value,p={};for(const m of this.propertyVectors){if(!m)continue;const v=m.name,w=m.getValue(i);w!==null&&(p[v]=w)}i++,yield{id:o,geometry:u,properties:p}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const e=[],i=this.geometryVector.getGeometries();for(let o=0;o<this.numFeatures;o++){let u;this.idVector&&(u=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(o)):this.idVector.getValue(o));const p={coordinates:i[o],type:this.geometryVector.geometryType(o)},m={};for(const v of this.propertyVectors){if(!v)continue;const w=v.name,C=v.getValue(o);C!==null&&(m[w]=C)}e.push({id:u,geometry:p,properties:m})}return e}containsMaxSaveIntegerValues(e){return e instanceof dp||e instanceof Em&&e instanceof Mm||e instanceof Tm}}class Jg{value;constructor(e){this.value=e}get(){return this.value}set(e){this.value=e}increment(){return this.value++}add(e){this.value+=e}}var ai,oo,br,lo,Tc,Hr,Gn,or,rs,ga;function lr(n,e,i){const o=new Int32Array(i);let u=0,p=e.get();for(let m=0;m<o.length;m++){let v=n[p++],w=127&v;v<128||(v=n[p++],w|=(127&v)<<7,v<128||(v=n[p++],w|=(127&v)<<14,v<128||(v=n[p++],w|=(127&v)<<21,v<128||(v=n[p++],w|=(15&v)<<28)))),o[u++]=w}return e.set(p),o}function Bd(n,e,i){const o=new BigInt64Array(i);for(let u=0;u<o.length;u++)o[u]=fp(n,e);return o}function ey(n,e){let i,o;return o=n[e.get()],e.increment(),i=127&o,o<128?i:(o=n[e.get()],e.increment(),i|=(127&o)<<7,o<128?i:(o=n[e.get()],e.increment(),i|=(127&o)<<14,o<128?i:(o=n[e.get()],e.increment(),i|=(127&o)<<21,o<128?i:(o=n[e.get()],i|=(15&o)<<28,(function(u,p,m){let v,w;if(w=p[m.get()],m.increment(),v=(112&w)>>4,w<128||(w=p[m.get()],m.increment(),v|=(127&w)<<3,w<128)||(w=p[m.get()],m.increment(),v|=(127&w)<<10,w<128)||(w=p[m.get()],m.increment(),v|=(127&w)<<17,w<128)||(w=p[m.get()],m.increment(),v|=(127&w)<<24,w<128)||(w=p[m.get()],m.increment(),v|=(1&w)<<31,w<128))return 4294967296*v+(u>>>0);throw new Error("Expected varint not more than 10 bytes")})(i,n,e)))))}function zh(n,e,i,o){throw new Error("FastPFor is not implemented yet.")}function wr(n){return n>>>1^-(1&n)}function Cu(n){return n>>1n^-(1n&n)}function fp(n,e){let i=0n,o=0,u=e.get();for(;u<n.length;){const p=n[u++];if(i|=BigInt(127&p)<<BigInt(o),!(128&p))break;if(o+=7,o>=64)throw new Error("Varint too long")}return e.set(u),i}function Vo(n,e,i){const o=new Int32Array(i);let u=0;for(let p=0;p<e;p++){const m=n[p];o.fill(n[p+e],u,u+m),u+=m}return o}function ty(n,e,i){const o=new BigInt64Array(i);let u=0;for(let p=0;p<e;p++){const m=Number(n[p]);o.fill(n[p+e],u,u+m),u+=m}return o}function iy(n,e,i){const o=new Float64Array(i);let u=0;for(let p=0;p<e;p++){const m=n[p];o.fill(n[p+e],u,u+m),u+=m}return o}function Sc(n){const e=n.length/4*4;let i=1;if(e>=4)for(let o=n[0];i<e-4;i+=4)o=n[i]+=o,o=n[i+1]+=o,o=n[i+2]+=o,o=n[i+3]+=o;for(;i!=n.length;)n[i]+=n[i-1],++i}function Am(n){n[0]=n[0]>>>1^-(1&n[0]),n[1]=n[1]>>>1^-(1&n[1]);const e=n.length/4*4;let i=2;if(e>=4)for(;i<e-4;i+=4){const o=n[i],u=n[i+1],p=n[i+2],m=n[i+3];n[i]=(o>>>1^-(1&o))+n[i-2],n[i+1]=(u>>>1^-(1&u))+n[i-1],n[i+2]=(p>>>1^-(1&p))+n[i],n[i+3]=(m>>>1^-(1&m))+n[i+1]}for(;i!=n.length;i+=2)n[i]=(n[i]>>>1^-(1&n[i]))+n[i-2],n[i+1]=(n[i+1]>>>1^-(1&n[i+1]))+n[i-1]}(function(n){n.NONE="NONE",n.DELTA="DELTA",n.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",n.RLE="RLE",n.MORTON="MORTON",n.PDE="PDE"})(ai||(ai={})),(function(n){n.NONE="NONE",n.FAST_PFOR="FAST_PFOR",n.VARINT="VARINT",n.ALP="ALP"})(oo||(oo={})),(function(n){n.PRESENT="PRESENT",n.DATA="DATA",n.OFFSET="OFFSET",n.LENGTH="LENGTH"})(br||(br={}));class Cm{_dictionaryType;_offsetType;_lengthType;constructor(e,i,o){this._dictionaryType=e,this._offsetType=i,this._lengthType=o}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function $r(n,e){const i=(function(o,u){const p=o[u.get()],m=Object.values(br)[p>>4];let v=null;switch(m){case br.DATA:v=new Cm(Object.values(lo)[15&p]);break;case br.OFFSET:v=new Cm(null,Object.values(Tc)[15&p]);break;case br.LENGTH:v=new Cm(null,null,Object.values(Hr)[15&p])}u.increment();const w=o[u.get()],C=Object.values(ai)[w>>5],P=Object.values(ai)[w>>2&7],L=Object.values(oo)[3&w];u.increment();const O=lr(o,u,2),F=O[0];return{physicalStreamType:m,logicalStreamType:v,logicalLevelTechnique1:C,logicalLevelTechnique2:P,physicalLevelTechnique:L,numValues:F,byteLength:O[1],decompressedCount:F}})(n,e);return i.logicalLevelTechnique1===ai.MORTON?(function(o,u,p){const m=lr(u,p,2);return{physicalStreamType:o.physicalStreamType,logicalStreamType:o.logicalStreamType,logicalLevelTechnique1:o.logicalLevelTechnique1,logicalLevelTechnique2:o.logicalLevelTechnique2,physicalLevelTechnique:o.physicalLevelTechnique,numValues:o.numValues,byteLength:o.byteLength,decompressedCount:o.decompressedCount,numBits:m[0],coordinateShift:m[1]}})(i,n,e):ai.RLE!==i.logicalLevelTechnique1&&ai.RLE!==i.logicalLevelTechnique2||oo.NONE===i.physicalLevelTechnique?i:(function(o,u,p){const m=lr(u,p,2);return{physicalStreamType:o.physicalStreamType,logicalStreamType:o.logicalStreamType,logicalLevelTechnique1:o.logicalLevelTechnique1,logicalLevelTechnique2:o.logicalLevelTechnique2,physicalLevelTechnique:o.physicalLevelTechnique,numValues:o.numValues,byteLength:o.byteLength,decompressedCount:m[1],runs:m[0],numRleValues:m[1]}})(i,n,e)}(function(n){n.NONE="NONE",n.SINGLE="SINGLE",n.SHARED="SHARED",n.VERTEX="VERTEX",n.MORTON="MORTON",n.FSST="FSST"})(lo||(lo={})),(function(n){n.VERTEX="VERTEX",n.INDEX="INDEX",n.STRING="STRING",n.KEY="KEY"})(Tc||(Tc={})),(function(n){n.VAR_BINARY="VAR_BINARY",n.GEOMETRIES="GEOMETRIES",n.PARTS="PARTS",n.RINGS="RINGS",n.TRIANGLES="TRIANGLES",n.SYMBOL="SYMBOL",n.DICTIONARY="DICTIONARY"})(Hr||(Hr={})),(function(n){n[n.FLAT=0]="FLAT",n[n.CONST=1]="CONST",n[n.SEQUENCE=2]="SEQUENCE",n[n.DICTIONARY=3]="DICTIONARY",n[n.FSST_DICTIONARY=4]="FSST_DICTIONARY"})(Gn||(Gn={}));class co{values;_size;constructor(e,i){this.values=e,this._size=i}get(e){const i=Math.floor(e/8);return(this.values[i]>>e%8&1)==1}set(e,i){const o=Math.floor(e/8);this.values[o]=this.values[o]|(i?1:0)<<e%8}getInt(e){const i=Math.floor(e/8);return this.values[i]>>e%8&1}size(){return this._size}getBuffer(){return this.values}}function Xr(n,e,i,o,u){return(function(p,m,v){switch(m.logicalLevelTechnique1){case ai.DELTA:return m.logicalLevelTechnique2===ai.RLE?(function(w,C,P){const L=new Int32Array(P);let O=0,F=0;for(let q=0;q<C;q++){const Z=w[q],$=wr(w[q+C]);for(let ee=0;ee<Z;ee++)F+=$,L[O++]=F}return L})(p,m.runs,m.numRleValues):((function(w){w[0]=w[0]>>>1^-(1&w[0]);const C=w.length/4*4;let P=1;if(C>=4)for(;P<C-4;P+=4){const L=w[P],O=w[P+1],F=w[P+2],q=w[P+3];w[P]=(L>>>1^-(1&L))+w[P-1],w[P+1]=(O>>>1^-(1&O))+w[P],w[P+2]=(F>>>1^-(1&F))+w[P+1],w[P+3]=(q>>>1^-(1&q))+w[P+2]}for(;P!=w.length;++P)w[P]=(w[P]>>>1^-(1&w[P]))+w[P-1]})(p),p);case ai.RLE:return(function(w,C,P){return P?(function(L,O,F){const q=new Int32Array(F);let Z=0;for(let $=0;$<O;$++){const ee=L[$];let ue=L[$+O];ue=ue>>>1^-(1&ue),q.fill(ue,Z,Z+ee),Z+=ee}return q})(w,C.runs,C.numRleValues):Vo(w,C.runs,C.numRleValues)})(p,m,v);case ai.MORTON:return Sc(p),p;case ai.COMPONENTWISE_DELTA:return Am(p),p;case ai.NONE:return v&&(function(w){for(let C=0;C<w.length;C++){const P=w[C];w[C]=P>>>1^-(1&P)}})(p),p;default:throw new Error(`The specified Logical level technique is not supported: ${m.logicalLevelTechnique1}`)}})(pp(n,e,i),i,o)}function Mc(n,e,i){return(function(o,u){if(u.logicalLevelTechnique1===ai.DELTA&&u.logicalLevelTechnique2===ai.NONE)return(function(m){const v=new Int32Array(m.length+1);v[0]=0,v[1]=wr(m[0]);let w=v[1],C=2;for(;C!=v.length;++C){const P=m[C-1];w+=P>>>1^-(1&P),v[C]=v[C-1]+w}return v})(o);if(u.logicalLevelTechnique1===ai.RLE&&u.logicalLevelTechnique2===ai.NONE)return(function(m,v,w){const C=new Int32Array(w+1);C[0]=0;let P=1,L=C[0];for(let O=0;O<v;O++){const F=m[O],q=m[O+v];for(let Z=P;Z<P+F;Z++)C[Z]=q+L,L=C[Z];P+=F}return C})(o,u.runs,u.numRleValues);if(u.logicalLevelTechnique1===ai.NONE&&u.logicalLevelTechnique2===ai.NONE){(function(m){let v=0;for(let w=0;w<m.length;w++)m[w]+=v,v=m[w]})(o);const p=new Int32Array(u.numValues+1);return p[0]=0,p.set(o,1),p}if(u.logicalLevelTechnique1===ai.DELTA&&u.logicalLevelTechnique2===ai.RLE){const p=(function(m,v,w){const C=new Int32Array(w+1);C[0]=0;let P=1,L=C[0];for(let O=0;O<v;O++){const F=m[O];let q=m[O+v];q=q>>>1^-(1&q);for(let Z=P;Z<P+F;Z++)C[Z]=q+L,L=C[Z];P+=F}return C})(o,u.runs,u.numRleValues);return Sc(p),p}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")})(pp(n,e,i),i)}function pp(n,e,i){const o=i.physicalLevelTechnique;if(o===oo.FAST_PFOR)return zh();if(o===oo.VARINT)return lr(n,e,i.numValues);if(o===oo.NONE){const u=e.get();e.add(i.byteLength);const p=n.subarray(u,e.get());return new Int32Array(p)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function Dm(n,e,i,o){const u=pp(n,e,i);if(u.length===1){const p=u[0];return o?wr(p):p}return o?(function(p){return wr(p[1])})(u):(function(p){return p[1]})(u)}function zm(n,e,i){return(function(o){if(o.length==2){const u=wr(o[1]);return[u,u]}return[wr(o[2]),wr(o[3])]})(pp(n,e,i))}function Du(n,e,i){return(function(o){if(o.length==2){const u=Cu(o[1]);return[u,u]}return[Cu(o[2]),Cu(o[3])]})(Bd(n,e,i.numValues))}function Ph(n,e,i,o){return(function(u,p,m){switch(p.logicalLevelTechnique1){case ai.DELTA:return p.logicalLevelTechnique2===ai.RLE?(function(v,w,C){const P=new BigInt64Array(C);let L=0,O=0n;for(let F=0;F<w;F++){const q=Number(v[F]),Z=Cu(v[F+w]);for(let $=0;$<q;$++)O+=Z,P[L++]=O}return P})(u,p.runs,p.numRleValues):((function(v){v[0]=v[0]>>1n^-(1n&v[0]);const w=v.length/4*4;let C=1;if(w>=4)for(;C<w-4;C+=4){const P=v[C],L=v[C+1],O=v[C+2],F=v[C+3];v[C]=(P>>1n^-(1n&P))+v[C-1],v[C+1]=(L>>1n^-(1n&L))+v[C],v[C+2]=(O>>1n^-(1n&O))+v[C+1],v[C+3]=(F>>1n^-(1n&F))+v[C+2]}for(;C!=v.length;++C)v[C]=(v[C]>>1n^-(1n&v[C]))+v[C-1]})(u),u);case ai.RLE:return(function(v,w,C){return C?(function(P,L,O){const F=new BigInt64Array(O);let q=0;for(let Z=0;Z<L;Z++){const $=Number(P[Z]);let ee=P[Z+L];ee=ee>>1n^-(1n&ee),F.fill(ee,q,q+$),q+=$}return F})(v,w.runs,w.numRleValues):ty(v,w.runs,w.numRleValues)})(u,p,m);case ai.NONE:return m&&(function(v){for(let w=0;w<v.length;w++){const C=v[w];v[w]=C>>1n^-(1n&C)}})(u),u;default:throw new Error(`The specified Logical level technique is not supported: ${p.logicalLevelTechnique1}`)}})(Bd(n,e,i.numValues),i,o)}function Pm(n,e,i,o){const u=Bd(n,e,i.numValues);if(u.length===1){const p=u[0];return o?Cu(p):p}return o?(function(p){return Cu(p[1])})(u):(function(p){return p[1]})(u)}function Im(n,e,i,o,u){return(function(p,m,v,w){switch(m.logicalLevelTechnique1){case ai.DELTA:return m.logicalLevelTechnique2===ai.RLE&&(p=Vo(p,m.runs,m.numRleValues)),(function(C,P){const L=new Int32Array(C.size());let O=0;C.get(0)?(L[0]=C.get(0)?P[0]>>>1^-(1&P[0]):0,O=1):L[0]=0;let F=1;for(;F!=L.length;++F)L[F]=C.get(F)?L[F-1]+(P[O]>>>1^-(1&P[O++])):L[F-1];return L})(w,p);case ai.RLE:return(function(C,P,L,O){const F=P;return L?(function(q,Z,$){const ee=new Int32Array(q.size());let ue=0;for(let ie=0;ie<$;ie++){const re=Z[ie];let fe=Z[ie+$];fe=fe>>>1^-(1&fe);for(let _e=ue;_e<ue+re;_e++)q.get(_e)?ee[_e]=fe:(ee[_e]=0,ue++);ue+=re}return ee})(O,C,F.runs):(function(q,Z,$){const ee=new Int32Array(q.size());let ue=0;for(let ie=0;ie<$;ie++){const re=Z[ie],fe=Z[ie+$];for(let _e=ue;_e<ue+re;_e++)q.get(_e)?ee[_e]=fe:(ee[_e]=0,ue++);ue+=re}return ee})(O,C,F.runs)})(p,m,v,w);case ai.MORTON:return Sc(p),p;case ai.COMPONENTWISE_DELTA:return Am(p),p;case ai.NONE:return p=v?(function(C,P){const L=new Int32Array(C.size());let O=0,F=0;for(;F!=L.length;++F)if(C.get(F)){const q=P[O++];L[F]=q>>>1^-(1&q)}else L[F]=0;return L})(w,p):(function(C,P){const L=new Int32Array(C.size());let O=0,F=0;for(;F!=L.length;++F)L[F]=C.get(F)?P[O++]:0;return L})(w,p),p;default:throw new Error("The specified Logical level technique is not supported")}})(i.physicalLevelTechnique===oo.FAST_PFOR?zh():lr(n,e,i.numValues),i,o,u)}function zl(n,e,i,o){const u=n.logicalLevelTechnique1;if(u===ai.RLE)return n.runs===1?Gn.CONST:Gn.FLAT;const p=e instanceof co?e.size():e;if(u===ai.DELTA&&n.logicalLevelTechnique2===ai.RLE){const m=n.runs,v=2;if(n.numRleValues!==p)return Gn.FLAT;if(m===1)return Gn.SEQUENCE;if(m===2){const w=o.get();let C;if(n.physicalLevelTechnique===oo.VARINT)C=lr(i,o,4);else{const P=o.get();C=new Int32Array(i.buffer,i.byteOffset+P,4)}if(o.set(w),C[2]===v&&C[3]===v)return Gn.SEQUENCE}}return n.numValues===1?Gn.CONST:Gn.FLAT}class Ih extends hp{getValueFromBuffer(e){return this.dataBuffer[e]}}class Rm extends Sm{constructor(e,i,o,u){super(e,BigInt64Array.of(i),o,u)}getValueFromBuffer(e){return this.dataBuffer[0]+BigInt(e)*this.delta}}class Pl{_geometryOffsets;_partOffsets;_ringOffsets;constructor(e,i,o){this._geometryOffsets=e,this._partOffsets=i,this._ringOffsets=o}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function Od(n,e,i){return{x:mp(n,e)-i,y:mp(n>>1,e)-i}}function mp(n,e){let i=0;for(let o=0;o<e;o++)i|=(n&1<<2*o)>>o;return i}(function(n){n[n.POINT=0]="POINT",n[n.LINESTRING=1]="LINESTRING",n[n.POLYGON=2]="POLYGON",n[n.MULTIPOINT=3]="MULTIPOINT",n[n.MULTILINESTRING=4]="MULTILINESTRING",n[n.MULTIPOLYGON=5]="MULTIPOLYGON"})(or||(or={})),(function(n){n[n.POINT=0]="POINT",n[n.LINESTRING=1]="LINESTRING",n[n.POLYGON=2]="POLYGON"})(rs||(rs={})),(function(n){n[n.MORTON=0]="MORTON",n[n.VEC_2=1]="VEC_2",n[n.VEC_3=2]="VEC_3"})(ga||(ga={}));class gp{createPoint(e){return[[e]]}createMultiPoint(e){return e.map((i=>[i]))}createLineString(e){return[e]}createMultiLineString(e){return e}createPolygon(e,i){return[e].concat(i)}createMultiPolygon(e){return e.flat()}}function km(n){const e=new Array(n.numGeometries);let i=1,o=1,u=1,p=0;const m=new gp;let v=0,w=0;const C=n.mortonSettings,P=n.topologyVector,L=P.geometryOffsets,O=P.partOffsets,F=P.ringOffsets,q=n.vertexOffsets,Z=n.containsPolygonGeometry(),$=n.vertexBuffer;for(let ee=0;ee<n.numGeometries;ee++){const ue=n.geometryType(ee);if(ue===or.POINT){if(q&&q.length!==0)if(n.vertexBufferType===ga.VEC_2){const ie=2*q[w++],re=new V($[ie],$[ie+1]);e[p++]=m.createPoint(re)}else{const ie=Od($[q[w++]],C.numBits,C.coordinateShift),re=new V(ie.x,ie.y);e[p++]=m.createPoint(re)}else{const ie=new V($[v++],$[v++]);e[p++]=m.createPoint(ie)}L&&u++,O&&i++,F&&o++}else if(ue===or.MULTIPOINT){const ie=L[u]-L[u-1];u++;const re=new Array(ie);if(q&&q.length!==0){for(let fe=0;fe<ie;fe++){const _e=2*q[w++];re[fe]=new V($[_e],$[_e+1])}e[p++]=m.createMultiPoint(re)}else{for(let fe=0;fe<ie;fe++){const _e=$[v++],je=$[v++];re[fe]=new V(_e,je)}e[p++]=m.createMultiPoint(re)}}else if(ue===or.LINESTRING){let ie,re=0;Z?(re=F[o]-F[o-1],o++):re=O[i]-O[i-1],i++,q&&q.length!==0?(ie=n.vertexBufferType===ga.VEC_2?Vd($,q,w,re,!1):jm($,q,w,re,!1,C),w+=re):(ie=Lm($,v,re,!1),v+=2*re),e[p++]=m.createLineString(ie),L&&u++}else if(ue===or.POLYGON){const ie=O[i]-O[i-1];i++;const re=new Array(ie-1);let fe=F[o]-F[o-1];if(o++,q&&q.length!==0){const _e=n.vertexBufferType===ga.VEC_2?yp($,q,w,fe):Nd($,q,w,fe,0,C);w+=fe;for(let je=0;je<re.length;je++)fe=F[o]-F[o-1],o++,re[je]=n.vertexBufferType===ga.VEC_2?yp($,q,w,fe):Nd($,q,w,fe,0,C),w+=fe;e[p++]=m.createPolygon(_e,re)}else{const _e=Fd($,v,fe);v+=2*fe;for(let je=0;je<re.length;je++)fe=F[o]-F[o-1],o++,re[je]=Fd($,v,fe),v+=2*fe;e[p++]=m.createPolygon(_e,re)}L&&u++}else if(ue===or.MULTILINESTRING){const ie=L[u]-L[u-1];u++;const re=new Array(ie);if(q&&q.length!==0){for(let fe=0;fe<ie;fe++){let _e=0;Z?(_e=F[o]-F[o-1],o++):_e=O[i]-O[i-1],i++;const je=n.vertexBufferType===ga.VEC_2?Vd($,q,w,_e,!1):jm($,q,w,_e,!1,C);re[fe]=je,w+=_e}e[p++]=m.createMultiLineString(re)}else{for(let fe=0;fe<ie;fe++){let _e=0;Z?(_e=F[o]-F[o-1],o++):_e=O[i]-O[i-1],i++,re[fe]=Lm($,v,_e,!1),v+=2*_e}e[p++]=m.createMultiLineString(re)}}else{if(ue!==or.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const ie=L[u]-L[u-1];u++;const re=new Array(ie);let fe=0;if(q&&q.length!==0){for(let _e=0;_e<ie;_e++){const je=O[i]-O[i-1];i++;const Qe=new Array(je-1);fe=F[o]-F[o-1],o++;const We=n.vertexBufferType===ga.VEC_2?yp($,q,w,fe):Nd($,q,w,fe,0,C);w+=fe;for(let it=0;it<Qe.length;it++)fe=F[o]-F[o-1],o++,Qe[it]=n.vertexBufferType===ga.VEC_2?yp($,q,w,fe):Nd($,q,w,fe,0,C),w+=fe;re[_e]=m.createPolygon(We,Qe)}e[p++]=m.createMultiPolygon(re)}else{for(let _e=0;_e<ie;_e++){const je=O[i]-O[i-1];i++;const Qe=new Array(je-1);fe=F[o]-F[o-1],o++;const We=Fd($,v,fe);v+=2*fe;for(let it=0;it<Qe.length;it++){const mt=F[o]-F[o-1];o++,Qe[it]=Fd($,v,mt),v+=2*mt}re[_e]=m.createPolygon(We,Qe)}e[p++]=m.createMultiPolygon(re)}}}}return e}function Fd(n,e,i){return Lm(n,e,i,!0)}function yp(n,e,i,o){return Vd(n,e,i,o,!0)}function Nd(n,e,i,o,u,p){return jm(n,e,i,o,!0,p)}function Lm(n,e,i,o){const u=new Array(o?i+1:i);for(let p=0;p<2*i;p+=2)u[p/2]=new V(n[e+p],n[e+p+1]);return o&&(u[u.length-1]=u[0]),u}function Vd(n,e,i,o,u){const p=new Array(u?o+1:o);for(let m=0;m<2*o;m+=2){const v=2*e[i+m/2];p[m/2]=new V(n[v],n[v+1])}return u&&(p[p.length-1]=p[0]),p}function jm(n,e,i,o,u,p){const m=new Array(u?o+1:o);for(let v=0;v<o;v++){const w=Od(n[e[i+v]],p.numBits,p.coordinateShift);m[v]=new V(w.x,w.y)}return u&&(m[m.length-1]=m[0]),m}class Ud{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(e,i,o,u,p){this._vertexBufferType=e,this._topologyVector=i,this._vertexOffsets=o,this._vertexBuffer=u,this._mortonSettings=p}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const e=km(this);let i=0;for(;i<this.numGeometries;)yield{coordinates:e[i],type:this.geometryType(i)},i++}getSimpleEncodedVertex(e){const i=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[i],this.vertexBuffer[i+1]]}getVertex(e){if(this.vertexOffsets&&this.mortonSettings){const o=Od(this.vertexBuffer[this.vertexOffsets[e]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[o.x,o.y]}const i=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[i],this.vertexBuffer[i+1]]}getGeometries(){return km(this)}get mortonSettings(){return this._mortonSettings}}class Gd extends Ud{_numGeometries;_geometryType;constructor(e,i,o,u,p,m,v){super(o,u,p,m,v),this._numGeometries=e,this._geometryType=i}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===or.POLYGON||this._geometryType===or.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class qd extends Ud{_geometryTypes;constructor(e,i,o,u,p,m){super(e,o,u,p,m),this._geometryTypes=i}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let e=0;e<this.numGeometries;e++)if(this.geometryType(e)===or.POLYGON||this.geometryType(e)===or.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class ny{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(e,i,o,u){this._triangleOffsets=e,this._indexBuffer=i,this._vertexBuffer=o,this._topologyVector=u}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const e=new Array(this.numGeometries),i=this._topologyVector,o=i.partOffsets,u=i.ringOffsets,p=i.geometryOffsets;let m=0,v=1,w=1,C=1;for(let P=0;P<this.numGeometries;P++)switch(this.geometryType(P)){case or.POLYGON:{const L=o[v]-o[v-1];v++;const O=[];for(let F=0;F<L;F++){const q=u[w]-u[w-1];w++;const Z=[];for(let $=0;$<q;$++){const ee=this._vertexBuffer[m++],ue=this._vertexBuffer[m++];Z.push(new V(ee,ue))}Z.length>0&&Z.push(Z[0]),O.push(Z)}e[P]=O,p&&C++}break;case or.MULTIPOLYGON:{const L=p[C]-p[C-1];C++;const O=[];for(let F=0;F<L;F++){const q=o[v]-o[v-1];v++;for(let Z=0;Z<q;Z++){const $=u[w]-u[w-1];w++;const ee=[];for(let ue=0;ue<$;ue++){const ie=this._vertexBuffer[m++],re=this._vertexBuffer[m++];ee.push(new V(ie,re))}ee.length>0&&ee.push(ee[0]),O.push(ee)}}e[P]=O}}return e}[Symbol.iterator](){return null}}function Rh(n,e,i,o,u,p){return new Yy(n,e,i,o,u,p)}class Yy extends ny{_numGeometries;_geometryType;constructor(e,i,o,u,p,m){super(o,u,p,m),this._numGeometries=e,this._geometryType=i}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function Bm(n,e,i,o,u){return new ry(n,e,i,o,u)}class ry extends ny{_geometryTypes;constructor(e,i,o,u,p){super(i,o,u,p),this._geometryTypes=e}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function ay(n,e,i,o,u){const p=$r(n,i);let m=null,v=null,w=null,C=null,P=null,L=null,O=null,F=null;if(zl(p,o,n,i)===Gn.CONST){const Z=Dm(n,i,p,!1);for(let $=0;$<e-1;$++){const ee=$r(n,i);switch(ee.physicalStreamType){case br.LENGTH:switch(ee.logicalStreamType.lengthType){case Hr.GEOMETRIES:m=Mc(n,i,ee);break;case Hr.PARTS:v=Mc(n,i,ee);break;case Hr.RINGS:w=Mc(n,i,ee);break;case Hr.TRIANGLES:O=Mc(n,i,ee)}break;case br.OFFSET:switch(ee.logicalStreamType.offsetType){case Tc.VERTEX:C=Xr(n,i,ee,!1);break;case Tc.INDEX:F=Xr(n,i,ee,!1)}break;case br.DATA:lo.VERTEX===ee.logicalStreamType.dictionaryType?P=Xr(n,i,ee,!0):(L={numBits:ee.numBits,coordinateShift:ee.coordinateShift},P=Xr(n,i,ee,!1))}}return F!==null?m!=null||v!=null?Rh(o,Z,O,F,P,new Pl(m,v,w)):Rh(o,Z,O,F,P):L===null?(function($,ee,ue,ie,re){return new Gd($,ee,ga.VEC_2,ue,ie,re)})(o,Z,new Pl(m,v,w),C,P):(function($,ee,ue,ie,re,fe){return new Gd($,ee,ga.MORTON,ue,ie,re,fe)})(o,Z,new Pl(m,v,w),C,P,L)}const q=Xr(n,i,p,!1);for(let Z=0;Z<e-1;Z++){const $=$r(n,i);switch($.physicalStreamType){case br.LENGTH:switch($.logicalStreamType.lengthType){case Hr.GEOMETRIES:m=Xr(n,i,$,!1);break;case Hr.PARTS:v=Xr(n,i,$,!1);break;case Hr.RINGS:w=Xr(n,i,$,!1);break;case Hr.TRIANGLES:O=Mc(n,i,$)}break;case br.OFFSET:switch($.logicalStreamType.offsetType){case Tc.VERTEX:C=Xr(n,i,$,!1);break;case Tc.INDEX:F=Xr(n,i,$,!1)}break;case br.DATA:lo.VERTEX===$.logicalStreamType.dictionaryType?P=Xr(n,i,$,!0):(L={numBits:$.numBits,coordinateShift:$.coordinateShift},P=Xr(n,i,$,!1))}}return F!==null&&v===null?Bm(q,O,F,P):(m!==null?(m=_p(q,m,2),v!==null&&w!==null?(v=xp(q,m,v,!1),w=(function(Z,$,ee,ue){const ie=new Int32Array(ee[ee.length-1]+1);let re=0;ie[0]=re;let fe=1,_e=1,je=0;for(let Qe=0;Qe<Z.length;Qe++){const We=Z[Qe],it=$[Qe+1]-$[Qe];if(We!==0&&We!==3)for(let mt=0;mt<it;mt++){const ut=ee[fe]-ee[fe-1];fe++;for(let Ye=0;Ye<ut;Ye++)re=ie[_e++]=re+ue[je++]}else for(let mt=0;mt<it;mt++)ie[_e++]=++re,fe++}return ie})(q,m,v,w)):v!==null&&(v=(function(Z,$,ee){const ue=new Int32Array($[$.length-1]+1);let ie=0;ue[0]=ie;let re=1,fe=0;for(let _e=0;_e<Z.length;_e++){const je=Z[_e],Qe=$[_e+1]-$[_e];if(je===4||je===1)for(let We=0;We<Qe;We++)ie=ue[re++]=ie+ee[fe++];else for(let We=0;We<Qe;We++)ue[re++]=++ie}return ue})(q,m,v))):v!==null&&w!==null?(v=_p(q,v,1),w=xp(q,v,w,!0)):v!==null&&(v=_p(q,v,0)),F!==null?Bm(q,O,F,P,new Pl(m,v,w)):L===null?(function(Z,$,ee,ue){return new qd(ga.VEC_2,Z,$,ee,ue)})(q,new Pl(m,v,w),C,P):(function(Z,$,ee,ue,ie){return new qd(ga.MORTON,Z,$,ee,ue,ie)})(q,new Pl(m,v,w),C,P,L))}function _p(n,e,i){const o=new Int32Array(n.length+1);let u=0;o[0]=u;let p=0;for(let m=0;m<n.length;m++)u=o[m+1]=u+(n[m]>i?e[p++]:1);return o}function xp(n,e,i,o){const u=new Int32Array(e[e.length-1]+1);let p=0;u[0]=p;let m=1,v=0;for(let w=0;w<n.length;w++){const C=n[w],P=e[w+1]-e[w];if(C===5||C===2||o&&(C===4||C===1))for(let L=0;L<P;L++)p=u[m++]=p+i[v++];else for(let L=0;L<P;L++)u[m++]=++p}return u}class sy extends bc{dataVector;constructor(e,i,o){super(e,i.getBuffer(),o),this.dataVector=i}getValueFromBuffer(e){return this.dataVector.get(e)}}class oy extends hp{getValueFromBuffer(e){return this.dataBuffer[e]}}class Zd extends bc{constructor(e,i,o){super(e,BigInt64Array.of(i),o)}getValueFromBuffer(e){return this.dataBuffer[0]}}function Hd(n,e,i){return ly(n,Math.ceil(e/8),i)}function ly(n,e,i){const o=new Uint8Array(e);let u=0;for(;u<e;){const p=n[i.increment()];if(p<=127){const m=p+3,v=n[i.increment()],w=u+m;o.fill(v,u,w),u=w}else{const m=256-p;for(let v=0;v<m;v++)o[u++]=n[i.increment()]}}return o}const Om=new TextDecoder;function $d(n,e,i){return i-e>=12?Om.decode(n.subarray(e,i)):(function(o,u,p){let m="",v=u;for(;v<p;){const w=o[v];let C,P,L,O=null,F=w>239?4:w>223?3:w>191?2:1;if(v+F>p)break;F===1?w<128&&(O=w):F===2?(C=o[v+1],(192&C)==128&&(O=(31&w)<<6|63&C,O<=127&&(O=null))):F===3?(C=o[v+1],P=o[v+2],(192&C)==128&&(192&P)==128&&(O=(15&w)<<12|(63&C)<<6|63&P,(O<=2047||O>=55296&&O<=57343)&&(O=null))):F===4&&(C=o[v+1],P=o[v+2],L=o[v+3],(192&C)==128&&(192&P)==128&&(192&L)==128&&(O=(15&w)<<18|(63&C)<<12|(63&P)<<6|63&L,(O<=65535||O>=1114112)&&(O=null))),O===null?(O=65533,F=1):O>65535&&(O-=65536,m+=String.fromCharCode(O>>>10&1023|55296),O=56320|1023&O),m+=String.fromCharCode(O),v+=F}return m})(n,e,i)}class kh extends bc{offsetBuffer;constructor(e,i,o,u){super(e,o,u),this.offsetBuffer=i}}class vp extends kh{textEncoder;constructor(e,i,o,u){super(e,i,o,u??i.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(e){return $d(this.dataBuffer,this.offsetBuffer[e],this.offsetBuffer[e+1])}}class zu extends kh{indexBuffer;textEncoder;constructor(e,i,o,u,p){super(e,o,u,p??i.length),this.indexBuffer=i,this.indexBuffer=i,this.textEncoder=new TextEncoder}getValueFromBuffer(e){const i=this.indexBuffer[e];return $d(this.dataBuffer,this.offsetBuffer[i],this.offsetBuffer[i+1])}}class bp extends kh{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(e,i,o,u,p,m,v){super(e,o,u,v),this.indexBuffer=i,this.symbolOffsetBuffer=p,this.symbolTableBuffer=m,this.textEncoder=new TextEncoder}getValueFromBuffer(e){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(o,u,p){const m=[],v=new Array(u.length).fill(0);for(let w=1;w<u.length;w++)v[w]=v[w-1]+u[w-1];for(let w=0;w<p.length;w++)if(p[w]===255)m.push(p[++w]);else{const C=u[p[w]],P=v[p[w]];for(let L=0;L<C;L++)m.push(o[P+L])}return new Uint8Array(m)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const i=this.indexBuffer[e];return $d(this.decodedDictionary,this.offsetBuffer[i],this.offsetBuffer[i+1])}offsetToLengthBuffer(e){const i=new Uint32Array(e.length-1);let o=e[0];for(let u=1;u<e.length;u++){const p=e[u];i[u-1]=p-o,o=p}return i}}function Ec(n,e,i,o,u,p){return i.type==="scalarType"?(function(m,v,w,C,P,L){let O=null,F=0;if(m===0)return null;if(L.nullable){const Z=$r(v,w);F=Z.numValues;const $=w.get(),ee=Hd(v,F,w);w.set($+Z.byteLength),O=new co(ee,Z.numValues)}const q=O??C;switch(P.physicalType){case 4:case 3:return(function(Z,$,ee,ue,ie){const re=$r(Z,$),fe=zl(re,ie,Z,$),_e=ue.physicalType===3;if(fe===Gn.FLAT){const je=Bs(ie)?Im(Z,$,re,_e,ie):Xr(Z,$,re,_e);return new dp(ee.name,je,ie)}if(fe===Gn.SEQUENCE){const je=zm(Z,$,re);return new Mm(ee.name,je[0],je[1],re.numRleValues)}{const je=Dm(Z,$,re,_e);return new Em(ee.name,je,ie)}})(v,w,L,P,q);case 9:return(function(Z,$,ee,ue,ie){let re=null,fe=null,_e=null,je=null,Qe=null,We=null,it=null,mt=null;for(let ut=0;ut<ue;ut++){const Ye=$r($,ee);if(Ye.byteLength!==0)switch(Ye.physicalStreamType){case br.PRESENT:{const qe=Hd($,Ye.numValues,ee);We=new co(qe,Ye.numValues);break}case br.OFFSET:fe=ie!=null||We!=null?Im($,ee,Ye,!1,ie??We):Xr($,ee,Ye,!1);break;case br.LENGTH:{const qe=Mc($,ee,Ye);Hr.DICTIONARY===Ye.logicalStreamType.lengthType?re=qe:Hr.SYMBOL===Ye.logicalStreamType.lengthType?je=qe:it=qe;break}case br.DATA:{const qe=$.subarray(ee.get(),ee.get()+Ye.byteLength);ee.add(Ye.byteLength);const bt=Ye.logicalStreamType.dictionaryType;lo.FSST===bt?Qe=qe:lo.SINGLE===bt||lo.SHARED===bt?_e=qe:lo.NONE===bt&&(mt=qe);break}}}return(function(ut,Ye,qe,bt,xt,Et,vt){return Ye?new bp(ut,qe,bt,xt,Et,Ye,vt):null})(Z,Qe,fe,re,_e,je,ie??We)??(function(ut,Ye,qe,bt,xt){return Ye?xt?new zu(ut,qe,bt,Ye,xt):new zu(ut,qe,bt,Ye):null})(Z,_e,fe,re,ie??We)??(function(ut,Ye,qe,bt,xt){if(!Ye||!qe)return null;if(bt)return xt?new zu(ut,bt,Ye,qe,xt):new zu(ut,bt,Ye,qe);if(xt&&xt.size()!==Ye.length-1){const Et=new Int32Array(xt.size());let vt=0;for(let jt=0;jt<xt.size();jt++)Et[jt]=xt.get(jt)?vt++:0;return new zu(ut,Et,Ye,qe,xt)}return xt?new vp(ut,Ye,qe,xt):new vp(ut,Ye,qe)})(Z,it,mt,fe,ie??We)})(L.name,v,w,L.nullable?m-1:m,O);case 0:return(function(Z,$,ee,ue,ie){const re=$r(Z,$),fe=re.numValues,_e=$.get(),je=Bs(ie)?(function(We,it,mt,ut){const Ye=ly(We,Math.ceil(it/8),mt),qe=new co(Ye,it),bt=ut.size(),xt=new co(new Uint8Array(bt),bt);let Et=0;for(let vt=0;vt<ut.size();vt++){const jt=!!ut.get(vt)&&qe.get(Et++);xt.set(vt,jt)}return xt.getBuffer()})(Z,fe,$,ie):Hd(Z,fe,$);$.set(_e+re.byteLength);const Qe=new co(je,fe);return new sy(ee.name,Qe,ie)})(v,w,L,0,q);case 6:case 5:return(function(Z,$,ee,ue,ie){const re=$r(Z,$),fe=zl(re,ue,Z,$),_e=ie.physicalType===5;if(fe===Gn.FLAT){const je=Bs(ue)?(function(Qe,We,it,mt,ut){return(function(Ye,qe,bt,xt){switch(qe.logicalLevelTechnique1){case ai.DELTA:return qe.logicalLevelTechnique2===ai.RLE&&(Ye=ty(Ye,qe.runs,qe.numRleValues)),(function(Et,vt){const jt=new BigInt64Array(Et.size());let bi=0;Et.get(0)?(jt[0]=Et.get(0)?vt[0]>>1n^-(1n&vt[0]):0n,bi=1):jt[0]=0n;let li=1;for(;li!=jt.length;++li)jt[li]=Et.get(li)?jt[li-1]+(vt[bi]>>1n^-(1n&vt[bi++])):jt[li-1];return jt})(xt,Ye);case ai.RLE:return(function(Et,vt,jt,bi){const li=vt;return jt?(function(vn,Yr,cr){const bn=new BigInt64Array(vn.size());let dn=0;for(let Ii=0;Ii<cr;Ii++){const kn=Number(Yr[Ii]);let qn=Yr[Ii+cr];qn=qn>>1n^-(1n&qn);for(let an=dn;an<dn+kn;an++)vn.get(an)?bn[an]=qn:(bn[an]=0n,dn++);dn+=kn}return bn})(bi,Et,li.runs):(function(vn,Yr,cr){const bn=new BigInt64Array(vn.size());let dn=0;for(let Ii=0;Ii<cr;Ii++){const kn=Number(Yr[Ii]),qn=Yr[Ii+cr];for(let an=dn;an<dn+kn;an++)vn.get(an)?bn[an]=qn:(bn[an]=0n,dn++);dn+=kn}return bn})(bi,Et,li.runs)})(Ye,qe,bt,xt);case ai.NONE:return Ye=bt?(function(Et,vt){const jt=new BigInt64Array(Et.size());let bi=0,li=0;for(;li!=jt.length;++li)if(Et.get(li)){const vn=vt[bi++];jt[li]=vn>>1n^-(1n&vn)}else jt[li]=0n;return jt})(xt,Ye):(function(Et,vt){const jt=new BigInt64Array(Et.size());let bi=0,li=0;for(;li!=jt.length;++li)jt[li]=Et.get(li)?vt[bi++]:0n;return jt})(xt,Ye),Ye;default:throw new Error("The specified Logical level technique is not supported")}})(Bd(Qe,We,it.numValues),it,mt,ut)})(Z,$,re,_e,ue):Ph(Z,$,re,_e);return new Ih(ee.name,je,ue)}if(fe===Gn.SEQUENCE){const je=Du(Z,$,re);return new Rm(ee.name,je[0],je[1],re.numRleValues)}{const je=Pm(Z,$,re,_e);return new Zd(ee.name,je,ue)}})(v,w,L,q,P);case 7:return(function(Z,$,ee,ue){const ie=$r(Z,$),re=Bs(ue)?(function(fe,_e,je,Qe){const We=_e.get(),it=We+Qe*Float32Array.BYTES_PER_ELEMENT,mt=new Uint8Array(fe.subarray(We,it)).buffer,ut=new Float32Array(mt);_e.set(it);const Ye=je.size(),qe=new Float32Array(Ye);let bt=0;for(let xt=0;xt<Ye;xt++)qe[xt]=je.get(xt)?ut[bt++]:0;return qe})(Z,$,ue,ie.numValues):(function(fe,_e,je){const Qe=_e.get(),We=Qe+je*Float32Array.BYTES_PER_ELEMENT,it=new Uint8Array(fe.subarray(Qe,We)).buffer,mt=new Float32Array(it);return _e.set(We),mt})(Z,$,ie.numValues);return new oy(ee.name,re,ue)})(v,w,L,q);case 8:return(function(Z,$,ee,ue){const ie=$r(Z,$),re=Bs(ue)?(function(fe,_e,je,Qe){const We=_e.get(),it=We+Qe*Float64Array.BYTES_PER_ELEMENT,mt=new Uint8Array(fe.subarray(We,it)).buffer,ut=new Float64Array(mt);_e.set(it);const Ye=je.size(),qe=new Float64Array(Ye);let bt=0;for(let xt=0;xt<Ye;xt++)qe[xt]=je.get(xt)?ut[bt++]:0;return qe})(Z,$,ue,ie.numValues):(function(fe,_e,je){const Qe=_e.get(),We=Qe+je*Float64Array.BYTES_PER_ELEMENT,it=new Uint8Array(fe.subarray(Qe,We)).buffer,mt=new Float64Array(it);return _e.set(We),mt})(Z,$,ie.numValues);return new Tm(ee.name,re,ue)})(v,w,L,q);default:throw new Error(`The specified data type for the field is currently not supported: ${P}`)}})(o,n,e,u,i.scalarType,i):o!=1?null:(function(m,v,w,C){let P=null,L=null,O=null,F=null,q=!1;for(;!q;){const ue=$r(m,v);switch(ue.physicalStreamType){case br.LENGTH:Hr.DICTIONARY===ue.logicalStreamType.lengthType?P=Mc(m,v,ue):O=Mc(m,v,ue);break;case br.DATA:lo.SINGLE===ue.logicalStreamType.dictionaryType||lo.SHARED===ue.logicalStreamType.dictionaryType?(L=m.subarray(v.get(),v.get()+ue.byteLength),q=!0):F=m.subarray(v.get(),v.get()+ue.byteLength),v.add(ue.byteLength)}}const Z=w.complexType.children,$=[];let ee=0;for(const ue of Z){const ie=lr(m,v,1)[0];if(ie==0)continue;const re=`${w.name}${ue.name==="default"?"":":"+ue.name}`;if(ie!==2||ue.type!=="scalarField"||ue.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const fe=$r(m,v),_e=Hd(m,fe.numValues,v),je=$r(m,v),Qe=je.decompressedCount!==C?Im(m,v,je,!1,new co(_e,fe.numValues)):Xr(m,v,je,!1);$[ee++]=F?new bp(re,Qe,P,L,O,F,new co(_e,fe.numValues)):new zu(re,Qe,P,L,new co(_e,fe.numValues))}return $})(n,e,i,u)}function Bs(n){return n instanceof co}function Ac(n){if(n.name==="id")return!1;if(n.type==="scalarType"){const e=n.scalarType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(e.type==="logicalType")return!1}else if(n.type==="complexType"){const e=n.complexType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",n),!1}const Xd=new TextDecoder;function Lh(n,e){const i=lr(n,e,1)[0];if(i===0)return"";const o=e.get(),u=n.subarray(o,o+i);return e.add(i),Xd.decode(u)}function Il(n,e){const i=lr(n,e,1)[0]>>>0,o=!!(4&i),u=!!(2&i),p=lr(n,e,1)[0]>>>0,m={};if(1&i&&(m.nullable=!0),u){const v={};if(o?(v.type="logicalType",v.logicalType=p):(v.type="physicalType",v.physicalType=p),8&i){const w=lr(n,e,1)[0]>>>0;v.children=new Array(w);for(let C=0;C<w;C++)v.children[C]=Il(n,e)}m.type="complexField",m.complexField=v}else{const v={};o?(v.type="logicalType",v.logicalType=p):(v.type="physicalType",v.physicalType=p),m.type="scalarField",m.scalarField=v}return m}function Wy(n,e){const i=lr(n,e,1)[0]>>>0,o=(function(u){switch(u){case 0:case 1:case 2:case 3:{const p={};p.nullable=!!(1&u),p.columnScope=0;const m={};return m.physicalType=u>1?6:4,m.type="physicalType",p.scalarType=m,p.type="scalarType",p}case 4:{const p={nullable:!1,columnScope:0},m={type:"physicalType",physicalType:0};return p.type="complexType",p.complexType=m,p}case 30:{const p={nullable:!1,columnScope:0},m={type:"physicalType",physicalType:1};return p.type="complexType",p.complexType=m,p}default:return(function(p){let m=null;switch(p){case 10:case 11:m=0;break;case 12:case 13:m=1;break;case 14:case 15:m=2;break;case 16:case 17:m=3;break;case 18:case 19:m=4;break;case 20:case 21:m=5;break;case 22:case 23:m=6;break;case 24:case 25:m=7;break;case 26:case 27:m=8;break;case 28:case 29:m=9;break;default:return null}const v={};v.nullable=!!(1&p),v.columnScope=0;const w={type:"physicalType"};return w.physicalType=m,v.type="scalarType",v.scalarType=w,v})(u)}})(i);if(!o)throw new Error(`Unsupported column type code: ${i}`);if((function(u){return u>=10})(i)?o.name=Lh(n,e):i>=0&&i<=3?o.name="id":i===4&&(o.name="geometry"),(function(u){return u===30})(i)){const u=lr(n,e,1)[0]>>>0,p=o.complexType;p.children=new Array(u);for(let m=0;m<u;m++)p.children[m]=Il(n,e)}return o}function cy(n,e){const i={featureTables:[]},o={};o.name=Lh(n,e);const u=lr(n,e,1)[0]>>>0,p=lr(n,e,1)[0]>>>0;o.columns=new Array(p);for(let m=0;m<p;m++)o.columns[m]=Wy(n,e);return i.featureTables.push(o),[i,u]}function Yd(n,e,i,o,u,p,m=!1){const v=e.scalarType.physicalType,w=zl(u,p,n,i);if(v===4)switch(w){case Gn.FLAT:{const C=Xr(n,i,u,!1);return new dp(o,C,p)}case Gn.SEQUENCE:{const C=zm(n,i,u);return new Mm(o,C[0],C[1],u.numRleValues)}case Gn.CONST:{const C=Dm(n,i,u,!1);return new Em(o,C,p)}}else switch(w){case Gn.FLAT:{if(m){const P=(function(L,O,F,q){const Z=(function($,ee,ue){const ie=new Float64Array(ee);for(let re=0;re<ee;re++)ie[re]=ey($,ue);return ie})(L,F.numValues,O);return(function($,ee,ue){switch(ee.logicalLevelTechnique1){case ai.DELTA:return ee.logicalLevelTechnique2===ai.RLE&&($=iy($,ee.runs,ee.numRleValues)),(function(ie){ie[0]=ie[0]%2==1?(ie[0]+1)/-2:ie[0]/2;const re=ie.length/4*4;let fe=1;if(re>=4)for(;fe<re-4;fe+=4){const _e=ie[fe],je=ie[fe+1],Qe=ie[fe+2],We=ie[fe+3];ie[fe]=(_e%2==1?(_e+1)/-2:_e/2)+ie[fe-1],ie[fe+1]=(je%2==1?(je+1)/-2:je/2)+ie[fe],ie[fe+2]=(Qe%2==1?(Qe+1)/-2:Qe/2)+ie[fe+1],ie[fe+3]=(We%2==1?(We+1)/-2:We/2)+ie[fe+2]}for(;fe!=ie.length;++fe)ie[fe]=(ie[fe]%2==1?(ie[fe]+1)/-2:ie[fe]/2)+ie[fe-1]})($),$;case ai.RLE:return(function(ie,re,fe){return iy(ie,re.runs,re.numRleValues)})($,ee);case ai.NONE:return $;default:throw new Error(`The specified Logical level technique is not supported: ${ee.logicalLevelTechnique1}`)}})(Z,F)})(n,i,u);return new Tm(o,P,p)}const C=Ph(n,i,u,!1);return new Ih(o,C,p)}case Gn.SEQUENCE:{const C=Du(n,i,u);return new Rm(o,C[0],C[1],u.numRleValues)}case Gn.CONST:{const C=Pm(n,i,u,!1);return new Zd(o,C,p)}}throw new Error("Vector type not supported for id column.")}class Ky{constructor(e,i){var o;switch(this._featureData=e,this.properties=this._featureData.properties||{},(o=this._featureData.geometry)===null||o===void 0?void 0:o.type){case or.POINT:case or.MULTIPOINT:this.type=1;break;case or.LINESTRING:case or.MULTILINESTRING:this.type=2;break;case or.POLYGON:case or.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=i,this.id=Number(this._featureData.id)}loadGeometry(){const e=[];for(const i of this._featureData.geometry.coordinates){const o=[];for(const u of i)o.push(new V(u.x,u.y));e.push(o)}return e}}class uy{constructor(e){this.features=[],this.featureTable=e,this.name=e.name,this.extent=e.extent,this.version=2,this.features=e.getFeatures(),this.length=this.features.length}feature(e){return new Ky(this.features[e],this.extent)}}class Wd{constructor(e){this.layers={};const i=(function(o,u,p=!0){const m=new Jg(0),v=[];for(;m.get()<o.length;){const w=lr(o,m,1)[0]>>>0,C=m.get()+w;if(C>o.length)throw new Error(`Block overruns tile: ${C} > ${o.length}`);if(lr(o,m,1)[0]>>>0!=1){m.set(C);continue}const P=cy(o,m),L=P[1],O=P[0].featureTables[0];let F=null,q=null;const Z=[];let $=0;for(const ue of O.columns){const ie=ue.name;if(ie==="id"){let re=null;if(ue.nullable){const _e=$r(o,m),je=m.get(),Qe=Hd(o,_e.numValues,m);m.set(je+_e.byteLength),re=new co(Qe,_e.numValues)}const fe=$r(o,m);$=fe.decompressedCount,F=Yd(o,ue,m,ie,fe,re??$,p)}else if(ie==="geometry"){const re=lr(o,m,1)[0];if($===0){const fe=m.get();$=$r(o,m).decompressedCount,m.set(fe)}q=ay(o,re,m,$)}else{const re=Ac(ue)?lr(o,m,1)[0]:1;if(re===0&&ue.type==="scalarType")continue;const fe=Ec(o,m,ue,re,$);if(fe)if(Array.isArray(fe))for(const _e of fe)Z.push(_e);else Z.push(fe)}}const ee=new wc(O.name,q,F,Z,L);v.push(ee),m.set(C)}return v})(new Uint8Array(e));this.layers=i.reduce(((o,u)=>Object.assign(Object.assign({},o),{[u.name]:new uy(u)})),{})}}class hy{constructor(e,i){this.feature=e,this.type=e.type,this.properties=e.tags?e.tags:{},this.extent=i,"id"in e&&(typeof e.id=="string"?this.id=parseInt(e.id,10):typeof e.id!="number"||isNaN(e.id)||(this.id=e.id))}loadGeometry(){const e=[],i=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const o of i){const u=[];for(const p of o)u.push(new V(p[0],p[1]));e.push(u)}return e}}const Kd="_geojsonTileLayer";function wp(n,e){e.writeVarintField(15,n.version||1),e.writeStringField(1,n.name||""),e.writeVarintField(5,n.extent||4096);const i={keys:[],values:[],keycache:{},valuecache:{}};for(let p=0;p<n.length;p++)i.feature=n.feature(p),e.writeMessage(2,Tp,i);const o=i.keys;for(const p of o)e.writeStringField(3,p);const u=i.values;for(const p of u)e.writeMessage(4,Sp,p)}function Tp(n,e){if(!n.feature)return;const i=n.feature;i.id!==void 0&&e.writeVarintField(1,i.id),e.writeMessage(2,dy,n),e.writeVarintField(3,i.type),e.writeMessage(4,Nm,i)}function dy(n,e){for(const i in n.feature?.properties){let o=n.feature.properties[i],u=n.keycache[i];if(o==null)continue;u===void 0&&(n.keys.push(i),u=n.keys.length-1,n.keycache[i]=u),e.writeVarint(u),typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"&&(o=JSON.stringify(o));const p=typeof o+":"+o;let m=n.valuecache[p];m===void 0&&(n.values.push(o),m=n.values.length-1,n.valuecache[p]=m),e.writeVarint(m)}}function Cc(n,e){return(e<<3)+(7&n)}function Fm(n){return n<<1^n>>31}function Nm(n,e){const i=n.loadGeometry(),o=n.type;let u=0,p=0;for(const m of i){let v=1;o===1&&(v=m.length),e.writeVarint(Cc(1,v));const w=o===3?m.length-1:m.length;for(let C=0;C<w;C++){C===1&&o!==1&&e.writeVarint(Cc(2,w-1));const P=m[C].x-u,L=m[C].y-p;e.writeVarint(Fm(P)),e.writeVarint(Fm(L)),u+=P,p+=L}n.type===3&&e.writeVarint(Cc(7,1))}}function Sp(n,e){const i=typeof n;i==="string"?e.writeStringField(1,n):i==="boolean"?e.writeBooleanField(7,n):i==="number"&&(n%1!=0?e.writeDoubleField(3,n):n<0?e.writeSVarintField(6,n):e.writeVarintField(5,n))}class Vm{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Po(It,16,0),this.grid3D=new Po(It,16,0),this.featureIndexArray=new Q,this.promoteId=i}insert(e,i,o,u,p,m){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,u,p);const w=m?this.grid3D:this.grid;for(let C=0;C<i.length;C++){const P=i[C],L=[1/0,1/0,-1/0,-1/0];for(let O=0;O<P.length;O++){const F=P[O];L[0]=Math.min(L[0],F.x),L[1]=Math.min(L[1],F.y),L[2]=Math.max(L[2],F.x),L[3]=Math.max(L[3],F.y)}L[0]<It&&L[1]<It&&L[2]>=0&&L[3]>=0&&w.insert(v,L[0],L[1],L[2],L[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new gi(new Wf(this.rawTileData)).layers:new Wd(this.rawTileData).layers,this.sourceLayerCoder=new wm(this.vtLayers?Object.keys(this.vtLayers).sort():[Kd])),this.vtLayers}query(e,i,o,u){this.loadVTLayers();const p=e.params,m=It/e.tileSize/e.scale,v=Fr(p.filter,p.globalState),w=e.queryGeometry,C=e.queryPadding*m,P=vc.fromPoints(w),L=this.grid.query(P.minX-C,P.minY-C,P.maxX+C,P.maxY+C),O=vc.fromPoints(e.cameraQueryGeometry).expandBy(C),F=this.grid3D.query(O.minX,O.minY,O.maxX,O.maxY,(($,ee,ue,ie)=>(function(re,fe,_e,je,Qe){for(const it of re)if(fe<=it.x&&_e<=it.y&&je>=it.x&&Qe>=it.y)return!0;const We=[new V(fe,_e),new V(fe,Qe),new V(je,Qe),new V(je,_e)];if(re.length>2){for(const it of We)if(jo(re,it))return!0}for(let it=0;it<re.length-1;it++)if(yg(re[it],re[it+1],We))return!0;return!1})(e.cameraQueryGeometry,$-C,ee-C,ue+C,ie+C)));for(const $ of F)L.push($);L.sort(Mp);const q={};let Z;for(let $=0;$<L.length;$++){const ee=L[$];if(ee===Z)continue;Z=ee;const ue=this.featureIndexArray.get(ee);let ie=null;this.loadMatchingFeature(q,ue.bucketIndex,ue.sourceLayerIndex,ue.featureIndex,v,p.layers,p.availableImages,i,o,u,((re,fe,_e)=>(ie||(ie=no(re)),fe.queryIntersectsFeature({queryGeometry:w,feature:re,featureState:_e,geometry:ie,zoom:this.z,transform:e.transform,pixelsToTileUnits:m,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation}))))}return q}loadMatchingFeature(e,i,o,u,p,m,v,w,C,P,L){const O=this.bucketLayerIDs[i];if(m&&!O.some(($=>m.has($))))return;const F=this.sourceLayerCoder.decode(o),q=this.vtLayers[F].feature(u);if(p.needGeometry){const $=ts(q,!0);if(!p.filter(new Mi(this.tileID.overscaledZ),$,this.tileID.canonical))return}else if(!p.filter(new Mi(this.tileID.overscaledZ),q))return;const Z=this.getId(q,F);for(let $=0;$<O.length;$++){const ee=O[$];if(m&&!m.has(ee))continue;const ue=w[ee];if(!ue)continue;let ie={};Z&&P&&(ie=P.getState(ue.sourceLayer||Kd,Z));const re=Li({},C[ee]);re.paint=fy(re.paint,ue.paint,q,ie,v),re.layout=fy(re.layout,ue.layout,q,ie,v);const fe=!L||L(q,ue,ie);if(!fe)continue;const _e=new up(q,this.z,this.x,this.y,Z);_e.layer=re;let je=e[ee];je===void 0&&(je=e[ee]=[]),je.push({featureIndex:u,feature:_e,intersectionZ:fe})}}lookupSymbolFeatures(e,i,o,u,p,m,v,w){const C={};this.loadVTLayers();const P=Fr(p.filterSpec,p.globalState);for(const L of e)this.loadMatchingFeature(C,o,u,L,P,m,v,w,i);return C}hasLayer(e){for(const i of this.bucketLayerIDs)for(const o of i)if(e===o)return!0;return!1}getId(e,i){var o;let u=e.id;return this.promoteId&&(u=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof u=="boolean"&&(u=Number(u)),u===void 0&&(!((o=e.properties)===null||o===void 0)&&o.cluster)&&this.promoteId&&(u=Number(e.properties.cluster_id))),u}}function fy(n,e,i,o,u){return va(n,((p,m)=>{const v=e instanceof pl?e.get(m):null;return v&&v.evaluate?v.evaluate(i,o,u):v}))}function Mp(n,e){return e-n}function r(n,e,i,o,u){const p=[];for(let m=0;m<n.length;m++){const v=n[m];let w;for(let C=0;C<v.length-1;C++){let P=v[C],L=v[C+1];P.x<e&&L.x<e||(P.x<e?P=new V(e,P.y+(e-P.x)/(L.x-P.x)*(L.y-P.y))._round():L.x<e&&(L=new V(e,P.y+(e-P.x)/(L.x-P.x)*(L.y-P.y))._round()),P.y<i&&L.y<i||(P.y<i?P=new V(P.x+(i-P.y)/(L.y-P.y)*(L.x-P.x),i)._round():L.y<i&&(L=new V(P.x+(i-P.y)/(L.y-P.y)*(L.x-P.x),i)._round()),P.x>=o&&L.x>=o||(P.x>=o?P=new V(o,P.y+(o-P.x)/(L.x-P.x)*(L.y-P.y))._round():L.x>=o&&(L=new V(o,P.y+(o-P.x)/(L.x-P.x)*(L.y-P.y))._round()),P.y>=u&&L.y>=u||(P.y>=u?P=new V(P.x+(u-P.y)/(L.y-P.y)*(L.x-P.x),u)._round():L.y>=u&&(L=new V(P.x+(u-P.y)/(L.y-P.y)*(L.x-P.x),u)._round()),w&&P.equals(w[w.length-1])||(w=[P],p.push(w)),w.push(L)))))}}return p}function s(n,e,i,o,u){switch(e){case 1:return(function(p,m,v,w){const C=[];for(const P of p)for(const L of P){const O=w===0?L.x:L.y;O>=m&&O<=v&&C.push([L])}return C})(n,i,o,u);case 2:return _(n,i,o,u,!1);case 3:return _(n,i,o,u,!0)}return[]}function h(n,e,i,o,u){const p=o===0?A:z;let m=[];const v=[];for(let P=0;P<n.length-1;P++){const L=n[P],O=n[P+1],F=o===0?L.x:L.y,q=o===0?O.x:O.y;let Z=!1;F<e?q>e&&m.push(p(L,O,e)):F>i?q<i&&m.push(p(L,O,i)):m.push(L),q<e&&F>=e&&(m.push(p(L,O,e)),Z=!0),q>i&&F<=i&&(m.push(p(L,O,i)),Z=!0),!u&&Z&&(v.push(m),m=[])}const w=n.length-1,C=o===0?n[w].x:n[w].y;return C>=e&&C<=i&&m.push(n[w]),u&&m.length>0&&!m[0].equals(m[m.length-1])&&m.push(new V(m[0].x,m[0].y)),m.length>0&&v.push(m),v}function _(n,e,i,o,u){const p=[];for(const m of n){const v=h(m,e,i,o,u);v.length>0&&p.push(...v)}return p}function A(n,e,i){return new V(i,n.y+(i-n.x)/(e.x-n.x)*(e.y-n.y))}function z(n,e,i){return new V(n.x+(i-n.y)/(e.y-n.y)*(e.x-n.x),i)}wt("FeatureIndex",Vm,{omit:["rawTileData","sourceLayerCoder"]});class G extends V{constructor(e,i,o,u){super(e,i),this.angle=o,u!==void 0&&(this.segment=u)}clone(){return new G(this.x,this.y,this.angle,this.segment)}}function ne(n,e,i,o,u){if(e.segment===void 0||i===0)return!0;let p=e,m=e.segment+1,v=0;for(;v>-i/2;){if(m--,m<0)return!1;v-=n[m].dist(p),p=n[m]}v+=n[m].dist(n[m+1]),m++;const w=[];let C=0;for(;v<i/2;){const P=n[m],L=n[m+1];if(!L)return!1;let O=n[m-1].angleTo(P)-P.angleTo(L);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:v,angleDelta:O}),C+=O;v-w[0].distance>o;)C-=w.shift().angleDelta;if(C>u)return!1;m++,v+=P.dist(L)}return!0}function we(n){let e=0;for(let i=0;i<n.length-1;i++)e+=n[i].dist(n[i+1]);return e}function Ge(n,e,i){return n?.6*e*i:0}function et(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function ct(n,e,i,o,u,p){const m=Ge(i,u,p),v=et(i,o)*p;let w=0;const C=we(n)/2;for(let P=0;P<n.length-1;P++){const L=n[P],O=n[P+1],F=L.dist(O);if(w+F>C){const q=(C-w)/F,Z=en.number(L.x,O.x,q),$=en.number(L.y,O.y,q),ee=new G(Z,$,O.angleTo(L),P);return ee._round(),!m||ne(n,ee,v,m,e)?ee:void 0}w+=F}}function He(n,e,i,o,u,p,m,v,w){const C=Ge(o,p,m),P=et(o,u),L=P*m,O=n[0].x===0||n[0].x===w||n[0].y===0||n[0].y===w;return e-L<e/4&&(e=L+e/4),Ke(n,O?e/2*v%e:(P/2+2*p)*m*v%e,e,C,i,L,O,!1,w)}function Ke(n,e,i,o,u,p,m,v,w){const C=p/2,P=we(n);let L=0,O=e-i,F=[];for(let q=0;q<n.length-1;q++){const Z=n[q],$=n[q+1],ee=Z.dist($),ue=$.angleTo(Z);for(;O+i<L+ee;){O+=i;const ie=(O-L)/ee,re=en.number(Z.x,$.x,ie),fe=en.number(Z.y,$.y,ie);if(re>=0&&re<w&&fe>=0&&fe<w&&O-C>=0&&O+C<=P){const _e=new G(re,fe,ue,q);_e._round(),o&&!ne(n,_e,p,o,u)||F.push(_e)}}L+=ee}return v||F.length||m||(F=Ke(n,L/2,i,o,u,p,m,!0,w)),F}function kt(n,e,i,o){const u=[],p=n.image,m=p.pixelRatio,v=p.paddedRect.w-2,w=p.paddedRect.h-2;let C={x1:n.left,y1:n.top,x2:n.right,y2:n.bottom};const P=p.stretchX||[[0,v]],L=p.stretchY||[[0,w]],O=(qe,bt)=>qe+bt[1]-bt[0],F=P.reduce(O,0),q=L.reduce(O,0),Z=v-F,$=w-q;let ee=0,ue=F,ie=0,re=q,fe=0,_e=Z,je=0,Qe=$;if(p.content&&o){const qe=p.content,bt=qe[2]-qe[0],xt=qe[3]-qe[1];(p.textFitWidth||p.textFitHeight)&&(C=Dl(n)),ee=Zt(P,0,qe[0]),ie=Zt(L,0,qe[1]),ue=Zt(P,qe[0],qe[2]),re=Zt(L,qe[1],qe[3]),fe=qe[0]-ee,je=qe[1]-ie,_e=bt-ue,Qe=xt-re}const We=C.x1,it=C.y1,mt=C.x2-We,ut=C.y2-it,Ye=(qe,bt,xt,Et)=>{const vt=Ie(qe.stretch-ee,ue,mt,We),jt=Ae(qe.fixed-fe,_e,qe.stretch,F),bi=Ie(bt.stretch-ie,re,ut,it),li=Ae(bt.fixed-je,Qe,bt.stretch,q),vn=Ie(xt.stretch-ee,ue,mt,We),Yr=Ae(xt.fixed-fe,_e,xt.stretch,F),cr=Ie(Et.stretch-ie,re,ut,it),bn=Ae(Et.fixed-je,Qe,Et.stretch,q),dn=new V(vt,bi),Ii=new V(vn,bi),kn=new V(vn,cr),qn=new V(vt,cr),an=new V(jt/m,li/m),as=new V(Yr/m,bn/m),Wr=e*Math.PI/180;if(Wr){const Tr=Math.sin(Wr),Cn=Math.cos(Wr),ur=[Cn,-Tr,Tr,Cn];dn._matMult(ur),Ii._matMult(ur),qn._matMult(ur),kn._matMult(ur)}const ss=qe.stretch+qe.fixed,Uo=bt.stretch+bt.fixed;return{tl:dn,tr:Ii,bl:qn,br:kn,tex:{x:p.paddedRect.x+1+ss,y:p.paddedRect.y+1+Uo,w:xt.stretch+xt.fixed-ss,h:Et.stretch+Et.fixed-Uo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:an,pixelOffsetBR:as,minFontScaleX:_e/m/mt,minFontScaleY:Qe/m/ut,isSDF:i}};if(o&&(p.stretchX||p.stretchY)){const qe=$i(P,Z,F),bt=$i(L,$,q);for(let xt=0;xt<qe.length-1;xt++){const Et=qe[xt],vt=qe[xt+1];for(let jt=0;jt<bt.length-1;jt++)u.push(Ye(Et,bt[jt],vt,bt[jt+1]))}}else u.push(Ye({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:w+1}));return u}function Zt(n,e,i){let o=0;for(const u of n)o+=Math.max(e,Math.min(i,u[1]))-Math.max(e,Math.min(i,u[0]));return o}function $i(n,e,i){const o=[{fixed:-1,stretch:0}];for(const[u,p]of n){const m=o[o.length-1];o.push({fixed:u-m.stretch,stretch:m.stretch}),o.push({fixed:u-m.stretch,stretch:m.stretch+(p-u)})}return o.push({fixed:e+1,stretch:i}),o}function Ie(n,e,i,o){return n/e*i+o}function Ae(n,e,i,o){return n-e*i/o}wt("Anchor",G);class Ne{constructor(e,i,o,u,p,m,v,w,C,P){var L;if(this.boxStartIndex=e.length,C){let O=m.top,F=m.bottom;const q=m.collisionPadding;q&&(O-=q[1],F+=q[3]);let Z=F-O;Z>0&&(Z=Math.max(10,Z),this.circleDiameter=Z)}else{const O=!((L=m.image)===null||L===void 0)&&L.content&&(m.image.textFitWidth||m.image.textFitHeight)?Dl(m):{x1:m.left,y1:m.top,x2:m.right,y2:m.bottom};O.y1=O.y1*v-w[0],O.y2=O.y2*v+w[2],O.x1=O.x1*v-w[3],O.x2=O.x2*v+w[1];const F=m.collisionPadding;if(F&&(O.x1-=F[0]*v,O.y1-=F[1]*v,O.x2+=F[2]*v,O.y2+=F[3]*v),P){const q=new V(O.x1,O.y1),Z=new V(O.x2,O.y1),$=new V(O.x1,O.y2),ee=new V(O.x2,O.y2),ue=P*Math.PI/180;q._rotate(ue),Z._rotate(ue),$._rotate(ue),ee._rotate(ue),O.x1=Math.min(q.x,Z.x,$.x,ee.x),O.x2=Math.max(q.x,Z.x,$.x,ee.x),O.y1=Math.min(q.y,Z.y,$.y,ee.y),O.y2=Math.max(q.y,Z.y,$.y,ee.y)}e.emplaceBack(i.x,i.y,O.x1,O.y1,O.x2,O.y2,o,u,p)}this.boxEndIndex=e.length}}class st{constructor(e=[],i=(o,u)=>o<u?-1:o>u?1:0){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:o}=this,u=i[e];for(;e>0;){const p=e-1>>1,m=i[p];if(o(u,m)>=0)break;i[e]=m,e=p}i[e]=u}_down(e){const{data:i,compare:o}=this,u=this.length>>1,p=i[e];for(;e<u;){let m=1+(e<<1);const v=m+1;if(v<this.length&&o(i[v],i[m])<0&&(m=v),o(i[m],p)>=0)break;i[e]=i[m],e=m}i[e]=p}}function Gt(n,e=1,i=!1){const o=vc.fromPoints(n[0]),u=Math.min(o.width(),o.height());let p=u/2;const m=new st([],Pi),{minX:v,minY:w,maxX:C,maxY:P}=o;if(u===0)return new V(v,w);for(let F=v;F<C;F+=u)for(let q=w;q<P;q+=u)m.push(new Lt(F+p,q+p,p,n));let L=(function(F){let q=0,Z=0,$=0;const ee=F[0];for(let ue=0,ie=ee.length,re=ie-1;ue<ie;re=ue++){const fe=ee[ue],_e=ee[re],je=fe.x*_e.y-_e.x*fe.y;Z+=(fe.x+_e.x)*je,$+=(fe.y+_e.y)*je,q+=3*je}return new Lt(Z/q,$/q,0,F)})(n),O=m.length;for(;m.length;){const F=m.pop();(F.d>L.d||!L.d)&&(L=F,i&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,O)),F.max-L.d<=e||(p=F.h/2,m.push(new Lt(F.p.x-p,F.p.y-p,p,n)),m.push(new Lt(F.p.x+p,F.p.y-p,p,n)),m.push(new Lt(F.p.x-p,F.p.y+p,p,n)),m.push(new Lt(F.p.x+p,F.p.y+p,p,n)),O+=4)}return i&&(console.log(`num probes: ${O}`),console.log(`best distance: ${L.d}`)),L.p}function Pi(n,e){return e.max-n.max}function Lt(n,e,i,o){this.p=new V(n,e),this.h=i,this.d=(function(u,p){let m=!1,v=1/0;for(let w=0;w<p.length;w++){const C=p[w];for(let P=0,L=C.length,O=L-1;P<L;O=P++){const F=C[P],q=C[O];F.y>u.y!=q.y>u.y&&u.x<(q.x-F.x)*(u.y-F.y)/(q.y-F.y)+F.x&&(m=!m),v=Math.min(v,qp(u,F,q))}}return(m?1:-1)*Math.sqrt(v)})(this.p,o),this.max=this.d+this.h*Math.SQRT2}var Ft;M.aP=void 0,(Ft=M.aP||(M.aP={}))[Ft.center=1]="center",Ft[Ft.left=2]="left",Ft[Ft.right=3]="right",Ft[Ft.top=4]="top",Ft[Ft.bottom=5]="bottom",Ft[Ft["top-left"]=6]="top-left",Ft[Ft["top-right"]=7]="top-right",Ft[Ft["bottom-left"]=8]="bottom-left",Ft[Ft["bottom-right"]=9]="bottom-right";const pi=Number.POSITIVE_INFINITY;function Ai(n,e){return e[1]!==pi?(function(i,o,u){let p=0,m=0;switch(o=Math.abs(o),u=Math.abs(u),i){case"top-right":case"top-left":case"top":m=u-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-u}switch(i){case"top-right":case"bottom-right":case"right":p=-o;break;case"top-left":case"bottom-left":case"left":p=o}return[p,m]})(n,e[0],e[1]):(function(i,o){let u=0,p=0;o<0&&(o=0);const m=o/Math.SQRT2;switch(i){case"top-right":case"top-left":p=m-7;break;case"bottom-right":case"bottom-left":p=7-m;break;case"bottom":p=7-o;break;case"top":p=o-7}switch(i){case"top-right":case"bottom-right":u=-m;break;case"top-left":case"bottom-left":u=m;break;case"left":u=o;break;case"right":u=-o}return[u,p]})(n,e[0])}function Rl(n,e,i){var o;const u=n.layout,p=(o=u.get("text-variable-anchor-offset"))===null||o===void 0?void 0:o.evaluate(e,{},i);if(p){const v=p.values,w=[];for(let C=0;C<v.length;C+=2){const P=w[C]=v[C],L=v[C+1].map((O=>O*Yn));P.startsWith("top")?L[1]-=7:P.startsWith("bottom")&&(L[1]+=7),w[C+1]=L}return new pn(w)}const m=u.get("text-variable-anchor");if(m){let v;v=n._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[u.get("text-radial-offset").evaluate(e,{},i)*Yn,pi]:u.get("text-offset").evaluate(e,{},i).map((C=>C*Yn));const w=[];for(const C of m)w.push(C,Ai(C,v));return new pn(w)}return null}function Um(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function X1(n,e,i,o,u,p,m,v,w,C,P,L){let O=p.textMaxSize.evaluate(e,{});O===void 0&&(O=m);const F=n.layers[0].layout,q=F.get("icon-offset").evaluate(e,{},P),Z=Z0(i.horizontal),$=m/24,ee=n.tilePixelRatio*$,ue=n.tilePixelRatio*O/24,ie=n.tilePixelRatio*v,re=n.tilePixelRatio*F.get("symbol-spacing"),fe=F.get("text-padding")*n.tilePixelRatio,_e=(function(xt,Et,vt,jt=1){const bi=xt.get("icon-padding").evaluate(Et,{},vt),li=bi&&bi.values;return[li[0]*jt,li[1]*jt,li[2]*jt,li[3]*jt]})(F,e,P,n.tilePixelRatio),je=F.get("text-max-angle")/180*Math.PI,Qe=F.get("text-rotation-alignment")!=="viewport"&&F.get("symbol-placement")!=="point",We=F.get("icon-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",it=F.get("symbol-placement"),mt=re/2,ut=F.get("icon-text-fit");let Ye;o&&ut!=="none"&&(n.allowVerticalPlacement&&i.vertical&&(Ye=so(o,i.vertical,ut,F.get("icon-text-fit-padding"),q,$)),Z&&(o=so(o,Z,ut,F.get("icon-text-fit-padding"),q,$)));const qe=P?L.line.getGranularityForZoomLevel(P.z):1,bt=(xt,Et)=>{Et.x<0||Et.x>=It||Et.y<0||Et.y>=It||(function(vt,jt,bi,li,vn,Yr,cr,bn,dn,Ii,kn,qn,an,as,Wr,ss,Uo,Tr,Cn,ur,Ln,Sr,Pu,kl,Zm){const jh=vt.addToLineVertexArray(jt,bi);let Qd,Ep,Ap,Cp,Y0=0,W0=0,K0=0,Q0=0,a_=-1,s_=-1;const Iu={};let J0=_n("");if(vt.allowVerticalPlacement&&li.vertical){const ya=bn.layout.get("text-rotate").evaluate(Ln,{},kl)+90;Ap=new Ne(dn,jt,Ii,kn,qn,li.vertical,an,as,Wr,ya),cr&&(Cp=new Ne(dn,jt,Ii,kn,qn,cr,Uo,Tr,Wr,ya))}if(vn){const ya=bn.layout.get("icon-rotate").evaluate(Ln,{}),uo=bn.layout.get("icon-text-fit")!=="none",Jd=kt(vn,ya,Pu,uo),jl=cr?kt(cr,ya,Pu,uo):void 0;Ep=new Ne(dn,jt,Ii,kn,qn,vn,Uo,Tr,!1,ya),Y0=4*Jd.length;const ef=vt.iconSizeData;let Dc=null;ef.kind==="source"?(Dc=[ns*bn.layout.get("icon-size").evaluate(Ln,{})],Dc[0]>_c&&sn(`${vt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):ef.kind==="composite"&&(Dc=[ns*Sr.compositeIconSizes[0].evaluate(Ln,{},kl),ns*Sr.compositeIconSizes[1].evaluate(Ln,{},kl)],(Dc[0]>_c||Dc[1]>_c)&&sn(`${vt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),vt.addSymbols(vt.icon,Jd,Dc,ur,Cn,Ln,M.az.none,jt,jh.lineStartIndex,jh.lineLength,-1,kl),a_=vt.icon.placedSymbolArray.length-1,jl&&(W0=4*jl.length,vt.addSymbols(vt.icon,jl,Dc,ur,Cn,Ln,M.az.vertical,jt,jh.lineStartIndex,jh.lineLength,-1,kl),s_=vt.icon.placedSymbolArray.length-1)}const ex=Object.keys(li.horizontal);for(const ya of ex){const uo=li.horizontal[ya];if(!Qd){J0=_n(uo.text);const jl=bn.layout.get("text-rotate").evaluate(Ln,{},kl);Qd=new Ne(dn,jt,Ii,kn,qn,uo,an,as,Wr,jl)}const Jd=uo.positionedLines.length===1;if(K0+=q0(vt,jt,uo,Yr,bn,Wr,Ln,ss,jh,li.vertical?M.az.horizontal:M.az.horizontalOnly,Jd?ex:[ya],Iu,a_,Sr,kl),Jd)break}li.vertical&&(Q0+=q0(vt,jt,li.vertical,Yr,bn,Wr,Ln,ss,jh,M.az.vertical,["vertical"],Iu,s_,Sr,kl));const K1=Qd?Qd.boxStartIndex:vt.collisionBoxArray.length,Q1=Qd?Qd.boxEndIndex:vt.collisionBoxArray.length,J1=Ap?Ap.boxStartIndex:vt.collisionBoxArray.length,ew=Ap?Ap.boxEndIndex:vt.collisionBoxArray.length,tw=Ep?Ep.boxStartIndex:vt.collisionBoxArray.length,iw=Ep?Ep.boxEndIndex:vt.collisionBoxArray.length,nw=Cp?Cp.boxStartIndex:vt.collisionBoxArray.length,rw=Cp?Cp.boxEndIndex:vt.collisionBoxArray.length;let Ll=-1;const my=(ya,uo)=>ya&&ya.circleDiameter?Math.max(ya.circleDiameter,uo):uo;Ll=my(Qd,Ll),Ll=my(Ap,Ll),Ll=my(Ep,Ll),Ll=my(Cp,Ll);const tx=Ll>-1?1:0;tx&&(Ll*=Zm/Yn),vt.glyphOffsetArray.length>=Ah.MAX_GLYPHS&&sn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ln.sortKey!==void 0&&vt.addToSortKeyRanges(vt.symbolInstances.length,Ln.sortKey);const aw=Rl(bn,Ln,kl),[sw,ow]=(function(ya,uo){const Jd=ya.length,jl=uo?.values;if(jl?.length>0)for(let ef=0;ef<jl.length;ef+=2){const Dc=jl[ef+1];ya.emplaceBack(M.aP[jl[ef]],Dc[0],Dc[1])}return[Jd,ya.length]})(vt.textAnchorOffsets,aw);vt.symbolInstances.emplaceBack(jt.x,jt.y,Iu.right>=0?Iu.right:-1,Iu.center>=0?Iu.center:-1,Iu.left>=0?Iu.left:-1,Iu.vertical||-1,a_,s_,J0,K1,Q1,J1,ew,tw,iw,nw,rw,Ii,K0,Q0,Y0,W0,tx,0,an,Ll,sw,ow)})(n,Et,xt,i,o,u,Ye,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,ee,[fe,fe,fe,fe],Qe,w,ie,_e,We,q,e,p,C,P,m)};if(it==="line")for(const xt of r(e.geometry,0,0,It,It)){const Et=Sl(xt,qe),vt=He(Et,re,je,i.vertical||Z,o,24,ue,n.overscaling,It);for(const jt of vt)Z&&Y1(n,Z.text,mt,jt)||bt(Et,jt)}else if(it==="line-center"){for(const xt of e.geometry)if(xt.length>1){const Et=Sl(xt,qe),vt=ct(Et,je,i.vertical||Z,o,24,ue);vt&&bt(Et,vt)}}else if(e.type==="Polygon")for(const xt of Yc(e.geometry,0)){const Et=Gt(xt,16);bt(Sl(xt[0],qe,!0),new G(Et.x,Et.y,0))}else if(e.type==="LineString")for(const xt of e.geometry){const Et=Sl(xt,qe);bt(Et,new G(Et[0].x,Et[0].y,0))}else if(e.type==="Point")for(const xt of e.geometry)for(const Et of xt)bt([Et],new G(Et.x,Et.y,0))}function q0(n,e,i,o,u,p,m,v,w,C,P,L,O,F,q){const Z=(function(ue,ie,re,fe,_e,je,Qe,We){const it=fe.layout.get("text-rotate").evaluate(je,{})*Math.PI/180,mt=[];for(const ut of ie.positionedLines)for(const Ye of ut.positionedGlyphs){if(!Ye.rect)continue;const qe=Ye.rect||{};let bt=4,xt=!0,Et=1,vt=0;const jt=(_e||We)&&Ye.vertical,bi=Ye.metrics.advance*Ye.scale/2;if(We&&ie.verticalizable&&(vt=ut.lineOffset/2-(Ye.imageName?-(Yn-Ye.metrics.width*Ye.scale)/2:(Ye.scale-1)*Yn)),Ye.imageName){const Tr=Qe[Ye.imageName];xt=Tr.sdf,Et=Tr.pixelRatio,bt=1/Et}const li=_e?[Ye.x+bi,Ye.y]:[0,0];let vn=_e?[0,0]:[Ye.x+bi+re[0],Ye.y+re[1]-vt],Yr=[0,0];jt&&(Yr=vn,vn=[0,0]);const cr=Ye.metrics.isDoubleResolution?2:1,bn=(Ye.metrics.left-bt)*Ye.scale-bi+vn[0],dn=(-Ye.metrics.top-bt)*Ye.scale+vn[1],Ii=bn+qe.w/cr*Ye.scale/Et,kn=dn+qe.h/cr*Ye.scale/Et,qn=new V(bn,dn),an=new V(Ii,dn),as=new V(bn,kn),Wr=new V(Ii,kn);if(jt){const Tr=new V(-bi,bi- -17),Cn=-Math.PI/2,ur=12-bi,Ln=new V(22-ur,-(Ye.imageName?ur:0)),Sr=new V(...Yr);qn._rotateAround(Cn,Tr)._add(Ln)._add(Sr),an._rotateAround(Cn,Tr)._add(Ln)._add(Sr),as._rotateAround(Cn,Tr)._add(Ln)._add(Sr),Wr._rotateAround(Cn,Tr)._add(Ln)._add(Sr)}if(it){const Tr=Math.sin(it),Cn=Math.cos(it),ur=[Cn,-Tr,Tr,Cn];qn._matMult(ur),an._matMult(ur),as._matMult(ur),Wr._matMult(ur)}const ss=new V(0,0),Uo=new V(0,0);mt.push({tl:qn,tr:an,bl:as,br:Wr,tex:qe,writingMode:ie.writingMode,glyphOffset:li,sectionIndex:Ye.sectionIndex,isSDF:xt,pixelOffsetTL:ss,pixelOffsetBR:Uo,minFontScaleX:0,minFontScaleY:0})}return mt})(0,i,v,u,p,m,o,n.allowVerticalPlacement),$=n.textSizeData;let ee=null;$.kind==="source"?(ee=[ns*u.layout.get("text-size").evaluate(m,{})],ee[0]>_c&&sn(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):$.kind==="composite"&&(ee=[ns*F.compositeTextSizes[0].evaluate(m,{},q),ns*F.compositeTextSizes[1].evaluate(m,{},q)],(ee[0]>_c||ee[1]>_c)&&sn(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,Z,ee,v,p,m,C,e,w.lineStartIndex,w.lineLength,O,q);for(const ue of P)L[ue]=n.text.placedSymbolArray.length-1;return 4*Z.length}function Z0(n){for(const e in n)return n[e];return null}function Y1(n,e,i,o){const u=n.compareText;if(e in u){const p=u[e];for(let m=p.length-1;m>=0;m--)if(o.dist(p[m])<i)return!0}else u[e]=[];return u[e].push(o),!1}const H0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Qy{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,o]=new Uint8Array(e,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const u=o>>4;if(u!==1)throw new Error(`Got v${u} data when expected v1.`);const p=H0[15&o];if(!p)throw new Error("Unrecognized array type.");const[m]=new Uint16Array(e,2,1),[v]=new Uint32Array(e,4,1);return new Qy(v,m,p,e)}constructor(e,i=64,o=Float64Array,u){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=o,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const p=H0.indexOf(this.ArrayType),m=2*e*this.ArrayType.BYTES_PER_ELEMENT,v=e*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-v%8)%8;if(p<0)throw new Error(`Unexpected typed array class: ${o}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+w,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+m+v+w),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+w,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+p]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=e)}add(e,i){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=e,this.coords[this._pos++]=i,o}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Jy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,i,o,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:m,nodeSize:v}=this,w=[0,p.length-1,0],C=[];for(;w.length;){const P=w.pop()||0,L=w.pop()||0,O=w.pop()||0;if(L-O<=v){for(let $=O;$<=L;$++){const ee=m[2*$],ue=m[2*$+1];ee>=e&&ee<=o&&ue>=i&&ue<=u&&C.push(p[$])}continue}const F=O+L>>1,q=m[2*F],Z=m[2*F+1];q>=e&&q<=o&&Z>=i&&Z<=u&&C.push(p[F]),(P===0?e<=q:i<=Z)&&(w.push(O),w.push(F-1),w.push(1-P)),(P===0?o>=q:u>=Z)&&(w.push(F+1),w.push(L),w.push(1-P))}return C}within(e,i,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:p,nodeSize:m}=this,v=[0,u.length-1,0],w=[],C=o*o;for(;v.length;){const P=v.pop()||0,L=v.pop()||0,O=v.pop()||0;if(L-O<=m){for(let $=O;$<=L;$++)X0(p[2*$],p[2*$+1],e,i)<=C&&w.push(u[$]);continue}const F=O+L>>1,q=p[2*F],Z=p[2*F+1];X0(q,Z,e,i)<=C&&w.push(u[F]),(P===0?e-o<=q:i-o<=Z)&&(v.push(O),v.push(F-1),v.push(1-P)),(P===0?e+o>=q:i+o>=Z)&&(v.push(F+1),v.push(L),v.push(1-P))}return w}}function Jy(n,e,i,o,u,p){if(u-o<=i)return;const m=o+u>>1;$0(n,e,m,o,u,p),Jy(n,e,i,o,m-1,1-p),Jy(n,e,i,m+1,u,1-p)}function $0(n,e,i,o,u,p){for(;u>o;){if(u-o>600){const C=u-o+1,P=i-o+1,L=Math.log(C),O=.5*Math.exp(2*L/3),F=.5*Math.sqrt(L*O*(C-O)/C)*(P-C/2<0?-1:1);$0(n,e,i,Math.max(o,Math.floor(i-P*O/C+F)),Math.min(u,Math.floor(i+(C-P)*O/C+F)),p)}const m=e[2*i+p];let v=o,w=u;for(Gm(n,e,o,i),e[2*u+p]>m&&Gm(n,e,o,u);v<w;){for(Gm(n,e,v,w),v++,w--;e[2*v+p]<m;)v++;for(;e[2*w+p]>m;)w--}e[2*o+p]===m?Gm(n,e,o,w):(w++,Gm(n,e,w,u)),w<=i&&(o=w+1),i<=w&&(u=w-1)}}function Gm(n,e,i,o){e_(n,i,o),e_(e,2*i,2*o),e_(e,2*i+1,2*o+1)}function e_(n,e,i){const o=n[e];n[e]=n[i],n[i]=o}function X0(n,e,i,o){const u=n-i,p=e-o;return u*u+p*p}var t_;M.cI=void 0,(t_=M.cI||(M.cI={})).create="create",t_.load="load",t_.fullLoad="fullLoad";let py=null,qm=[];const i_=1e3/60,n_="loadTime",r_="fullLoadTime",W1={mark(n){performance.mark(n)},frame(n){const e=n;py!=null&&qm.push(e-py),py=e},clearMetrics(){py=null,qm=[],performance.clearMeasures(n_),performance.clearMeasures(r_);for(const n in M.cI)performance.clearMarks(M.cI[n])},getPerformanceMetrics(){performance.measure(n_,M.cI.create,M.cI.load),performance.measure(r_,M.cI.create,M.cI.fullLoad);const n=performance.getEntriesByName(n_)[0].duration,e=performance.getEntriesByName(r_)[0].duration,i=qm.length,o=1/(qm.reduce(((p,m)=>p+m),0)/i/1e3),u=qm.filter((p=>p>i_)).reduce(((p,m)=>p+(m-i_)/i_),0);return{loadTime:n,fullLoadTime:e,fps:o,percentDroppedFrames:u/(i+u)*100,totalFrames:i}}};M.$=le,M.A=Ue,M.B=Xa,M.C=Xn,M.D=Tt,M.E=lt,M.F=function([n,e,i]){return e+=90,e*=Math.PI/180,i*=Math.PI/180,{x:n*Math.cos(e)*Math.sin(i),y:n*Math.sin(e)*Math.sin(i),z:n*Math.cos(i)}},M.G=en,M.H=Mi,M.I=Vi,M.J=ah,M.K=function(n){if(on==null){const e=n.navigator?n.navigator.userAgent:null;on=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return on},M.L=class{constructor(n,e){this.target=n,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new op((()=>this.process())),this.subscription=$o(this.target,"message",(i=>this.receive(i)),!1),this.globalScope=Jr(self)?n:window}registerMessageHandler(n,e){this.messageHandlers[n]=e}unregisterMessageHandler(n){delete this.messageHandlers[n]}sendAsync(n,e){return new Promise(((i,o)=>{const u=Math.round(1e18*Math.random()).toString(36).substring(0,10),p=e?$o(e.signal,"abort",(()=>{p?.unsubscribe(),delete this.resolveRejects[u];const w={id:u,type:"<cancel>",origin:location.origin,targetMapId:n.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)}),_m):null;this.resolveRejects[u]={resolve:w=>{p?.unsubscribe(),i(w)},reject:w=>{p?.unsubscribe(),o(w)}};const m=[],v=Object.assign(Object.assign({},n),{id:u,sourceMapId:this.mapId,origin:location.origin,data:Ya(n.data,m)});this.target.postMessage(v,{transfer:m})}))}receive(n){const e=n.data,i=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!=="resource://android"&&location.origin!=="resource://android"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[i];const o=this.abortControllers[i];return delete this.abortControllers[i],void(o&&o.abort())}if(Jr(self)||e.mustQueue)return this.tasks[i]=e,this.taskQueue.push(i),void this.invoker.trigger();this.processTask(i,e)}}process(){if(this.taskQueue.length===0)return;const n=this.taskQueue.shift(),e=this.tasks[n];delete this.tasks[n],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(n,e)}processTask(n,e){return c(this,void 0,void 0,(function*(){if(e.type==="<response>"){const u=this.resolveRejects[n];return delete this.resolveRejects[n],u?void(e.error?u.reject(lc(e.error)):u.resolve(lc(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(n,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const i=lc(e.data),o=new AbortController;this.abortControllers[n]=o;try{const u=yield this.messageHandlers[e.type](e.sourceMapId,i,o);this.completeTask(n,null,u)}catch(u){this.completeTask(n,u)}}))}completeTask(n,e,i){const o=[];delete this.abortControllers[n];const u={id:n,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?Ya(e):null,data:Ya(i,o)};this.target.postMessage(u,{transfer:o})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},M.M=J,M.N=function(){var n=new Ue(16);return Ue!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},M.O=function(n,e,i){var o,u,p,m,v,w,C,P,L,O,F,q,Z=i[0],$=i[1],ee=i[2];return e===n?(n[12]=e[0]*Z+e[4]*$+e[8]*ee+e[12],n[13]=e[1]*Z+e[5]*$+e[9]*ee+e[13],n[14]=e[2]*Z+e[6]*$+e[10]*ee+e[14],n[15]=e[3]*Z+e[7]*$+e[11]*ee+e[15]):(u=e[1],p=e[2],m=e[3],v=e[4],w=e[5],C=e[6],P=e[7],L=e[8],O=e[9],F=e[10],q=e[11],n[0]=o=e[0],n[1]=u,n[2]=p,n[3]=m,n[4]=v,n[5]=w,n[6]=C,n[7]=P,n[8]=L,n[9]=O,n[10]=F,n[11]=q,n[12]=o*Z+v*$+L*ee+e[12],n[13]=u*Z+w*$+O*ee+e[13],n[14]=p*Z+C*$+F*ee+e[14],n[15]=m*Z+P*$+q*ee+e[15]),n},M.P=V,M.Q=function(n,e,i){var o=i[0],u=i[1],p=i[2];return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*o,n[4]=e[4]*u,n[5]=e[5]*u,n[6]=e[6]*u,n[7]=e[7]*u,n[8]=e[8]*p,n[9]=e[9]*p,n[10]=e[10]*p,n[11]=e[11]*p,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},M.R=Zr,M.S=function(n,e,i){var o=e[0],u=e[1],p=e[2],m=e[3],v=e[4],w=e[5],C=e[6],P=e[7],L=e[8],O=e[9],F=e[10],q=e[11],Z=e[12],$=e[13],ee=e[14],ue=e[15],ie=i[0],re=i[1],fe=i[2],_e=i[3];return n[0]=ie*o+re*v+fe*L+_e*Z,n[1]=ie*u+re*w+fe*O+_e*$,n[2]=ie*p+re*C+fe*F+_e*ee,n[3]=ie*m+re*P+fe*q+_e*ue,n[4]=(ie=i[4])*o+(re=i[5])*v+(fe=i[6])*L+(_e=i[7])*Z,n[5]=ie*u+re*w+fe*O+_e*$,n[6]=ie*p+re*C+fe*F+_e*ee,n[7]=ie*m+re*P+fe*q+_e*ue,n[8]=(ie=i[8])*o+(re=i[9])*v+(fe=i[10])*L+(_e=i[11])*Z,n[9]=ie*u+re*w+fe*O+_e*$,n[10]=ie*p+re*C+fe*F+_e*ee,n[11]=ie*m+re*P+fe*q+_e*ue,n[12]=(ie=i[12])*o+(re=i[13])*v+(fe=i[14])*L+(_e=i[15])*Z,n[13]=ie*u+re*w+fe*O+_e*$,n[14]=ie*p+re*C+fe*F+_e*ee,n[15]=ie*m+re*P+fe*q+_e*ue,n},M.T=Of,M.U=function(n,e){const i={};for(let o=0;o<e.length;o++){const u=e[o];u in n&&(i[u]=n[u])}return i},M.V=No,M.W=hi,M.X=xm,M.Y=Yg,M.Z=Ce,M._=c,M.a=Vl,M.a$=si,M.a0=Xe,M.a1=fo,M.a2=Na,M.a3=Kg,M.a4=kd,M.a5=It,M.a6=function(n,e,i){if(!n)return e||{};if(!e)return n||{};const o=jd(n),u=jd(e);(function(m,v){v.removeAll&&(m.add.clear(),m.update.clear(),m.remove.clear(),v.remove.clear());for(const w of v.remove)m.add.delete(w),m.update.delete(w);for(const[w,C]of v.update){const P=m.update.get(w);P&&(v.update.set(w,bm(P,C)),m.update.delete(w))}})(o,u);const p={};if((o.removeAll||u.removeAll)&&(p.removeAll=!0),p.remove=new Set([...o.remove,...u.remove]),p.add=new Map([...o.add,...u.add]),p.update=new Map([...o.update,...u.update]),p.remove.size&&p.add.size)for(const m of p.add.keys())p.remove.delete(m);return(function(m){const v={};return m.removeAll&&(v.removeAll=m.removeAll),m.remove&&(v.remove=Array.from(m.remove)),m.add&&(v.add=Array.from(m.add.values())),m.update&&(v.update=Array.from(m.update.values())),v})(p)},M.a7=function(n,e){const i=new Map;if(n==null||n.type==null)return i;if(n.type==="Feature"){const o=Ld(n,e);return o==null?void 0:(i.set(o,n),i)}if(n.type==="FeatureCollection"){const o=new Set;for(const u of n.features){const p=Ld(u,e);if(p==null||o.has(p))return;o.add(p),i.set(p,u)}return i}},M.a8=function(n,e,i){var o,u;const p=[];if(e.removeAll)n.clear();else if(e.remove)for(const m of e.remove){const v=n.get(m);v&&(p.push(v.geometry),n.delete(m))}if(e.add)for(const m of e.add){const v=Ld(m,i);if(v==null)continue;const w=n.get(v);w&&p.push(w.geometry),p.push(m.geometry),n.set(v,m)}if(e.update)for(const m of e.update){const v=n.get(m.id);if(!v)continue;const w=!!m.newGeometry,C=m.removeAllProperties||((o=m.removeProperties)===null||o===void 0?void 0:o.length)>0||((u=m.addOrUpdateProperties)===null||u===void 0?void 0:u.length)>0;if(!w&&!C)continue;p.push(v.geometry);const P=Object.assign({},v);if(n.set(m.id,P),w&&(p.push(m.newGeometry),P.geometry=m.newGeometry),C){if(P.properties=m.removeAllProperties?{}:Object.assign({},P.properties||{}),m.removeProperties)for(const L of m.removeProperties)delete P.properties[L];if(m.addOrUpdateProperties)for(const{key:L,value:O}of m.addOrUpdateProperties)P.properties[L]=O}}return p},M.a9=zi,M.aA=function(n,{uSize:e,uSizeT:i},{lowerSize:o,upperSize:u}){return n.kind==="source"?o/ns:n.kind==="composite"?en.number(o/ns,u/ns,i):e},M.aB=function(n,e){var i=e[0],o=e[1],u=e[2],p=e[3],m=e[4],v=e[5],w=e[6],C=e[7],P=e[8],L=e[9],O=e[10],F=e[11],q=e[12],Z=e[13],$=e[14],ee=e[15],ue=i*v-o*m,ie=i*w-u*m,re=i*C-p*m,fe=o*w-u*v,_e=o*C-p*v,je=u*C-p*w,Qe=P*Z-L*q,We=P*$-O*q,it=P*ee-F*q,mt=L*$-O*Z,ut=L*ee-F*Z,Ye=O*ee-F*$,qe=ue*Ye-ie*ut+re*mt+fe*it-_e*We+je*Qe;return qe?(n[0]=(v*Ye-w*ut+C*mt)*(qe=1/qe),n[1]=(u*ut-o*Ye-p*mt)*qe,n[2]=(Z*je-$*_e+ee*fe)*qe,n[3]=(O*_e-L*je-F*fe)*qe,n[4]=(w*it-m*Ye-C*We)*qe,n[5]=(i*Ye-u*it+p*We)*qe,n[6]=($*re-q*je-ee*ie)*qe,n[7]=(P*je-O*re+F*ie)*qe,n[8]=(m*ut-v*it+C*Qe)*qe,n[9]=(o*it-i*ut-p*Qe)*qe,n[10]=(q*_e-Z*re+ee*ue)*qe,n[11]=(L*re-P*_e-F*ue)*qe,n[12]=(v*We-m*mt-w*Qe)*qe,n[13]=(i*mt-o*We+u*Qe)*qe,n[14]=(Z*ie-q*fe-$*ue)*qe,n[15]=(P*fe-L*ie+O*ue)*qe,n):null},M.aC=at,M.aD=function(n){var e=n[0],i=n[1];return Math.sqrt(e*e+i*i)},M.aE=function(n){return n[0]=0,n[1]=0,n},M.aF=function(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n},M.aG=pm,M.aH=yr,M.aI=function(n,e,i,o){const u=e.y-n.y,p=e.x-n.x,m=o.y-i.y,v=o.x-i.x,w=m*p-v*u;if(w===0)return null;const C=(v*(n.y-i.y)-m*(n.x-i.x))/w;return new V(n.x+C*p,n.y+C*u)},M.aJ=r,M.aK=bu,M.aL=function(n){let e=1/0,i=1/0,o=-1/0,u=-1/0;for(const p of n)e=Math.min(e,p.x),i=Math.min(i,p.y),o=Math.max(o,p.x),u=Math.max(u,p.y);return[e,i,o,u]},M.aM=Yn,M.aN=ni,M.aO=function(n,e,i,o,u=!1){if(!i[0]&&!i[1])return[0,0];const p=u?o==="map"?-n.bearingInRadians:0:o==="viewport"?n.bearingInRadians:0;if(p){const m=Math.sin(p),v=Math.cos(p);i=[i[0]*v-i[1]*m,i[0]*m+i[1]*v]}return[u?i[0]:ni(e,i[0],n.zoom),u?i[1]:ni(e,i[1],n.zoom)]},M.aQ=ip,M.aR=Um,M.aS=um,M.aT=Qy,M.aU=tn,M.aV=Sd,M.aW=ae,M.aX=yt,M.aY=Oe,M.aZ=ea,M.a_=vm,M.aa=vc,M.ab=25,M.ac=mr,M.ad=n=>{const e=window.document.createElement("video");return e.muted=!0,new Promise((i=>{e.onloadstart=()=>{i(e)};for(const o of n){const u=window.document.createElement("source");ke(o)||(e.crossOrigin="Anonymous"),u.src=o,e.appendChild(u)}}))},M.ae=tt,M.af=function(){return Xi++},M.ag=f,M.ah=Ah,M.ai=Kd,M.aj=Fr,M.ak=ts,M.al=up,M.am=function(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((i,o,u,p)=>{const m=u||p;return e[o]=!m||m.toLowerCase(),""})),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e},M.an=Nt,M.ao=85.051129,M.ap=Qn,M.aq=function(n){return Math.pow(2,n)},M.ar=pt,M.as=Wg,M.at=function(n){return Math.log(n)/Math.LN2},M.au=function(n){var e=n[0],i=n[1];return e*e+i*i},M.av=function(n){if(!n.length)return new Set;const e=Math.max(...n.map((w=>w.canonical.z)));let i=1/0,o=-1/0,u=1/0,p=-1/0;const m=[];for(const w of n){const{x:C,y:P,z:L}=w.canonical,O=Math.pow(2,e-L),F=C*O,q=P*O;m.push({id:w,x:F,y:q}),F<i&&(i=F),F>o&&(o=F),q<u&&(u=q),q>p&&(p=q)}const v=new Set;for(const w of m)w.x!==i&&w.x!==o&&w.y!==u&&w.y!==p||v.add(w.id);return v},M.aw=function(n,e){const i=Math.abs(2*n.wrap)-+(n.wrap<0),o=Math.abs(2*e.wrap)-+(e.wrap<0);return n.overscaledZ-e.overscaledZ||o-i||e.canonical.y-n.canonical.y||e.canonical.x-n.canonical.x},M.ax=class{constructor(n,e){this.max=n,this.onRemove=e,this.reset()}reset(){for(const n in this.data)for(const e of this.data[n])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(n,e,i){const o=n.wrapped().key;this.data[o]===void 0&&(this.data[o]=[]);const u={value:e,timeout:void 0};if(i!==void 0&&(u.timeout=setTimeout((()=>{this.remove(n,u)}),i)),this.data[o].push(u),this.order.push(o),this.order.length>this.max){const p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const e=this.data[n].shift();return e.timeout&&clearTimeout(e.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),e.value}getByKey(n){const e=this.data[n];return e?e[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,e){if(!this.has(n))return this;const i=n.wrapped().key,o=e===void 0?0:this.data[i].indexOf(e),u=this.data[i][o];return this.data[i].splice(o,1),u.timeout&&clearTimeout(u.timeout),this.data[i].length===0&&delete this.data[i],this.onRemove(u.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(n){const e=[];for(const i in this.data)for(const o of this.data[i])n(o.value)||e.push(o);for(const i of e)this.remove(i.value.tileID,i)}},M.ay=function(n,e){let i=0,o=0;if(n.kind==="constant")o=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:u,minZoom:p,maxZoom:m}=n,v=u?Nt(Pr.interpolationFactor(u,e,p,m),0,1):0;n.kind==="camera"?o=en.number(n.minSize,n.maxSize,v):i=v}return{uSizeT:i,uSize:o}},M.b=cs,M.b$=es,M.b0=Ot,M.b1=function(n){var e=new Ue(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e},M.b2=function(n,e,i){return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],n},M.b3=function(n,e){var i=e[0],o=e[1],u=e[2],p=i*i+o*o+u*u;return p>0&&(p=1/Math.sqrt(p)),n[0]=e[0]*p,n[1]=e[1]*p,n[2]=e[2]*p,n},M.b4=Gi,M.b5=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]},M.b6=function(n,e,i){return n[0]=e[0]*i[0],n[1]=e[1]*i[1],n[2]=e[2]*i[2],n[3]=e[3]*i[3],n},M.b7=_t,M.b8=function(n,e,i){const o=e[0]*i[0]+e[1]*i[1]+e[2]*i[2];return o===0?null:(-(n[0]*i[0]+n[1]*i[1]+n[2]*i[2])-i[3])/o},M.b9=Bn,M.bA=function(){return new Float64Array(3)},M.bB=Je,M.bC=function(n,e,i){var o=i[0],u=i[1],p=i[2],m=i[3],v=e[0],w=e[1],C=e[2],P=u*C-p*w,L=p*v-o*C,O=o*w-u*v;return n[0]=v+m*(P+=P)+u*(O+=O)-p*(L+=L),n[1]=w+m*L+p*P-o*O,n[2]=C+m*O+o*L-u*P,n},M.bD=function(n,e,i){const o=(u=[n[0],n[1],n[2],e[0],e[1],e[2],i[0],i[1],i[2]])[0]*((P=u[8])*(m=u[4])-(v=u[5])*(C=u[7]))+u[1]*(-P*(p=u[3])+v*(w=u[6]))+u[2]*(C*p-m*w);var u,p,m,v,w,C,P;if(o===0)return null;const L=Gi([],[e[0],e[1],e[2]],[i[0],i[1],i[2]]),O=Gi([],[i[0],i[1],i[2]],[n[0],n[1],n[2]]),F=Gi([],[n[0],n[1],n[2]],[e[0],e[1],e[2]]),q=si([],L,-n[3]);return Ot(q,q,si([],O,-e[3])),Ot(q,q,si([],F,-i[3])),si(q,q,1/o),q},M.bE=lp,M.bF=function(){return new Float64Array(4)},M.bG=function(n,e,i,o){var u=[],p=[];return u[0]=e[0]-i[0],u[1]=e[1]-i[1],u[2]=e[2]-i[2],p[0]=u[0]*Math.cos(o)-u[1]*Math.sin(o),p[1]=u[0]*Math.sin(o)+u[1]*Math.cos(o),p[2]=u[2],n[0]=p[0]+i[0],n[1]=p[1]+i[1],n[2]=p[2]+i[2],n},M.bH=function(n,e,i,o){var u=[],p=[];return u[0]=e[0]-i[0],u[1]=e[1]-i[1],u[2]=e[2]-i[2],p[0]=u[0],p[1]=u[1]*Math.cos(o)-u[2]*Math.sin(o),p[2]=u[1]*Math.sin(o)+u[2]*Math.cos(o),n[0]=p[0]+i[0],n[1]=p[1]+i[1],n[2]=p[2]+i[2],n},M.bI=function(n,e,i,o){var u=[],p=[];return u[0]=e[0]-i[0],u[1]=e[1]-i[1],u[2]=e[2]-i[2],p[0]=u[2]*Math.sin(o)+u[0]*Math.cos(o),p[1]=u[1],p[2]=u[2]*Math.cos(o)-u[0]*Math.sin(o),n[0]=p[0]+i[0],n[1]=p[1]+i[1],n[2]=p[2]+i[2],n},M.bJ=function(n,e,i){var o=Math.sin(i),u=Math.cos(i),p=e[0],m=e[1],v=e[2],w=e[3],C=e[8],P=e[9],L=e[10],O=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=p*u-C*o,n[1]=m*u-P*o,n[2]=v*u-L*o,n[3]=w*u-O*o,n[8]=p*o+C*u,n[9]=m*o+P*u,n[10]=v*o+L*u,n[11]=w*o+O*u,n},M.bK=function(n,e){const i=Ee(n,360),o=Ee(e,360),u=o-i,p=o>i?u-360:u+360;return Math.abs(u)<Math.abs(p)?u:p},M.bL=function(n){return n[0]=0,n[1]=0,n[2]=0,n},M.bM=function(n,e,i,o){const u=Math.sqrt(n*n+e*e),p=Math.sqrt(i*i+o*o);n/=u,e/=u,i/=p,o/=p;const m=Math.acos(n*i+e*o);return-e*i+n*o>0?m:-m},M.bN=function(n,e){const i=Ee(n,2*Math.PI),o=Ee(e,2*Math.PI);return Math.min(Math.abs(i-o),Math.abs(i-o+2*Math.PI),Math.abs(i-o-2*Math.PI))},M.bO=function(){const n={},e=Te.$version;for(const i in Te.$root){const o=Te.$root[i];if(o.required){let u=null;u=i==="version"?e:o.type==="array"?[]:{},u!=null&&(n[i]=u)}}return n},M.bP=ve,M.bQ=lh,M.bR=function n(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(let o=0;o<e.length;o++)if(!n(e[o],i[o]))return!1;return!0}if(typeof e=="object"&&e!==null&&i!==null){if(typeof i!="object"||Object.keys(e).length!==Object.keys(i).length)return!1;for(const o in e)if(!n(e[o],i[o]))return!1;return!0}return e===i},M.bS=function(n){n=n.slice();const e=Object.create(null);for(let i=0;i<n.length;i++)e[n[i].id]=n[i];for(let i=0;i<n.length;i++)"ref"in n[i]&&(n[i]=wi(n[i],e[n[i].ref]));return n},M.bT=function(n,e){if(n.type==="custom")return new ym(n,e);switch(n.type){case"background":return new yi(n,e);case"circle":return new Lf(n,e);case"color-relief":return new Tg(n,e);case"fill":return new Cg(n,e);case"fill-extrusion":return new nm(n,e);case"heatmap":return new bg(n,e);case"hillshade":return new xn(n,e);case"line":return new am(n,e);case"raster":return new Js(n,e);case"symbol":return new xc(n,e)}},M.bU=n=>n.type==="raster",M.bV=Qr,M.bW=function(n,e){if(!n)return[{command:"setStyle",args:[e]}];let i=[];try{if(!At(n.version,e.version))return[{command:"setStyle",args:[e]}];At(n.center,e.center)||i.push({command:"setCenter",args:[e.center]}),At(n.state,e.state)||i.push({command:"setGlobalState",args:[e.state]}),At(n.centerAltitude,e.centerAltitude)||i.push({command:"setCenterAltitude",args:[e.centerAltitude]}),At(n.zoom,e.zoom)||i.push({command:"setZoom",args:[e.zoom]}),At(n.bearing,e.bearing)||i.push({command:"setBearing",args:[e.bearing]}),At(n.pitch,e.pitch)||i.push({command:"setPitch",args:[e.pitch]}),At(n.roll,e.roll)||i.push({command:"setRoll",args:[e.roll]}),At(n.sprite,e.sprite)||i.push({command:"setSprite",args:[e.sprite]}),At(n.glyphs,e.glyphs)||i.push({command:"setGlyphs",args:[e.glyphs]}),At(n.transition,e.transition)||i.push({command:"setTransition",args:[e.transition]}),At(n.light,e.light)||i.push({command:"setLight",args:[e.light]}),At(n.terrain,e.terrain)||i.push({command:"setTerrain",args:[e.terrain]}),At(n.sky,e.sky)||i.push({command:"setSky",args:[e.sky]}),At(n.projection,e.projection)||i.push({command:"setProjection",args:[e.projection]});const o={},u=[];(function(m,v,w,C){let P;for(P in v=v||{},m=m||{})Object.prototype.hasOwnProperty.call(m,P)&&(Object.prototype.hasOwnProperty.call(v,P)||qi(P,w,C));for(P in v)Object.prototype.hasOwnProperty.call(v,P)&&(Object.prototype.hasOwnProperty.call(m,P)?At(m[P],v[P])||(m[P].type==="geojson"&&v[P].type==="geojson"&&Fn(m,v,P)?Rt(w,{command:"setGeoJSONSourceData",args:[P,v[P].data]}):Zi(P,v,w,C)):Wt(P,v,w))})(n.sources,e.sources,u,o);const p=[];n.layers&&n.layers.forEach((m=>{"source"in m&&o[m.source]?i.push({command:"removeLayer",args:[m.id]}):p.push(m)})),i=i.concat(u),(function(m,v,w){v=v||[];const C=(m=m||[]).map(ln),P=v.map(ln),L=m.reduce(Dn,{}),O=v.reduce(Dn,{}),F=C.slice(),q=Object.create(null);let Z,$,ee,ue,ie;for(let re=0,fe=0;re<C.length;re++)Z=C[re],Object.prototype.hasOwnProperty.call(O,Z)?fe++:(Rt(w,{command:"removeLayer",args:[Z]}),F.splice(F.indexOf(Z,fe),1));for(let re=0,fe=0;re<P.length;re++)Z=P[P.length-1-re],F[F.length-1-re]!==Z&&(Object.prototype.hasOwnProperty.call(L,Z)?(Rt(w,{command:"removeLayer",args:[Z]}),F.splice(F.lastIndexOf(Z,F.length-fe),1)):fe++,ue=F[F.length-re],Rt(w,{command:"addLayer",args:[O[Z],ue]}),F.splice(F.length-re,0,Z),q[Z]=!0);for(let re=0;re<P.length;re++)if(Z=P[re],$=L[Z],ee=O[Z],!q[Z]&&!At($,ee))if(At($.source,ee.source)&&At($["source-layer"],ee["source-layer"])&&At($.type,ee.type)){for(ie in Nn($.layout,ee.layout,w,Z,null,"setLayoutProperty"),Nn($.paint,ee.paint,w,Z,null,"setPaintProperty"),At($.filter,ee.filter)||Rt(w,{command:"setFilter",args:[Z,ee.filter]}),At($.minzoom,ee.minzoom)&&At($.maxzoom,ee.maxzoom)||Rt(w,{command:"setLayerZoomRange",args:[Z,ee.minzoom,ee.maxzoom]}),$)Object.prototype.hasOwnProperty.call($,ie)&&ie!=="layout"&&ie!=="paint"&&ie!=="filter"&&ie!=="metadata"&&ie!=="minzoom"&&ie!=="maxzoom"&&(ie.indexOf("paint.")===0?Nn($[ie],ee[ie],w,Z,ie.slice(6),"setPaintProperty"):At($[ie],ee[ie])||Rt(w,{command:"setLayerProperty",args:[Z,ie,ee[ie]]}));for(ie in ee)Object.prototype.hasOwnProperty.call(ee,ie)&&!Object.prototype.hasOwnProperty.call($,ie)&&ie!=="layout"&&ie!=="paint"&&ie!=="filter"&&ie!=="metadata"&&ie!=="minzoom"&&ie!=="maxzoom"&&(ie.indexOf("paint.")===0?Nn($[ie],ee[ie],w,Z,ie.slice(6),"setPaintProperty"):At($[ie],ee[ie])||Rt(w,{command:"setLayerProperty",args:[Z,ie,ee[ie]]}))}else Rt(w,{command:"removeLayer",args:[Z]}),ue=F[F.lastIndexOf(Z)+1],Rt(w,{command:"addLayer",args:[ee,ue]})})(p,e.layers,i)}catch(o){console.warn("Unable to compute style diff:",o),i=[{command:"setStyle",args:[e]}]}return i},M.bX=function(n){const e=[],i=n.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),n.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},M.bY=va,M.bZ=Kr,M.b_=class extends Gr{constructor(n,e){super(n,e),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},M.ba=function(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n},M.bb=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]},M.bc=Qg,M.bd=Dh,M.be=function(n,e,i,o,u){var p=1/Math.tan(e/2);if(n[0]=p/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=p,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,u!=null&&u!==1/0){var m=1/(o-u);n[10]=(u+o)*m,n[14]=2*u*o*m}else n[10]=-1,n[14]=-2*o;return n},M.bf=function(n){var e=new Ue(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},M.bg=function(n,e,i){var o=Math.sin(i),u=Math.cos(i),p=e[0],m=e[1],v=e[2],w=e[3],C=e[4],P=e[5],L=e[6],O=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=p*u+C*o,n[1]=m*u+P*o,n[2]=v*u+L*o,n[3]=w*u+O*o,n[4]=C*u-p*o,n[5]=P*u-m*o,n[6]=L*u-v*o,n[7]=O*u-w*o,n},M.bh=function(n,e,i){var o=Math.sin(i),u=Math.cos(i),p=e[4],m=e[5],v=e[6],w=e[7],C=e[8],P=e[9],L=e[10],O=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=p*u+C*o,n[5]=m*u+P*o,n[6]=v*u+L*o,n[7]=w*u+O*o,n[8]=C*u-p*o,n[9]=P*u-m*o,n[10]=L*u-v*o,n[11]=O*u-w*o,n},M.bi=function(){const n=new Float32Array(16);return pt(n),n},M.bj=function(){const n=new Float64Array(16);return pt(n),n},M.bk=function(){return new Float64Array(16)},M.bl=function(n,e,i){const o=new Float64Array(4);return Je(o,n,e-90,i),o},M.bm=function(n,e,i,o){var u,p,m,v,w,C=e[0],P=e[1],L=e[2],O=e[3],F=i[0],q=i[1],Z=i[2],$=i[3];return(p=C*F+P*q+L*Z+O*$)<0&&(p=-p,F=-F,q=-q,Z=-Z,$=-$),1-p>Ve?(u=Math.acos(p),m=Math.sin(u),v=Math.sin((1-o)*u)/m,w=Math.sin(o*u)/m):(v=1-o,w=o),n[0]=v*C+w*F,n[1]=v*P+w*q,n[2]=v*L+w*Z,n[3]=v*O+w*$,n},M.bn=function(n){const e=new Float64Array(9);var i,o,u,p,m,v,w,C,P,L,O,F,q,Z,$,ee,ue,ie;L=(u=(o=n)[0])*(w=u+u),O=(p=o[1])*w,q=(m=o[2])*w,Z=m*(C=p+p),ee=(v=o[3])*w,ue=v*C,ie=v*(P=m+m),(i=e)[0]=1-(F=p*C)-($=m*P),i[3]=O-ie,i[6]=q+ue,i[1]=O+ie,i[4]=1-L-$,i[7]=Z-ee,i[2]=q-ue,i[5]=Z+ee,i[8]=1-L-F;const re=ea(-Math.asin(Nt(e[2],-1,1)));let fe,_e;return Math.hypot(e[5],e[8])<.001?(fe=0,_e=-ea(Math.atan2(e[3],e[4]))):(fe=ea(e[5]===0&&e[8]===0?0:Math.atan2(e[5],e[8])),_e=ea(e[1]===0&&e[0]===0?0:Math.atan2(e[1],e[0]))),{roll:fe,pitch:re+90,bearing:_e}},M.bo=function(n,e){return n.roll==e.roll&&n.pitch==e.pitch&&n.bearing==e.bearing},M.bp=Qt,M.bq=xl,M.br=ja,M.bs=ro,M.bt=pr,M.bu=ot,M.bv=St,M.bw=Hn,M.bx=function(n,e,i,o,u){return ot(o,u,Nt((n-e)/(i-e),0,1))},M.by=function(n,e,i,o){return n[0]=e[0]+i[0]*o,n[1]=e[1]+i[1]*o,n[2]=e[2]+i[2]*o,n},M.bz=Ee,M.c=Y,M.c$=class{constructor(n){this._marks={start:[n.url,"start"].join("#"),end:[n.url,"end"].join("#"),measure:n.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let n=performance.getEntriesByName(this._marks.measure);return n.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),n=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),n}},M.c0=class extends Gr{constructor(n,e){super(n,e),this.current=qr}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let e=1;e<16;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},M.c1=fc,M.c2=class extends Gr{constructor(n,e){super(n,e),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},M.c3=class extends Gr{constructor(n,e){super(n,e),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},M.c4=gt,M.c5=function(n,e){var i=Math.sin(e),o=Math.cos(e);return n[0]=o,n[1]=i,n[2]=0,n[3]=-i,n[4]=o,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},M.c6=function(n,e,i){var o=e[0],u=e[1],p=e[2];return n[0]=o*i[0]+u*i[3]+p*i[6],n[1]=o*i[1]+u*i[4]+p*i[7],n[2]=o*i[2]+u*i[5]+p*i[8],n},M.c7=function(n,e,i,o,u,p,m){var v=1/(e-i),w=1/(o-u),C=1/(p-m);return n[0]=-2*v,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*w,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*C,n[11]=0,n[12]=(e+i)*v,n[13]=(u+o)*w,n[14]=(m+p)*C,n[15]=1,n},M.c8=class extends Gr{constructor(n,e){super(n,e),this.current=new Array}set(n){if(n!=this.current){this.current=n;const e=new Float32Array(4*n.length);for(let i=0;i<n.length;i++)e[4*i]=n[i].r,e[4*i+1]=n[i].g,e[4*i+2]=n[i].b,e[4*i+3]=n[i].a;this.gl.uniform4fv(this.location,e)}}},M.c9=class extends Gr{constructor(n,e){super(n,e),this.current=new Array}set(n){if(n!=this.current){this.current=n;const e=new Float32Array(n);this.gl.uniform1fv(this.location,e)}}},M.cA=function(n,e){var i;if(!Nl[e])return!1;const o=n?.target,u=((i=o?.ownerDocument)===null||i===void 0?void 0:i.defaultView)||window;return n instanceof u.MouseEvent||n instanceof u.WheelEvent},M.cB=function(n,e){return Fs[e]&&"touches"in n},M.cC=function(n){return Fs[n]||Nl[n]},M.cD=function(n,e,i){var o=e[0],u=e[1];return n[0]=i[0]*o+i[4]*u+i[12],n[1]=i[1]*o+i[5]*u+i[13],n},M.cE=function(n,e){const{x:i,y:o}=zi.fromLngLat(e);return!(n<0||n>25||o<0||o>=1||i<0||i>=1)},M.cF=function(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},M.cG=class extends ml{},M.cH=W1,M.cJ=pe,M.cK=function(n,e){Y.REGISTERED_PROTOCOLS[n]=e},M.cL=function(n){delete Y.REGISTERED_PROTOCOLS[n]},M.cM=function(n,e){const i={};for(let u=0;u<n.length;u++){const p=e&&e[n[u].id]||Hs(n[u]);e&&(e[n[u].id]=p);let m=i[p];m||(m=i[p]=[]),m.push(n[u])}const o=[];for(const u in i)o.push(i[u]);return o},M.cN=wt,M.cO=wm,M.cP=Vm,M.cQ=Jf,M.cR=function(n){var e;n.bucket.createArrays(),n.bucket.tilePixelRatio=It/(512*n.bucket.overscaling),n.bucket.compareText={},n.bucket.iconsNeedLinear=!1;const i=n.bucket.layers[0],o=i.layout,u=i._unevaluatedLayout._values,p={layoutIconSize:u["icon-size"].possiblyEvaluate(new Mi(n.bucket.zoom+1),n.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new Mi(n.bucket.zoom+1),n.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new Mi(18))};if(n.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:L}=n.bucket.textSizeData;p.compositeTextSizes=[u["text-size"].possiblyEvaluate(new Mi(P),n.canonical),u["text-size"].possiblyEvaluate(new Mi(L),n.canonical)]}if(n.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:L}=n.bucket.iconSizeData;p.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new Mi(P),n.canonical),u["icon-size"].possiblyEvaluate(new Mi(L),n.canonical)]}const m=o.get("text-line-height")*Yn,v=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",w=o.get("text-keep-upright"),C=o.get("text-size");for(const P of n.bucket.features){const L=o.get("text-font").evaluate(P,{},n.canonical).join(","),O=C.evaluate(P,{},n.canonical),F=p.layoutTextSize.evaluate(P,{},n.canonical),q=p.layoutIconSize.evaluate(P,{},n.canonical),Z={horizontal:{},vertical:void 0},$=P.text;let ee,ue=[0,0];if($){const fe=$.toString(),_e=o.get("text-letter-spacing").evaluate(P,{},n.canonical)*Yn,je=ch(fe)?_e:0,Qe=o.get("text-anchor").evaluate(P,{},n.canonical),We=Rl(i,P,n.canonical);if(!We){const Ye=o.get("text-radial-offset").evaluate(P,{},n.canonical);ue=Ye?Ai(Qe,[Ye*Yn,pi]):o.get("text-offset").evaluate(P,{},n.canonical).map((qe=>qe*Yn))}let it=v?"center":o.get("text-justify").evaluate(P,{},n.canonical);const mt=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(P,{},n.canonical)*Yn:1/0,ut=()=>{n.bucket.allowVerticalPlacement&&Cs(fe)&&(Z.vertical=Pd($,n.glyphMap,n.glyphPositions,n.imagePositions,L,mt,m,Qe,"left",je,ue,M.az.vertical,!0,F,O))};if(!v&&We){const Ye=new Set;if(it==="auto")for(let bt=0;bt<We.values.length;bt+=2)Ye.add(Um(We.values[bt]));else Ye.add(it);let qe=!1;for(const bt of Ye)if(!Z.horizontal[bt])if(qe)Z.horizontal[bt]=Z.horizontal[0];else{const xt=Pd($,n.glyphMap,n.glyphPositions,n.imagePositions,L,mt,m,"center",bt,je,ue,M.az.horizontal,!1,F,O);xt&&(Z.horizontal[bt]=xt,qe=xt.positionedLines.length===1)}ut()}else{it==="auto"&&(it=Um(Qe));const Ye=Pd($,n.glyphMap,n.glyphPositions,n.imagePositions,L,mt,m,Qe,it,je,ue,M.az.horizontal,!1,F,O);Ye&&(Z.horizontal[it]=Ye),ut(),Cs(fe)&&v&&w&&(Z.vertical=Pd($,n.glyphMap,n.glyphPositions,n.imagePositions,L,mt,m,Qe,it,je,ue,M.az.vertical,!1,F,O))}}let ie=!1;if(P.icon&&P.icon.name){const fe=n.imageMap[P.icon.name];fe&&(ee=dm(n.imagePositions[P.icon.name],o.get("icon-offset").evaluate(P,{},n.canonical),o.get("icon-anchor").evaluate(P,{},n.canonical)),ie=!!fe.sdf,n.bucket.sdfIcons===void 0?n.bucket.sdfIcons=ie:n.bucket.sdfIcons!==ie&&sn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(fe.pixelRatio!==n.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(n.bucket.iconsNeedLinear=!0))}const re=Z0(Z.horizontal)||Z.vertical;(e=n.bucket).iconsInText||(e.iconsInText=!!re&&re.iconsInText),(re||ee)&&X1(n.bucket,P,Z,ee,n.imageMap,p,F,q,ue,ie,n.canonical,n.subdivisionGranularity)}n.showCollisionBoxes&&n.bucket.generateCollisionDebugBuffers()},M.cS=Tu,M.cT=mc,M.cU=vh,M.cV=function(n){const e=new Wf;return(function(i,o){for(const u in i.layers)o.writeMessage(3,wp,i.layers[u])})(n,e),e.finish()},M.cW=function(n,e,i,o,u,p){let m=s(n,e,i,u,0);return m=s(m,e,o,p,1),m},M.cX=class{constructor(n){this.maxEntries=n,this.map=new Map}get(n){const e=this.map.get(n);return e!==void 0&&(this.map.delete(n),this.map.set(n,e)),e}set(n,e){if(this.map.has(n))this.map.delete(n);else if(this.map.size>=this.maxEntries){const i=this.map.keys().next().value;this.map.delete(i)}this.map.set(n,e)}clear(){this.map.clear()}},M.cY=gi,M.cZ=Wf,M.c_=Wd,M.ca=class extends to{},M.cb=Rg,M.cc=class extends nn{},M.cd=gd,M.ce=function(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},M.cf=Oo,M.cg=function(n,e,i){var o=e[0],u=e[1],p=e[2],m=i[3]*o+i[7]*u+i[11]*p+i[15];return n[0]=(i[0]*o+i[4]*u+i[8]*p+i[12])/(m=m||1),n[1]=(i[1]*o+i[5]*u+i[9]*p+i[13])/m,n[2]=(i[2]*o+i[6]*u+i[10]*p+i[14])/m,n},M.ch=class extends gl{},M.ci=class extends t{},M.cj=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]&&n[4]===e[4]&&n[5]===e[5]&&n[6]===e[6]&&n[7]===e[7]&&n[8]===e[8]&&n[9]===e[9]&&n[10]===e[10]&&n[11]===e[11]&&n[12]===e[12]&&n[13]===e[13]&&n[14]===e[14]&&n[15]===e[15]},M.ck=function(n,e){var i=n[0],o=n[1],u=n[2],p=n[3],m=n[4],v=n[5],w=n[6],C=n[7],P=n[8],L=n[9],O=n[10],F=n[11],q=n[12],Z=n[13],$=n[14],ee=n[15],ue=e[0],ie=e[1],re=e[2],fe=e[3],_e=e[4],je=e[5],Qe=e[6],We=e[7],it=e[8],mt=e[9],ut=e[10],Ye=e[11],qe=e[12],bt=e[13],xt=e[14],Et=e[15];return Math.abs(i-ue)<=Ve*Math.max(1,Math.abs(i),Math.abs(ue))&&Math.abs(o-ie)<=Ve*Math.max(1,Math.abs(o),Math.abs(ie))&&Math.abs(u-re)<=Ve*Math.max(1,Math.abs(u),Math.abs(re))&&Math.abs(p-fe)<=Ve*Math.max(1,Math.abs(p),Math.abs(fe))&&Math.abs(m-_e)<=Ve*Math.max(1,Math.abs(m),Math.abs(_e))&&Math.abs(v-je)<=Ve*Math.max(1,Math.abs(v),Math.abs(je))&&Math.abs(w-Qe)<=Ve*Math.max(1,Math.abs(w),Math.abs(Qe))&&Math.abs(C-We)<=Ve*Math.max(1,Math.abs(C),Math.abs(We))&&Math.abs(P-it)<=Ve*Math.max(1,Math.abs(P),Math.abs(it))&&Math.abs(L-mt)<=Ve*Math.max(1,Math.abs(L),Math.abs(mt))&&Math.abs(O-ut)<=Ve*Math.max(1,Math.abs(O),Math.abs(ut))&&Math.abs(F-Ye)<=Ve*Math.max(1,Math.abs(F),Math.abs(Ye))&&Math.abs(q-qe)<=Ve*Math.max(1,Math.abs(q),Math.abs(qe))&&Math.abs(Z-bt)<=Ve*Math.max(1,Math.abs(Z),Math.abs(bt))&&Math.abs($-xt)<=Ve*Math.max(1,Math.abs($),Math.abs(xt))&&Math.abs(ee-Et)<=Ve*Math.max(1,Math.abs(ee),Math.abs(Et))},M.cl=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},M.cm=n=>n.type==="symbol",M.cn=n=>n.type==="circle",M.co=n=>n.type==="heatmap",M.cp=n=>n.type==="line",M.cq=n=>n.type==="fill",M.cr=n=>n.type==="fill-extrusion",M.cs=n=>n.type==="hillshade",M.ct=n=>n.type==="color-relief",M.cu=n=>n.type==="background",M.cv=n=>n.type==="custom",M.cw=zt,M.cx=function(n,e,i){if(e<=0)return n;const o=1/e;return i===void 0||Math.abs(i)<1e-10?Math.round(n*o)/o:(i>0?Math.ceil(n*o-1e-9):Math.floor(n*o+1e-10))/o},M.cy=function(n,e,i){const o=Pt(e.x-i.x,e.y-i.y),u=Pt(n.x-i.x,n.y-i.y);var p,m;return ea(Math.atan2(o[0]*u[1]-o[1]*u[0],(p=o)[0]*(m=u)[0]+p[1]*m[1]))},M.cz=Ht,M.d=ke,M.d0=function(n,e,i,o,u){return c(this,void 0,void 0,(function*(){if(Xe())try{return yield fo(n,e,i,o,u)}catch{}return(function(p,m,v,w,C){const P=p.width,L=p.height;ba&&Os||(ba=new OffscreenCanvas(P,L),Os=ba.getContext("2d",{willReadFrequently:!0})),ba.width=P,ba.height=L,Os.drawImage(p,0,0,P,L);const O=Os.getImageData(m,v,w,C);return Os.clearRect(0,0,P,L),O.data})(n,e,i,o,u)}))},M.d1=gh,M.d2=X,M.d3=class{constructor(n,e){this.layers={[Kd]:this},this.name=Kd,this.version=e?e.version:1,this.extent=e?e.extent:4096,this.length=n.length,this.features=n}feature(n){return new hy(this.features[n],this.extent)}},M.d4=nc,M.d5=za,M.e=Li,M.f=n=>c(void 0,void 0,void 0,(function*(){if(n.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(n)],{type:"image/png"});try{return createImageBitmap(e)}catch(i){throw new Error(`Could not load image because of ${i.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),M.g=W,M.h=n=>new Promise(((e,i)=>{const o=new Image;o.onload=()=>{e(o),URL.revokeObjectURL(o.src),o.onload=null,window.requestAnimationFrame((()=>{o.src=ho}))},o.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const u=new Blob([new Uint8Array(n)],{type:"image/png"});o.src=n.byteLength?URL.createObjectURL(u):ho})),M.i=Jr,M.j=(n,e)=>Pe(Li(n,{type:"json"}),e),M.k=$e,M.l=nt,M.m=Pe,M.n=(n,e)=>Pe(Li(n,{type:"arrayBuffer"}),e),M.o=function(n){return new Wf(n).readFields(Ug,[])},M.p=cm,M.q=function(n){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(n))},M.r=md,M.s=$o,M.t=En,M.u=Te,M.v=ou,M.w=sn,M.x=hh,M.y=$a,M.z=Qs})),I("worker",["./shared"],(function(M){class c{constructor(Y,W){this.keyCache={},Y&&this.replace(Y,W)}replace(Y,W){this._layerConfigs={},this._layers={},this.update(Y,[],W)}update(Y,W,J){for(const ve of Y){this._layerConfigs[ve.id]=ve;const Pe=this._layers[ve.id]=M.bT(ve,J);Pe._featureFilter=M.aj(Pe.filter,J),this.keyCache[ve.id]&&delete this.keyCache[ve.id]}for(const ve of W)delete this.keyCache[ve],delete this._layerConfigs[ve],delete this._layers[ve];this.familiesBySource={};const pe=M.cM(Object.values(this._layerConfigs),this.keyCache);for(const ve of pe){const Pe=ve.map((lt=>this._layers[lt.id])),ke=Pe[0];if(ke.isHidden())continue;const ze=ke.source||"";let Re=this.familiesBySource[ze];Re||(Re=this.familiesBySource[ze]={});const nt=ke.sourceLayer||M.ai;let $e=Re[nt];$e||($e=Re[nt]=[]),$e.push(Pe)}}}class V{constructor(Y){const W={},J=[];for(const ke in Y){const ze=Y[ke],Re=W[ke]={};for(const nt in ze){const $e=ze[+nt];if(!$e||$e.bitmap.width===0||$e.bitmap.height===0)continue;const lt={x:0,y:0,w:$e.bitmap.width+2,h:$e.bitmap.height+2};J.push(lt),Re[nt]={rect:lt,metrics:$e.metrics}}}const{w:pe,h:ve}=M.p(J),Pe=new M.r({width:pe||1,height:ve||1});for(const ke in Y){const ze=Y[ke];for(const Re in ze){const nt=ze[+Re];if(!nt||nt.bitmap.width===0||nt.bitmap.height===0)continue;const $e=W[ke][Re].rect;M.r.copy(nt.bitmap,Pe,{x:0,y:0},{x:$e.x+1,y:$e.y+1},nt.bitmap)}}this.image=Pe,this.positions=W}}M.cN("GlyphAtlas",V);class X{constructor(Y){this.tileID=new M.a2(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.uid=Y.uid,this.zoom=Y.zoom,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Y.showCollisionBoxes,this.collectResourceTiming=!!Y.collectResourceTiming,this.returnDependencies=!!Y.returnDependencies,this.promoteId=Y.promoteId,this.inFlightDependencies=[]}parse(Y,W,J,pe,ve){return M._(this,void 0,void 0,(function*(){this.status="parsing",this.data=Y,this.collisionBoxArray=new M.ag;const Pe=new M.cO(Object.keys(Y.layers).sort()),ke=new M.cP(this.tileID,this.promoteId);ke.bucketLayerIDs=[];const ze={},Re={featureIndex:ke,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:J,subdivisionGranularity:ve},nt=W.familiesBySource[this.source];for(const tt in nt){const Tn=Y.layers[tt];if(!Tn)continue;Tn.version===1&&M.w(`Vector tile source "${this.source}" layer "${tt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Er=Pe.encode(tt),Br=[];for(let ci=0;ci<Tn.length;ci++){const ht=Tn.feature(ci),qt=ke.getId(ht,tt);Br.push({feature:ht,id:qt,index:ci,sourceLayerIndex:Er})}for(const ci of nt[tt]){const ht=ci[0];ht.source!==this.source&&M.w(`layer.source = ${ht.source} does not equal this.source = ${this.source}`),ht.isHidden(this.zoom,!0)||(K(ci,this.zoom,J),(ze[ht.id]=ht.createBucket({index:ke.bucketLayerIDs.length,layers:ci,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Er,sourceID:this.source})).populate(Br,Re,this.tileID.canonical),ke.bucketLayerIDs.push(ci.map((qt=>qt.id))))}}const $e=M.bY(Re.glyphDependencies,(tt=>Object.keys(tt).map(Number)));this.inFlightDependencies.forEach((tt=>tt?.abort())),this.inFlightDependencies=[];let lt=Promise.resolve({});if(Object.keys($e).length){const tt=new AbortController;this.inFlightDependencies.push(tt),lt=pe.sendAsync({type:"GG",data:{stacks:$e,source:this.source,tileID:this.tileID,type:"glyphs"}},tt)}const Te=Object.keys(Re.iconDependencies);let Ut=Promise.resolve({});if(Te.length){const tt=new AbortController;this.inFlightDependencies.push(tt),Ut=pe.sendAsync({type:"GI",data:{icons:Te,source:this.source,tileID:this.tileID,type:"icons"}},tt)}const wi=Object.keys(Re.patternDependencies);let At=Promise.resolve({});if(wi.length){const tt=new AbortController;this.inFlightDependencies.push(tt),At=pe.sendAsync({type:"GI",data:{icons:wi,source:this.source,tileID:this.tileID,type:"patterns"}},tt)}const Rt=Re.dashDependencies;let Wt=Promise.resolve({});if(Object.keys(Rt).length){const tt=new AbortController;this.inFlightDependencies.push(tt),Wt=pe.sendAsync({type:"GDA",data:{dashes:Rt}},tt)}const[qi,Zi,Fn,Nn]=yield Promise.all([lt,Ut,At,Wt]),ln=new V(qi),Dn=new M.cQ(Zi,Fn);for(const tt in ze){const Tn=ze[tt];Tn instanceof M.ah?(K(Tn.layers,this.zoom,J),M.cR({bucket:Tn,glyphMap:qi,glyphPositions:ln.positions,imageMap:Zi,imagePositions:Dn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Re.subdivisionGranularity})):Tn.hasDependencies&&(Tn instanceof M.cS||Tn instanceof M.cT||Tn instanceof M.cU)&&(K(Tn.layers,this.zoom,J),Tn.addFeatures(Re,this.tileID.canonical,Dn.patternPositions,Nn))}return this.status="done",{buckets:Object.values(ze).filter((tt=>!tt.isEmpty())),featureIndex:ke,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ln.image,imageAtlas:Dn,dashPositions:Nn,glyphMap:this.returnDependencies?qi:null,iconMap:this.returnDependencies?Zi:null,glyphPositions:this.returnDependencies?ln.positions:null}}))}}function K(Ce,Y,W){const J=new M.H(Y);for(const pe of Ce)pe.recalculate(J,W)}class te{constructor(Y,W,J,pe,ve){this.type=Y,this.properties=J||{},this.extent=ve,this.pointsArray=W,this.id=pe}loadGeometry(){return this.pointsArray.map((Y=>Y.map((W=>new M.P(W.x,W.y)))))}}class de{constructor(Y,W,J){this.version=2,this._myFeatures=Y,this.name=W,this.length=Y.length,this.extent=J}feature(Y){return this._myFeatures[Y]}}class De{constructor(){this.layers={}}addLayer(Y){this.layers[Y.name]=Y}}function Ze(Ce){let Y=M.cV(Ce);return Y.byteOffset===0&&Y.byteLength===Y.buffer.byteLength||(Y=new Uint8Array(Y)),{vectorTile:Ce,rawData:Y.buffer}}function xe(Ce,Y,W){const{extent:J}=Ce,pe=Math.pow(2,W.z-Y.z),ve=(W.x-Y.x*pe)*J,Pe=(W.y-Y.y*pe)*J,ke=[];for(let ze=0;ze<Ce.length;ze++){const Re=Ce.feature(ze);let nt=Re.loadGeometry();for(const lt of nt)for(const Te of lt)Te.x=Te.x*pe-ve,Te.y=Te.y*pe-Pe;const $e=128;nt=M.cW(nt,Re.type,-$e,-$e,J+$e,J+$e),nt.length!==0&&ke.push(new te(Re.type,nt,Re.properties,Re.id,J))}return new de(ke,Ce.name,J)}class le{constructor(Y,W,J){this.actor=Y,this.layerIndex=W,this.availableImages=J,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new M.cX(1e3)}loadVectorTile(Y,W){return M._(this,void 0,void 0,(function*(){const J=yield M.n(Y.request,W);try{return{vectorTile:Y.encoding!=="mlt"?new M.cY(new M.cZ(J.data)):new M.c_(J.data),rawData:J.data,cacheControl:J.cacheControl,expires:J.expires}}catch(pe){const ve=new Uint8Array(J.data);let Pe=`Unable to parse the tile at ${Y.request.url}, `;throw Pe+=ve[0]===31&&ve[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${pe.message}`,new Error(Pe)}}))}loadTile(Y){return M._(this,void 0,void 0,(function*(){const{uid:W,overzoomParameters:J}=Y;J&&(Y.request=J.overzoomRequest);const pe=!!(Y&&Y.request&&Y.request.collectResourceTiming)&&new M.c$(Y.request),ve=new X(Y);this.loading[W]=ve;const Pe=new AbortController;ve.abort=Pe;try{const ke=yield this.loadVectorTile(Y,Pe);if(delete this.loading[W],!ke)return null;if(J){const lt=this._getOverzoomTile(Y,ke.vectorTile);ke.rawData=lt.rawData,ke.vectorTile=lt.vectorTile}const ze=ke.rawData,Re={};ke.expires&&(Re.expires=ke.expires),ke.cacheControl&&(Re.cacheControl=ke.cacheControl);const nt={};if(pe){const lt=pe.finish();lt&&(nt.resourceTiming=JSON.parse(JSON.stringify(lt)))}ve.vectorTile=ke.vectorTile;const $e=ve.parse(ke.vectorTile,this.layerIndex,this.availableImages,this.actor,Y.subdivisionGranularity);this.loaded[W]=ve,this.fetching[W]={rawTileData:ze,cacheControl:Re,resourceTiming:nt};try{const lt=yield $e;return M.e({rawTileData:ze.slice(0),encoding:Y.encoding},lt,Re,nt)}finally{delete this.fetching[W]}}catch(ke){throw delete this.loading[W],ve.status="done",this.loaded[W]=ve,ke}}))}_getOverzoomTile(Y,W){const{tileID:J,source:pe,overzoomParameters:ve}=Y,{maxZoomTileID:Pe}=ve,ke=`${Pe.key}_${J.key}`,ze=this.overzoomedTileResultCache.get(ke);if(ze)return ze;const Re=new De,nt=this.layerIndex.familiesBySource[pe];for(const lt in nt){const Te=W.layers[lt];if(!Te)continue;const Ut=xe(Te,Pe,J.canonical);Ut.length>0&&Re.addLayer(Ut)}const $e=Ze(Re);return this.overzoomedTileResultCache.set(ke,$e),$e}reloadTile(Y){return M._(this,void 0,void 0,(function*(){const W=Y.uid;if(!this.loaded||!this.loaded[W])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const J=this.loaded[W];if(J.showCollisionBoxes=Y.showCollisionBoxes,J.status==="parsing"){const pe=yield J.parse(J.vectorTile,this.layerIndex,this.availableImages,this.actor,Y.subdivisionGranularity);let ve;if(this.fetching[W]){const{rawTileData:Pe,cacheControl:ke,resourceTiming:ze}=this.fetching[W];delete this.fetching[W],ve=M.e({rawTileData:Pe.slice(0),encoding:Y.encoding},pe,ke,ze)}else ve=pe;return ve}if(J.status==="done"&&J.vectorTile)return J.parse(J.vectorTile,this.layerIndex,this.availableImages,this.actor,Y.subdivisionGranularity)}))}abortTile(Y){return M._(this,void 0,void 0,(function*(){const W=this.loading,J=Y.uid;W&&W[J]&&W[J].abort&&(W[J].abort.abort(),delete W[J])}))}removeTile(Y){return M._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[Y.uid]&&delete this.loaded[Y.uid]}))}}class Xe{constructor(){this.loaded={}}loadTile(Y){return M._(this,void 0,void 0,(function*(){const{uid:W,encoding:J,rawImageData:pe,redFactor:ve,greenFactor:Pe,blueFactor:ke,baseShift:ze}=Y,Re=pe.width+2,nt=pe.height+2,$e=M.b(pe)?new M.R({width:Re,height:nt},yield M.d0(pe,-1,-1,Re,nt)):pe,lt=new M.d1(W,$e,J,ve,Pe,ke,ze);return this.loaded=this.loaded||{},this.loaded[W]=lt,lt}))}removeTile(Y){const W=this.loaded,J=Y.uid;W&&W[J]&&delete W[J]}}var Ve,Ue,gt=(function(){if(Ue)return Ve;function Ce(W,J){if(W.length!==0){Y(W[0],J);for(var pe=1;pe<W.length;pe++)Y(W[pe],!J)}}function Y(W,J){for(var pe=0,ve=0,Pe=0,ke=W.length,ze=ke-1;Pe<ke;ze=Pe++){var Re=(W[Pe][0]-W[ze][0])*(W[ze][1]+W[Pe][1]),nt=pe+Re;ve+=Math.abs(pe)>=Math.abs(Re)?pe-nt+Re:Re-nt+pe,pe=nt}pe+ve>=0!=!!J&&W.reverse()}return Ue=1,Ve=function W(J,pe){var ve,Pe=J&&J.type;if(Pe==="FeatureCollection")for(ve=0;ve<J.features.length;ve++)W(J.features[ve],pe);else if(Pe==="GeometryCollection")for(ve=0;ve<J.geometries.length;ve++)W(J.geometries[ve],pe);else if(Pe==="Feature")W(J.geometry,pe);else if(Pe==="Polygon")Ce(J.coordinates,pe);else if(Pe==="MultiPolygon")for(ve=0;ve<J.coordinates.length;ve++)Ce(J.coordinates[ve],pe);return J}})(),pt=M.d2(gt);const Dt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ce=>Ce},_t=Math.fround||(Mt=new Float32Array(1),Ce=>(Mt[0]=+Ce,Mt[0]));var Mt;class Ot{constructor(Y){this.options=Object.assign(Object.create(Dt),Y),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Y){const{log:W,minZoom:J,maxZoom:pe}=this.options;W&&console.time("total time");const ve=`prepare ${Y.length} points`;W&&console.time(ve),this.points=Y;const Pe=[];for(let ze=0;ze<Y.length;ze++){const Re=Y[ze];if(!Re.geometry)continue;const[nt,$e]=Re.geometry.coordinates,lt=_t(ki(nt)),Te=_t(Bn($e));Pe.push(lt,Te,1/0,ze,-1,1),this.options.reduce&&Pe.push(0)}let ke=this.trees[pe+1]=this._createTree(Pe);W&&console.timeEnd(ve);for(let ze=pe;ze>=J;ze--){const Re=+Date.now();ke=this.trees[ze]=this._createTree(this._cluster(ke,ze)),W&&console.log("z%d: %d clusters in %dms",ze,ke.numItems,+Date.now()-Re)}return W&&console.timeEnd("total time"),this}getClusters(Y,W){let J=((Y[0]+180)%360+360)%360-180;const pe=Math.max(-90,Math.min(90,Y[1]));let ve=Y[2]===180?180:((Y[2]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)J=-180,ve=180;else if(J>ve){const $e=this.getClusters([J,pe,180,Pe],W),lt=this.getClusters([-180,pe,ve,Pe],W);return $e.concat(lt)}const ke=this.trees[this._limitZoom(W)],ze=ke.range(ki(J),Bn(Pe),ki(ve),Bn(pe)),Re=ke.data,nt=[];for(const $e of ze){const lt=this.stride*$e;nt.push(Re[lt+5]>1?si(Re,lt,this.clusterProps):this.points[Re[lt+3]])}return nt}getChildren(Y){const W=this._getOriginId(Y),J=this._getOriginZoom(Y),pe="No cluster with the specified id.",ve=this.trees[J];if(!ve)throw new Error(pe);const Pe=ve.data;if(W*this.stride>=Pe.length)throw new Error(pe);const ke=this.options.radius/(this.options.extent*Math.pow(2,J-1)),ze=ve.within(Pe[W*this.stride],Pe[W*this.stride+1],ke),Re=[];for(const nt of ze){const $e=nt*this.stride;Pe[$e+4]===Y&&Re.push(Pe[$e+5]>1?si(Pe,$e,this.clusterProps):this.points[Pe[$e+3]])}if(Re.length===0)throw new Error(pe);return Re}getLeaves(Y,W,J){const pe=[];return this._appendLeaves(pe,Y,W=W||10,J=J||0,0),pe}getTile(Y,W,J){const pe=this.trees[this._limitZoom(Y)],ve=Math.pow(2,Y),{extent:Pe,radius:ke}=this.options,ze=ke/Pe,Re=(J-ze)/ve,nt=(J+1+ze)/ve,$e={features:[]};return this._addTileFeatures(pe.range((W-ze)/ve,Re,(W+1+ze)/ve,nt),pe.data,W,J,ve,$e),W===0&&this._addTileFeatures(pe.range(1-ze/ve,Re,1,nt),pe.data,ve,J,ve,$e),W===ve-1&&this._addTileFeatures(pe.range(0,Re,ze/ve,nt),pe.data,-1,J,ve,$e),$e.features.length?$e:null}getClusterExpansionZoom(Y){let W=this._getOriginZoom(Y)-1;for(;W<=this.options.maxZoom;){const J=this.getChildren(Y);if(W++,J.length!==1)break;Y=J[0].properties.cluster_id}return W}_appendLeaves(Y,W,J,pe,ve){const Pe=this.getChildren(W);for(const ke of Pe){const ze=ke.properties;if(ze&&ze.cluster?ve+ze.point_count<=pe?ve+=ze.point_count:ve=this._appendLeaves(Y,ze.cluster_id,J,pe,ve):ve<pe?ve++:Y.push(ke),Y.length===J)break}return ve}_createTree(Y){const W=new M.aT(Y.length/this.stride|0,this.options.nodeSize,Float32Array);for(let J=0;J<Y.length;J+=this.stride)W.add(Y[J],Y[J+1]);return W.finish(),W.data=Y,W}_addTileFeatures(Y,W,J,pe,ve,Pe){for(const ke of Y){const ze=ke*this.stride,Re=W[ze+5]>1;let nt,$e,lt;if(Re)nt=Gi(W,ze,this.clusterProps),$e=W[ze],lt=W[ze+1];else{const wi=this.points[W[ze+3]];nt=wi.properties;const[At,Rt]=wi.geometry.coordinates;$e=ki(At),lt=Bn(Rt)}const Te={type:1,geometry:[[Math.round(this.options.extent*($e*ve-J)),Math.round(this.options.extent*(lt*ve-pe))]],tags:nt};let Ut;Ut=Re||this.options.generateId?W[ze+3]:this.points[W[ze+3]].id,Ut!==void 0&&(Te.id=Ut),Pe.features.push(Te)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,W){const{radius:J,extent:pe,reduce:ve,minPoints:Pe}=this.options,ke=J/(pe*Math.pow(2,W)),ze=Y.data,Re=[],nt=this.stride;for(let $e=0;$e<ze.length;$e+=nt){if(ze[$e+2]<=W)continue;ze[$e+2]=W;const lt=ze[$e],Te=ze[$e+1],Ut=Y.within(ze[$e],ze[$e+1],ke),wi=ze[$e+5];let At=wi;for(const Rt of Ut){const Wt=Rt*nt;ze[Wt+2]>W&&(At+=ze[Wt+5])}if(At>wi&&At>=Pe){let Rt,Wt=lt*wi,qi=Te*wi,Zi=-1;const Fn=($e/nt<<5)+(W+1)+this.points.length;for(const Nn of Ut){const ln=Nn*nt;if(ze[ln+2]<=W)continue;ze[ln+2]=W;const Dn=ze[ln+5];Wt+=ze[ln]*Dn,qi+=ze[ln+1]*Dn,ze[ln+4]=Fn,ve&&(Rt||(Rt=this._map(ze,$e,!0),Zi=this.clusterProps.length,this.clusterProps.push(Rt)),ve(Rt,this._map(ze,ln)))}ze[$e+4]=Fn,Re.push(Wt/At,qi/At,1/0,Fn,-1,At),ve&&Re.push(Zi)}else{for(let Rt=0;Rt<nt;Rt++)Re.push(ze[$e+Rt]);if(At>1)for(const Rt of Ut){const Wt=Rt*nt;if(!(ze[Wt+2]<=W)){ze[Wt+2]=W;for(let qi=0;qi<nt;qi++)Re.push(ze[Wt+qi])}}}}return Re}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,W,J){if(Y[W+5]>1){const Pe=this.clusterProps[Y[W+6]];return J?Object.assign({},Pe):Pe}const pe=this.points[Y[W+3]].properties,ve=this.options.map(pe);return J&&ve===pe?Object.assign({},ve):ve}}function si(Ce,Y,W){return{type:"Feature",id:Ce[Y+3],properties:Gi(Ce,Y,W),geometry:{type:"Point",coordinates:[(J=Ce[Y],360*(J-.5)),yr(Ce[Y+1])]}};var J}function Gi(Ce,Y,W){const J=Ce[Y+5],pe=J>=1e4?`${Math.round(J/1e3)}k`:J>=1e3?Math.round(J/100)/10+"k":J,ve=Ce[Y+6],Pe=ve===-1?{}:Object.assign({},W[ve]);return Object.assign(Pe,{cluster:!0,cluster_id:Ce[Y+3],point_count:J,point_count_abbreviated:pe})}function ki(Ce){return Ce/360+.5}function Bn(Ce){const Y=Math.sin(Ce*Math.PI/180),W=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return W<0?0:W>1?1:W}function yr(Ce){const Y=(180-360*Ce)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function On(Ce,Y,W,J){let pe=J;const ve=Y+(W-Y>>1);let Pe,ke=W-Y;const ze=Ce[Y],Re=Ce[Y+1],nt=Ce[W],$e=Ce[W+1];for(let lt=Y+3;lt<W;lt+=3){const Te=Je(Ce[lt],Ce[lt+1],ze,Re,nt,$e);if(Te>pe)Pe=lt,pe=Te;else if(Te===pe){const Ut=Math.abs(lt-ve);Ut<ke&&(Pe=lt,ke=Ut)}}pe>J&&(Pe-Y>3&&On(Ce,Y,Pe,J),Ce[Pe+2]=pe,W-Pe>3&&On(Ce,Pe,W,J))}function Je(Ce,Y,W,J,pe,ve){let Pe=pe-W,ke=ve-J;if(Pe!==0||ke!==0){const ze=((Ce-W)*Pe+(Y-J)*ke)/(Pe*Pe+ke*ke);ze>1?(W=pe,J=ve):ze>0&&(W+=Pe*ze,J+=ke*ze)}return Pe=Ce-W,ke=Y-J,Pe*Pe+ke*ke}function at(Ce,Y,W,J){const pe={type:Y,geom:W},ve={id:Ce??null,type:pe.type,geometry:pe.geom,tags:J,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};switch(pe.type){case"Point":case"MultiPoint":case"LineString":Pt(ve,pe.geom);break;case"Polygon":Pt(ve,pe.geom[0]);break;case"MultiLineString":for(const Pe of pe.geom)Pt(ve,Pe);break;case"MultiPolygon":for(const Pe of pe.geom)Pt(ve,Pe[0])}return ve}function Pt(Ce,Y){for(let W=0;W<Y.length;W+=3)Ce.minX=Math.min(Ce.minX,Y[W]),Ce.minY=Math.min(Ce.minY,Y[W+1]),Ce.maxX=Math.max(Ce.maxX,Y[W]),Ce.maxY=Math.max(Ce.maxY,Y[W+1])}function It(Ce,Y){const W=[];switch(Ce.type){case"FeatureCollection":for(let J=0;J<Ce.features.length;J++)ni(W,Ce.features[J],Y,J);break;case"Feature":ni(W,Ce,Y);break;default:ni(W,{geometry:Ce,properties:void 0},Y)}return W}function ni(Ce,Y,W,J){if(!Y.geometry)return;if(Y.geometry.type==="GeometryCollection"){for(const ke of Y.geometry.geometries)ni(Ce,{id:Y.id,geometry:ke,properties:Y.properties},W,J);return}if(!Y.geometry.coordinates?.length)return;const ve=Math.pow(W.tolerance/((1<<W.maxZoom)*W.extent),2);let Pe=Y.id;switch(W.promoteId?Pe=Y.properties?.[W.promoteId]:W.generateId&&(Pe=J||0),Y.geometry.type){case"Point":{const ke=[];return Ee(Y.geometry.coordinates,ke),void Ce.push(at(Pe,Y.geometry.type,ke,Y.properties))}case"MultiPoint":{const ke=[];for(const ze of Y.geometry.coordinates)Ee(ze,ke);return void Ce.push(at(Pe,Y.geometry.type,ke,Y.properties))}case"LineString":{const ke=[];return ot(Y.geometry.coordinates,ke,ve,!1),void Ce.push(at(Pe,Y.geometry.type,ke,Y.properties))}case"MultiLineString":{if(W.lineMetrics){for(const ze of Y.geometry.coordinates){const Re=[];ot(ze,Re,ve,!1),Ce.push(at(Pe,"LineString",Re,Y.properties))}return}const ke=[];return St(Y.geometry.coordinates,ke,ve,!1),void Ce.push(at(Pe,Y.geometry.type,ke,Y.properties))}case"Polygon":{const ke=[];return St(Y.geometry.coordinates,ke,ve,!0),void Ce.push(at(Pe,Y.geometry.type,ke,Y.properties))}case"MultiPolygon":{const ke=[];for(const ze of Y.geometry.coordinates){const Re=[];St(ze,Re,ve,!0),ke.push(Re)}return void Ce.push(at(Pe,Y.geometry.type,ke,Y.properties))}default:throw new Error("Input data is not a valid GeoJSON object.")}}function Ee(Ce,Y){Y.push(zt(Ce[0]),Ht(Ce[1]),0)}function ot(Ce,Y,W,J){let pe,ve,Pe=0;for(let ze=0;ze<Ce.length;ze++){const Re=zt(Ce[ze][0]),nt=Ht(Ce[ze][1]);Y.push(Re,nt,0),ze>0&&(Pe+=J?(pe*nt-Re*ve)/2:Math.sqrt(Math.pow(Re-pe,2)+Math.pow(nt-ve,2))),pe=Re,ve=nt}const ke=Y.length-3;Y[2]=1,W>0&&On(Y,0,ke,W),Y[ke+2]=1,Y.size=Math.abs(Pe),Y.start=0,Y.end=Y.size}function St(Ce,Y,W,J){for(let pe=0;pe<Ce.length;pe++){const ve=[];ot(Ce[pe],ve,W,J),Y.push(ve)}}function zt(Ce){return Ce/360+.5}function Ht(Ce){const Y=Math.sin(Ce*Math.PI/180),W=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return W<0?0:W>1?1:W}function Nt(Ce,Y,W,J,pe,ve,Pe,ke){if(J/=Y,ve>=(W/=Y)&&Pe<J)return Ce;if(Pe<W||ve>=J)return null;const ze=[];for(const Re of Ce){const nt=pe===0?Re.minX:Re.minY,$e=pe===0?Re.maxX:Re.maxY;if(nt>=W&&$e<J)ze.push(Re);else if(!($e<W||nt>=J))switch(Re.type){case"Point":case"MultiPoint":{const lt=[];if(hi(Re.geometry,lt,W,J,pe),!lt.length)continue;ze.push(at(Re.id,lt.length===3?"Point":"MultiPoint",lt,Re.tags));continue}case"LineString":{const lt=[];if(Li(Re.geometry,lt,W,J,pe,!1,ke.lineMetrics),!lt.length)continue;if(ke.lineMetrics){for(const Te of lt)ze.push(at(Re.id,Re.type,Te,Re.tags));continue}if(lt.length>1){ze.push(at(Re.id,"MultiLineString",lt,Re.tags));continue}ze.push(at(Re.id,Re.type,lt[0],Re.tags));continue}case"MultiLineString":{const lt=[];if(va(Re.geometry,lt,W,J,pe,!1),!lt.length)continue;if(lt.length===1){ze.push(at(Re.id,"LineString",lt[0],Re.tags));continue}ze.push(at(Re.id,Re.type,lt,Re.tags));continue}case"Polygon":{const lt=[];if(va(Re.geometry,lt,W,J,pe,!0),!lt.length)continue;ze.push(at(Re.id,Re.type,lt,Re.tags));continue}case"MultiPolygon":{const lt=[];for(const Te of Re.geometry){const Ut=[];va(Te,Ut,W,J,pe,!0),Ut.length&&lt.push(Ut)}if(!lt.length)continue;ze.push(at(Re.id,Re.type,lt,Re.tags));continue}}}return ze.length?ze:null}function hi(Ce,Y,W,J,pe){for(let ve=0;ve<Ce.length;ve+=3){const Pe=Ce[ve+pe];Pe>=W&&Pe<=J&&Kr(Y,Ce[ve],Ce[ve+1],Ce[ve+2])}}function Li(Ce,Y,W,J,pe,ve,Pe){let ke=Xi(Ce);const ze=pe===0?Qr:kc;let Re,nt,$e=Ce.start;for(let At=0;At<Ce.length-3;At+=3){const Rt=Ce[At],Wt=Ce[At+1],qi=Ce[At+2],Zi=Ce[At+3],Fn=Ce[At+4],Nn=pe===0?Rt:Wt,ln=pe===0?Zi:Fn;let Dn=!1;Pe&&(Re=Math.sqrt(Math.pow(Rt-Zi,2)+Math.pow(Wt-Fn,2))),Nn<W?ln>W&&(nt=ze(ke,Rt,Wt,Zi,Fn,W),Pe&&(ke.start=$e+Re*nt)):Nn>J?ln<J&&(nt=ze(ke,Rt,Wt,Zi,Fn,J),Pe&&(ke.start=$e+Re*nt)):Kr(ke,Rt,Wt,qi),ln<W&&Nn>=W&&(nt=ze(ke,Rt,Wt,Zi,Fn,W),Dn=!0),ln>J&&Nn<=J&&(nt=ze(ke,Rt,Wt,Zi,Fn,J),Dn=!0),!ve&&Dn&&(Pe&&(ke.end=$e+Re*nt),Y.push(ke),ke=Xi(Ce)),Pe&&($e+=Re)}let lt=Ce.length-3;const Te=Ce[lt],Ut=Ce[lt+1],wi=pe===0?Te:Ut;wi>=W&&wi<=J&&Kr(ke,Te,Ut,Ce[lt+2]),lt=ke.length-3,ve&&lt>=3&&(ke[lt]!==ke[0]||ke[lt+1]!==ke[1])&&Kr(ke,ke[0],ke[1],ke[2]),ke.length&&Y.push(ke)}function Xi(Ce){const Y=[];return Y.size=Ce.size,Y.start=Ce.start,Y.end=Ce.end,Y}function va(Ce,Y,W,J,pe,ve){for(const Pe of Ce)Li(Pe,Y,W,J,pe,ve,!1)}function Kr(Ce,Y,W,J){Ce.push(Y,W,J)}function Qr(Ce,Y,W,J,pe,ve){const Pe=(ve-Y)/(J-Y);return Kr(Ce,ve,W+(pe-W)*Pe,1),Pe}function kc(Ce,Y,W,J,pe,ve){const Pe=(ve-W)/(pe-W);return Kr(Ce,Y+(J-Y)*Pe,ve,1),Pe}function sn(Ce,Y){const W=Y.buffer/Y.extent;let J=Ce;const pe=Nt(Ce,1,-1-W,W,0,-1,2,Y),ve=Nt(Ce,1,1-W,2+W,0,-1,2,Y);return(pe||ve)&&(J=Nt(Ce,1,-W,1+W,0,-1,2,Y)||[],pe&&(J=jr(pe,1).concat(J)),ve&&(J=J.concat(jr(ve,-1)))),J}function jr(Ce,Y){const W=[];for(const J of Ce)switch(J.type){case"Point":case"MultiPoint":case"LineString":{const pe=Jr(J.geometry,Y);W.push(at(J.id,J.type,pe,J.tags));continue}case"MultiLineString":case"Polygon":{const pe=[];for(const ve of J.geometry)pe.push(Jr(ve,Y));W.push(at(J.id,J.type,pe,J.tags));continue}case"MultiPolygon":{const pe=[];for(const ve of J.geometry){const Pe=[];for(const ke of ve)Pe.push(Jr(ke,Y));pe.push(Pe)}W.push(at(J.id,J.type,pe,J.tags));continue}}return W}function Jr(Ce,Y){const W=[];W.size=Ce.size,Ce.start!==void 0&&(W.start=Ce.start,W.end=Ce.end);for(let J=0;J<Ce.length;J+=3)W.push(Ce[J]+Y,Ce[J+1],Ce[J+2]);return W}function on(Ce,Y){if(Ce.transformed)return Ce;const W=1<<Ce.z,J=Ce.x,pe=Ce.y;for(const ve of Ce.features){if(ve.type===1){const ke=[];for(let ze=0;ze<ve.geometry.length;ze+=2)ke.push(cs(ve.geometry[ze],ve.geometry[ze+1],Y,W,J,pe));ve.geometry=ke;continue}const Pe=[];for(const ke of ve.geometry){const ze=[];for(let Re=0;Re<ke.length;Re+=2)ze.push(cs(ke[Re],ke[Re+1],Y,W,J,pe));Pe.push(ze)}ve.geometry=Pe}return Ce.transformed=!0,Ce}function cs(Ce,Y,W,J,pe,ve){return[Math.round(W*(Ce*J-pe)),Math.round(W*(Y*J-ve))]}function ho(Ce,Y,W,J,pe){const ve=Y===pe.maxZoom?0:pe.tolerance/((1<<Y)*pe.extent),Pe={features:[],numPoints:0,numSimplified:0,numFeatures:Ce.length,source:null,x:W,y:J,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ke of Ce)fo(Pe,ke,ve,pe);return Pe}function fo(Ce,Y,W,J){Ce.minX=Math.min(Ce.minX,Y.minX),Ce.minY=Math.min(Ce.minY,Y.minY),Ce.maxX=Math.max(Ce.maxX,Y.maxX),Ce.maxY=Math.max(Ce.maxY,Y.maxY);let pe,ve=Y.tags||null;switch(Y.type){case"Point":case"MultiPoint":{const Pe=[];for(let ke=0;ke<Y.geometry.length;ke+=3)Pe.push(Y.geometry[ke],Y.geometry[ke+1]),Ce.numPoints++,Ce.numSimplified++;if(!Pe.length)return;pe={type:1,tags:ve,geometry:Pe};break}case"LineString":{const Pe=[];if(ba(Pe,Y.geometry,Ce,W,!1,!1),!Pe.length)return;if(J.lineMetrics){ve={};for(const ke in Y.tags)ve[ke]=Y.tags[ke];ve.mapbox_clip_start=Y.geometry.start/Y.geometry.size,ve.mapbox_clip_end=Y.geometry.end/Y.geometry.size}pe={type:2,tags:ve,geometry:Pe};break}case"MultiLineString":case"Polygon":{const Pe=[];for(let ke=0;ke<Y.geometry.length;ke++)ba(Pe,Y.geometry[ke],Ce,W,Y.type==="Polygon",ke===0);if(!Pe.length)return;pe={type:Y.type==="Polygon"?3:2,tags:ve,geometry:Pe};break}case"MultiPolygon":{const Pe=[];for(let ke=0;ke<Y.geometry.length;ke++){const ze=Y.geometry[ke];for(let Re=0;Re<ze.length;Re++)ba(Pe,ze[Re],Ce,W,!0,Re===0)}if(!Pe.length)return;pe={type:3,tags:ve,geometry:Pe};break}}Y.id!==null&&(pe.id=Y.id),Ce.features.push(pe)}function ba(Ce,Y,W,J,pe,ve){const Pe=J*J;if(J>0&&Y.size<(pe?Pe:J))return void(W.numPoints+=Y.length/3);const ke=[];for(let ze=0;ze<Y.length;ze+=3)(J===0||Y[ze+2]>Pe)&&(W.numSimplified++,ke.push(Y[ze],Y[ze+1])),W.numPoints++;pe&&(function(ze,Re){let nt=0;for(let $e=0,lt=ze.length,Te=lt-2;$e<lt;Te=$e,$e+=2)nt+=(ze[$e]-ze[Te])*(ze[$e+1]+ze[Te+1]);if(nt>0===Re)for(let $e=0,lt=ze.length;$e<lt/2;$e+=2){const Te=ze[$e],Ut=ze[$e+1];ze[$e]=ze[lt-2-$e],ze[$e+1]=ze[lt-1-$e],ze[lt-2-$e]=Te,ze[lt-1-$e]=Ut}})(ke,ve),Ce.push(ke)}function Os(Ce,Y,W){const J=!!Y.newGeometry,pe=Y.removeAllProperties||Y.removeProperties?.length>0||Y.addOrUpdateProperties?.length>0;if(J){let ve=It({type:"FeatureCollection",features:[{type:"Feature",id:Ce.id,geometry:Y.newGeometry,properties:pe?$o(Ce.tags,Y):Ce.tags}]},W);return ve=sn(ve,W),ve[0]}if(pe){const ve={...Ce};return ve.tags=$o(ve.tags,Y),ve}return null}function $o(Ce,Y){if(Y.removeAllProperties)return{};const W={...Ce||{}};if(Y.removeProperties)for(const J of Y.removeProperties)delete W[J];if(Y.addOrUpdateProperties)for(const{key:J,value:pe}of Y.addOrUpdateProperties)W[J]=pe;return W}const Qn={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,updateable:!1,debug:0};class ea{options;tiles;tileCoords;stats={};total=0;source;constructor(Y,W){const J=(W=this.options=Object.assign({},Qn,W)).debug;if(J&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");let pe=It(Y,W);this.tiles={},this.tileCoords=[],J&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),pe=sn(pe,W),pe.length&&this.splitTile(pe,0,0,0),W.updateable&&(this.source=pe),J&&(pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Y,W,J,pe,ve,Pe,ke){const ze=[Y,W,J,pe],Re=this.options,nt=Re.debug;for(;ze.length;){pe=ze.pop(),J=ze.pop(),W=ze.pop(),Y=ze.pop();const $e=1<<W,lt=Fs(W,J,pe);let Te=this.tiles[lt];if(!Te&&(nt>1&&console.time("creation"),Te=this.tiles[lt]=ho(Y,W,J,pe,Re),this.tileCoords.push({z:W,x:J,y:pe,id:lt}),nt)){nt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,J,pe,Te.numFeatures,Te.numPoints,Te.numSimplified),console.timeEnd("creation"));const Dn=`z${W}`;this.stats[Dn]=(this.stats[Dn]||0)+1,this.total++}if(Te.source=Y,ve==null){if(W===Re.indexMaxZoom||Te.numPoints<=Re.indexMaxPoints)continue}else{if(W===Re.maxZoom||W===ve)continue;if(ve!=null){const Dn=ve-W;if(J!==Pe>>Dn||pe!==ke>>Dn)continue}}if(Te.source=null,!Y.length)continue;nt>1&&console.time("clipping");const Ut=.5*Re.buffer/Re.extent,wi=.5-Ut,At=.5+Ut,Rt=1+Ut;let Wt=null,qi=null,Zi=null,Fn=null;const Nn=Nt(Y,$e,J-Ut,J+At,0,Te.minX,Te.maxX,Re),ln=Nt(Y,$e,J+wi,J+Rt,0,Te.minX,Te.maxX,Re);Nn&&(Wt=Nt(Nn,$e,pe-Ut,pe+At,1,Te.minY,Te.maxY,Re),qi=Nt(Nn,$e,pe+wi,pe+Rt,1,Te.minY,Te.maxY,Re)),ln&&(Zi=Nt(ln,$e,pe-Ut,pe+At,1,Te.minY,Te.maxY,Re),Fn=Nt(ln,$e,pe+wi,pe+Rt,1,Te.minY,Te.maxY,Re)),nt>1&&console.timeEnd("clipping"),ze.push(Wt||[],W+1,2*J,2*pe),ze.push(qi||[],W+1,2*J,2*pe+1),ze.push(Zi||[],W+1,2*J+1,2*pe),ze.push(Fn||[],W+1,2*J+1,2*pe+1)}}getTile(Y,W,J){Y=+Y,W=+W,J=+J;const pe=this.options,{extent:ve,debug:Pe}=pe;if(Y<0||Y>24)return null;const ke=1<<Y,ze=Fs(Y,W=W+ke&ke-1,J);if(this.tiles[ze])return on(this.tiles[ze],ve);Pe>1&&console.log("drilling down to z%d-%d-%d",Y,W,J);let Re,nt=Y,$e=W,lt=J;for(;!Re&&nt>0;)nt--,$e>>=1,lt>>=1,Re=this.tiles[Fs(nt,$e,lt)];return Re?.source?(Pe>1&&(console.log("found parent tile z%d-%d-%d",nt,$e,lt),console.time("drilling down")),this.splitTile(Re.source,nt,$e,lt,Y,W,J),Pe>1&&console.timeEnd("drilling down"),this.tiles[ze]?on(this.tiles[ze],ve):null):null}invalidateTiles(Y){const W=this.options,{debug:J}=W;let pe=1/0,ve=-1/0,Pe=1/0,ke=-1/0;for(const nt of Y)pe=Math.min(pe,nt.minX),ve=Math.max(ve,nt.maxX),Pe=Math.min(Pe,nt.minY),ke=Math.max(ke,nt.maxY);const ze=W.buffer/W.extent,Re=new Set;for(const nt in this.tiles){const $e=this.tiles[nt],lt=1<<$e.z,Te=($e.x-ze)/lt,Ut=($e.x+1+ze)/lt,wi=($e.y-ze)/lt,At=($e.y+1+ze)/lt;if(ve<Te||pe>=Ut||ke<wi||Pe>=At)continue;let Rt=!1;for(const Wt of Y)if(Wt.maxX>=Te&&Wt.minX<Ut&&Wt.maxY>=wi&&Wt.minY<At){Rt=!0;break}if(Rt){if(J){J>1&&console.log("invalidate tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",$e.z,$e.x,$e.y,$e.numFeatures,$e.numPoints,$e.numSimplified);const Wt=`z${$e.z}`;this.stats[Wt]=(this.stats[Wt]||0)-1,this.total--}delete this.tiles[nt],Re.add(nt)}}Re.size&&(this.tileCoords=this.tileCoords.filter((nt=>!Re.has(nt.id))))}updateData(Y){const W=this.options,J=W.debug;if(!W.updateable)throw new Error("to update tile geojson `updateable` option must be set to true");const{affected:pe,source:ve}=(function($e,lt,Te){const Ut=(function(At){return At?{removeAll:At.removeAll,remove:new Set(At.remove||[]),add:new Map(At.add?.map((Rt=>[Rt.id,Rt]))),update:new Map(At.update?.map((Rt=>[Rt.id,Rt])))}:{remove:new Set,add:new Map,update:new Map}})(lt);let wi=[];if(Ut.removeAll&&(wi=$e,$e=[]),Ut.remove.size||Ut.add.size){const At=[];for(const Rt of $e){const{id:Wt}=Rt;(Ut.remove.has(Wt)||Ut.add.has(Wt))&&At.push(Rt)}if(At.length){wi.push(...At);const Rt=new Set(At.map((Wt=>Wt.id)));$e=$e.filter((Wt=>!Rt.has(Wt.id)))}if(Ut.add.size){let Rt=It({type:"FeatureCollection",features:Array.from(Ut.add.values())},Te);Rt=sn(Rt,Te),wi.push(...Rt),$e.push(...Rt)}}if(Ut.update.size)for(const[At,Rt]of Ut.update){const Wt=$e.findIndex((Fn=>Fn.id===At));if(Wt===-1)continue;const qi=$e[Wt],Zi=Os(qi,Rt,Te);Zi&&(wi.push(qi,Zi),$e[Wt]=Zi)}return{affected:wi,source:$e}})(this.source,Y,W);if(!pe.length)return;this.source=ve,J>1&&(console.log("invalidating tiles"),console.time("invalidating")),this.invalidateTiles(pe),J>1&&console.timeEnd("invalidating");const[Pe,ke,ze]=[0,0,0],Re=ho(this.source,Pe,ke,ze,this.options);Re.source=this.source;const nt=Fs(Pe,ke,ze);if(this.tiles[nt]=Re,this.tileCoords.push({z:Pe,x:ke,y:ze,id:nt}),J){const $e=`z${Pe}`;this.stats[$e]=(this.stats[$e]||0)+1,this.total++}}}function Fs(Ce,Y,W){return 32*((1<<Ce)*W+Y)+Ce}class Nl extends le{constructor(Y,W,J,pe=Ns){super(Y,W,J),this._dataUpdateable=new Map,this._createGeoJSONIndex=pe}loadVectorTile(Y,W){return M._(this,void 0,void 0,(function*(){const J=Y.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const pe=this._geoJSONIndex.getTile(J.z,J.x,J.y);return pe?Ze(new M.d3(pe.features,{version:2,extent:M.a5})):null}))}loadData(Y){return M._(this,void 0,void 0,(function*(){var W;(W=this._pendingRequest)===null||W===void 0||W.abort();const J=this._startPerformance(Y);this._pendingRequest=new AbortController;try{(!this._pendingData||Y.request||Y.data||Y.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(Y,this._pendingRequest));const pe=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(pe,Y),this.loaded={};const ve={};return Y.request&&(ve.data=pe),this._finishPerformance(J,Y,ve),ve}catch(pe){if(delete this._pendingRequest,M.Z(pe))return{abandoned:!0};throw pe}}))}_startPerformance(Y){var W;if(!((W=Y?.request)===null||W===void 0)&&W.collectResourceTiming)return new M.c$(Y.request)}_finishPerformance(Y,W,J){if(!Y)return;const pe=Y.finish();pe&&(J.resourceTiming={},J.resourceTiming[W.source]=JSON.parse(JSON.stringify(pe)))}getData(){return M._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(Y){const W=this.loaded;return W&&W[Y.uid]?super.reloadTile(Y):this.loadTile(Y)}loadAndProcessGeoJSON(Y,W){return M._(this,void 0,void 0,(function*(){let J;if(Y.request?J=yield this.loadGeoJSONFromUrl(Y.request,Y.promoteId,W):Y.data?J=this._loadGeoJSONFromObject(Y.data,Y.promoteId):Y.dataDiff&&(J=this._loadGeoJSONFromDiff(Y.dataDiff,Y.promoteId,Y.source)),delete this._pendingRequest,typeof J!="object")throw new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`);return pt(J,!0),Y.filter&&(J=this._filterGeoJSON(J,Y.filter)),J}))}loadGeoJSONFromUrl(Y,W,J){return M._(this,void 0,void 0,(function*(){const pe=yield M.j(Y,J);return this._dataUpdateable=M.a7(pe.data,W),pe.data}))}_loadGeoJSONFromObject(Y,W){return this._dataUpdateable=M.a7(Y,W),Y}_loadGeoJSONFromDiff(Y,W,J){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${J}`);M.a8(this._dataUpdateable,Y,W);const pe=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(pe)}_filterGeoJSON(Y,W){const J=M.d4(W,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map((ve=>`${ve.key}: ${ve.message}`)).join(", "));const pe=Y.features.filter((ve=>J.value.evaluate({zoom:0},ve)));return this._toFeatureCollection(pe)}_toFeatureCollection(Y){return{type:"FeatureCollection",features:Y}}removeSource(Y){return M._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(Y){return this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId)}getClusterChildren(Y){return this._geoJSONIndex.getChildren(Y.clusterId)}getClusterLeaves(Y){return this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset)}}function Ns(Ce,Y){return Y.cluster?new Ot((function({superclusterOptions:W,clusterProperties:J}){if(!J||!W)return W;const pe={},ve={},Pe={accumulated:null,zoom:0},ke={properties:null},ze=Object.keys(J);for(const Re of ze){const[nt,$e]=J[Re],lt=M.d4($e),Te=M.d4(typeof nt=="string"?[nt,["accumulated"],["get",Re]]:nt);pe[Re]=lt.value,ve[Re]=Te.value}return W.map=Re=>{ke.properties=Re;const nt={};for(const $e of ze)nt[$e]=pe[$e].evaluate(Pe,ke);return nt},W.reduce=(Re,nt)=>{ke.properties=nt;for(const $e of ze)Pe.accumulated=Re[$e],Re[$e]=ve[$e].evaluate(Pe,ke)},W})(Y)).load(Ce.features):(function(W,J){return new ea(W,J)})(Ce,Y.geojsonVtOptions)}class Vl{constructor(Y){this.self=Y,this.actor=new M.L(Y),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(W,J)=>{if(this.externalWorkerSourceTypes[W])throw new Error(`Worker source with name "${W}" already registered.`);this.externalWorkerSourceTypes[W]=J},this.self.addProtocol=M.cK,this.self.removeProtocol=M.cL,this.self.registerRTLTextPlugin=W=>{M.d5.setMethods(W)},this.actor.registerMessageHandler("LDT",((W,J)=>this._getDEMWorkerSource(W,J.source).loadTile(J))),this.actor.registerMessageHandler("RDT",((W,J)=>M._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(W,J.source).removeTile(J)})))),this.actor.registerMessageHandler("GCEZ",((W,J)=>M._(this,void 0,void 0,(function*(){return this._getWorkerSource(W,J.type,J.source).getClusterExpansionZoom(J)})))),this.actor.registerMessageHandler("GCC",((W,J)=>M._(this,void 0,void 0,(function*(){return this._getWorkerSource(W,J.type,J.source).getClusterChildren(J)})))),this.actor.registerMessageHandler("GCL",((W,J)=>M._(this,void 0,void 0,(function*(){return this._getWorkerSource(W,J.type,J.source).getClusterLeaves(J)})))),this.actor.registerMessageHandler("LD",((W,J)=>this._getWorkerSource(W,J.type,J.source).loadData(J))),this.actor.registerMessageHandler("GD",((W,J)=>this._getWorkerSource(W,J.type,J.source).getData())),this.actor.registerMessageHandler("LT",((W,J)=>this._getWorkerSource(W,J.type,J.source).loadTile(J))),this.actor.registerMessageHandler("RT",((W,J)=>this._getWorkerSource(W,J.type,J.source).reloadTile(J))),this.actor.registerMessageHandler("AT",((W,J)=>this._getWorkerSource(W,J.type,J.source).abortTile(J))),this.actor.registerMessageHandler("RMT",((W,J)=>this._getWorkerSource(W,J.type,J.source).removeTile(J))),this.actor.registerMessageHandler("RS",((W,J)=>M._(this,void 0,void 0,(function*(){if(!this.workerSources[W]||!this.workerSources[W][J.type]||!this.workerSources[W][J.type][J.source])return;const pe=this.workerSources[W][J.type][J.source];delete this.workerSources[W][J.type][J.source],pe.removeSource!==void 0&&pe.removeSource(J)})))),this.actor.registerMessageHandler("RM",(W=>M._(this,void 0,void 0,(function*(){delete this.layerIndexes[W],delete this.availableImages[W],delete this.workerSources[W],delete this.demWorkerSources[W],this.globalStates.delete(W)})))),this.actor.registerMessageHandler("SR",((W,J)=>M._(this,void 0,void 0,(function*(){this.referrer=J})))),this.actor.registerMessageHandler("SRPS",((W,J)=>this._syncRTLPluginState(W,J))),this.actor.registerMessageHandler("IS",((W,J)=>M._(this,void 0,void 0,(function*(){this.self.importScripts(J)})))),this.actor.registerMessageHandler("SI",((W,J)=>this._setImages(W,J))),this.actor.registerMessageHandler("UL",((W,J)=>M._(this,void 0,void 0,(function*(){this._getLayerIndex(W).update(J.layers,J.removedIds,this._getGlobalState(W))})))),this.actor.registerMessageHandler("UGS",((W,J)=>M._(this,void 0,void 0,(function*(){const pe=this._getGlobalState(W);for(const ve in J)pe[ve]=J[ve]})))),this.actor.registerMessageHandler("SL",((W,J)=>M._(this,void 0,void 0,(function*(){this._getLayerIndex(W).replace(J,this._getGlobalState(W))}))))}_getGlobalState(Y){let W=this.globalStates.get(Y);return W||(W={},this.globalStates.set(Y,W)),W}_setImages(Y,W){return M._(this,void 0,void 0,(function*(){this.availableImages[Y]=W;for(const J in this.workerSources[Y]){const pe=this.workerSources[Y][J];for(const ve in pe)pe[ve].availableImages=W}}))}_syncRTLPluginState(Y,W){return M._(this,void 0,void 0,(function*(){return yield M.d5.syncState(W,this.self.importScripts)}))}_getAvailableImages(Y){let W=this.availableImages[Y];return W||(W=[]),W}_getLayerIndex(Y){let W=this.layerIndexes[Y];return W||(W=this.layerIndexes[Y]=new c),W}_getWorkerSource(Y,W,J){if(this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][W]||(this.workerSources[Y][W]={}),!this.workerSources[Y][W][J]){const pe={sendAsync:(ve,Pe)=>(ve.targetMapId=Y,this.actor.sendAsync(ve,Pe))};switch(W){case"vector":this.workerSources[Y][W][J]=new le(pe,this._getLayerIndex(Y),this._getAvailableImages(Y));break;case"geojson":this.workerSources[Y][W][J]=new Nl(pe,this._getLayerIndex(Y),this._getAvailableImages(Y));break;default:this.workerSources[Y][W][J]=new this.externalWorkerSourceTypes[W](pe,this._getLayerIndex(Y),this._getAvailableImages(Y))}}return this.workerSources[Y][W][J]}_getDEMWorkerSource(Y,W){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][W]||(this.demWorkerSources[Y][W]=new Xe),this.demWorkerSources[Y][W]}}return M.i(self)&&(self.worker=new Vl(self)),Vl})),I("index",["exports","./shared"],(function(M,c){var V="5.17.0";function X(){var y=new c.A(4);return c.A!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y}let K,te,de;const De={frame(y,t,a,l){const f=l||window,x=f.requestAnimationFrame((E=>{b(),t(E)})),{unsubscribe:b}=c.s(y.signal,"abort",(()=>{b(),f.cancelAnimationFrame(x),a(new c.a(y.signal.reason))}),!1)},frameAsync(y,t){return new Promise(((a,l)=>{this.frame(y,a,l,t)}))},getImageData(y,t=0){return this.getImageCanvasContext(y).getImageData(-t,-t,y.width+2*t,y.height+2*t)},getImageCanvasContext(y){const t=window.document.createElement("canvas"),a=t.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return t.width=y.width,t.height=y.height,a.drawImage(y,0,0,y.width,y.height),a},resolveURL:y=>(K||(K=document.createElement("a")),K.href=y,K.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return de!==void 0?de:!!matchMedia&&(te==null&&(te=matchMedia("(prefers-reduced-motion: reduce)")),te.matches)},set prefersReducedMotion(y){de=y}},Ze=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(y){this._frozenAt=y}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function xe(){return Ze.getCurrentTime()}class le{static testProp(t){if(!le.docStyle)return t[0];for(let a=0;a<t.length;a++)if(t[a]in le.docStyle)return t[a];return t[0]}static create(t,a,l){const f=window.document.createElement(t);return a!==void 0&&(f.className=a),l&&l.appendChild(f),f}static createNS(t,a){return window.document.createElementNS(t,a)}static disableDrag(){le.docStyle&&le.selectProp&&(le.userSelect=le.docStyle[le.selectProp],le.docStyle[le.selectProp]="none")}static enableDrag(){le.docStyle&&le.selectProp&&(le.docStyle[le.selectProp]=le.userSelect)}static setTransform(t,a){t.style[le.transformProp]=a}static addEventListener(t,a,l,f={}){t.addEventListener(a,l,"passive"in f?f:f.capture)}static removeEventListener(t,a,l,f={}){t.removeEventListener(a,l,"passive"in f?f:f.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",le.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",le.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",le.suppressClickInternal,!0)}),0)}static getScale(t){const a=t.getBoundingClientRect();return{x:a.width/t.offsetWidth||1,y:a.height/t.offsetHeight||1,boundingClientRect:a}}static getPoint(t,a,l){const f=a.boundingClientRect;return new c.P((l.clientX-f.left)/a.x-t.clientLeft,(l.clientY-f.top)/a.y-t.clientTop)}static mousePos(t,a){const l=le.getScale(t);return le.getPoint(t,l,a)}static touchPos(t,a){const l=[],f=le.getScale(t);for(let x=0;x<a.length;x++)l.push(le.getPoint(t,f,a[x]));return l}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const a=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),l=a.querySelectorAll("script");for(const f of l)f.remove();return le.clean(a),a.innerHTML}static isPossiblyDangerous(t,a){const l=a.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!l.includes("javascript:")&&!l.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const a=t.children;for(const l of a)le.removeAttributes(l),le.clean(l)}static removeAttributes(t){for(const{name:a,value:l}of t.attributes)le.isPossiblyDangerous(a,l)&&t.removeAttribute(a)}}le.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,le.selectProp=le.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),le.transformProp=le.testProp(["transform","WebkitTransform"]);const Xe={supported:!1,testSupport:function(y){!gt&&Ue&&(pt?Dt(y):Ve=y)}};let Ve,Ue,gt=!1,pt=!1;function Dt(y){const t=y.createTexture();y.bindTexture(y.TEXTURE_2D,t);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,Ue),y.isContextLost())return;Xe.supported=!0}catch{}y.deleteTexture(t),gt=!0}var _t;typeof document<"u"&&(Ue=document.createElement("img"),Ue.onload=()=>{Ve&&Dt(Ve),Ve=null,pt=!0},Ue.onerror=()=>{gt=!0,Ve=null},Ue.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(y){let t,a,l,f;y.resetRequestQueue=()=>{t=[],a=0,l=0,f={}},y.addThrottleControl=D=>{const k=l++;return f[k]=D,k},y.removeThrottleControl=D=>{delete f[D],b()},y.getImage=(D,k,j=!0)=>new Promise(((U,N)=>{Xe.supported&&(D.headers||(D.headers={}),D.headers.accept="image/webp,*/*"),c.e(D,{type:"image"}),t.push({abortController:k,requestParameters:D,supportImageRefresh:j,state:"queued",onError:H=>{N(H)},onSuccess:H=>{U(H)}}),b()}));const x=D=>c._(this,void 0,void 0,(function*(){D.state="running";const{requestParameters:k,supportImageRefresh:j,onError:U,onSuccess:N,abortController:H}=D,Q=j===!1&&!c.i(self)&&!c.g(k.url)&&(!k.headers||Object.keys(k.headers).reduce(((se,he)=>se&&he==="accept"),!0));a++;const ae=Q?E(k,H):c.m(k,H);try{const se=yield ae;delete D.abortController,D.state="completed",se.data instanceof HTMLImageElement||c.b(se.data)?N(se):se.data&&N({data:yield(oe=se.data,typeof createImageBitmap=="function"?c.f(oe):c.h(oe)),cacheControl:se.cacheControl,expires:se.expires})}catch(se){delete D.abortController,U(se)}finally{a--,b()}var oe})),b=()=>{const D=(()=>{for(const k of Object.keys(f))if(f[k]())return!0;return!1})()?c.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let k=a;k<D&&t.length>0;k++){const j=t.shift();j.abortController.signal.aborted?k--:x(j)}},E=(D,k)=>new Promise(((j,U)=>{const N=new Image,H=D.url,Q=D.credentials;Q&&Q==="include"?N.crossOrigin="use-credentials":(Q&&Q==="same-origin"||!c.d(H))&&(N.crossOrigin="anonymous"),k.signal.addEventListener("abort",(()=>{N.src="",U(new c.a(k.signal.reason))})),N.fetchPriority="high",N.onload=()=>{N.onerror=N.onload=null,j({data:N})},N.onerror=()=>{N.onerror=N.onload=null,k.signal.aborted||U(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},N.src=H}))})(_t||(_t={})),_t.resetRequestQueue();class Mt{constructor(t){this._transformRequestFn=t??null}transformRequest(t,a){return this._transformRequestFn&&this._transformRequestFn(t,a)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function Ot(y){const t=[];if(typeof y=="string")t.push({id:"default",url:y});else if(y&&y.length>0){const a=[];for(const{id:l,url:f}of y){const x=`${l}${f}`;a.indexOf(x)===-1&&(a.push(x),t.push({id:l,url:f}))}}return t}function si(y,t,a){try{const l=new URL(y);return l.pathname+=`${t}${a}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${y}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Gi(y){const{userImage:t}=y;return!!(t&&t.render&&t.render())&&(y.data.replace(new Uint8Array(t.data.buffer)),!0)}class ki extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const t of Object.keys(this.images))this.removeImage(t);this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:a,promiseResolve:l}of this.requestors)l(this._getImagesForIds(a));this.requestors=[]}}getImage(t){const a=this.images[t];if(a&&!a.data&&a.spriteData){const l=a.spriteData;a.data=new c.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),a.spriteData=null}return a}addImage(t,a){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,a)&&(this.images[t]=a)}_validate(t,a){let l=!0;const f=a.data||a.spriteData;return this._validateStretch(a.stretchX,f&&f.width)||(this.fire(new c.k(new Error(`Image "${t}" has invalid "stretchX" value`))),l=!1),this._validateStretch(a.stretchY,f&&f.height)||(this.fire(new c.k(new Error(`Image "${t}" has invalid "stretchY" value`))),l=!1),this._validateContent(a.content,a)||(this.fire(new c.k(new Error(`Image "${t}" has invalid "content" value`))),l=!1),l}_validateStretch(t,a){if(!t)return!0;let l=0;for(const f of t){if(f[0]<l||f[1]<f[0]||a<f[1])return!1;l=f[1]}return!0}_validateContent(t,a){if(!t)return!0;if(t.length!==4)return!1;const l=a.spriteData,f=l&&l.width||a.data.width,x=l&&l.height||a.data.height;return!(t[0]<0||f<t[0]||t[1]<0||x<t[1]||t[2]<0||f<t[2]||t[3]<0||x<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,a,l=!0){const f=this.getImage(t);if(l&&(f.data.width!==a.data.width||f.data.height!==a.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=f.version+1,this.images[t]=a,this.updatedImages[t]=!0}removeImage(t){const a=this.images[t];delete this.images[t],delete this.patterns[t],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((a,l)=>{let f=!0;if(!this.isLoaded())for(const x of t)this.images[x]||(f=!1);this.isLoaded()||f?a(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:a})}))}_getImagesForIds(t){const a={};for(const l of t){let f=this.getImage(l);f||(this.fire(new c.l("styleimagemissing",{id:l})),f=this.getImage(l)),f?a[l]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:c.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:t,height:a}=this.atlasImage;return{width:t,height:a}}getPattern(t){const a=this.patterns[t],l=this.getImage(t);if(!l)return null;if(a&&a.position.version===l.version)return a.position;if(a)a.position.version=l.version;else{const f={w:l.data.width+2,h:l.data.height+2,x:0,y:0},x=new c.I(f,l);this.patterns[t]={bin:f,position:x}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const a=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(t,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const x in this.patterns)t.push(this.patterns[x].bin);const{w:a,h:l}=c.p(t),f=this.atlasImage;f.resize({width:a||1,height:l||1});for(const x in this.patterns){const{bin:b}=this.patterns[x],E=b.x+1,D=b.y+1,k=this.getImage(x).data,j=k.width,U=k.height;c.R.copy(k,f,{x:0,y:0},{x:E,y:D},{width:j,height:U}),c.R.copy(k,f,{x:0,y:U-1},{x:E,y:D-1},{width:j,height:1}),c.R.copy(k,f,{x:0,y:0},{x:E,y:D+U},{width:j,height:1}),c.R.copy(k,f,{x:j-1,y:0},{x:E-1,y:D},{width:1,height:U}),c.R.copy(k,f,{x:0,y:0},{x:E+j,y:D},{width:1,height:U})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const a of t){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const l=this.getImage(a);l||c.w(`Image with ID: "${a}" was not found`),Gi(l)&&this.updateImage(a,l)}}cloneImages(){const t={};for(const a in this.images){const l=this.images[a];t[a]=Object.assign(Object.assign({},l),{data:l.data?l.data.clone():null})}return t}}const Bn=1e20;function yr(y,t,a,l,f,x,b,E,D){for(let k=t;k<t+l;k++)On(y,a*x+k,x,f,b,E,D);for(let k=a;k<a+f;k++)On(y,k*x+t,1,l,b,E,D)}function On(y,t,a,l,f,x,b){x[0]=0,b[0]=-Bn,b[1]=Bn,f[0]=y[t];for(let E=1,D=0,k=0;E<l;E++){f[E]=y[t+E*a];const j=E*E;do{const U=x[D];k=(f[E]-f[U]+j-U*U)/(E-U)/2}while(k<=b[D]&&--D>-1);D++,x[D]=E,b[D]=k,b[D+1]=Bn}for(let E=0,D=0;E<l;E++){for(;b[D+1]<E;)D++;const k=x[D],j=E-k;y[t+E*a]=f[k]+j*j}}const Je=c.v.layout_symbol["text-font"].default.join(",");class at{constructor(t,a,l){this.requestManager=t,this.localIdeographFontFamily=a,this.entries={},this.lang=l}setURL(t){this.url=t}getGlyphs(t){return c._(this,void 0,void 0,(function*(){const a=[];for(const x in t)for(const b of t[x])a.push(this._getAndCacheGlyphsPromise(x,b));const l=yield Promise.all(a),f={};for(const{stack:x,id:b,glyph:E}of l)f[x]||(f[x]={}),f[x][b]=E&&{id:E.id,bitmap:E.bitmap.clone(),metrics:E.metrics};return f}))}_getAndCacheGlyphsPromise(t,a){return c._(this,void 0,void 0,(function*(){let l=this.entries[t];l||(l=this.entries[t]={glyphs:{},requests:{},ranges:{}});let f=l.glyphs[a];return f!==void 0?{stack:t,id:a,glyph:f}:!this.url||this._charUsesLocalIdeographFontFamily(a)?(f=l.glyphs[a]=this._drawGlyph(l,t,a),{stack:t,id:a,glyph:f}):yield this._downloadAndCacheRangePromise(t,a)}))}_downloadAndCacheRangePromise(t,a){return c._(this,void 0,void 0,(function*(){const l=this.entries[t],f=Math.floor(a/256);if(l.ranges[f])return{stack:t,id:a,glyph:null};if(!l.requests[f]){const x=at.loadGlyphRange(t,f,this.url,this.requestManager);l.requests[f]=x}try{const x=yield l.requests[f];for(const b in x)l.glyphs[+b]=x[+b];return l.ranges[f]=!0,{stack:t,id:a,glyph:x[a]||null}}catch(x){const b=l.glyphs[a]=this._drawGlyph(l,t,a);return this._warnOnMissingGlyphRange(b,f,a,x),{stack:t,id:a,glyph:b}}}))}_warnOnMissingGlyphRange(t,a,l,f){const x=256*a,b=x+255,E=l.toString(16).padStart(4,"0").toUpperCase();c.w(`Unable to load glyph range ${a}, ${x}-${b}. Rendering codepoint U+${E} locally instead. ${f}`)}_charUsesLocalIdeographFontFamily(t){return!!this.localIdeographFontFamily&&c.q(t)}_drawGlyph(t,a,l){const f=a===Je&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(l),x=f?"ideographTinySDF":"tinySDF";t[x]||(t[x]=this._createTinySDF(f?this.localIdeographFontFamily:a));const b=t[x].draw(String.fromCodePoint(l)),E=new RegExp("^\\p{gc=Cf}+$","u").test(String.fromCodePoint(l));return{id:l,bitmap:new c.r({width:b.width||60,height:b.height||60},b.data),metrics:{width:E?0:b.glyphWidth/2||24,height:b.glyphHeight/2||24,left:b.glyphLeft/2+.5||0,top:b.glyphTop/2-27.5||-8,advance:E?0:b.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(t){const a=t?t.split(","):[];a.push("sans-serif");const l=a.map((f=>/[-\w]+/.test(f)?f:`'${CSS.escape(f)}'`)).join(",");return new at.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:l,fontWeight:this._fontWeight(a[0]),fontStyle:this._fontStyle(a[0]),lang:this.lang})}_fontStyle(t){return/italic/i.test(t)?"italic":/oblique/i.test(t)?"oblique":"normal"}_fontWeight(t){const a={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let l;for(const[f,x]of Object.entries(a))new RegExp(`\\b${f}\\b`,"i").test(t)&&(l=`${x}`);return l}destroy(){for(const t in this.entries){const a=this.entries[t];a.tinySDF&&(a.tinySDF=null),a.ideographTinySDF&&(a.ideographTinySDF=null),a.glyphs={},a.requests={},a.ranges={}}this.entries={}}}at.loadGlyphRange=function(y,t,a,l){return c._(this,void 0,void 0,(function*(){const f=256*t,x=f+255,b=l.transformRequest(a.replace("{fontstack}",y).replace("{range}",`${f}-${x}`),"Glyphs"),E=yield c.n(b,new AbortController);if(!E||!E.data)throw new Error(`Could not load glyph range. range: ${t}, ${f}-${x}`);const D={};for(const k of c.o(E.data))D[k.id]=k;return D}))},at.TinySDF=class{constructor({fontSize:y=24,buffer:t=3,radius:a=8,cutoff:l=.25,fontFamily:f="sans-serif",fontWeight:x="normal",fontStyle:b="normal",lang:E=null}={}){this.buffer=t,this.cutoff=l,this.radius=a,this.lang=E;const D=this.size=y+4*t,k=this._createCanvas(D),j=this.ctx=k.getContext("2d",{willReadFrequently:!0});j.font=`${b} ${x} ${y}px ${f}`,j.textBaseline="alphabetic",j.textAlign="left",j.fillStyle="black",this.gridOuter=new Float64Array(D*D),this.gridInner=new Float64Array(D*D),this.f=new Float64Array(D),this.z=new Float64Array(D+1),this.v=new Uint16Array(D)}_createCanvas(y){const t=document.createElement("canvas");return t.width=t.height=y,t}draw(y){const{width:t,actualBoundingBoxAscent:a,actualBoundingBoxDescent:l,actualBoundingBoxLeft:f,actualBoundingBoxRight:x}=this.ctx.measureText(y),b=Math.ceil(a),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-f))),D=Math.min(this.size-this.buffer,b+Math.ceil(l)),k=E+2*this.buffer,j=D+2*this.buffer,U=Math.max(k*j,0),N=new Uint8ClampedArray(U),H={data:N,width:k,height:j,glyphWidth:E,glyphHeight:D,glyphTop:b,glyphLeft:0,glyphAdvance:t};if(E===0||D===0)return H;const{ctx:Q,buffer:ae,gridInner:oe,gridOuter:se}=this;this.lang&&(Q.lang=this.lang),Q.clearRect(ae,ae,E,D),Q.fillText(y,ae,ae+b);const he=Q.getImageData(ae,ae,E,D);se.fill(Bn,0,U),oe.fill(0,0,U);for(let ye=0;ye<D;ye++)for(let ce=0;ce<E;ce++){const ge=he.data[4*(ye*E+ce)+3]/255;if(ge===0)continue;const be=(ye+ae)*k+ce+ae;if(ge===1)se[be]=0,oe[be]=Bn;else{const me=.5-ge;se[be]=me>0?me*me:0,oe[be]=me<0?me*me:0}}yr(se,0,0,k,j,k,this.f,this.v,this.z),yr(oe,ae,ae,E,D,k,this.f,this.v,this.z);for(let ye=0;ye<U;ye++){const ce=Math.sqrt(se[ye])-Math.sqrt(oe[ye]);N[ye]=Math.round(255-255*(ce/this.radius+this.cutoff))}return H}};class Pt{constructor(){this.specification=c.u.light.position}possiblyEvaluate(t,a){return c.F(t.expression.evaluate(a))}interpolate(t,a,l){return{x:c.G.number(t.x,a.x,l),y:c.G.number(t.y,a.y,l),z:c.G.number(t.z,a.z,l)}}}let It;class ni extends c.E{constructor(t){super(),It=It||new c.t({anchor:new c.D(c.u.light.anchor),position:new Pt,color:new c.D(c.u.light.color),intensity:new c.D(c.u.light.intensity)}),this._transitionable=new c.x(It,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,a={}){if(!this._validate(c.y,t,a))for(const l in t){const f=t[l];l.endsWith(c.z)?this._transitionable.setTransition(l.slice(0,-c.z.length),f):this._transitionable.setValue(l,f)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,l){return(!l||l.validate!==!1)&&c.B(this,t.call(c.C,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.u}))}}const Ee=new c.t({"sky-color":new c.D(c.u.sky["sky-color"]),"horizon-color":new c.D(c.u.sky["horizon-color"]),"fog-color":new c.D(c.u.sky["fog-color"]),"fog-ground-blend":new c.D(c.u.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.u.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.u.sky["atmosphere-blend"])});class ot extends c.E{constructor(t){super(),this._transitionable=new c.x(Ee,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.H(0))}setSky(t,a={}){if(!this._validate(c.J,t,a)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in t){const f=t[l];l.endsWith(c.z)?this._transitionable.setTransition(l.slice(0,-c.z.length),f):this._transitionable.setValue(l,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,l={}){return l?.validate!==!1&&c.B(this,t.call(c.C,c.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.u})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class St{constructor(t,a){this.width=t,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,a){const l=t.join(",")+String(a);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(t,a)),this.dashEntry[l]}getDashRanges(t,a,l){const f=[];let x=t.length%2==1?-t[t.length-1]*l:0,b=t[0]*l,E=!0;f.push({left:x,right:b,isDash:E,zeroLength:t[0]===0});let D=t[0];for(let k=1;k<t.length;k++){E=!E;const j=t[k];x=D*l,D+=j,b=D*l,f.push({left:x,right:b,isDash:E,zeroLength:j===0})}return f}addRoundDash(t,a,l){const f=a/2;for(let x=-l;x<=l;x++){const b=this.width*(this.nextRow+l+x);let E=0,D=t[E];for(let k=0;k<this.width;k++){k/D.right>1&&(D=t[++E]);const j=Math.abs(k-D.left),U=Math.abs(k-D.right),N=Math.min(j,U);let H;const Q=x/l*(f+1);if(D.isDash){const ae=f-Math.abs(Q);H=Math.sqrt(N*N+ae*ae)}else H=f-Math.sqrt(N*N+Q*Q);this.data[b+k]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(t){for(let E=t.length-1;E>=0;--E){const D=t[E],k=t[E+1];D.zeroLength?t.splice(E,1):k&&k.isDash===D.isDash&&(k.left=D.left,t.splice(E,1))}const a=t[0],l=t[t.length-1];a.isDash===l.isDash&&(a.left=l.left-this.width,l.right=a.right+this.width);const f=this.width*this.nextRow;let x=0,b=t[x];for(let E=0;E<this.width;E++){E/b.right>1&&(b=t[++x]);const D=Math.abs(E-b.left),k=Math.abs(E-b.right),j=Math.min(D,k);this.data[f+E]=Math.max(0,Math.min(255,(b.isDash?j:-j)+128))}}addDash(t,a){const l=a?7:0,f=2*l+1;if(this.nextRow+f>this.height)return c.w("LineAtlas out of space"),null;let x=0;for(let E=0;E<t.length;E++)x+=t[E];if(x!==0){const E=this.width/x,D=this.getDashRanges(t,this.width,E);a?this.addRoundDash(D,E,l):this.addRegularDash(D)}const b={y:this.nextRow+l,height:2*l,width:x};return this.nextRow+=f,this.dirty=!0,b}bind(t){const a=t.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const zt="maplibre_preloaded_worker_pool";class Ht{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Ht.workerCount;)this.workers.push(new Worker(c.c.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach((a=>{a.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[zt]}numActive(){return Object.keys(this.active).length}}const Nt=Math.floor(De.hardwareConcurrency/2);let hi,Li;function Xi(){return hi||(hi=new Ht),hi}Ht.workerCount=c.K(globalThis)?Math.max(Math.min(Nt,3),1):1;class va{constructor(t,a){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=a;const l=this.workerPool.acquire(a);for(let f=0;f<l.length;f++){const x=new c.L(l[f],a);x.name=`Worker ${f}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,a){const l=[];for(const f of this.actors)l.push(f.sendAsync({type:t,data:a}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((a=>{a.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,a){for(const l of this.actors)l.registerMessageHandler(t,a)}unregisterMessageHandler(t){for(const a of this.actors)a.unregisterMessageHandler(t)}}function Kr(){return Li||(Li=new va(Xi(),c.M),Li.registerMessageHandler("GR",((y,t,a)=>c.m(t,a)))),Li}function Qr(y,t){const a=c.N();return c.O(a,a,[1,1,0]),c.Q(a,a,[.5*y.width,.5*y.height,1]),y.calculatePosMatrix?c.S(a,a,y.calculatePosMatrix(t.toUnwrapped())):a}function kc(y,t,a,l,f,x,b){var E;const D=(function(N,H,Q){if(N)for(const ae of N){const oe=H[ae];if(oe&&oe.source===Q&&oe.type==="fill-extrusion")return!0}else for(const ae in H){const oe=H[ae];if(oe.source===Q&&oe.type==="fill-extrusion")return!0}return!1})((E=f?.layers)!==null&&E!==void 0?E:null,t,y.id),k=x.maxPitchScaleFactor(),j=y.tilesIn(l,k,D);j.sort(sn);const U=[];for(const N of j)U.push({wrappedTileID:N.tileID.wrapped().key,queryResults:N.tile.queryRenderedFeatures(t,a,y.getState(),N.queryGeometry,N.cameraQueryGeometry,N.scale,f,x,k,Qr(x,N.tileID),b?(H,Q)=>b(N.tileID,H,Q):void 0)});return(function(N,H){for(const Q in N)for(const ae of N[Q])jr(ae,H);return N})((function(N){const H={},Q={};for(const ae of N){const oe=ae.queryResults,se=ae.wrappedTileID,he=Q[se]=Q[se]||{};for(const ye in oe){const ce=oe[ye],ge=he[ye]=he[ye]||{},be=H[ye]=H[ye]||[];for(const me of ce)ge[me.featureIndex]||(ge[me.featureIndex]=!0,be.push(me))}}return H})(U),y)}function sn(y,t){const a=y.tileID,l=t.tileID;return a.overscaledZ-l.overscaledZ||a.canonical.y-l.canonical.y||a.wrap-l.wrap||a.canonical.x-l.canonical.x}function jr(y,t){const a=y.feature,l=t.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=l}function Jr(y,t,a,l){return c._(this,void 0,void 0,(function*(){let f=y;if(y.url?f=(yield c.j(t.transformRequest(y.url,"Source"),a)).data:yield De.frameAsync(a,l),!f)return null;const x=c.U(c.e(f,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(x.vectorLayerIds=f.vector_layers.map((b=>b.id))),x}))}class on{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof c.V?new c.V(t.lng,t.lat):c.V.convert(t),this}setSouthWest(t){return this._sw=t instanceof c.V?new c.V(t.lng,t.lat):c.V.convert(t),this}extend(t){const a=this._sw,l=this._ne;let f,x;if(t instanceof c.V)f=t,x=t;else{if(!(t instanceof on))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(on.convert(t)):this.extend(c.V.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(c.V.convert(t)):this;if(f=t._sw,x=t._ne,!f||!x)return this}return a||l?(a.lng=Math.min(f.lng,a.lng),a.lat=Math.min(f.lat,a.lat),l.lng=Math.max(x.lng,l.lng),l.lat=Math.max(x.lat,l.lat)):(this._sw=new c.V(f.lng,f.lat),this._ne=new c.V(x.lng,x.lat)),this}getCenter(){return new c.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.V(this.getWest(),this.getNorth())}getSouthEast(){return new c.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:l}=c.V.convert(t);let f=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&f}intersects(t){if(!((t=on.convert(t)).getNorth()>=this.getSouth()&&t.getSouth()<=this.getNorth()))return!1;const a=Math.abs(this.getEast()-this.getWest()),l=Math.abs(t.getEast()-t.getWest());if(a>=360||l>=360)return!0;const f=c.W(this.getWest(),-180,180),x=c.W(this.getEast(),-180,180),b=c.W(t.getWest(),-180,180),E=c.W(t.getEast(),-180,180),D=f>=x,k=b>=E;return!(!D||!k)||(D?E>=f||b<=x:k?x>=b||f<=E:b<=x&&E>=f)}static convert(t){return t instanceof on?t:t&&new on(t)}static fromLngLat(t,a=0){const l=360*a/40075017,f=l/Math.cos(Math.PI/180*t.lat);return new on(new c.V(t.lng-f,t.lat-l),new c.V(t.lng+f,t.lat+l))}adjustAntiMeridian(){const t=new c.V(this._sw.lng,this._sw.lat),a=new c.V(this._ne.lng,this._ne.lat);return new on(t,t.lng>a.lng?new c.V(a.lng+360,a.lat):a)}}class cs{constructor(t,a,l){this.bounds=on.convert(this.validateBounds(t)),this.minzoom=a||0,this.maxzoom=l||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const a=Math.pow(2,t.z),l=Math.floor(c.Y(this.bounds.getWest())*a),f=Math.floor(c.X(this.bounds.getNorth())*a),x=Math.ceil(c.Y(this.bounds.getEast())*a),b=Math.ceil(c.X(this.bounds.getSouth())*a);return t.x>=l&&t.x<x&&t.y>=f&&t.y<b}}class ho extends c.E{constructor(t,a,l,f){if(super(),this.id=t,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.U(a,["url","scheme","tileSize","promoteId","encoding"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield Jr(this._options,this.map._requestManager,this._tileJSONRequest,this.map._ownerWindow);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),t&&(c.e(this,t),t.bounds&&(this.tileBounds=new cs(t.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,c.Z(t)||this.fire(new c.k(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(t){return c._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(a,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(t)};l.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise(((x,b)=>{t.reloadPromise={resolve:x,reject:b}}))}else t.actor=this.dispatcher.getActor(),f="LT";t.abortController=new AbortController;try{const x=yield t.actor.sendAsync({type:f,data:l},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,x)}catch(x){if(delete t.abortController,t.aborted)return;if(x&&x.status!==404)throw x;this._afterTileLoadWorkerResponse(t,null)}}))}_getOverzoomParameters(t){if(t.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const a=t.tileID.scaledTo(this.maxzoom).canonical,l=a.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:a,overzoomRequest:this.map._requestManager.transformRequest(l,"Tile")}}_afterTileLoadWorkerResponse(t,a){if(a&&a.resourceTiming&&(t.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&t.setExpiryData(a),t.loadVectorData(a,this.map.painter),t.reloadPromise){const l=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(l.resolve).catch(l.reject)}}abortTile(t){return c._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return c._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class fo extends c.E{constructor(t,a,l,f){super(),this.id=t,this.dispatcher=l,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.U(a,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,(function*(t=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield Jr(this._options,this.map._requestManager,this._tileJSONRequest,this.map._ownerWindow);this._tileJSONRequest=null,this._loaded=!0,a&&(c.e(this,a),a.bounds&&(this.tileBounds=new cs(a.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(a){this._tileJSONRequest=null,this._loaded=!0,c.Z(a)||this.fire(new c.k(a))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return c.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return c._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const l=yield _t.getImage(this.map._requestManager.transformRequest(a,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&(l.cacheControl||l.expires)&&t.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const f=this.map.painter.context,x=f.gl,b=l.data;t.texture=this.map.painter.getTileTexture(b.width),t.texture?t.texture.update(b,{useMipmap:!0}):(t.texture=new c.T(f,b,x.RGBA,{useMipmap:!0}),t.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(l){if(delete t.abortController,t.aborted)t.state="unloaded";else if(l)throw t.state="errored",l}}))}abortTile(t){return c._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return c._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class ba extends fo{constructor(t,a,l,f){super(t,a,l,f),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(t){return c._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(a,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const f=yield _t.getImage(l,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(f&&f.data){const x=f.data;this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&t.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const b=c.b(x)&&c.$()?x:yield this.readImageNow(x),E={type:this.type,uid:t.uid,source:this.id,rawImageData:b,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const D=yield t.actor.sendAsync({type:"LDT",data:E});t.dem=D,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(f){if(delete t.abortController,t.aborted)t.state="unloaded";else if(f)throw t.state="errored",f}}))}readImageNow(t){return c._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&c.a0()){const a=t.width+2,l=t.height+2;try{return new c.R({width:a,height:l},yield c.a1(t,-1,-1,a,l))}catch{}}return De.getImageData(t,1)}))}_getNeighboringTiles(t){const a=t.canonical,l=Math.pow(2,a.z),f=(a.x-1+l)%l,x=a.x===0?t.wrap-1:t.wrap,b=(a.x+1+l)%l,E=a.x+1===l?t.wrap+1:t.wrap,D={};return D[new c.a2(t.overscaledZ,x,a.z,f,a.y).key]={backfilled:!1},D[new c.a2(t.overscaledZ,E,a.z,b,a.y).key]={backfilled:!1},a.y>0&&(D[new c.a2(t.overscaledZ,x,a.z,f,a.y-1).key]={backfilled:!1},D[new c.a2(t.overscaledZ,t.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},D[new c.a2(t.overscaledZ,E,a.z,b,a.y-1).key]={backfilled:!1}),a.y+1<l&&(D[new c.a2(t.overscaledZ,x,a.z,f,a.y+1).key]={backfilled:!1},D[new c.a2(t.overscaledZ,t.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},D[new c.a2(t.overscaledZ,E,a.z,b,a.y+1).key]={backfilled:!1}),D}unloadTile(t){return c._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}function Os(y){return y.type==="GeometryCollection"?y.geometries.map((t=>t.coordinates)).flat(1/0):y.coordinates.flat(1/0)}function $o(y){const t=new on;let a;switch(y.type){case"FeatureCollection":a=y.features.map((l=>Os(l.geometry))).flat(1/0);break;case"Feature":a=Os(y.geometry);break;default:a=Os(y)}if(a.length==0)return t;for(let l=0;l<a.length-1;l+=2)t.extend([a[l],a[l+1]]);return t}class Qn extends c.E{constructor(t,a,l,f){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:a.data},this.actor=l.getActor(),this.setEventedParent(f),this._data=typeof a.data=="string"?{url:a.data}:{geojson:a.data},this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId,a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(a.buffer!==void 0?a.buffer:128),tolerance:this._pixelsToTileUnits(a.tolerance!==void 0?a.tolerance:.375),extent:c.a5,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(a.clusterMaxZoom),minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.a5,radius:this._pixelsToTileUnits(a.clusterRadius||50),log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(t){return t*(c.a5/this.tileSize)}_getClusterMaxZoom(t){const a=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${a}"`),a}load(){return c._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t,a){this._data=typeof t=="string"?{url:t}:{geojson:t},this._pendingWorkerUpdate={data:t};const l=this._updateWorkerData();return a?l:this}updateData(t,a){this._pendingWorkerUpdate.diff=c.a6(this._pendingWorkerUpdate.diff,t);const l=this._updateWorkerData();return a?l:this}getData(){return c._(this,void 0,void 0,(function*(){const t=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}getBounds(){return c._(this,void 0,void 0,(function*(){return $o(yield this.getData())}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,a,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:a,offset:l}})}_updateWorkerData(){return c._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void c.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:t,diff:a}=this._pendingWorkerUpdate,l=this._getLoadGeoJSONParameters(t,a);t!==void 0?this._pendingWorkerUpdate.data=void 0:a&&(this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,yield this._dispatchWorkerUpdate(l)}))}_getLoadGeoJSONParameters(t,a){const l=c.e({type:this.type},this.workerOptions);return typeof t=="string"?(l.request=this.map._requestManager.transformRequest(De.resolveURL(t),"Source"),l.request.collectResourceTiming=this._collectResourceTiming,l):t!==void 0?(l.data=t,l):(a&&(l.dataDiff=a),l)}_dispatchWorkerUpdate(t){return c._(this,void 0,void 0,(function*(){this._isUpdatingWorker=!0,this.fire(new c.l("dataloading",{dataType:"source"}));try{const a=yield this.actor.sendAsync({type:"LD",data:t});if(this._isUpdatingWorker=!1,this._removed||a.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));a.data&&(this._data={geojson:a.data});const l=this._applyDiffToSource(t.dataDiff),f=this._getShouldReloadTileOptions(l),x={dataType:"source"};this._applyResourceTiming(x,a),this.fire(new c.l("data",Object.assign(Object.assign({},x),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},x),{sourceDataType:"content",shouldReloadTileOptions:f})))}catch(a){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(a))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyResourceTiming(t,a){var l;if(!this._collectResourceTiming)return;const f=(l=a.resourceTiming)===null||l===void 0?void 0:l[this.id];if(!f)return;const x=f.slice(0);x?.length&&c.e(t,{resourceTiming:x})}_applyDiffToSource(t){if(!t)return;const a=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const f=c.a7(this._data.geojson,a);if(!f)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:f}}if(!this._data.updateable)return;const l=c.a8(this._data.updateable,t,a);return t.removeAll||this._options.cluster?void 0:l}_getShouldReloadTileOptions(t){if(t)return{affectedBounds:t.filter(Boolean).map((a=>$o(a)))}}shouldReloadTile(t,{affectedBounds:a}){if(t.state==="loading")return!0;if(t.state==="unloaded")return!1;const{buffer:l,extent:f}=this.workerOptions.geojsonVtOptions,x=(function({x:b,y:E,z:D},k=0){const j=c.a3((b-k)/Math.pow(2,D)),U=c.a4((E+1+k)/Math.pow(2,D)),N=c.a3((b+1+k)/Math.pow(2,D)),H=c.a4((E-k)/Math.pow(2,D));return new on([j,U],[N,H])})(t.tileID.canonical,l/f);for(const b of a)if(x.intersects(b))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(t){return c._(this,void 0,void 0,(function*(){const a=t.actor?"RT":"LT";t.actor=this.actor;const l={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const f=yield this.actor.sendAsync({type:a,data:l},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(f,this.map.painter,a==="RT")}))}abortTile(t){return c._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return c._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class ea extends c.E{constructor(t,a,l,f){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=l,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=a}load(t){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield _t.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,t&&(this.coordinates=t),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,c.Z(a)||this.fire(new c.k(a))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const a=t.map(c.a9.fromLngLat);var l;return this.tileID=(function(f){const x=c.aa.fromPoints(f),b=x.width(),E=x.height(),D=Math.max(b,E),k=Math.max(0,Math.floor(-Math.log(D)/Math.LN2)),j=Math.pow(2,k);return new c.ac(k,Math.floor((x.minX+x.maxX)/2*j),Math.floor((x.minY+x.maxY)/2*j))})(a),this.terrainTileRanges=this._getOverlappingTileRanges(a),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=a.map((f=>this.tileID.getTilePoint(f)._round())),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,a=t.gl;this.texture||(this.texture=new c.T(t,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const f in this.tiles){const x=this.tiles[f];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return c._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:a,minY:l,maxX:f,maxY:x}=c.aa.fromPoints(t),b={};for(let E=0;E<=c.ab;E++){const D=Math.pow(2,E),k=Math.floor(a*D),j=Math.floor(l*D),U=Math.floor(f*D),N=Math.floor(x*D),H=(k%D+D)%D,Q=U%D,ae=Math.floor(k/D),oe=Math.floor(U/D);b[E]={minWrap:ae,maxWrap:oe,minTileXWrapped:H,maxTileXWrapped:Q,minTileY:j,maxTileY:N}}return b}}class Fs extends ea{constructor(t,a,l,f){super(t,a,l,f),this.roundZoom=!0,this.type="video",this.options=a}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const a of t.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield c.ad(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new c.k(a))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const a=this.video.seekable;t<a.start(0)||t>a.end(0)?this.fire(new c.k(new c.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,a=t.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(t,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const f in this.tiles){const x=this.tiles[f];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Nl extends ea{constructor(t,a,l,f){super(t,a,l,f),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some((x=>!Array.isArray(x)||x.length!==2||x.some((b=>typeof b!="number"))))||this.fire(new c.k(new c.ae(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.ae(`sources.${t}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.k(new c.ae(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.ae(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.ae(`sources.${t}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,l=a.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new c.T(a,this.canvas,l.RGBA,{premultiply:!0}),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let f=!1;for(const x in this.tiles){const b=this.tiles[x];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,f=!0)}f&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Ns={},Vl=y=>{switch(y){case"geojson":return Qn;case"image":return ea;case"raster":return fo;case"raster-dem":return ba;case"vector":return ho;case"video":return Fs;case"canvas":return Nl}return Ns[y]},Ce="RTLPluginLoaded";class Y extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Kr()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((a=>{throw this.status="error",a}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return c._(this,arguments,void 0,(function*(a,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=De.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return c._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(Ce))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let W=null;function J(){return W||(W=new Y),W}var pe,ve;(function(y){y[y.Base=0]="Base",y[y.Parent=1]="Parent"})(pe||(pe={})),(function(y){y[y.Departing=0]="Departing",y[y.Incoming=1]="Incoming"})(ve||(ve={}));class Pe{constructor(t,a){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=t,this.uid=c.af(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(t){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(t||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:t,fadingDirection:a,fadingParentID:l,fadeEndTime:f}){this.resetFadeLogic(),this.fadingRole=t,this.fadingDirection=a,this.fadingParentID=l,this.fadeEndTime=f}setSelfFadeLogic(t){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=t}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=xe(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,a,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData,this.latestFeatureIndex.encoding=t.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=(function(f,x){const b={};if(!x)return b;for(const E of f){const D=E.layerIds.map((k=>x.getLayer(k))).filter(Boolean);if(D.length!==0){E.layers=D,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map((k=>D.filter((j=>j.id===k))[0])));for(const k of D)b[k.id]=E}}return b})(t.buckets,a?.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const x=this.buckets[f];if(x instanceof c.ah){if(this.hasSymbolBuckets=!0,!l)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const x=this.buckets[f];if(x instanceof c.ah&&x.hasRTLText){this.hasRTLText=!0,J().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const x=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(f).queryRadius(x))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),this.dashPositions=t.dashPositions}else this.collisionBoxArray=new c.ag}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const l in this.buckets){const f=this.buckets[l];f.uploadPending()&&f.upload(t)}const a=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(t,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(t,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,a,l,f,x,b,E,D,k,j,U){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:x,scale:b,tileSize:this.tileSize,pixelPosMatrix:j,transform:D,params:E,queryPadding:this.queryPadding*k,getElevation:U},t,a,l):{}}querySourceFeatures(t,a){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const f=l.loadVTLayers(),x=a&&a.sourceLayer?a.sourceLayer:"",b=f[c.ai]||f[x];if(!b)return;const E=c.aj(a?.filter,a?.globalState),{z:D,x:k,y:j}=this.tileID.canonical,U={z:D,x:k,y:j};for(let N=0;N<b.length;N++){const H=b.feature(N);if(E.needGeometry){const oe=c.ak(H,!0);if(!E.filter(new c.H(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!E.filter(new c.H(this.tileID.overscaledZ),H))continue;const Q=l.getId(H,x),ae=new c.al(H,D,k,j,Q);ae.tile=U,t.push(ae)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const a=this.expirationTime;if(t.cacheControl){const l=c.am(t.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const l=Date.now();let f=!1;if(this.expirationTime>l)f=!1;else if(a)if(this.expirationTime<a)f=!0;else{const x=this.expirationTime-a;x?this.expirationTime=l+Math.max(x,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!a.style.hasLayer(f))continue;const x=this.buckets[f],b=x.layers[0].sourceLayer||c.ai,E=l[b],D=t[b];if(!E||!D||Object.keys(D).length===0)continue;x.update(D,E,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const k=a&&a.style&&a.style.getLayer(f);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(x)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<xe()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(t){this.symbolFadeHoldUntil=xe()+t}setDependencies(t,a){const l={};for(const f of a)l[f]=!0;this.dependencies[t]=l}hasDependency(t,a){for(const l of t){const f=this.dependencies[l];if(f){for(const x of a)if(f[x])return!0}}return!1}}class ke{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,a,l){const f=String(a);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][f]=this.stateChanges[t][f]||{},c.e(this.stateChanges[t][f],l),this.deletedStates[t]===null){this.deletedStates[t]={};for(const x in this.state[t])x!==f&&(this.deletedStates[t][x]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][f]===null){this.deletedStates[t][f]={};for(const x in this.state[t][f])l[x]||(this.deletedStates[t][f][x]=null)}else for(const x in l)this.deletedStates[t]&&this.deletedStates[t][f]&&this.deletedStates[t][f][x]===null&&delete this.deletedStates[t][f][x]}removeFeatureState(t,a,l){if(this.deletedStates[t]===null)return;const f=String(a);if(this.deletedStates[t]=this.deletedStates[t]||{},l&&a!==void 0)this.deletedStates[t][f]!==null&&(this.deletedStates[t][f]=this.deletedStates[t][f]||{},this.deletedStates[t][f][l]=null);else if(a!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][f])for(l in this.deletedStates[t][f]={},this.stateChanges[t][f])this.deletedStates[t][f][l]=null;else this.deletedStates[t][f]=null;else this.deletedStates[t]=null}getState(t,a){const l=String(a),f=c.e({},(this.state[t]||{})[l],(this.stateChanges[t]||{})[l]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const x=this.deletedStates[t][a];if(x===null)return{};for(const b in x)delete f[b]}return f}initializeTileState(t,a){t.setFeatureState(this.state,a)}coalesceChanges(t,a){const l={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const x={};for(const b in this.stateChanges[f])this.state[f][b]||(this.state[f][b]={}),c.e(this.state[f][b],this.stateChanges[f][b]),x[b]=this.state[f][b];l[f]=x}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const x={};if(this.deletedStates[f]===null)for(const b in this.state[f])x[b]={},this.state[f][b]={};else for(const b in this.deletedStates[f]){if(this.deletedStates[f][b]===null)this.state[f][b]={};else for(const E of Object.keys(this.deletedStates[f][b]))delete this.state[f][b][E];x[b]=this.state[f][b]}l[f]=l[f]||{},c.e(l[f],x)}this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0&&t.setFeatureState(l,a)}}const ze=89.25;function Re(y,t){const a=c.an(t.lat,-c.ao,c.ao);return new c.P(c.Y(t.lng)*y,c.X(a)*y)}function nt(y,t){return new c.a9(t.x/y,t.y/y).toLngLat()}function $e(y){return y.cameraToCenterDistance*Math.min(.85*Math.tan(c.ap(90-y.pitch)),Math.tan(c.ap(ze-y.pitch)))}function lt(y,t){const a=y.canonical,l=t/c.aq(a.z),f=a.x+Math.pow(2,a.z)*y.wrap,x=c.ar(new Float64Array(16));return c.O(x,x,[f*l,a.y*l,0]),c.Q(x,x,[l/c.a5,l/c.a5,1]),x}function Te(y,t,a,l,f){const x=c.a9.fromLngLat(y,t),b=f*c.as(1,y.lat),{x:E,y:D,z:k}=Ut(a,l);return new c.a9(x.x+b*-E,x.y+b*-D,x.z+b*-k)}function Ut(y,t){const a=c.ap(y),l=c.ap(t),f=Math.cos(-a),x=Math.sin(a);return{x:x*Math.sin(l),y:-x*Math.cos(l),z:f}}function wi(y,t,a){const l=t.intersectsFrustum(y);if(!a||l===0)return l;const f=t.intersectsPlane(a);return f===0?0:l===2&&f===2?2:1}function At(y,t,a){let l=0;const f=(a-t)/10;for(let x=0;x<10;x++)l+=f*Math.pow(Math.cos(t+(x+.5)/10*(a-t)),y);return l}function Rt(y,t){return function(a,l,f,x,b){const E=2*((y-1)/c.at(Math.cos(c.ap(ze-b))/Math.cos(c.ap(ze)))-1),D=Math.acos(f/x),k=2*At(E-1,0,c.ap(b/2)),j=Math.min(c.ap(ze),D+c.ap(b/2)),U=At(E-1,Math.min(j,D-c.ap(b/2)),j),N=Math.atan(l/f),H=Math.hypot(l,f);let Q=a;return Q+=c.at(x/H/Math.max(.5,Math.cos(c.ap(b/2)))),Q+=E*c.at(Math.cos(N))/2,Q-=c.at(Math.max(1,U/k/t))/2,Q}}const Wt=Rt(9.314,3);function qi(y,t){const a=(t.roundZoom?Math.round:Math.floor)(y.zoom+c.at(y.tileSize/t.tileSize));return Math.max(0,a)}function Zi(y,t){const a=y.getCameraFrustum(),l=y.getClippingPlane(),f=y.screenPointToMercatorCoordinate(y.getCameraPoint()),x=c.a9.fromLngLat(y.center,y.elevation);f.z=x.z+Math.cos(y.pitchInRadians)*y.cameraToCenterDistance/y.worldSize;const b=y.getCoveringTilesDetailsProvider(),E=b.allowVariableZoom(y,t),D=qi(y,t),k=t.minzoom||0,j=t.maxzoom!==void 0?t.maxzoom:y.maxZoom,U=Math.min(Math.max(0,D),j),N=Math.pow(2,U),H=[N*f.x,N*f.y,0],Q=[N*x.x,N*x.y,0],ae=Math.hypot(x.x-f.x,x.y-f.y),oe=Math.abs(x.z-f.z),se=Math.hypot(ae,oe),he=ge=>({zoom:0,x:0,y:0,wrap:ge,fullyVisible:!1}),ye=[],ce=[];if(y.renderWorldCopies&&b.allowWorldCopies())for(let ge=1;ge<=3;ge++)ye.push(he(-ge)),ye.push(he(ge));for(ye.push(he(0));ye.length>0;){const ge=ye.pop(),be=ge.x,me=ge.y;let Me=ge.fullyVisible;const Fe={x:be,y:me,z:ge.zoom},Le=b.getTileBoundingVolume(Fe,ge.wrap,y.elevation,t);if(!Me){const ft=wi(a,Le,l);if(ft===0)continue;Me=ft===2}const Be=b.distanceToTile2d(f.x,f.y,Fe,Le);let Oe=D;E&&(Oe=(t.calculateTileZoom||Wt)(y.zoom+c.at(y.tileSize/t.tileSize),Be,oe,se,y.fov)),Oe=(t.roundZoom?Math.round:Math.floor)(Oe),Oe=Math.max(0,Oe);const dt=Math.min(Oe,j);if(ge.wrap=b.getWrap(x,Fe,ge.wrap),ge.zoom>=dt){if(ge.zoom<k)continue;const ft=U-ge.zoom,rt=H[0]-.5-(be<<ft),yt=H[1]-.5-(me<<ft),$t=t.reparseOverscaled?Math.max(ge.zoom,Oe):ge.zoom;ce.push({tileID:new c.a2(ge.zoom===j?$t:ge.zoom,ge.wrap,ge.zoom,be,me),distanceSq:c.au([Q[0]-.5-be,Q[1]-.5-me]),tileDistanceToCamera:Math.sqrt(rt*rt+yt*yt)})}else for(let ft=0;ft<4;ft++)ye.push({zoom:ge.zoom+1,x:(be<<1)+ft%2,y:(me<<1)+(ft>>1),wrap:ge.wrap,fullyVisible:Me})}return ce.sort(((ge,be)=>ge.distanceSq-be.distanceSq)).map((ge=>ge.tileID))}const Fn=c.aa.fromPoints([new c.P(0,0),new c.P(c.a5,c.a5)]);function Nn(y){return y==="raster"||y==="image"||y==="video"}function ln(y,t,a,l,f,x,b){if(!t.hasData())return!1;const{tileID:E,fadingRole:D,fadingDirection:k,fadingParentID:j}=t;if(D===pe.Base&&k===ve.Incoming&&j)return a[j.key]=j,!0;const U=Math.max(E.overscaledZ-f,x);for(let N=E.overscaledZ-1;N>=U;N--){const H=E.scaledTo(N),Q=y.getLoadedTile(H);if(Q)return t.setCrossFadeLogic({fadingRole:pe.Base,fadingDirection:ve.Incoming,fadingParentID:Q.tileID,fadeEndTime:l+b}),Q.setCrossFadeLogic({fadingRole:pe.Parent,fadingDirection:ve.Departing,fadeEndTime:l+b}),a[H.key]=H,!0}return!1}function Dn(y,t,a,l,f,x){if(!t.hasData())return!1;const b=t.tileID.children(f);let E=tt(y,t,b,a,l,f,x);if(E)return!0;for(const D of b)tt(y,t,D.children(f),a,l,f,x)&&(E=!0);return E}function tt(y,t,a,l,f,x,b){if(a[0].overscaledZ>=x)return!1;let E=!1;for(const D of a){const k=y.getLoadedTile(D);if(!k)continue;const{fadingRole:j,fadingDirection:U,fadingParentID:N}=k;j===pe.Base&&U===ve.Departing&&N||(k.setCrossFadeLogic({fadingRole:pe.Base,fadingDirection:ve.Departing,fadingParentID:t.tileID,fadeEndTime:f+b}),t.setCrossFadeLogic({fadingRole:pe.Parent,fadingDirection:ve.Incoming,fadeEndTime:f+b})),l[D.key]=D,E=!0}return E}function Tn(y,t,a,l){const f=y.tileID;return!!y.selfFading||!y.hasData()&&!!t.has(f)&&(y.setSelfFadeLogic(a+l),!0)}function Er(y,t){var a;y.needsHillshadePrepare=!0,y.needsTerrainPrepare=!0;let l=t.tileID.canonical.x-y.tileID.canonical.x;const f=t.tileID.canonical.y-y.tileID.canonical.y,x=Math.pow(2,y.tileID.canonical.z),b=t.tileID.key;l===0&&f===0||Math.abs(f)>1||(Math.abs(l)>1&&(Math.abs(l+x)===1?l+=x:Math.abs(l-x)===1&&(l-=x)),t.dem&&y.dem&&(y.dem.backfillBorder(t.dem,l,f),!((a=y.neighboringTiles)===null||a===void 0)&&a[b]&&(y.neighboringTiles[b].backfilled=!0)))}class Br{constructor(){this._tiles={}}handleWrapJump(t){const a={};for(const l in this._tiles){const f=this._tiles[l];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+t),a[f.tileID.key]=f}this._tiles=a}setFeatureState(t,a){for(const l in this._tiles)this._tiles[l].setFeatureState(t,a)}getAllTiles(){return Object.values(this._tiles)}getAllIds(t=!1){return t?Object.values(this._tiles).map((a=>a.tileID)).sort(c.aw).map((a=>a.key)):Object.keys(this._tiles)}getTileById(t){return this._tiles[t]}setTile(t,a){this._tiles[t]=a}deleteTileById(t){delete this._tiles[t]}getLoadedTile(t){const a=this.getTileById(t.key);return a?.hasData()?a:null}isIdRenderable(t,a=!1){var l;return(l=this.getTileById(t))===null||l===void 0?void 0:l.isRenderable(a)}getRenderableIds(t=0,a){const l=[];for(const f of this.getAllIds())this.isIdRenderable(f,a)&&l.push(this.getTileById(f));return a?l.sort(((f,x)=>{const b=f.tileID,E=x.tileID,D=new c.P(b.canonical.x,b.canonical.y)._rotate(-t),k=new c.P(E.canonical.x,E.canonical.y)._rotate(-t);return b.overscaledZ-E.overscaledZ||k.y-D.y||k.x-D.x})).map((f=>f.tileID.key)):l.map((f=>f.tileID)).sort(c.aw).map((f=>f.key))}}class ci extends c.E{constructor(t,a,l){super(),this.id=t,this.dispatcher=l,this.on("data",(f=>this._dataHandler(f))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((f,x,b,E)=>{const D=new(Vl(x.type))(f,x,b,E);if(D.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${D.id}`);return D})(t,a,l,this),this._inViewTiles=new Br,this._outOfViewCache=new c.ax(0,(f=>this._unloadTile(f))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new ke,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){for(const a of this._inViewTiles.getAllTiles())a.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t),this._inViewTiles=new Br}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,a,l){return c._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,a,l)}catch(f){t.state="errored",f.status!==404?this._source.fire(new c.k(f,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new c.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const a of this._inViewTiles.getAllTiles())a.upload(t),a.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(t){var a;return this._inViewTiles.getRenderableIds((a=this.transform)===null||a===void 0?void 0:a.bearingInRadians,t)}hasRenderableParent(t){const a=t.overscaledZ-1;if(a>=this._source.minzoom){const l=this.getLoadedTile(t.scaledTo(a));if(l)return this._inViewTiles.isIdRenderable(l.tileID.key)}return!1}reload(t,a=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const l of this._inViewTiles.getAllIds()){const f=this._inViewTiles.getTileById(l);a&&!this._source.shouldReloadTile(f,a)||(t?this._reloadTile(l,"expired"):f.state!=="errored"&&this._reloadTile(l,"reloading"))}}}_reloadTile(t,a){return c._(this,void 0,void 0,(function*(){const l=this._inViewTiles.getTileById(t);l&&(l.state!=="loading"&&(l.state=a),yield this._loadTile(l,t,a))}))}_tileLoaded(t,a,l){t.timeAdded=xe(),t.selfFading&&(t.fadeEndTime=t.timeAdded+this._rasterFadeDuration),l==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(a,t),this.getSource().type==="raster-dem"&&t.dem&&(function(f,x){var b,E;const D=x.getRenderableIds();for(const k of D){if(!f.neighboringTiles||!f.neighboringTiles[k])continue;const j=x.getTileById(k);f.neighboringTiles[k].backfilled||Er(f,j),!((E=(b=j.neighboringTiles)===null||b===void 0?void 0:b[f.tileID.key])===null||E===void 0)&&E.backfilled||Er(j,f)}})(t,this._inViewTiles),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:t,coord:t.tileID}))}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._inViewTiles.getTileById(t)}_retainLoadedChildren(t,a){const l=this._getLoadedDescendents(a),f=new Set;for(const x of a){const b=l[x.key];if(!b?.length){f.add(x);continue}const E=x.overscaledZ+ci.maxOverzooming,D=b.filter((U=>U.tileID.overscaledZ<=E));if(!D.length){f.add(x);continue}const k=Math.min(...D.map((U=>U.tileID.overscaledZ))),j=D.filter((U=>U.tileID.overscaledZ===k)).map((U=>U.tileID));for(const U of j)t[U.key]=U;this._areDescendentsComplete(j,k,x.overscaledZ)||f.add(x)}return f}_getLoadedDescendents(t){var a;const l={};for(const f of this._inViewTiles.getAllTiles().filter((x=>x.hasData())))for(const x of t)f.tileID.isChildOf(x)&&(l[a=x.key]||(l[a]=[])).push(f);return l}_areDescendentsComplete(t,a,l){return t.length===1&&t[0].isOverscaled()?t[0].overscaledZ===a:Math.pow(4,a-l)===t.length}getLoadedTile(t){return this._inViewTiles.getLoadedTile(t)}updateCacheSize(t){const a=Math.ceil(t.width/this._source.tileSize)+1,l=Math.ceil(t.height/this._source.tileSize)+1,f=Math.floor(a*l*(this._maxTileCacheZoomLevels===null?c.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._outOfViewCache.setMaxSize(x)}handleWrapJump(t){const a=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);this._prevLng=t,a&&(this._inViewTiles.handleWrapJump(a),this._resetTileReloadTimers())}update(t,a){if(!this._sourceLoaded||this._paused)return;let l;this.transform=t,this.terrain=a,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?l=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((D=>new c.a2(D.canonical.z,D.wrap,D.canonical.z,D.canonical.x,D.canonical.y))):(l=Zi(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?t.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter((D=>this._source.hasTile(D))))):l=[],this.usedForTerrain&&(l=this._addTerrainIdealTiles(l));const f=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,f&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const x=qi(t,this._source),b=this._updateRetainedTiles(l,x),E=Nn(this._source.type);E&&this._rasterFadeDuration>0&&!a&&(function(D,k,j,U,N,H,Q){const ae=xe(),oe=c.av(k);for(const se of k){const he=D.getTileById(se.key);he.fadingDirection!==ve.Departing&&he.fadeOpacity!==0||he.resetFadeLogic(),ln(D,he,j,ae,U,N,Q)||Dn(D,he,j,ae,H,Q)||Tn(he,oe,ae,Q)||he.resetFadeLogic()}})(this._inViewTiles,l,b,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),E?this._cleanUpRasterTiles(b):this._cleanUpVectorTiles(b)}_cleanUpRasterTiles(t){for(const a of this._inViewTiles.getAllIds())t[a]||this._removeTile(a)}_cleanUpVectorTiles(t){for(const a of this._inViewTiles.getAllIds()){const l=this._inViewTiles.getTileById(a);t[a]?l.clearSymbolFadeHold():l.hasSymbolBuckets?l.holdingForSymbolFade()?l.symbolFadeFinished()&&this._removeTile(a):l.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(a)}}_addTerrainIdealTiles(t){const a=[];for(const l of t)if(l.canonical.z>this._source.minzoom){const f=l.scaledTo(l.canonical.z-1);a.push(f);const x=l.scaledTo(Math.max(this._source.minzoom,Math.min(l.canonical.z,5)));a.push(x)}return t.concat(a)}releaseSymbolFadeTiles(){for(const t of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(t).holdingForSymbolFade()&&this._removeTile(t)}_updateRetainedTiles(t,a){var l;const f=new Set;for(const k of t)this._addTile(k).hasData()||f.add(k);const x=t.reduce(((k,j)=>(k[j.key]=j,k)),{}),b=this._retainLoadedChildren(x,f),E={},D=Math.max(a-ci.maxUnderzooming,this._source.minzoom);for(const k of b){let j=this._inViewTiles.getTileById(k.key),U=j?.wasRequested();for(let N=k.overscaledZ-1;N>=D;--N){const H=k.scaledTo(N);if(E[H.key])break;if(E[H.key]=!0,j=this.getTile(H),!j&&U&&(j=this._addTile(H)),j){const Q=j.hasData();if((Q||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||U)&&(x[H.key]=H),U=j.wasRequested(),Q)break}}}return x}_addTile(t){let a=this._inViewTiles.getTileById(t.key);if(a)return a;a=this._outOfViewCache.getAndRemove(t),a&&(a.resetFadeLogic(),this._setTileReloadTimer(t.key,a),a.tileID=t,this._state.initializeTileState(a,this.map?this.map.painter:null));const l=a;return a||(a=new Pe(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(a,t.key,a.state)),a.uses++,this._inViewTiles.setTile(t.key,a),l||this._source.fire(new c.l("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(t,a){this._clearTileReloadTimer(t);const l=a.getExpiryTimeout();l&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),l))}_clearTileReloadTimer(t){const a=this._timers[t];a&&(clearTimeout(a),delete this._timers[t])}_resetTileReloadTimers(){for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t of this._inViewTiles.getAllIds()){const a=this._inViewTiles.getTileById(t);this._setTileReloadTimer(t,a)}}refreshTiles(t){for(const a of this._inViewTiles.getAllIds()){const l=this._inViewTiles.getTileById(a);(this._inViewTiles.isIdRenderable(a)||l.state=="errored")&&t.some((f=>f.equals(l.tileID.canonical)))&&this._reloadTile(a,"expired")}}_removeTile(t){const a=this._inViewTiles.getTileById(t);a&&(a.uses--,this._inViewTiles.deleteTileById(t),this._clearTileReloadTimer(t),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._outOfViewCache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(t){t.dataType==="source"&&(t.sourceDataType!=="metadata"?t.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(t.sourceDataChanged,t.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t of this._inViewTiles.getAllIds())this._removeTile(t);this._outOfViewCache.reset()}tilesIn(t,a,l){const f=[],x=this.transform;if(!x)return f;const b=x.getCoveringTilesDetailsProvider().allowWorldCopies(),E=l?x.getCameraQueryGeometry(t):t,D=H=>x.screenPointToMercatorCoordinate(H,this.terrain),k=this.transformBbox(t,D,!b),j=this.transformBbox(E,D,!b),U=this.getIds(),N=c.aa.fromPoints(j);for(let H=0;H<U.length;H++){const Q=this._inViewTiles.getTileById(U[H]);if(Q.holdingForSymbolFade())continue;const ae=b?[Q.tileID]:[Q.tileID.unwrapTo(-1),Q.tileID.unwrapTo(0)],oe=Math.pow(2,x.zoom-Q.tileID.overscaledZ),se=a*Q.queryPadding*c.a5/Q.tileSize/oe;for(const he of ae){const ye=N.map((ce=>he.getTilePoint(new c.a9(ce.x,ce.y))));if(ye.expandBy(se),ye.intersects(Fn)){const ce=k.map((be=>he.getTilePoint(be))),ge=j.map((be=>he.getTilePoint(be)));f.push({tile:Q,tileID:b?he:he.unwrapTo(0),queryGeometry:ce,cameraQueryGeometry:ge,scale:oe})}}}return f}transformBbox(t,a,l){let f=t.map(a);if(l){const x=c.aa.fromPoints(t);x.shrinkBy(.001*Math.min(x.width(),x.height()));const b=x.map(a);c.aa.fromPoints(f).covers(b)||(f=f.map((E=>E.x>.5?new c.a9(E.x-1,E.y,E.z):E)))}return f}getVisibleCoordinates(t){const a=this.getRenderableIds(t).map((l=>this._inViewTiles.getTileById(l).tileID));return this.transform&&this.transform.populateCache(a),a}hasTransition(){return!!this._source.hasTransition()||!(!Nn(this._source.type)||!(function(t,a){if(a<=0)return!1;const l=xe();for(const f of t.getAllTiles())if(f.fadeEndTime>=l)return!0;return!1})(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(t){this._rasterFadeDuration=t}setFeatureState(t,a,l){this._state.updateState(t=t||c.ai,a,l)}removeFeatureState(t,a,l){this._state.removeFeatureState(t=t||c.ai,a,l)}getFeatureState(t,a){return this._state.getState(t=t||c.ai,a)}setDependencies(t,a,l){const f=this._inViewTiles.getTileById(t);f&&f.setDependencies(a,l)}reloadTilesForDependencies(t,a){for(const l of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(l).hasDependency(t,a)&&this._reloadTile(l,"reloading");this._outOfViewCache.filter((l=>!l.hasDependency(t,a)))}areTilesLoaded(){for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}}ci.maxUnderzooming=10,ci.maxOverzooming=3;class ht{constructor(t,a){this.reset(t,a)}reset(t,a){this.points=t||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=c.an(t,0,1);let a=1,l=this._distances[a];const f=t*this.paddedLength+this.padding;for(;l<f&&a<this._distances.length;)l=this._distances[++a];const x=a-1,b=this._distances[x],E=l-b,D=E>0?(f-b)/E:0;return this.points[x].mult(1-D).add(this.points[a].mult(D))}}function qt(y,t){let a=!0;return y==="always"||y!=="never"&&t!=="never"||(a=!1),a}class Jt{constructor(t,a,l){const f=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(t/l),this.yCellCount=Math.ceil(a/l);for(let b=0;b<this.xCellCount*this.yCellCount;b++)f.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=a,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,a,l,f,x){this._forEachCell(a,l,f,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(a),this.bboxes.push(l),this.bboxes.push(f),this.bboxes.push(x)}insertCircle(t,a,l,f){this._forEachCell(a-f,l-f,a+f,l+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(a),this.circles.push(l),this.circles.push(f)}_insertBoxCell(t,a,l,f,x,b){this.boxCells[x].push(b)}_insertCircleCell(t,a,l,f,x,b){this.circleCells[x].push(b)}_query(t,a,l,f,x,b,E){if(l<0||t>this.width||f<0||a>this.height)return[];const D=[];if(t<=0&&a<=0&&this.width<=l&&this.height<=f){if(x)return[{key:null,x1:t,y1:a,x2:l,y2:f}];for(let k=0;k<this.boxKeys.length;k++)D.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const j=this.circles[3*k],U=this.circles[3*k+1],N=this.circles[3*k+2];D.push({key:this.circleKeys[k],x1:j-N,y1:U-N,x2:j+N,y2:U+N})}}else this._forEachCell(t,a,l,f,this._queryCell,D,{hitTest:x,overlapMode:b,seenUids:{box:{},circle:{}}},E);return D}query(t,a,l,f){return this._query(t,a,l,f,!1,null)}hitTest(t,a,l,f,x,b){return this._query(t,a,l,f,!0,x,b).length>0}hitTestCircle(t,a,l,f,x){const b=t-l,E=t+l,D=a-l,k=a+l;if(E<0||b>this.width||k<0||D>this.height)return!1;const j=[];return this._forEachCell(b,D,E,k,this._queryCellCircle,j,{hitTest:!0,overlapMode:f,circle:{x:t,y:a,radius:l},seenUids:{box:{},circle:{}}},x),j.length>0}_queryCell(t,a,l,f,x,b,E,D){const{seenUids:k,hitTest:j,overlapMode:U}=E,N=this.boxCells[x];if(N!==null){const Q=this.bboxes;for(const ae of N)if(!k.box[ae]){k.box[ae]=!0;const oe=4*ae,se=this.boxKeys[ae];if(t<=Q[oe+2]&&a<=Q[oe+3]&&l>=Q[oe+0]&&f>=Q[oe+1]&&(!D||D(se))&&(!j||!qt(U,se.overlapMode))&&(b.push({key:se,x1:Q[oe],y1:Q[oe+1],x2:Q[oe+2],y2:Q[oe+3]}),j))return!0}}const H=this.circleCells[x];if(H!==null){const Q=this.circles;for(const ae of H)if(!k.circle[ae]){k.circle[ae]=!0;const oe=3*ae,se=this.circleKeys[ae];if(this._circleAndRectCollide(Q[oe],Q[oe+1],Q[oe+2],t,a,l,f)&&(!D||D(se))&&(!j||!qt(U,se.overlapMode))){const he=Q[oe],ye=Q[oe+1],ce=Q[oe+2];if(b.push({key:se,x1:he-ce,y1:ye-ce,x2:he+ce,y2:ye+ce}),j)return!0}}}return!1}_queryCellCircle(t,a,l,f,x,b,E,D){const{circle:k,seenUids:j,overlapMode:U}=E,N=this.boxCells[x];if(N!==null){const Q=this.bboxes;for(const ae of N)if(!j.box[ae]){j.box[ae]=!0;const oe=4*ae,se=this.boxKeys[ae];if(this._circleAndRectCollide(k.x,k.y,k.radius,Q[oe+0],Q[oe+1],Q[oe+2],Q[oe+3])&&(!D||D(se))&&!qt(U,se.overlapMode))return b.push(!0),!0}}const H=this.circleCells[x];if(H!==null){const Q=this.circles;for(const ae of H)if(!j.circle[ae]){j.circle[ae]=!0;const oe=3*ae,se=this.circleKeys[ae];if(this._circlesCollide(Q[oe],Q[oe+1],Q[oe+2],k.x,k.y,k.radius)&&(!D||D(se))&&!qt(U,se.overlapMode))return b.push(!0),!0}}}_forEachCell(t,a,l,f,x,b,E,D){const k=this._convertToXCellCoord(t),j=this._convertToYCellCoord(a),U=this._convertToXCellCoord(l),N=this._convertToYCellCoord(f);for(let H=k;H<=U;H++)for(let Q=j;Q<=N;Q++)if(x.call(this,t,a,l,f,this.xCellCount*Q+H,b,E,D))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,a,l,f,x,b){const E=f-t,D=x-a,k=l+b;return k*k>E*E+D*D}_circleAndRectCollide(t,a,l,f,x,b,E){const D=(b-f)/2,k=Math.abs(t-(f+D));if(k>D+l)return!1;const j=(E-x)/2,U=Math.abs(a-(x+j));if(U>j+l)return!1;if(k<=D||U<=j)return!0;const N=k-D,H=U-j;return N*N+H*H<=l*l}}function ta(y,t,a){const l=c.N();if(!y){const{vecSouth:U,vecEast:N}=us(t),H=X();H[0]=N[0],H[1]=N[1],H[2]=U[0],H[3]=U[1],f=H,(j=(b=(x=H)[0])*(k=x[3])-(D=x[2])*(E=x[1]))&&(f[0]=k*(j=1/j),f[1]=-E*j,f[2]=-D*j,f[3]=b*j),l[0]=H[0],l[1]=H[1],l[4]=H[2],l[5]=H[3]}var f,x,b,E,D,k,j;return c.Q(l,l,[1/a,1/a,1]),l}function Ou(y,t,a,l){if(y){const f=c.N();if(!t){const{vecSouth:x,vecEast:b}=us(a);f[0]=b[0],f[1]=b[1],f[4]=x[0],f[5]=x[1]}return c.Q(f,f,[l,l,1]),f}return a.pixelsToClipSpaceMatrix}function us(y){const t=Math.cos(y.rollInRadians),a=Math.sin(y.rollInRadians),l=Math.cos(y.pitchInRadians),f=Math.cos(y.bearingInRadians),x=Math.sin(y.bearingInRadians),b=c.aC();b[0]=-f*l*a-x*t,b[1]=-x*l*a+f*t;const E=c.aD(b);E<1e-9?c.aE(b):c.aF(b,b,1/E);const D=c.aC();D[0]=f*l*t-x*a,D[1]=x*l*t+f*a;const k=c.aD(D);return k<1e-9?c.aE(D):c.aF(D,D,1/k),{vecEast:D,vecSouth:b}}function Xt(y,t,a,l){let f;l?(f=[y,t,l(y,t),1],c.aH(f,f,a)):(f=[y,t,0,1],wa(f,f,a));const x=f[3];return{point:new c.P(f[0]/x,f[1]/x),signedDistanceFromCamera:x,isOccluded:!1}}function Xo(y,t){return .5+y/t*.5}function hs(y,t){return y.x>=-t[0]&&y.x<=t[0]&&y.y>=-t[1]&&y.y<=t[1]}function Vs(y,t,a,l,f,x,b,E,D,k,j,U,N){const H=a?y.textSizeData:y.iconSizeData,Q=c.ay(H,t.transform.zoom),ae=[256/t.width*2+1,256/t.height*2+1],oe=a?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;oe.clear();const se=y.lineVertexArray,he=a?y.text.placedSymbolArray:y.icon.placedSymbolArray,ye=t.transform.width/t.transform.height;let ce=!1;for(let ge=0;ge<he.length;ge++){const be=he.get(ge);if(be.hidden||be.writingMode===c.az.vertical&&!ce){ps(be.numGlyphs,oe);continue}ce=!1;const me=new c.P(be.anchorX,be.anchorY),Me={getElevation:N,pitchedLabelPlaneMatrix:l,lineVertexArray:se,pitchWithMap:x,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:me,unwrappedTileID:D,width:k,height:j,translation:U},Fe=Gl(be.anchorX,be.anchorY,Me);if(!hs(Fe.point,ae)){ps(be.numGlyphs,oe);continue}const Le=Xo(t.transform.cameraToCenterDistance,Fe.signedDistanceFromCamera),Be=c.aA(H,Q,be),Oe=x?Be*t.transform.getPitchedTextCorrection(be.anchorX,be.anchorY,D)/Le:Be*Le,dt=fn({projectionContext:Me,pitchedLabelPlaneMatrixInverse:f,symbol:be,fontSize:Oe,flip:!1,keepUpright:b,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:oe,aspectRatio:ye,rotateToLine:E});ce=dt.useVertical,(dt.notEnoughRoom||ce||dt.needsFlipping&&fn({projectionContext:Me,pitchedLabelPlaneMatrixInverse:f,symbol:be,fontSize:Oe,flip:!0,keepUpright:b,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:oe,aspectRatio:ye,rotateToLine:E}).notEnoughRoom)&&ps(be.numGlyphs,oe)}a?y.text.dynamicLayoutVertexBuffer.updateData(oe):y.icon.dynamicLayoutVertexBuffer.updateData(oe)}function ds(y,t,a,l,f,x,b,E){const D=x.glyphStartIndex+x.numGlyphs,k=x.lineStartIndex,j=x.lineStartIndex+x.lineLength,U=t.getoffsetX(x.glyphStartIndex),N=t.getoffsetX(D-1),H=qa(y*U,a,l,f,x.segment,k,j,E,b);if(!H)return null;const Q=qa(y*N,a,l,f,x.segment,k,j,E,b);return Q?E.projectionCache.anyProjectionOccluded?null:{first:H,last:Q}:null}function fs(y,t,a,l){return y===c.az.horizontal&&Math.abs(a.y-t.y)>Math.abs(a.x-t.x)*l?{useVertical:!0}:(y===c.az.vertical?t.y<a.y:t.x>a.x)?{needsFlipping:!0}:null}function fn(y){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:a,symbol:l,fontSize:f,flip:x,keepUpright:b,glyphOffsetArray:E,dynamicLayoutVertexArray:D,aspectRatio:k,rotateToLine:j}=y,U=f/24,N=l.lineOffsetX*U,H=l.lineOffsetY*U;let Q;if(l.numGlyphs>1){const ae=l.glyphStartIndex+l.numGlyphs,oe=l.lineStartIndex,se=l.lineStartIndex+l.lineLength,he=ds(U,E,N,H,x,l,j,t);if(!he)return{notEnoughRoom:!0};const ye=Us(he.first.point.x,he.first.point.y,t,a),ce=Us(he.last.point.x,he.last.point.y,t,a);if(b&&!x){const ge=fs(l.writingMode,ye,ce,k);if(ge)return ge}Q=[he.first];for(let ge=l.glyphStartIndex+1;ge<ae-1;ge++){const be=qa(U*E.getoffsetX(ge),N,H,x,l.segment,oe,se,t,j);if(!be)return{notEnoughRoom:!0};Q.push(be)}Q.push(he.last)}else{if(b&&!x){const oe=di(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,se=l.lineStartIndex+l.segment+1,he=new c.P(t.lineVertexArray.getx(se),t.lineVertexArray.gety(se)),ye=di(he.x,he.y,t),ce=ye.signedDistanceFromCamera>0?ye.point:Ul(t.tileAnchorPoint,he,oe,1,t),ge=Us(oe.x,oe.y,t,a),be=Us(ce.x,ce.y,t,a),me=fs(l.writingMode,ge,be,k);if(me)return me}const ae=qa(U*E.getoffsetX(l.glyphStartIndex),N,H,x,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,t,j);if(!ae||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Q=[ae]}for(const ae of Q)c.aG(D,ae.point,ae.angle);return{}}function Ul(y,t,a,l,f){const x=y.add(y.sub(t)._unit()),b=di(x.x,x.y,f).point,E=a.sub(b);return a.add(E._mult(l/E.mag()))}function _r(y,t,a){const l=t.projectionCache;if(l.projections[y])return l.projections[y];const f=new c.P(t.lineVertexArray.getx(y),t.lineVertexArray.gety(y)),x=di(f.x,f.y,t);if(x.signedDistanceFromCamera>0)return l.projections[y]=x.point,l.anyProjectionOccluded=l.anyProjectionOccluded||x.isOccluded,x.point;const b=y-a.direction;return Ul(a.distanceFromAnchor===0?t.tileAnchorPoint:new c.P(t.lineVertexArray.getx(b),t.lineVertexArray.gety(b)),f,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,t)}function di(y,t,a){const l=y+a.translation[0],f=t+a.translation[1];let x;return a.pitchWithMap?(x=Xt(l,f,a.pitchedLabelPlaneMatrix,a.getElevation),x.isOccluded=!1):(x=a.transform.projectTileCoordinates(l,f,a.unwrappedTileID,a.getElevation),x.point.x=(.5*x.point.x+.5)*a.width,x.point.y=(.5*-x.point.y+.5)*a.height),x}function Us(y,t,a,l){if(a.pitchWithMap){const f=[y,t,0,1];return c.aH(f,f,l),a.transform.projectTileCoordinates(f[0]/f[3],f[1]/f[3],a.unwrappedTileID,a.getElevation).point}return{x:y/a.width*2-1,y:1-t/a.height*2}}function Gl(y,t,a){return a.transform.projectTileCoordinates(y,t,a.unwrappedTileID,a.getElevation)}function ql(y,t,a){return y._unit()._perp()._mult(t*a)}function po(y,t,a,l,f,x,b,E,D){if(E.projectionCache.offsets[y])return E.projectionCache.offsets[y];const k=a.add(t);if(y+D.direction<l||y+D.direction>=f)return E.projectionCache.offsets[y]=k,k;const j=_r(y+D.direction,E,D),U=ql(j.sub(a),b,D.direction),N=a.add(U),H=j.add(U);return E.projectionCache.offsets[y]=c.aI(x,k,N,H)||k,E.projectionCache.offsets[y]}function qa(y,t,a,l,f,x,b,E,D){const k=l?y-t:y+t;let j=k>0?1:-1,U=0;l&&(j*=-1,U=Math.PI),j<0&&(U+=Math.PI);let N,H=j>0?x+f:x+f+1;E.projectionCache.cachedAnchorPoint?N=E.projectionCache.cachedAnchorPoint:(N=di(E.tileAnchorPoint.x,E.tileAnchorPoint.y,E).point,E.projectionCache.cachedAnchorPoint=N);let Q,ae,oe=N,se=N,he=0,ye=0;const ce=Math.abs(k),ge=[];let be;for(;he+ye<=ce;){if(H+=j,H<x||H>=b)return null;he+=ye,se=oe,ae=Q;const Fe={absOffsetX:ce,direction:j,distanceFromAnchor:he,previousVertex:se};if(oe=_r(H,E,Fe),a===0)ge.push(se),be=oe.sub(se);else{let Le;const Be=oe.sub(se);Le=Be.mag()===0?ql(_r(H+j,E,Fe).sub(oe),a,j):ql(Be,a,j),ae||(ae=se.add(Le)),Q=po(H,Le,oe,x,b,ae,a,E,Fe),ge.push(ae),be=Q.sub(ae)}ye=be.mag()}const me=be._mult((ce-he)/ye)._add(ae||se),Me=U+Math.atan2(oe.y-se.y,oe.x-se.x);return ge.push(me),{point:me,angle:D?Me:0,path:ge}}const Lc=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ps(y,t){for(let a=0;a<y;a++){const l=t.length;t.resize(l+4),t.float32.set(Lc,3*l)}}function wa(y,t,a){const l=t[0],f=t[1];return y[0]=a[0]*l+a[4]*f+a[12],y[1]=a[1]*l+a[5]*f+a[13],y[3]=a[3]*l+a[7]*f+a[15],y}const _i=100;class Zh{constructor(t,a=new Jt(t.width+200,t.height+200,25),l=new Jt(t.width+200,t.height+200,25)){this.transform=t,this.grid=a,this.ignoredGrid=l,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+_i,this.screenBottomBoundary=t.height+_i,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,a,l,f,x,b,E,D,k,j,U,N){const H=this.projectAndGetPerspectiveRatio(t.anchorPointX+D[0],t.anchorPointY+D[1],x,j,N),Q=l*H.perspectiveRatio;let ae;if(b||E)ae=this._projectCollisionBox(t,Q,f,x,b,E,D,H,j,U,N);else{const be=H.x+(U?U.x*Q:0),me=H.y+(U?U.y*Q:0);ae={allPointsOccluded:!1,box:[be+t.x1*Q,me+t.y1*Q,be+t.x2*Q,me+t.y2*Q]}}const[oe,se,he,ye]=ae.box,ce=b?ae.allPointsOccluded:H.isOccluded;let ge=ce;return ge||(ge=H.perspectiveRatio<this.perspectiveRatioCutoff),ge||(ge=!this.isInsideGrid(oe,se,he,ye)),ge||a!=="always"&&this.grid.hitTest(oe,se,he,ye,a,k)?{box:[oe,se,he,ye],placeable:!1,offscreen:!1,occluded:ce}:{box:[oe,se,he,ye],placeable:!0,offscreen:this.isOffscreen(oe,se,he,ye),occluded:ce}}placeCollisionCircles(t,a,l,f,x,b,E,D,k,j,U,N,H,Q){const ae=[],oe=new c.P(a.anchorX,a.anchorY),se=this.getPerspectiveRatio(oe.x,oe.y,b,Q),he=(k?x*this.transform.getPitchedTextCorrection(a.anchorX,a.anchorY,b)/se:x*se)/c.aM,ye={getElevation:Q,pitchedLabelPlaneMatrix:E,lineVertexArray:l,pitchWithMap:k,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:oe,unwrappedTileID:b,width:this.transform.width,height:this.transform.height,translation:H},ce=ds(he,f,a.lineOffsetX*he,a.lineOffsetY*he,!1,a,!1,ye);let ge=!1,be=!1,me=!0;if(ce){const Me=.5*U*se+N,Fe=new c.P(-100,-100),Le=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Be=new ht,Oe=ce.first,dt=ce.last;let ft=[];for(let $t=Oe.path.length-1;$t>=1;$t--)ft.push(Oe.path[$t]);for(let $t=1;$t<dt.path.length;$t++)ft.push(dt.path[$t]);const rt=2.5*Me;if(k){const $t=this.projectPathToScreenSpace(ft,ye);ft=$t.some((Si=>Si.signedDistanceFromCamera<=0))?[]:$t.map((Si=>Si.point))}let yt=[];if(ft.length>0){const $t=ft[0].clone(),Si=ft[0].clone();for(let Ui=1;Ui<ft.length;Ui++)$t.x=Math.min($t.x,ft[Ui].x),$t.y=Math.min($t.y,ft[Ui].y),Si.x=Math.max(Si.x,ft[Ui].x),Si.y=Math.max(Si.y,ft[Ui].y);yt=$t.x>=Fe.x&&Si.x<=Le.x&&$t.y>=Fe.y&&Si.y<=Le.y?[ft]:Si.x<Fe.x||$t.x>Le.x||Si.y<Fe.y||$t.y>Le.y?[]:c.aJ([ft],Fe.x,Fe.y,Le.x,Le.y)}for(const $t of yt){Be.reset($t,.25*Me);let Si=0;Si=Be.length<=.5*Me?1:Math.ceil(Be.paddedLength/rt)+1;for(let Ui=0;Ui<Si;Ui++){const Oi=Ui/Math.max(Si-1,1),Wi=Be.lerp(Oi),Di=Wi.x+_i,hn=Wi.y+_i;ae.push(Di,hn,Me,0);const Ki=Di-Me,tr=hn-Me,yn=Di+Me,_n=hn+Me;if(me=me&&this.isOffscreen(Ki,tr,yn,_n),be=be||this.isInsideGrid(Ki,tr,yn,_n),t!=="always"&&this.grid.hitTestCircle(Di,hn,Me,t,j)&&(ge=!0,!D))return{circles:[],offscreen:!1,collisionDetected:ge}}}}return{circles:!D&&ge||!be||se<this.perspectiveRatioCutoff?[]:ae,offscreen:me,collisionDetected:ge}}projectPathToScreenSpace(t,a){const l=(function(f,x){const b=c.N();return c.aB(b,x.pitchedLabelPlaneMatrix),f.map((E=>{const D=Xt(E.x,E.y,b,x.getElevation),k=x.transform.projectTileCoordinates(D.point.x,D.point.y,x.unwrappedTileID,x.getElevation);return k.point.x=(.5*k.point.x+.5)*x.width,k.point.y=(.5*-k.point.y+.5)*x.height,k}))})(t,a);return(function(f){let x=0,b=0,E=0,D=0;for(let k=0;k<f.length;k++)f[k].isOccluded?(E=k+1,D=0):(D++,D>b&&(b=D,x=E));return f.slice(x,x+b)})(l)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[],l=new c.aa;for(const U of t){const N=new c.P(U.x+_i,U.y+_i);l.extend(N),a.push(N)}const{minX:f,minY:x,maxX:b,maxY:E}=l,D=this.grid.query(f,x,b,E).concat(this.ignoredGrid.query(f,x,b,E)),k={},j={};for(const U of D){const N=U.key;if(k[N.bucketInstanceId]===void 0&&(k[N.bucketInstanceId]={}),k[N.bucketInstanceId][N.featureIndex])continue;const H=[new c.P(U.x1,U.y1),new c.P(U.x2,U.y1),new c.P(U.x2,U.y2),new c.P(U.x1,U.y2)];c.aK(a,H)&&(k[N.bucketInstanceId][N.featureIndex]=!0,j[N.bucketInstanceId]===void 0&&(j[N.bucketInstanceId]=[]),j[N.bucketInstanceId].push(N.featureIndex))}return j}insertCollisionBox(t,a,l,f,x,b){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:x,collisionGroupID:b,overlapMode:a},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,a,l,f,x,b){const E=l?this.ignoredGrid:this.grid,D={bucketInstanceId:f,featureIndex:x,collisionGroupID:b,overlapMode:a};for(let k=0;k<t.length;k+=4)E.insertCircle(D,t[k],t[k+1],t[k+2])}projectAndGetPerspectiveRatio(t,a,l,f,x){if(x){let b;f?(b=[t,a,f(t,a),1],c.aH(b,b,x)):(b=[t,a,0,1],wa(b,b,x));const E=b[3];return{x:(b[0]/E+1)/2*this.transform.width+_i,y:(-b[1]/E+1)/2*this.transform.height+_i,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E*.5,isOccluded:!1,signedDistanceFromCamera:E}}{const b=this.transform.projectTileCoordinates(t,a,l,f);return{x:(b.point.x+1)/2*this.transform.width+_i,y:(1-b.point.y)/2*this.transform.height+_i,perspectiveRatio:.5+this.transform.cameraToCenterDistance/b.signedDistanceFromCamera*.5,isOccluded:b.isOccluded,signedDistanceFromCamera:b.signedDistanceFromCamera}}}getPerspectiveRatio(t,a,l,f){const x=this.transform.projectTileCoordinates(t,a,l,f);return .5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5}isOffscreen(t,a,l,f){return l<_i||t>=this.screenRightBoundary||f<_i||a>this.screenBottomBoundary}isInsideGrid(t,a,l,f){return l>=0&&t<this.gridRightBoundary&&f>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const t=c.ar([]);return c.O(t,t,[-100,-100,0]),t}_projectCollisionBox(t,a,l,f,x,b,E,D,k,j,U){let N=1,H=0,Q=0,ae=1;const oe=t.anchorPointX+E[0],se=t.anchorPointY+E[1];if(b&&!x){const ft=this.projectAndGetPerspectiveRatio(oe+1,se,f,k,U),rt=ft.x-D.x,yt=Math.atan((ft.y-D.y)/rt)+(rt<0?Math.PI:0),$t=Math.sin(yt),Si=Math.cos(yt);N=Si,H=$t,Q=-$t,ae=Si}else if(!b&&x){const ft=us(this.transform);N=ft.vecEast[0],H=ft.vecEast[1],Q=ft.vecSouth[0],ae=ft.vecSouth[1]}let he=D.x,ye=D.y,ce=a;x&&(he=oe,ye=se,ce=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),ce*=this.transform.getPitchedTextCorrection(oe,se,f),j||(ce*=c.an(.5+D.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),j&&(he+=N*j.x*ce+Q*j.y*ce,ye+=H*j.x*ce+ae*j.y*ce);const ge=t.x1*ce,be=t.x2*ce,me=(ge+be)/2,Me=t.y1*ce,Fe=t.y2*ce,Le=(Me+Fe)/2,Be=[{offsetX:ge,offsetY:Me},{offsetX:me,offsetY:Me},{offsetX:be,offsetY:Me},{offsetX:be,offsetY:Le},{offsetX:be,offsetY:Fe},{offsetX:me,offsetY:Fe},{offsetX:ge,offsetY:Fe},{offsetX:ge,offsetY:Le}];let Oe=[];for(const{offsetX:ft,offsetY:rt}of Be)Oe.push(new c.P(he+N*ft+Q*rt,ye+H*ft+ae*rt));let dt=!1;if(x){const ft=Oe.map((rt=>this.projectAndGetPerspectiveRatio(rt.x,rt.y,f,k,U)));dt=ft.some((rt=>!rt.isOccluded)),Oe=ft.map((rt=>new c.P(rt.x,rt.y)))}else dt=!0;return{box:c.aL(Oe),allPointsOccluded:!dt}}}class lf{constructor(t,a,l,f){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?a:-a))):f&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class Yo{constructor(t,a,l,f,x){this.text=new lf(t?t.text:null,a,l,x),this.icon=new lf(t?t.icon:null,a,f,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Hh{constructor(t,a,l){this.text=t,this.icon=a,this.skipFade=l}}class jc{constructor(t,a,l,f,x){this.bucketInstanceId=t,this.featureIndex=a,this.sourceLayerIndex=l,this.bucketIndex=f,this.tileID=x}}class cf{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const a=++this.maxGroupID;this.collisionGroups[t]={ID:a,predicate:l=>l.collisionGroupID===a}}return this.collisionGroups[t]}}function Ar(y,t,a,l,f){const{horizontalAlign:x,verticalAlign:b}=c.aS(y);return new c.P(-(x-.5)*t+l[0]*f,-(b-.5)*a+l[1]*f)}class Bc{constructor(t,a,l,f,x){this.transform=t.clone(),this.terrain=a,this.collisionIndex=new Zh(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new cf(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const a=this.terrain;return a?(l,f)=>a.getElevation(t,l,f):null}getBucketParts(t,a,l,f){const x=l.getBucket(a),b=l.latestFeatureIndex;if(!x||!b||a.id!==x.layerIds[0])return;const E=l.collisionBoxArray,D=x.layers[0].layout,k=x.layers[0].paint,j=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),U=l.tileSize/c.a5,N=l.tileID.toUnwrapped(),H=D.get("text-rotation-alignment")==="map",Q=c.aN(l,1,this.transform.zoom),ae=c.aO(this.collisionIndex.transform,l,k.get("text-translate"),k.get("text-translate-anchor")),oe=c.aO(this.collisionIndex.transform,l,k.get("icon-translate"),k.get("icon-translate-anchor")),se=ta(H,this.transform,Q);this.retainedQueryData[x.bucketInstanceId]=new jc(x.bucketInstanceId,b,x.sourceLayerIndex,x.index,l.tileID);const he={bucket:x,layout:D,translationText:ae,translationIcon:oe,unwrappedTileID:N,pitchedLabelPlaneMatrix:se,scale:j,textPixelRatio:U,holdingForFade:l.holdingForSymbolFade(),collisionBoxArray:E,partiallyEvaluatedTextSize:c.ay(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(f)for(const ye of x.sortKeyRanges){const{sortKey:ce,symbolInstanceStart:ge,symbolInstanceEnd:be}=ye;t.push({sortKey:ce,symbolInstanceStart:ge,symbolInstanceEnd:be,parameters:he})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:he})}attemptAnchorPlacement(t,a,l,f,x,b,E,D,k,j,U,N,H,Q,ae,oe,se,he,ye,ce){const ge=c.aP[t.textAnchor],be=[t.textOffset0,t.textOffset1],me=Ar(ge,l,f,be,x),Me=this.collisionIndex.placeCollisionBox(a,N,D,k,j,E,b,oe,U.predicate,ye,me,ce);if((!he||this.collisionIndex.placeCollisionBox(he,N,D,k,j,E,b,se,U.predicate,ye,me,ce).placeable)&&Me.placeable){let Fe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID].text&&(Fe=this.prevPlacement.variableOffsets[H.crossTileID].anchor),H.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[H.crossTileID]={textOffset:be,width:l,height:f,anchor:ge,textBoxScale:x,prevAnchor:Fe},this.markUsedJustification(Q,ge,H,ae),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,ae,H),this.placedOrientations[H.crossTileID]=ae),{shift:me,placedGlyphBoxes:Me}}}placeLayerBucketPart(t,a,l){const{bucket:f,layout:x,translationText:b,translationIcon:E,unwrappedTileID:D,pitchedLabelPlaneMatrix:k,textPixelRatio:j,holdingForFade:U,collisionBoxArray:N,partiallyEvaluatedTextSize:H,collisionGroup:Q}=t.parameters,ae=x.get("text-optional"),oe=x.get("icon-optional"),se=c.aQ(x,"text-overlap","text-allow-overlap"),he=se==="always",ye=c.aQ(x,"icon-overlap","icon-allow-overlap"),ce=ye==="always",ge=x.get("text-rotation-alignment")==="map",be=x.get("text-pitch-alignment")==="map",me=x.get("icon-text-fit")!=="none",Me=x.get("symbol-z-order")==="viewport-y",Fe=he&&(ce||!f.hasIconData()||oe),Le=ce&&(he||!f.hasTextData()||ae);!f.collisionArrays&&N&&f.deserializeCollisionBoxes(N);const Be=this.retainedQueryData[f.bucketInstanceId].tileID,Oe=this._getTerrainElevationFunc(Be),dt=this.transform.getFastPathSimpleProjectionMatrix(Be),ft=(rt,yt,$t)=>{var Si,Ui;if(a[rt.crossTileID])return;if(U)return void(this.placements[rt.crossTileID]=new Hh(!1,!1,!1));let Oi=!1,Wi=!1,Di=!0,hn=null,Ki={box:null,placeable:!1,offscreen:null,occluded:!1},tr={placeable:!1},yn=null,_n=null,ir=null,Rs=0,ks=0,Ja=0;yt.textFeatureIndex?Rs=yt.textFeatureIndex:rt.useRuntimeCollisionCircles&&(Rs=rt.featureIndex),yt.verticalTextFeatureIndex&&(ks=yt.verticalTextFeatureIndex);const Gr=yt.textBox;if(Gr){const qr=Ei=>{let Fi=c.az.horizontal;if(f.allowVerticalPlacement&&!Ei&&this.prevPlacement){const In=this.prevPlacement.placedOrientations[rt.crossTileID];In&&(this.placedOrientations[rt.crossTileID]=In,Fi=In,this.markUsedOrientation(f,Fi,rt))}return Fi},da=(Ei,Fi)=>{if(f.allowVerticalPlacement&&rt.numVerticalGlyphVertices>0&&yt.verticalTextBox){for(const In of f.writingModes)if(In===c.az.vertical?(Ki=Fi(),tr=Ki):Ki=Ei(),Ki&&Ki.placeable)break}else Ki=Ei()},Ra=rt.textAnchorOffsetStartIndex,ka=rt.textAnchorOffsetEndIndex;if(ka===Ra){const Ei=(Fi,In)=>{const Un=this.collisionIndex.placeCollisionBox(Fi,se,j,Be,D,be,ge,b,Q.predicate,Oe,void 0,dt);return Un&&Un.placeable&&(this.markUsedOrientation(f,In,rt),this.placedOrientations[rt.crossTileID]=In),Un};da((()=>Ei(Gr,c.az.horizontal)),(()=>{const Fi=yt.verticalTextBox;return f.allowVerticalPlacement&&rt.numVerticalGlyphVertices>0&&Fi?Ei(Fi,c.az.vertical):{box:null,offscreen:null}})),qr(Ki&&Ki.placeable)}else{let Ei=c.aP[(Ui=(Si=this.prevPlacement)===null||Si===void 0?void 0:Si.variableOffsets[rt.crossTileID])===null||Ui===void 0?void 0:Ui.anchor];const Fi=(Un,dh,fh)=>{const ko=Un.x2-Un.x1,Af=Un.y2-Un.y1,Lo=rt.textBoxScale,ph=me&&ye==="never"?dh:null;let io=null,no=se==="never"?1:2,ts="never";Ei&&no++;for(let mh=0;mh<no;mh++){for(let xu=Ra;xu<ka;xu++){const vu=f.textAnchorOffsets.get(xu);if(Ei&&vu.textAnchor!==Ei)continue;const bu=this.attemptAnchorPlacement(vu,Un,ko,Af,Lo,ge,be,j,Be,D,Q,ts,rt,f,fh,b,E,ph,Oe);if(bu&&(io=bu.placedGlyphBoxes,io&&io.placeable))return Oi=!0,hn=bu.shift,io}Ei?Ei=null:ts=se}return l&&!io&&(io={box:this.collisionIndex.placeCollisionBox(Gr,"always",j,Be,D,be,ge,b,Q.predicate,Oe,void 0,dt).box,offscreen:!1,placeable:!1,occluded:!1}),io};da((()=>Fi(Gr,yt.iconBox,c.az.horizontal)),(()=>{const Un=yt.verticalTextBox;return f.allowVerticalPlacement&&(!Ki||!Ki.placeable)&&rt.numVerticalGlyphVertices>0&&Un?Fi(Un,yt.verticalIconBox,c.az.vertical):{box:null,occluded:!0,offscreen:null}})),Ki&&(Oi=Ki.placeable,Di=Ki.offscreen);const In=qr(Ki&&Ki.placeable);if(!Oi&&this.prevPlacement){const Un=this.prevPlacement.variableOffsets[rt.crossTileID];Un&&(this.variableOffsets[rt.crossTileID]=Un,this.markUsedJustification(f,Un.anchor,rt,In))}}}if(yn=Ki,Oi=yn&&yn.placeable,Di=yn&&yn.offscreen,rt.useRuntimeCollisionCircles&&rt.centerJustifiedTextSymbolIndex>=0){const qr=f.text.placedSymbolArray.get(rt.centerJustifiedTextSymbolIndex),da=c.aA(f.textSizeData,H,qr),Ra=x.get("text-padding");_n=this.collisionIndex.placeCollisionCircles(se,qr,f.lineVertexArray,f.glyphOffsetArray,da,D,k,l,be,Q.predicate,rt.collisionCircleDiameter,Ra,b,Oe),_n.circles.length&&_n.collisionDetected&&!l&&c.w("Collisions detected, but collision boxes are not shown"),Oi=he||_n.circles.length>0&&!_n.collisionDetected,Di=Di&&_n.offscreen}if(yt.iconFeatureIndex&&(Ja=yt.iconFeatureIndex),yt.iconBox){const qr=da=>this.collisionIndex.placeCollisionBox(da,ye,j,Be,D,be,ge,E,Q.predicate,Oe,me&&hn?hn:void 0,dt);tr&&tr.placeable&&yt.verticalIconBox?(ir=qr(yt.verticalIconBox),Wi=ir.placeable):(ir=qr(yt.iconBox),Wi=ir.placeable),Di=Di&&ir.offscreen}const xl=ae||rt.numHorizontalGlyphVertices===0&&rt.numVerticalGlyphVertices===0,fc=oe||rt.numIconVertices===0;xl||fc?fc?xl||(Wi=Wi&&Oi):Oi=Wi&&Oi:Wi=Oi=Wi&&Oi;const es=Wi&&ir.placeable;if(Oi&&yn.placeable&&this.collisionIndex.insertCollisionBox(yn.box,se,x.get("text-ignore-placement"),f.bucketInstanceId,tr&&tr.placeable&&ks?ks:Rs,Q.ID),es&&this.collisionIndex.insertCollisionBox(ir.box,ye,x.get("icon-ignore-placement"),f.bucketInstanceId,Ja,Q.ID),_n&&Oi&&this.collisionIndex.insertCollisionCircles(_n.circles,se,x.get("text-ignore-placement"),f.bucketInstanceId,Rs,Q.ID),l&&this.storeCollisionData(f.bucketInstanceId,$t,yt,yn,ir,_n),rt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[rt.crossTileID]=new Hh((Oi||Fe)&&!yn?.occluded,(Wi||Le)&&!ir?.occluded,Di||f.justReloaded),a[rt.crossTileID]=!0};if(Me){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const rt=f.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let yt=rt.length-1;yt>=0;--yt){const $t=rt[yt];ft(f.symbolInstances.get($t),f.collisionArrays[$t],$t)}}else for(let rt=t.symbolInstanceStart;rt<t.symbolInstanceEnd;rt++)ft(f.symbolInstances.get(rt),f.collisionArrays[rt],rt);f.justReloaded=!1}storeCollisionData(t,a,l,f,x,b){if(l.textBox||l.iconBox){let E,D;this.collisionBoxArrays.has(t)?E=this.collisionBoxArrays.get(t):(E=new Map,this.collisionBoxArrays.set(t,E)),E.has(a)?D=E.get(a):(D={text:null,icon:null},E.set(a,D)),l.textBox&&(D.text=f.box),l.iconBox&&(D.icon=x.box)}if(b){let E=this.collisionCircleArrays[t];E===void 0&&(E=this.collisionCircleArrays[t]=[]);for(let D=0;D<b.circles.length;D+=4)E.push(b.circles[D+0]-_i),E.push(b.circles[D+1]-_i),E.push(b.circles[D+2]),E.push(b.collisionDetected?1:0)}}markUsedJustification(t,a,l,f){let x;x=f===c.az.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[c.aR(a)];const b=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const E of b)E>=0&&(t.text.placedSymbolArray.get(E).crossTileID=x>=0&&E!==x?0:l.crossTileID)}markUsedOrientation(t,a,l){const f=a===c.az.horizontal||a===c.az.horizontalOnly?a:0,x=a===c.az.vertical?a:0,b=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const E of b)t.text.placedSymbolArray.get(E).placedOrientation=f;l.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let l=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const f=a?a.symbolFadeChange(t):1,x=a?a.opacities:{},b=a?a.variableOffsets:{},E=a?a.placedOrientations:{};for(const D in this.placements){const k=this.placements[D],j=x[D];j?(this.opacities[D]=new Yo(j,f,k.text,k.icon),l=l||k.text!==j.text.placed||k.icon!==j.icon.placed):(this.opacities[D]=new Yo(null,f,k.text,k.icon,k.skipFade),l=l||k.text||k.icon)}for(const D in x){const k=x[D];if(!this.opacities[D]){const j=new Yo(k,f,!1,!1);j.isHidden()||(this.opacities[D]=j,l=l||k.text.placed||k.icon.placed)}}for(const D in b)this.variableOffsets[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.variableOffsets[D]=b[D]);for(const D in E)this.placedOrientations[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.placedOrientations[D]=E[D]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:t)}updateLayerOpacities(t,a){const l={};for(const f of a){const x=f.getBucket(t);x&&f.latestFeatureIndex&&t.id===x.layerIds[0]&&this.updateBucketOpacities(x,f.tileID,l,f.collisionBoxArray)}}updateBucketOpacities(t,a,l,f){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const x=t.layers[0],b=x.layout,E=new Yo(null,0,!1,!1,!0),D=b.get("text-allow-overlap"),k=b.get("icon-allow-overlap"),j=x._unevaluatedLayout.hasValue("text-variable-anchor")||x._unevaluatedLayout.hasValue("text-variable-anchor-offset"),U=b.get("text-rotation-alignment")==="map",N=b.get("text-pitch-alignment")==="map",H=b.get("icon-text-fit")!=="none",Q=new Yo(null,0,D&&(k||!t.hasIconData()||b.get("icon-optional")),k&&(D||!t.hasTextData()||b.get("text-optional")),!0);!t.collisionArrays&&f&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(f);const ae=(se,he,ye)=>{for(let ce=0;ce<he/4;ce++)se.opacityVertexArray.emplaceBack(ye);se.hasVisibleVertices=se.hasVisibleVertices||ye!==Ko},oe=this.collisionBoxArrays.get(t.bucketInstanceId);for(let se=0;se<t.symbolInstances.length;se++){const he=t.symbolInstances.get(se),{numHorizontalGlyphVertices:ye,numVerticalGlyphVertices:ce,crossTileID:ge}=he;let be=this.opacities[ge];l[ge]?be=E:be||(be=Q,this.opacities[ge]=be),l[ge]=!0;const me=he.numIconVertices>0,Me=this.placedOrientations[he.crossTileID],Fe=Me===c.az.vertical,Le=Me===c.az.horizontal||Me===c.az.horizontalOnly;if(ye>0||ce>0){const Oe=Nu(be.text);ae(t.text,ye,Fe?Ko:Oe),ae(t.text,ce,Le?Ko:Oe);const dt=be.text.isHidden();[he.rightJustifiedTextSymbolIndex,he.centerJustifiedTextSymbolIndex,he.leftJustifiedTextSymbolIndex].forEach((yt=>{yt>=0&&(t.text.placedSymbolArray.get(yt).hidden=dt||Fe?1:0)})),he.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(he.verticalPlacedTextSymbolIndex).hidden=dt||Le?1:0);const ft=this.variableOffsets[he.crossTileID];ft&&this.markUsedJustification(t,ft.anchor,he,Me);const rt=this.placedOrientations[he.crossTileID];rt&&(this.markUsedJustification(t,"left",he,rt),this.markUsedOrientation(t,rt,he))}if(me){const Oe=Nu(be.icon),dt=!(H&&he.verticalPlacedIconSymbolIndex&&Fe);he.placedIconSymbolIndex>=0&&(ae(t.icon,he.numIconVertices,dt?Oe:Ko),t.icon.placedSymbolArray.get(he.placedIconSymbolIndex).hidden=be.icon.isHidden()),he.verticalPlacedIconSymbolIndex>=0&&(ae(t.icon,he.numVerticalIconVertices,dt?Ko:Oe),t.icon.placedSymbolArray.get(he.verticalPlacedIconSymbolIndex).hidden=be.icon.isHidden())}const Be=oe&&oe.has(se)?oe.get(se):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Oe=t.collisionArrays[se];if(Oe){let dt=new c.P(0,0);if(Oe.textBox||Oe.verticalTextBox){let ft=!0;if(j){const rt=this.variableOffsets[ge];rt?(dt=Ar(rt.anchor,rt.width,rt.height,rt.textOffset,rt.textBoxScale),U&&dt._rotate(N?-this.transform.bearingInRadians:this.transform.bearingInRadians)):ft=!1}if(Oe.textBox||Oe.verticalTextBox){let rt;Oe.textBox&&(rt=Fe),Oe.verticalTextBox&&(rt=Le),Fu(t.textCollisionBox.collisionVertexArray,be.text.placed,!ft||rt,Be.text,dt.x,dt.y)}}if(Oe.iconBox||Oe.verticalIconBox){const ft=!!(!Le&&Oe.verticalIconBox);let rt;Oe.iconBox&&(rt=ft),Oe.verticalIconBox&&(rt=!ft),Fu(t.iconCollisionBox.collisionVertexArray,be.icon.placed,rt,Be.icon,H?dt.x:0,H?dt.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,a){const l=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*l>t}setStale(){this.stale=!0}}function Fu(y,t,a,l,f,x){l&&l.length!==0||(l=[0,0,0,0]);const b=l[0]-_i,E=l[1]-_i,D=l[2]-_i,k=l[3]-_i;y.emplaceBack(t?1:0,a?1:0,f||0,x||0,b,E),y.emplaceBack(t?1:0,a?1:0,f||0,x||0,D,E),y.emplaceBack(t?1:0,a?1:0,f||0,x||0,D,k),y.emplaceBack(t?1:0,a?1:0,f||0,x||0,b,k)}const Oc=Math.pow(2,25),mo=Math.pow(2,24),uf=Math.pow(2,17),Zl=Math.pow(2,16),Gs=Math.pow(2,9),hf=Math.pow(2,8),Wo=Math.pow(2,1);function Nu(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const t=y.placed?1:0,a=Math.floor(127*y.opacity);return a*Oc+t*mo+a*uf+t*Zl+a*Gs+t*hf+a*Wo+t}const Ko=0;class go{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,a,l,f,x){const b=this._bucketParts;for(;this._currentTileIndex<t.length;)if(a.getBucketParts(b,f,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort(((E,D)=>E.sortKey-D.sortKey)));this._currentPartIndex<b.length;)if(a.placeLayerBucketPart(b[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,x())return!0;return!1}}class Hl{constructor(t,a,l,f,x,b,E,D){this.placement=new Bc(t,a,b,E,D),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(t,a,l){const f=xe(),x=()=>!this._forceFullPlacement&&xe()-f>2;for(;this._currentPlacementIndex>=0;){const b=a[t[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=E)&&(!b.maxzoom||b.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new go(b)),this._inProgressLayer.continuePlacement(l[b.source],this.placement,this._showCollisionBoxes,b,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Qt=512/c.a5/2;class Za{constructor(t,a,l){this.tileID=t,this.bucketInstanceId=l,this._symbolsByKey={};const f=new Map;for(let x=0;x<a.length;x++){const b=a.get(x),E=b.key,D=f.get(E);D?D.push(b):f.set(E,[b])}for(const[x,b]of f){const E={positions:b.map((D=>({x:Math.floor(D.anchorX*Qt),y:Math.floor(D.anchorY*Qt)}))),crossTileIDs:b.map((D=>D.crossTileID))};if(E.positions.length>128){const D=new c.aT(E.positions.length,16,Uint16Array);for(const{x:k,y:j}of E.positions)D.add(k,j);D.finish(),delete E.positions,E.index=D}this._symbolsByKey[x]=E}}getScaledCoordinates(t,a){const{x:l,y:f,z:x}=this.tileID.canonical,{x:b,y:E,z:D}=a.canonical,k=Qt/Math.pow(2,D-x),j=(E*c.a5+t.anchorY)*k,U=f*c.a5*Qt;return{x:Math.floor((b*c.a5+t.anchorX)*k-l*c.a5*Qt),y:Math.floor(j-U)}}findMatches(t,a,l){const f=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let x=0;x<t.length;x++){const b=t.get(x);if(b.crossTileID)continue;const E=this._symbolsByKey[b.key];if(!E)continue;const D=this.getScaledCoordinates(b,a);if(E.index){const k=E.index.range(D.x-f,D.y-f,D.x+f,D.y+f).sort();for(const j of k){const U=E.crossTileIDs[j];if(!l[U]){l[U]=!0,b.crossTileID=U;break}}}else if(E.positions)for(let k=0;k<E.positions.length;k++){const j=E.positions[k],U=E.crossTileIDs[k];if(Math.abs(j.x-D.x)<=f&&Math.abs(j.y-D.y)<=f&&!l[U]){l[U]=!0,b.crossTileID=U;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class $h{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Fc{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const a=Math.round((t-this.lng)/360);if(a!==0)for(const l in this.indexes){const f=this.indexes[l],x={};for(const b in f){const E=f[b];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+a),x[E.tileID.key]=E}this.indexes[l]=x}this.lng=t}addBucket(t,a,l){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let x=0;x<a.symbolInstances.length;x++)a.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const f=this.usedCrossTileIDs[t.overscaledZ];for(const x in this.indexes){const b=this.indexes[x];if(Number(x)>t.overscaledZ)for(const E in b){const D=b[E];D.tileID.isChildOf(t)&&D.findMatches(a.symbolInstances,t,f)}else{const E=b[t.scaledTo(Number(x)).key];E&&E.findMatches(a.symbolInstances,t,f)}}for(let x=0;x<a.symbolInstances.length;x++){const b=a.symbolInstances.get(x);b.crossTileID||(b.crossTileID=l.generate(),f[b.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Za(t,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(t,a){for(const l of a.getCrossTileIDsLists())for(const f of l)delete this.usedCrossTileIDs[t][f]}removeStaleBuckets(t){let a=!1;for(const l in this.indexes){const f=this.indexes[l];for(const x in f)t[f[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,f[x]),delete f[x],a=!0)}return a}}class Zn{constructor(){this.layerIndexes={},this.crossTileIDs=new $h,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,a,l){let f=this.layerIndexes[t.id];f===void 0&&(f=this.layerIndexes[t.id]=new Fc);let x=!1;const b={};f.handleWrapJump(l);for(const E of a){const D=E.getBucket(t);D&&t.id===D.layerIds[0]&&(D.bucketInstanceId||(D.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(E.tileID,D,this.crossTileIDs)&&(x=!0),b[D.bucketInstanceId]=!0)}return f.removeStaleBuckets(b)&&(x=!0),x}pruneUnusedLayers(t){const a={};t.forEach((l=>{a[l]=!0}));for(const l in this.layerIndexes)a[l]||delete this.layerIndexes[l]}}var zn="void main() {fragColor=vec4(1.0);}";const Qi={prelude:Vt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Vt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Vt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Vt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Vt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Vt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Vt(zn,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Vt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Vt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Vt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Vt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Vt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Vt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Vt(zn,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Vt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Vt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Vt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Vt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Vt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Vt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Vt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Vt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Vt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Vt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Vt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Vt(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:Vt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:Vt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Vt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Vt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Vt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Vt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Vt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Vt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Vt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Vt(`#ifdef GL_ES
precision highp float;
#endif
in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Vt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Vt(y,t){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=t.match(/in ([\w]+) ([\w]+)/g),f=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=x?x.concat(f):f,E={};return{fragmentSource:y=y.replace(a,((D,k,j,U,N)=>(E[N]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${N}
in ${j} ${U} ${N};
#else
uniform ${j} ${U} u_${N};
#endif
`:`
#ifdef HAS_UNIFORM_u_${N}
    ${j} ${U} ${N} = u_${N};
#endif
`))),vertexSource:t=t.replace(a,((D,k,j,U,N)=>{const H=U==="float"?"vec2":"vec4",Q=N.match(/color/)?"color":H;return E[N]?k==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
in ${j} ${H} a_${N};
out ${j} ${U} ${N};
#else
uniform ${j} ${U} u_${N};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = a_${N};
#else
    ${j} ${U} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = unpack_mix_${Q}(a_${N}, u_${N}_t);
#else
    ${j} ${U} ${N} = u_${N};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
in ${j} ${H} a_${N};
#else
uniform ${j} ${U} u_${N};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${j} ${U} ${N} = a_${N};
#else
    ${j} ${U} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${j} ${U} ${N} = unpack_mix_${Q}(a_${N}, u_${N}_t);
#else
    ${j} ${U} ${N} = u_${N};
#endif
`})),staticAttributes:l,staticUniforms:b}}class ji{constructor(t,a,l){this.vertexBuffer=t,this.indexBuffer=a,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Ta=c.aU([{name:"a_pos",type:"Int16",components:2}]);const pn="#define PROJECTION_MERCATOR",Cr="mercator";class Hn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Cr}get shaderDefine(){return pn}get shaderPreludeCode(){return Qi.projectionMercator}get vertexShaderPreludeCode(){return Qi.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,a,l,f,x){if(this._cachedMesh)return this._cachedMesh;const b=new c.aW;b.emplaceBack(0,0),b.emplaceBack(c.a5,0),b.emplaceBack(0,c.a5),b.emplaceBack(c.a5,c.a5);const E=t.createVertexBuffer(b,Ta.members),D=c.aX.simpleSegment(0,0,4,2),k=new c.aY;k.emplaceBack(1,0,2),k.emplaceBack(1,2,3);const j=t.createIndexBuffer(k);return this._cachedMesh=new ji(E,j,D),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class ia{constructor(t=0,a=0,l=0,f=0){if(isNaN(t)||t<0||isNaN(a)||a<0||isNaN(l)||l<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=a,this.left=l,this.right=f}interpolate(t,a,l){return a.top!=null&&t.top!=null&&(this.top=c.G.number(t.top,a.top,l)),a.bottom!=null&&t.bottom!=null&&(this.bottom=c.G.number(t.bottom,a.bottom,l)),a.left!=null&&t.left!=null&&(this.left=c.G.number(t.left,a.left,l)),a.right!=null&&t.right!=null&&(this.right=c.G.number(t.right,a.right,l)),this}getCenter(t,a){const l=c.an((this.left+t-this.right)/2,0,t),f=c.an((this.top+a-this.bottom)/2,0,a);return new c.P(l,f)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new ia(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ms(y,t){if(!y.renderWorldCopies||y.lngRange)return;const a=t.lng-y.center.lng;t.lng+=a>180?-360:a<-180?360:0}function Ji(y){return Math.max(0,Math.floor(y))}class yo{constructor(t,a){var l;this.applyConstrain=(f,x)=>this._constrainOverride!==null?this._constrainOverride(f,x):this._callbacks.defaultConstrain(f,x),this._callbacks=t,this._tileSize=512,this._renderWorldCopies=a?.renderWorldCopies===void 0||!!a?.renderWorldCopies,this._minZoom=a?.minZoom||0,this._maxZoom=a?.maxZoom||22,this._minPitch=a?.minPitch==null?0:a?.minPitch,this._maxPitch=a?.maxPitch==null?60:a?.maxPitch,this._constrainOverride=(l=a?.constrainOverride)!==null&&l!==void 0?l:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ji(this._zoom),this._scale=c.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new ia,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,a,l){this._constrainOverride=t.constrainOverride,this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Ji(this._zoom),this._scale=c.aq(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new ia(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!l&&t.autoCalculateNearFarZ,a&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get constrainOverride(){return this._constrainOverride}setConstrainOverride(t){t===void 0&&(t=null),this._constrainOverride!==t&&(this._constrainOverride=t,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const a=c.W(t,-180,180)*Math.PI/180;var l,f,x,b,E,D,k,j,U;this._bearingInRadians!==a&&(this._unmodified=!1,this._bearingInRadians=a,this._calcMatrices(),this._rotationMatrix=X(),l=this._rotationMatrix,x=-this._bearingInRadians,b=(f=this._rotationMatrix)[0],E=f[1],D=f[2],k=f[3],j=Math.sin(x),U=Math.cos(x),l[0]=b*U+D*j,l[1]=E*U+k*j,l[2]=b*-j+D*U,l[3]=E*-j+k*U)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const a=c.an(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==a&&(this._unmodified=!1,this._pitchInRadians=a,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const a=t/180*Math.PI;this._rollInRadians!==a&&(this._unmodified=!1,this._rollInRadians=a,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aZ(this._fovInRadians)}setFov(t){t=c.an(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=c.ap(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const a=this.applyConstrain(this._center,t).zoom;this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this._tileZoom=Math.max(0,Math.floor(a)),this._scale=c.aq(a),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,a){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=a,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,a,l){this._unmodified=!1,this._edgeInsets.interpolate(t,a,l),this.constrainInternal(),this._calcMatrices()}resize(t,a,l=!0){this._width=t,this._height=a,l&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new on([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-c.ao,c.ao])}getCameraQueryGeometry(t,a){if(a.length===1)return[a[0],t];{const{minX:l,minY:f,maxX:x,maxY:b}=c.aa.fromPoints(a).extend(t);return[new c.P(l,f),new c.P(x,f),new c.P(x,b),new c.P(l,b),new c.P(l,f)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:a,zoom:l}=this.applyConstrain(this.center,this.zoom);this.setCenter(a),this.setZoom(l),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=c.ar(new Float64Array(16));c.Q(t,t,[this._width/2,-this._height/2,1]),c.O(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=c.ar(new Float64Array(16)),c.Q(t,t,[1,-1,1]),c.O(t,t,[-1,-1,0]),c.Q(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,a,l,f){const x=l!==void 0?l:this.bearing,b=f=f!==void 0?f:this.pitch,{distanceToCenter:E,clampedElevation:D}=this._distanceToCenterFromAltElevationPitch(a,this.elevation,b),{x:k,y:j}=Ut(b,x),U=c.a9.fromLngLat(t,a);let N,H,Q=c.a_(1,U.y),ae=0;do{if(ae+=1,ae>10)break;H=E/Q,N=new c.a9(U.x+k*H,U.y+j*H),Q=1/N.meterInMercatorCoordinateUnits()}while(Math.abs(E-H*Q)>1e-12);return{center:N.toLngLat(),elevation:D,zoom:c.at(this.height/2/Math.tan(this.fovInRadians/2)/H/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const a=1/this.worldSize,l=c.as(1,this.center.lat)*this.worldSize,f=c.a9.fromLngLat(this.center,this.elevation),x=f.x/a,b=f.y/a,E=f.z/a,D=this.pitch,k=this.bearing,{x:j,y:U,z:N}=Ut(D,k),H=this.cameraToCenterDistance,Q=x+H*-j,ae=b+H*-U,oe=E+H*N,{distanceToCenter:se,clampedElevation:he}=this._distanceToCenterFromAltElevationPitch(oe/l,t,D),ye=se*l,ce=new c.a9((Q+j*ye)*a,(ae+U*ye)*a,0).toLngLat(),ge=c.as(1,ce.lat),be=c.at(this.height/2/Math.tan(this.fovInRadians/2)/se/ge/this.tileSize);this._elevation=he,this._center=ce,this.setZoom(be)}_distanceToCenterFromAltElevationPitch(t,a,l){const f=-Math.cos(c.ap(l)),x=t-a;let b,E=a;return f*x>=0||Math.abs(f)<.1?(b=1e4,E=t+b*f):b=-x/f,{distanceToCenter:b,clampedElevation:E}}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=c.as(1,this.center.lat)*this.worldSize;return Te(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const a=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/a,t.canonical.y/a,1/a/c.a5,1/a/c.a5]}}class na{constructor(t,a){this.min=t,this.max=a,this.center=c.a$([],c.b0([],this.min,this.max),.5)}quadrant(t){const a=[t%2==0,t<2],l=c.b1(this.min),f=c.b1(this.max);for(let x=0;x<a.length;x++)l[x]=a[x]?this.min[x]:this.center[x],f[x]=a[x]?this.center[x]:this.max[x];return f[2]=this.max[2],new na(l,f)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let a=!0;for(let l=0;l<t.planes.length;l++){const f=this.intersectsPlane(t.planes[l]);if(f===0)return 0;f===1&&(a=!1)}return a?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let a=t[3],l=t[3];for(let f=0;f<3;f++)t[f]>0?(a+=t[f]*this.min[f],l+=t[f]*this.max[f]):(l+=t[f]*this.min[f],a+=t[f]*this.max[f]);return a>=0?2:l<0?0:1}}class Qo{distanceToTile2d(t,a,l,f){const x=f.distanceX([t,a]),b=f.distanceY([t,a]);return Math.hypot(x,b)}getWrap(t,a,l){return l}getTileBoundingVolume(t,a,l,f){var x,b;let E=0,D=0;if(f?.terrain){const j=new c.a2(t.z,a,t.z,t.x,t.y),U=f.terrain.getMinMaxElevation(j);E=(x=U.minElevation)!==null&&x!==void 0?x:Math.min(0,l),D=(b=U.maxElevation)!==null&&b!==void 0?b:Math.max(0,l)}const k=1<<t.z;return new na([a+t.x/k,t.y/k,E],[a+(t.x+1)/k,(t.y+1)/k,D])}allowVariableZoom(t,a){const l=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,f=c.an(78.5-l/2,0,60);return!!a.terrain||t.pitch>f}allowWorldCopies(){return!0}prepareNextFrame(){}}class Dr{constructor(t,a,l){this.points=t,this.planes=a,this.aabb=l}static fromInvProjectionMatrix(t,a=1,l=0,f,x){const b=x?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],E=Math.pow(2,l),D=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((N=>(function(H,Q,ae,oe){const se=c.aH([],H,Q),he=1/se[3]/ae*oe;return c.b6(se,se,[he,he,1/se[3],he])})(N,t,a,E)));f&&(function(N,H,Q,ae){const oe=ae?4:0,se=ae?0:4;let he=0;const ye=[],ce=[];for(let me=0;me<4;me++){const Me=c.b2([],N[me+se],N[me+oe]),Fe=c.b7(Me);c.a$(Me,Me,1/Fe),ye.push(Fe),ce.push(Me)}for(let me=0;me<4;me++){const Me=c.b8(N[me+oe],ce[me],Q);he=Me!==null&&Me>=0?Math.max(he,Me):Math.max(he,ye[me])}const ge=(function(me,Me){const Fe=c.b2([],me[Me[0]],me[Me[1]]),Le=c.b2([],me[Me[2]],me[Me[1]]),Be=[0,0,0,0];return c.b3(Be,c.b4([],Fe,Le)),Be[3]=-c.b5(Be,me[Me[0]]),Be})(N,H),be=(function(me,Me){const Fe=c.b9(me),Le=c.ba([],me,1/Fe),Be=c.b2([],Me,c.a$([],Le,c.b5(Me,Le))),Oe=c.b9(Be);if(Oe>0){const dt=Math.sqrt(1-Le[3]*Le[3]),ft=c.a$([],Le,-Le[3]),rt=c.b0([],ft,c.a$([],Be,dt/Oe));return c.bb(Me,rt)}return null})(Q,ge);if(be!==null){const me=be/c.b5(ce[0],ge);he=Math.min(he,me)}for(let me=0;me<4;me++){const Me=Math.min(he,ye[me]);N[me+se]=[N[me+oe][0]+ce[me][0]*Me,N[me+oe][1]+ce[me][1]*Me,N[me+oe][2]+ce[me][2]*Me,1]}})(D,b[0],f,x);const k=b.map((N=>{const H=c.b2([],D[N[0]],D[N[1]]),Q=c.b2([],D[N[2]],D[N[1]]),ae=c.b3([],c.b4([],H,Q)),oe=-c.b5(ae,D[N[1]]);return ae.concat(oe)})),j=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],U=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const N of D)for(let H=0;H<3;H++)j[H]=Math.min(j[H],N[H]),U[H]=Math.max(U[H],N[H]);return new Dr(D,k,new na(j,U))}}class Vn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,l){return this._helper.interpolatePadding(t,a,l)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a,l=!0){this._helper.resize(t,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,a){}constructor(t){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(a,l)=>{l=c.an(+l,this.minZoom,this.maxZoom);const f={center:new c.V(a.lng,a.lat),zoom:l};let x=this._helper._lngRange;if(!this._helper._renderWorldCopies&&x===null){const ce=179.9999999999;x=[-ce,ce]}const b=this.tileSize*c.aq(f.zoom);let E=0,D=b,k=0,j=b,U=0,N=0;const{x:H,y:Q}=this.size;if(this._helper._latRange){const ce=this._helper._latRange;E=c.X(ce[1])*b,D=c.X(ce[0])*b,D-E<Q&&(U=Q/(D-E))}x&&(k=c.W(c.Y(x[0])*b,0,b),j=c.W(c.Y(x[1])*b,0,b),j<k&&(j+=b),j-k<H&&(N=H/(j-k)));const{x:ae,y:oe}=Re(b,a);let se,he;const ye=Math.max(N||0,U||0);if(ye){const ce=new c.P(N?(j+k)/2:ae,U?(D+E)/2:oe);return f.center=nt(b,ce).wrap(),f.zoom+=c.at(ye),f}if(this._helper._latRange){const ce=Q/2;oe-ce<E&&(he=E+ce),oe+ce>D&&(he=D-ce)}if(x){const ce=(k+j)/2;let ge=ae;this._helper._renderWorldCopies&&(ge=c.W(ae,ce-b/2,ce+b/2));const be=H/2;ge-be<k&&(se=k+be),ge+be>j&&(se=j-be)}if(se!==void 0||he!==void 0){const ce=new c.P(se??ae,he??oe);f.center=nt(b,ce).wrap()}return f},this.applyConstrain=(a,l)=>this._helper.applyConstrain(a,l),this._helper=new yo({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,l)=>this.defaultConstrain(a,l)},t),this._coveringTilesDetailsProvider=new Qo}clone(){const t=new Vn;return t.apply(this,!1),t}apply(t,a,l){this._helper.apply(t,a,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const a=[new c.bc(0,t)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new c.P(0,0)),f=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),x=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),b=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),E=Math.floor(Math.min(l.x,f.x,x.x,b.x)),D=Math.floor(Math.max(l.x,f.x,x.x,b.x)),k=1;for(let j=E-k;j<=D+k;j++)j!==0&&a.push(new c.bc(j,t))}return a}getCameraFrustum(){return Dr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const a=this.screenPointToLocation(this.centerPoint,t),l=t?t.getElevationForLngLatZoom(a,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(t,a){const l=c.as(this.elevation,this.center.lat),f=this.screenPointToMercatorCoordinateAtZ(a,l),x=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),b=c.a9.fromLngLat(t),E=new c.a9(b.x-(f.x-x.x),b.y-(f.y-x.y));this.setCenter(E?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,a){return a?this.coordinatePoint(c.a9.fromLngLat(t),a.getElevationForLngLat(t,this),this._pixelMatrix3D):this.coordinatePoint(c.a9.fromLngLat(t))}screenPointToLocation(t,a){var l;return(l=this.screenPointToMercatorCoordinate(t,a))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(t,a){if(a){const l=a.pointCoordinate(t);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,a){const l=a||0,f=[t.x,t.y,0,1],x=[t.x,t.y,1,1];c.aH(f,f,this._pixelMatrixInverse),c.aH(x,x,this._pixelMatrixInverse);const b=f[3],E=x[3],D=f[1]/b,k=x[1]/E,j=f[2]/b,U=x[2]/E,N=j===U?0:(l-j)/(U-j);return new c.a9(c.G.number(f[0]/b,x[0]/E,N)/this.worldSize,c.G.number(D,k,N)/this.worldSize,l)}coordinatePoint(t,a=0,l=this._pixelMatrix){const f=[t.x*this.worldSize,t.y*this.worldSize,a,1];return c.aH(f,f,l),new c.P(f[0]/f[3],f[1]/f[3])}getBounds(){const t=Math.max(0,this._helper._height/2-$e(this));return new on().extend(this.screenPointToLocation(new c.P(0,t))).extend(this.screenPointToLocation(new c.P(this._helper._width,t))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(t,a){return a?a.pointCoordinate(t)!=null:t.y>this.height/2-$e(this)}calculatePosMatrix(t,a=!1,l){var f;const x=(f=t.key)!==null&&f!==void 0?f:c.bd(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),b=a?this._alignedPosMatrixCache:this._posMatrixCache;if(b.has(x)){const k=b.get(x);return l?k.f32:k.f64}const E=lt(t,this.worldSize);c.S(E,a?this._alignedProjMatrix:this._viewProjMatrix,E);const D={f64:E,f32:new Float32Array(E)};return b.set(x,D),l?D.f32:D.f64}calculateFogMatrix(t){const a=t.key,l=this._fogMatrixCacheF32;if(l.has(a))return l.get(a);const f=lt(t,this.worldSize);return c.S(f,this._fogMatrix,f),l.set(a,new Float32Array(f)),l.get(a)}calculateCenterFromCameraLngLatAlt(t,a,l,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,l,f)}_calculateNearFarZIfNeeded(t,a,l){if(!this._helper.autoCalculateNearFarZ)return;const f=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),x=t-f*this._helper._pixelPerMeter/Math.cos(a),b=f<0?x:t,E=Math.PI/2+this.pitchInRadians,D=c.ap(this.fov)*(Math.abs(Math.cos(c.ap(this.roll)))*this.height+Math.abs(Math.sin(c.ap(this.roll)))*this.width)/this.height*(.5+l.y/this.height),k=Math.sin(D)*b/Math.sin(c.an(Math.PI-E-D,.01,Math.PI-.01)),j=$e(this),U=Math.atan(j/this._helper.cameraToCenterDistance),N=c.ap(.75),H=U>N?2*U*(.5+l.y/(2*j)):N,Q=Math.sin(H)*b/Math.sin(c.an(Math.PI-E-H,.01,Math.PI-.01)),ae=Math.min(k,Q);this._helper._farZ=1.01*(Math.cos(Math.PI/2-a)*ae+b),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,a=Re(this.worldSize,this.center),l=a.x,f=a.y;this._helper._pixelPerMeter=c.as(1,this.center.lat)*this.worldSize;const x=c.ap(Math.min(this.pitch,ze)),b=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(x));let E;this._calculateNearFarZIfNeeded(b,x,t),E=new Float64Array(16),c.be(E,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.aB(this._invProjMatrix,E),E[8]=2*-t.x/this._helper._width,E[9]=2*t.y/this._helper._height,this._projectionMatrix=c.bf(E),c.Q(E,E,[1,-1,1]),c.O(E,E,[0,0,-this._helper.cameraToCenterDistance]),c.bg(E,E,-this.rollInRadians),c.bh(E,E,this.pitchInRadians),c.bg(E,E,-this.bearingInRadians),c.O(E,E,[-l,-f,0]),this._mercatorMatrix=c.Q([],E,[this.worldSize,this.worldSize,this.worldSize]),c.Q(E,E,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,E),c.O(E,E,[0,0,-this.elevation]),this._viewProjMatrix=E,this._invViewProjMatrix=c.aB([],E);const D=[0,0,-1,1];c.aH(D,D,this._invViewProjMatrix),this._cameraPosition=[D[0]/D[3],D[1]/D[3],D[2]/D[3]],this._fogMatrix=new Float64Array(16),c.be(this._fogMatrix,this.fovInRadians,this.width/this.height,b,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,c.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.O(this._fogMatrix,this._fogMatrix,[-l,-f,0]),c.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,E);const k=this._helper._width%2/2,j=this._helper._height%2/2,U=Math.cos(this.bearingInRadians),N=Math.sin(-this.bearingInRadians),H=l-Math.round(l)+U*k+N*j,Q=f-Math.round(f)+U*j+N*k,ae=new Float64Array(E);if(c.O(ae,ae,[H>.5?H-1:H,Q>.5?Q-1:Q,0]),this._alignedProjMatrix=ae,E=c.aB(new Float64Array(16),this._pixelMatrix),!E)throw new Error("failed to invert matrix");this._pixelMatrixInverse=E,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new c.P(0,0)),a=[t.x*this.worldSize,t.y*this.worldSize,0,1];return c.aH(a,a,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=c.as(1,this.center.lat)*this.worldSize;return Te(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,a){const l=c.a9.fromLngLat(t),f=[l.x*this.worldSize,l.y*this.worldSize,a,1];return c.aH(f,f,this._viewProjMatrix),f[2]/f[3]}getProjectionData(t){const{overscaledTileID:a,aligned:l,applyTerrainMatrix:f}=t,x=this._helper.getMercatorTileCoordinates(a),b=a?this.calculatePosMatrix(a,l,!0):null;let E;return E=a&&a.terrainRttPosMatrix32f&&f?a.terrainRttPosMatrix32f:b||c.bi(),{mainMatrix:E,tileMercatorCoords:x,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:E}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,a,l){return 1}transformLightDirection(t){return c.b1(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,a,l,f){const x=this.calculatePosMatrix(l);let b;f?(b=[t,a,f(t,a),1],c.aH(b,b,x)):(b=[t,a,0,1],wa(b,b,x));const E=b[3];return{point:new c.P(b[0]/E,b[1]/E),signedDistanceFromCamera:E,isOccluded:!1}}populateCache(t){for(const a of t)this.calculatePosMatrix(a)}getMatrixForModel(t,a){const l=c.a9.fromLngLat(t,a),f=l.meterInMercatorCoordinateUnits(),x=c.bj();return c.O(x,x,[l.x,l.y,l.z]),c.bg(x,x,Math.PI),c.bh(x,x,Math.PI/2),c.Q(x,x,[-f,f,f]),x}getProjectionDataForCustomLayer(t=!0){const a=new c.a2(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:a,applyGlobeMatrix:t}),f=lt(a,this.worldSize);c.S(f,this._viewProjMatrix,f),l.tileMercatorCoords=[0,0,1,1];const x=[c.a5,c.a5,this.worldSize/this._helper.pixelsPerMeter],b=c.bk();return c.Q(b,f,x),l.fallbackMatrix=b,l.mainMatrix=b,l}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function zr(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Nc(y){if(y.useSlerp)if(y.k<1){const t=c.bl(y.startEulerAngles.roll,y.startEulerAngles.pitch,y.startEulerAngles.bearing),a=c.bl(y.endEulerAngles.roll,y.endEulerAngles.pitch,y.endEulerAngles.bearing),l=new Float64Array(4);c.bm(l,t,a,y.k);const f=c.bn(l);y.tr.setRoll(f.roll),y.tr.setPitch(f.pitch),y.tr.setBearing(f.bearing)}else y.tr.setRoll(y.endEulerAngles.roll),y.tr.setPitch(y.endEulerAngles.pitch),y.tr.setBearing(y.endEulerAngles.bearing);else y.tr.setRoll(c.G.number(y.startEulerAngles.roll,y.endEulerAngles.roll,y.k)),y.tr.setPitch(c.G.number(y.startEulerAngles.pitch,y.endEulerAngles.pitch,y.k)),y.tr.setBearing(c.G.number(y.startEulerAngles.bearing,y.endEulerAngles.bearing,y.k))}function Jo(y,t,a,l,f){const x=f.padding,b=Re(f.worldSize,a.getNorthWest()),E=Re(f.worldSize,a.getNorthEast()),D=Re(f.worldSize,a.getSouthEast()),k=Re(f.worldSize,a.getSouthWest()),j=c.ap(-l),U=b.rotate(j),N=E.rotate(j),H=D.rotate(j),Q=k.rotate(j),ae=new c.P(Math.max(U.x,N.x,Q.x,H.x),Math.max(U.y,N.y,Q.y,H.y)),oe=new c.P(Math.min(U.x,N.x,Q.x,H.x),Math.min(U.y,N.y,Q.y,H.y)),se=ae.sub(oe),he=(f.width-(x.left+x.right+t.left+t.right))/se.x,ye=(f.height-(x.top+x.bottom+t.top+t.bottom))/se.y;if(ye<0||he<0)return void zr();const ce=Math.min(c.at(f.scale*Math.min(he,ye)),y.maxZoom),ge=c.P.convert(y.offset),be=new c.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(c.ap(l)),me=ge.add(be).mult(f.scale/c.aq(ce));return{center:nt(f.worldSize,b.add(D).div(2).sub(me)),zoom:ce,bearing:l}}class el{get useGlobeControls(){return!1}handlePanInertia(t,a){const l=t.mag(),f=Math.abs($e(a));return{easingOffset:t.mult(Math.min(.75*f/l,1)),easingCenter:a.center}}handleMapControlsRollPitchBearingZoom(t,a){t.bearingDelta&&a.setBearing(a.bearing+t.bearingDelta),t.pitchDelta&&a.setPitch(a.pitch+t.pitchDelta),t.rollDelta&&a.setRoll(a.roll+t.rollDelta),t.zoomDelta&&a.setZoom(a.zoom+t.zoomDelta)}handleMapControlsPan(t,a,l){t.around.distSqr(a.centerPoint)<.01||a.setLocationAtPoint(l,t.around)}cameraForBoxAndBearing(t,a,l,f,x){return Jo(t,a,l,f,x)}handleJumpToCenterZoom(t,a){t.zoom!==(a.zoom!==void 0?+a.zoom:t.zoom)&&t.setZoom(+a.zoom),a.center!==void 0&&t.setCenter(c.V.convert(a.center))}handleEaseTo(t,a){const l=t.zoom,f=t.padding,x={roll:t.roll,pitch:t.pitch,bearing:t.bearing},b={roll:a.roll===void 0?t.roll:a.roll,pitch:a.pitch===void 0?t.pitch:a.pitch,bearing:a.bearing===void 0?t.bearing:a.bearing},E=a.zoom!==void 0,D=!t.isPaddingEqual(a.padding);let k=!1;const j=E?+a.zoom:t.zoom;let U=t.centerPoint.add(a.offsetAsPoint);const N=t.screenPointToLocation(U),{center:H,zoom:Q}=t.applyConstrain(c.V.convert(a.center||N),j??l);ms(t,H);const ae=Re(t.worldSize,N),oe=Re(t.worldSize,H).sub(ae),se=c.aq(Q-l);return k=Q!==l,{easeFunc:he=>{if(k&&t.setZoom(c.G.number(l,Q,he)),c.bo(x,b)||Nc({startEulerAngles:x,endEulerAngles:b,tr:t,k:he,useSlerp:x.roll!=b.roll}),D&&(t.interpolatePadding(f,a.padding,he),U=t.centerPoint.add(a.offsetAsPoint)),a.around)t.setLocationAtPoint(a.around,a.aroundPoint);else{const ye=c.aq(t.zoom-l),ce=Q>l?Math.min(2,se):Math.max(.5,se),ge=Math.pow(ce,1-he),be=nt(t.worldSize,ae.add(oe.mult(he*ge)).mult(ye));t.setLocationAtPoint(t.renderWorldCopies?be.wrap():be,U)}},isZooming:k,elevationCenter:H}}handleFlyTo(t,a){const l=a.zoom!==void 0,f=t.zoom,x=t.applyConstrain(c.V.convert(a.center||a.locationAtOffset),l?+a.zoom:f),b=x.center,E=x.zoom;ms(t,b);const D=Re(t.worldSize,a.locationAtOffset),k=Re(t.worldSize,b).sub(D),j=k.mag(),U=c.aq(E-f);let N;if(a.minZoom!==void 0){const H=Math.min(+a.minZoom,f,E),Q=t.applyConstrain(b,H).zoom;N=c.aq(Q-f)}return{easeFunc:(H,Q,ae,oe)=>{t.setZoom(H===1?E:f+c.at(Q));const se=H===1?b:nt(t.worldSize,D.add(k.mult(ae)).mult(Q));t.setLocationAtPoint(t.renderWorldCopies?se.wrap():se,oe)},scaleOfZoom:U,targetCenter:b,scaleOfMinZoom:N,pixelPathLength:j}}}class Ci{constructor(t,a,l){this.blendFunction=t,this.blendColor=a,this.mask=l}}Ci.Replace=[1,0],Ci.disabled=new Ci(Ci.Replace,c.bp.transparent,[!1,!1,!1,!1]),Ci.unblended=new Ci(Ci.Replace,c.bp.transparent,[!0,!0,!0,!0]),Ci.alphaBlended=new Ci([1,771],c.bp.transparent,[!0,!0,!0,!0]);const _o=2305;class ri{constructor(t,a,l){this.enable=t,this.mode=a,this.frontFace=l}}ri.disabled=new ri(!1,1029,_o),ri.backCCW=new ri(!0,1029,_o),ri.frontCCW=new ri(!0,1028,_o);class Yt{constructor(t,a,l){this.func=t,this.mask=a,this.range=l}}Yt.ReadOnly=!1,Yt.ReadWrite=!0,Yt.disabled=new Yt(519,Yt.ReadOnly,[0,1]);const tl=7680;class fi{constructor(t,a,l,f,x,b){this.test=t,this.ref=a,this.mask=l,this.fail=f,this.depthFail=x,this.pass=b}}fi.disabled=new fi({func:519,mask:0},0,0,tl,tl,tl);const Vc=new WeakMap;function Sa(y){var t;if(Vc.has(y))return Vc.get(y);{const a=(t=y.getParameter(y.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return Vc.set(y,a),a}}class xo{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const a=t.context,l=a.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const f=new c.aW;f.emplaceBack(-1,-1),f.emplaceBack(2,-1),f.emplaceBack(-1,2);const x=new c.aY;x.emplaceBack(0,1,2),this._fullscreenTriangle=new ji(a.createVertexBuffer(f,Ta.members),a.createIndexBuffer(x),c.aX.simpleSegment(0,0,f.length,x.length)),this._resultBuffer=new Uint8Array(4),a.activeTexture.set(l.TEXTURE1);const b=l.createTexture();l.bindTexture(l.TEXTURE_2D,b),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=a.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(b),Sa(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,a){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,a),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,a=t.gl;t.activeTexture.set(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,a){const l=this._cachedRenderContext.context,f=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:c.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,f.TRIANGLES,Yt.disabled,fi.disabled,Ci.unblended,ri.disabled,((x,b)=>({u_input:x,u_output_expected:b}))(t,a),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Sa(f)){f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.readBuffer(f.COLOR_ATTACHMENT0),f.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),f.bindBuffer(f.PIXEL_PACK_BUFFER,null);const x=f.fenceSync(f.SYNC_GPU_COMMANDS_COMPLETE,0);f.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:x}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Sa(t)){const a=t.clientWaitSync(this._readbackQueue.sync,0,0);if(a===t.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(a===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=xo._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let a=0;return a+=t[0]/256,a+=t[1]/65536,a+=t[2]/16777216,t[3]<127&&(a=-a),a/128}}const vo=c.a5/128;function df(y,t){const a=y.granularity!==void 0?Math.max(y.granularity,1):1,l=a+(y.generateBorders?2:0),f=a+(y.extendToNorthPole||y.generateBorders?1:0)+(y.extendToSouthPole||y.generateBorders?1:0),x=l+1,b=f+1,E=y.generateBorders?-1:0,D=y.generateBorders||y.extendToNorthPole?-1:0,k=a+(y.generateBorders?1:0),j=a+(y.generateBorders||y.extendToSouthPole?1:0),U=x*b,N=l*f*6,H=x*b>65536;if(H&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Q=H||t==="32bit",ae=new Int16Array(2*U);let oe=0;for(let ye=D;ye<=j;ye++)for(let ce=E;ce<=k;ce++){let ge=ce/a*c.a5;ce===-1&&(ge=-vo),ce===a+1&&(ge=c.a5+vo);let be=ye/a*c.a5;ye===-1&&(be=y.extendToNorthPole?c.br:-vo),ye===a+1&&(be=y.extendToSouthPole?c.bs:c.a5+vo),ae[oe++]=ge,ae[oe++]=be}const se=Q?new Uint32Array(N):new Uint16Array(N);let he=0;for(let ye=0;ye<f;ye++)for(let ce=0;ce<l;ce++){const ge=ce+1+ye*x,be=ce+(ye+1)*x,me=ce+1+(ye+1)*x;se[he++]=ce+ye*x,se[he++]=be,se[he++]=ge,se[he++]=ge,se[he++]=be,se[he++]=me}return{vertices:ae.buffer.slice(0),indices:se.buffer.slice(0),uses32bitIndices:Q}}const Uc=new c.aV({fill:new c.bt(128,2),line:new c.bt(512,0),tile:new c.bt(128,32),stencil:new c.bt(128,1),circle:3});class Xh{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Qi.projectionGlobe}get vertexShaderPreludeCode(){return Qi.projectionMercator.vertexSource}get subdivisionGranularity(){return Uc}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new xo(t));const a=c.X(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-a*Math.PI*2))-.5*Math.PI,f=this._errorMeasurement.updateErrorLoop(a,l),x=xe();f!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=f,this._errorMeasurementLastChangeTime=x);const b=Math.min(Math.max((x-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bv(b))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,a,l,f,x){const b=(x==="stencil"?Uc.stencil:Uc.tile).getGranularityForZoomLevel(a.z);return this._getMesh(t,{granularity:b,generateBorders:l,extendToNorthPole:a.y===0&&f,extendToSouthPole:a.y===(1<<a.z)-1&&f})}_getMesh(t,a){const l=this._getMeshKey(a);if(l in this._tileMeshCache)return this._tileMeshCache[l];const f=(function(x,b){const E=df(b,"16bit"),D=c.aW.deserialize({arrayBuffer:E.vertices,length:E.vertices.byteLength/2/2}),k=c.aY.deserialize({arrayBuffer:E.indices,length:E.indices.byteLength/2/3});return new ji(x.createVertexBuffer(D,Ta.members),x.createIndexBuffer(k),c.aX.simpleSegment(0,0,D.length,k.length))})(t,a);return this._tileMeshCache[l]=f,f}recalculate(t){}hasTransition(){const t=xe();let a=!1;return a=a||(t-this._errorMeasurementLastChangeTime)/1e3<.7,a=a||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,a}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const Np=new c.t({type:new c.D(c.u.projection.type)});class Yh extends c.E{constructor(t){super(),this._transitionable=new c.x(Np,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.H(0)),this._mercatorProjection=new Hn,this._verticalPerspectiveProjection=new Xh}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof c.bw){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,a,l,f,x){return this.currentProjection.getMeshFromTileID(t,a,l,f,x)}setProjection(t){this._transitionable.setValue("type",t?.type||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function Pr(y){const t=il(y.worldSize,y.center.lat);return 2*Math.PI*t}function gs(y,t,a,l,f){const x=1/(1<<f),b=t/c.a5*x+l*x,E=c.bz((y/c.a5*x+a*x)*Math.PI*2+Math.PI,2*Math.PI),D=2*Math.atan(Math.exp(Math.PI-b*Math.PI*2))-.5*Math.PI,k=Math.cos(D),j=new Float64Array(3);return j[0]=Math.sin(E)*k,j[1]=Math.sin(D),j[2]=Math.cos(E)*k,j}function en(y){return(function(t,a){const l=Math.cos(a),f=new Float64Array(3);return f[0]=Math.sin(t)*l,f[1]=Math.sin(a),f[2]=Math.cos(t)*l,f})(y.lng*Math.PI/180,y.lat*Math.PI/180)}function il(y,t){return y/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Gc(y){const t=Math.asin(y[1])/Math.PI*180,a=Math.sqrt(y[0]*y[0]+y[2]*y[2]);if(a>1e-6){const l=y[0]/a,f=Math.acos(y[2]/a),x=(l>0?f:-f)/Math.PI*180;return new c.V(c.W(x,-180,180),t)}return new c.V(0,t)}function qc(y){return Math.cos(y*Math.PI/180)}function mn(y,t){const a=qc(y),l=qc(t);return c.at(l/a)}function ff(y,t){const a=y.rotate(t.bearingInRadians),l=t.zoom+mn(t.center.lat,0),f=c.bu(1/qc(t.center.lat),1/qc(Math.min(Math.abs(t.center.lat),60)),c.bx(l,7,3,0,1)),x=360/Pr({worldSize:t.worldSize,center:{lat:t.center.lat}});return new c.V(t.center.lng-a.x*x*f,c.an(t.center.lat+a.y*x,-c.ao,c.ao))}function Vu(y){const t=.5*y,a=Math.sin(t),l=Math.cos(t);return Math.log(a+l)-Math.log(l-a)}function pf(y,t,a,l){const f=y.lat+a*l;if(Math.abs(a)>1){const x=(Math.sign(y.lat+a)!==Math.sign(y.lat)?-Math.abs(y.lat):Math.abs(y.lat))*Math.PI/180,b=Math.abs(y.lat+a)*Math.PI/180,E=Vu(x+l*(b-x)),D=Vu(x),k=Vu(b);return new c.V(y.lng+t*((E-D)/(k-D)),f)}return new c.V(y.lng+t*l,f)}class Vp{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,a,l,f){const x=`${t.z}_${t.x}_${t.y}_${f?.terrain?"t":""}`,b=this._cache.get(x);if(b)return b;const E=this._cachePrevious.get(x);if(E)return this._cache.set(x,E),E;const D=this._boundingVolumeFactory(t,a,l,f);return this._cache.set(x,D),this._hadAnyChanges=!0,D}}class $l{constructor(t,a,l,f){this.min=l,this.max=f,this.points=t,this.planes=a}static fromAabb(t,a){const l=[];for(let f=0;f<8;f++)l.push([1&~f?t[0]:a[0],(f>>1&1)==1?a[1]:t[1],(f>>2&1)==1?a[2]:t[2]]);return new $l(l,[[-1,0,0,a[0]],[1,0,0,-t[0]],[0,-1,0,a[1]],[0,1,0,-t[1]],[0,0,-1,a[2]],[0,0,1,-t[2]]],t,a)}static fromCenterSizeAngles(t,a,l){const f=c.bB([],l[0],l[1],l[2]),x=c.bC([],[a[0],0,0],f),b=c.bC([],[0,a[1],0],f),E=c.bC([],[0,0,a[2]],f),D=[...t],k=[...t];for(let U=0;U<8;U++)for(let N=0;N<3;N++){const H=t[N]+x[N]*(1&~U?-1:1)+b[N]*((U>>1&1)==1?1:-1)+E[N]*((U>>2&1)==1?1:-1);D[N]=Math.min(D[N],H),k[N]=Math.max(k[N],H)}const j=[];for(let U=0;U<8;U++){const N=[...t];c.b0(N,N,c.a$([],x,1&~U?-1:1)),c.b0(N,N,c.a$([],b,(U>>1&1)==1?1:-1)),c.b0(N,N,c.a$([],E,(U>>2&1)==1?1:-1)),j.push(N)}return new $l(j,[[...x,-c.b5(x,j[0])],[...b,-c.b5(b,j[0])],[...E,-c.b5(E,j[0])],[-x[0],-x[1],-x[2],-c.b5(x,j[7])],[-b[0],-b[1],-b[2],-c.b5(b,j[7])],[-E[0],-E[1],-E[2],-c.b5(E,j[7])]],D,k)}intersectsFrustum(t){let a=!0;const l=this.points.length,f=this.planes.length,x=t.planes.length,b=t.points.length;for(let E=0;E<x;E++){const D=t.planes[E];let k=0;for(let j=0;j<l;j++){const U=this.points[j];D[0]*U[0]+D[1]*U[1]+D[2]*U[2]+D[3]>=0&&k++}if(k===0)return 0;k<l&&(a=!1)}if(a)return 2;for(let E=0;E<f;E++){const D=this.planes[E];let k=0;for(let j=0;j<b;j++){const U=t.points[j];D[0]*U[0]+D[1]*U[1]+D[2]*U[2]+D[3]>=0&&k++}if(k===0)return 0}return 1}intersectsPlane(t){const a=this.points.length;let l=0;for(let f=0;f<a;f++){const x=this.points[f];t[0]*x[0]+t[1]*x[1]+t[2]*x[2]+t[3]>=0&&l++}return l===a?2:l===0?0:1}}function Uu(y,t,a){const l=y-t;return l<0?-l:Math.max(0,l-a)}function Xl(y,t,a,l,f){const x=y-a;let b;return b=x<0?Math.min(-x,1+x-f):x>1?Math.min(Math.max(x-f,0),1-x):0,Math.max(b,Uu(t,l,f))}class Wh{constructor(){this._boundingVolumeCache=new Vp(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,a,l,f){const x=1<<l.z,b=1/x,E=l.x/x,D=l.y/x;let k=2;return k=Math.min(k,Xl(t,a,E,D,b)),k=Math.min(k,Xl(t,a,E+.5,-D-b,b)),k=Math.min(k,Xl(t,a,E+.5,2-D-b,b)),k}getWrap(t,a,l){const f=1<<a.z,x=1/f,b=a.x/f,E=Uu(t.x,b,x),D=Uu(t.x,b-1,x),k=Uu(t.x,b+1,x),j=Math.min(E,D,k);return j===k?1:j===D?-1:0}allowVariableZoom(t,a){return qi(t,a)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,a,l,f){return this._boundingVolumeCache.getTileBoundingVolume(t,a,l,f)}_computeTileBoundingVolume(t,a,l,f){var x,b;let E=0,D=0;if(f?.terrain){const k=new c.a2(t.z,a,t.z,t.x,t.y),j=f.terrain.getMinMaxElevation(k);E=(x=j.minElevation)!==null&&x!==void 0?x:Math.min(0,l),D=(b=j.maxElevation)!==null&&b!==void 0?b:Math.max(0,l)}if(E/=c.bE,D/=c.bE,E+=1,D+=1,t.z<=0)return $l.fromAabb([-D,-D,-D],[D,D,D]);if(t.z===1)return $l.fromAabb([t.x===0?-D:0,t.y===0?0:-D,-D],[t.x===0?0:D,t.y===0?D:0,D]);{const k=[gs(0,0,t.x,t.y,t.z),gs(c.a5,0,t.x,t.y,t.z),gs(c.a5,c.a5,t.x,t.y,t.z),gs(0,c.a5,t.x,t.y,t.z)],j=[];for(const Be of k)j.push(c.a$([],Be,D));if(D!==E)for(const Be of k)j.push(c.a$([],Be,E));t.y===0&&j.push([0,1,0]),t.y===(1<<t.z)-1&&j.push([0,-1,0]);const U=[1,1,1],N=[-1,-1,-1];for(const Be of j)for(let Oe=0;Oe<3;Oe++)U[Oe]=Math.min(U[Oe],Be[Oe]),N[Oe]=Math.max(N[Oe],Be[Oe]);const H=gs(c.a5/2,c.a5/2,t.x,t.y,t.z),Q=c.b4([],[0,1,0],H);c.b3(Q,Q);const ae=c.b4([],H,Q);c.b3(ae,ae);const oe=c.b4([],k[2],k[1]);c.b3(oe,oe);const se=c.b4([],k[0],k[3]);c.b3(se,se),j.push(c.a$([],H,D)),t.y>=(1<<t.z)/2&&j.push(c.a$([],gs(c.a5/2,0,t.x,t.y,t.z),D)),t.y<(1<<t.z)/2&&j.push(c.a$([],gs(c.a5/2,c.a5,t.x,t.y,t.z),D));const he=Zc(H,j),ye=Zc(ae,j),ce=[-H[0],-H[1],-H[2],he.max],ge=[H[0],H[1],H[2],-he.min],be=[-ae[0],-ae[1],-ae[2],ye.max],me=[ae[0],ae[1],ae[2],-ye.min],Me=[...oe,0],Fe=[...se,0],Le=[];return t.y===0?Le.push(c.bD(Fe,Me,ce),c.bD(Fe,Me,ge)):Le.push(c.bD(be,Me,ce),c.bD(be,Me,ge),c.bD(be,Fe,ce),c.bD(be,Fe,ge)),t.y===(1<<t.z)-1?Le.push(c.bD(Fe,Me,ce),c.bD(Fe,Me,ge)):Le.push(c.bD(me,Me,ce),c.bD(me,Me,ge),c.bD(me,Fe,ce),c.bD(me,Fe,ge)),new $l(Le,[ce,ge,be,me,Me,Fe],U,N)}}}function Zc(y,t){let a=1/0,l=-1/0;for(const f of t){const x=c.b5(y,f);a=Math.min(a,x),l=Math.max(l,x)}return{min:a,max:l}}class Yl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,l){return this._helper.interpolatePadding(t,a,l)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a){this._helper.resize(t,a)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(t){this._cachedClippingPlane=c.bF(),this._projectionMatrix=c.bj(),this._globeViewProjMatrix32f=c.bi(),this._globeViewProjMatrixNoCorrection=c.bj(),this._globeViewProjMatrixNoCorrectionInverted=c.bj(),this._globeProjMatrixInverted=c.bj(),this._cameraPosition=c.bA(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(a,l)=>{const f=c.an(a.lat,-c.ao,c.ao),x=c.an(+l,this.minZoom+mn(0,f),this.maxZoom);return{center:new c.V(a.lng,f),zoom:x}},this.applyConstrain=(a,l)=>this._helper.applyConstrain(a,l),this._helper=new yo({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,l)=>this.defaultConstrain(a,l)},t),this._coveringTilesDetailsProvider=new Wh}clone(){const t=new Yl;return t.apply(this,!1),t}apply(t,a,l){this._globeLatitudeErrorCorrectionRadians=l||0,this._helper.apply(t,a)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=c.bA();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:a,applyGlobeMatrix:l}=t,f=this._helper.getMercatorTileCoordinates(a);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:f,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const a=this.pitchInRadians,l=this.cameraToCenterDistance/t,f=Math.sin(a)*l,x=Math.cos(a)*l+1,b=1/Math.sqrt(f*f+x*x)*1;let E=-f,D=x;const k=Math.sqrt(E*E+D*D);E/=k,D/=k;const j=[0,E,D];c.bG(j,j,[0,0,0],-this.bearingInRadians),c.bH(j,j,[0,0,0],-1*this.center.lat*Math.PI/180),c.bI(j,j,[0,0,0],this.center.lng*Math.PI/180);const U=1/c.b7(j);return c.a$(j,j,U),[...j,-b*U]}isLocationOccluded(t){return!this.isSurfacePointVisible(en(t))}transformLightDirection(t){const a=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,f=Math.cos(l),x=[Math.sin(a)*f,Math.sin(l),Math.cos(a)*f],b=[x[2],0,-x[0]],E=[0,0,0];c.b4(E,b,x),c.b3(b,b),c.b3(E,E);const D=[0,0,0];return c.b3(D,[b[0]*t[0]+E[0]*t[1]+x[0]*t[2],b[1]*t[0]+E[1]*t[1]+x[1]*t[2],b[2]*t[0]+E[2]*t[1]+x[2]*t[2]]),D}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,a,l){const f=(function(E,D,k){const j=1/(1<<k.z);return new c.a9(E/c.a5*j+k.x*j,D/c.a5*j+k.y*j)})(t,a,l.canonical),x=(b=f.y,[c.bz(f.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-b*Math.PI*2))-.5*Math.PI]);var b;return this.getCircleRadiusCorrection()/Math.cos(x[1])}projectTileCoordinates(t,a,l,f){const x=l.canonical,b=gs(t,a,x.x,x.y,x.z),E=1+(f?f(t,a):0)/c.bE,D=[b[0]*E,b[1]*E,b[2]*E,1];c.aH(D,D,this._globeViewProjMatrixNoCorrection);const k=this._cachedClippingPlane,j=k[0]*b[0]+k[1]*b[1]+k[2]*b[2]+k[3]<0;return{point:new c.P(D[0]/D[3],D[1]/D[3]),signedDistanceFromCamera:D[3],isOccluded:j}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=il(this.worldSize,this.center.lat),a=c.bk(),l=c.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),c.be(a,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const f=this.centerOffset;a[8]=2*-f.x/this._helper._width,a[9]=2*f.y/this._helper._height,this._projectionMatrix=c.bf(a),this._globeProjMatrixInverted=c.bk(),c.aB(this._globeProjMatrixInverted,a),c.O(a,a,[0,0,-this.cameraToCenterDistance]),c.bg(a,a,this.rollInRadians),c.bh(a,a,-this.pitchInRadians),c.bg(a,a,this.bearingInRadians),c.O(a,a,[0,0,-t]);const x=c.bA();x[0]=t,x[1]=t,x[2]=t,c.bh(l,a,this.center.lat*Math.PI/180),c.bJ(l,l,-this.center.lng*Math.PI/180),c.Q(l,l,x),this._globeViewProjMatrixNoCorrection=l,c.bh(a,a,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bJ(a,a,-this.center.lng*Math.PI/180),c.Q(a,a,x),this._globeViewProjMatrix32f=new Float32Array(a),this._globeViewProjMatrixNoCorrectionInverted=c.bk(),c.aB(this._globeViewProjMatrixNoCorrectionInverted,l);const b=c.bA();this._cameraPosition=c.bA(),this._cameraPosition[2]=this.cameraToCenterDistance/t,c.bG(this._cameraPosition,this._cameraPosition,b,-this.rollInRadians),c.bH(this._cameraPosition,this._cameraPosition,b,this.pitchInRadians),c.bG(this._cameraPosition,this._cameraPosition,b,-this.bearingInRadians),c.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bH(this._cameraPosition,this._cameraPosition,b,-this.center.lat*Math.PI/180),c.bI(this._cameraPosition,this._cameraPosition,b,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const E=c.bf(this._globeViewProjMatrixNoCorrectionInverted);c.Q(E,E,[1,1,-1]),this._cachedFrustum=Dr.fromInvProjectionMatrix(E,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){c.w("calculateFogMatrix is not supported on globe projection.");const a=c.bk();return c.ar(a),a}getVisibleUnwrappedCoordinates(t){return[new c.bc(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,a){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=en(t);c.a$(l,l,1+a/c.bE);const f=c.bF();return c.aH(f,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),f[2]/f[3]}populateCache(t){}getBounds(){const t=.5*this.width,a=.5*this.height,l=[new c.P(0,0),new c.P(t,0),new c.P(this.width,0),new c.P(this.width,a),new c.P(this.width,this.height),new c.P(t,this.height),new c.P(0,this.height),new c.P(0,a)],f=[];for(const U of l)f.push(this.unprojectScreenPoint(U));let x=0,b=0,E=0,D=0;const k=this.center;for(const U of f){const N=c.bK(k.lng,U.lng),H=c.bK(k.lat,U.lat);N<b&&(b=N),N>x&&(x=N),H<D&&(D=H),H>E&&(E=H)}const j=[k.lng+b,k.lat+D,k.lng+x,k.lat+E];return this.isSurfacePointOnScreen([0,1,0])&&(j[3]=90,j[0]=-180,j[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(j[1]=-90,j[0]=-180,j[2]=180),new on(j)}calculateCenterFromCameraLngLatAlt(t,a,l,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,l,f)}setLocationAtPoint(t,a){const l=en(this.unprojectScreenPoint(a)),f=en(t),x=c.bA();c.bL(x);const b=c.bA();c.bI(b,l,x,-this.center.lng*Math.PI/180),c.bH(b,b,x,this.center.lat*Math.PI/180);const E=f[0]*f[0]+f[2]*f[2],D=b[0]*b[0];if(E<D)return;const k=Math.sqrt(E-D),j=-k,U=c.bM(f[0],f[2],b[0],k),N=c.bM(f[0],f[2],b[0],j),H=c.bA();c.bI(H,f,x,-U);const Q=c.bM(H[1],H[2],b[1],b[2]),ae=c.bA();c.bI(ae,f,x,-N);const oe=c.bM(ae[1],ae[2],b[1],b[2]),se=.5*Math.PI,he=Q>=-se&&Q<=se,ye=oe>=-se&&oe<=se;let ce,ge;if(he&&ye){const Fe=this.center.lng*Math.PI/180,Le=this.center.lat*Math.PI/180;c.bN(U,Fe)+c.bN(Q,Le)<c.bN(N,Fe)+c.bN(oe,Le)?(ce=U,ge=Q):(ce=N,ge=oe)}else if(he)ce=U,ge=Q;else{if(!ye)return;ce=N,ge=oe}const be=ce/Math.PI*180,me=ge/Math.PI*180,Me=this.center.lat;this.setCenter(new c.V(be,c.an(me,-90,90))),this.setZoom(this.zoom+mn(Me,this.center.lat))}locationToScreenPoint(t,a){const l=en(t);if(a){const f=a.getElevationForLngLatZoom(t,this._helper._tileZoom);c.a$(l,l,1+f/c.bE)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(t){const a=c.bF();return c.aH(a,[...t,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],new c.P((.5*a[0]+.5)*this.width,(.5*-a[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,a){if(a){const l=a.pointCoordinate(t);if(l)return l}return c.a9.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,a){var l;return(l=this.screenPointToMercatorCoordinate(t,a))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(t,a){const l=this._cameraPosition,f=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(l,f)}getRayDirectionFromPixel(t){const a=c.bF();a[0]=t.x/this.width*2-1,a[1]=-1*(t.y/this.height*2-1),a[2]=1,a[3]=1,c.aH(a,a,this._globeViewProjMatrixNoCorrectionInverted),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];const l=c.bA();l[0]=a[0]-this._cameraPosition[0],l[1]=a[1]-this._cameraPosition[1],l[2]=a[2]-this._cameraPosition[2];const f=c.bA();return c.b3(f,l),f}isSurfacePointVisible(t){const a=this._cachedClippingPlane;return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const a=c.bF();return c.aH(a,[...t,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],a[0]>-1&&a[0]<1&&a[1]>-1&&a[1]<1&&a[2]>-1&&a[2]<1}rayPlanetIntersection(t,a){const l=c.b5(t,a),f=c.bA(),x=c.bA();c.a$(x,a,l),c.b2(f,t,x);const b=1-c.b5(f,f);if(b<0)return null;const E=c.b5(t,t)-1,D=-l+(l<0?1:-1)*Math.sqrt(b),k=E/D,j=D;return{tMin:Math.min(k,j),tMax:Math.max(k,j)}}unprojectScreenPoint(t){const a=this._cameraPosition,l=this.getRayDirectionFromPixel(t),f=this.rayPlanetIntersection(a,l);if(f){const j=c.bA();c.b0(j,a,[l[0]*f.tMin,l[1]*f.tMin,l[2]*f.tMin]);const U=c.bA();return c.b3(U,j),Gc(U)}const x=this._cachedClippingPlane,b=x[0]*l[0]+x[1]*l[1]+x[2]*l[2],E=-c.bb(x,a)/b,D=c.bA();if(E>0)c.b0(D,a,[l[0]*E,l[1]*E,l[2]*E]);else{const j=c.bA();c.b0(j,a,[2*l[0],2*l[1],2*l[2]]);const U=c.bb(this._cachedClippingPlane,j);c.b2(D,j,[this._cachedClippingPlane[0]*U,this._cachedClippingPlane[1]*U,this._cachedClippingPlane[2]*U])}const k=(function(j){const U=c.bA();return U[0]=j[0]*-j[3],U[1]=j[1]*-j[3],U[2]=j[2]*-j[3],{center:U,radius:Math.sqrt(1-j[3]*j[3])}})(x);return Gc((function(j,U,N){const H=c.bA();c.b2(H,N,j);const Q=c.bA();return c.by(Q,j,H,U/c.b9(H)),Q})(k.center,k.radius,D))}getMatrixForModel(t,a){const l=c.V.convert(t),f=1/c.bE,x=c.bj();return c.bJ(x,x,l.lng/180*Math.PI),c.bh(x,x,-l.lat/180*Math.PI),c.O(x,x,[0,0,1+a/c.bE]),c.bh(x,x,.5*Math.PI),c.Q(x,x,[f,f,f]),x}getProjectionDataForCustomLayer(t=!0){const a=this.getProjectionData({overscaledTileID:new c.a2(0,0,0,0,0),applyGlobeMatrix:t});return a.tileMercatorCoords=[0,0,1,1],a}getFastPathSimpleProjectionMatrix(t){}}class Wl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,l){return this._helper.interpolatePadding(t,a,l)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a,l=!0){this._helper.resize(t,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,a){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=a,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(t){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(a,l)=>this.currentTransform.defaultConstrain(a,l),this.applyConstrain=(a,l)=>this._helper.applyConstrain(a,l),this._helper=new yo({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,l)=>this.defaultConstrain(a,l)},t),this._globeness=1,this._mercatorTransform=new Vn,this._verticalPerspectiveTransform=new Yl}clone(){const t=new Wl;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this,!1),t}apply(t,a){this._helper.apply(t,a),this._mercatorTransform.apply(this,!1),this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const a=this._mercatorTransform.getProjectionData(t),l=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:a.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:a.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return c.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,a,l){const f=this._mercatorTransform.getPitchedTextCorrection(t,a,l),x=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,a,l);return c.bu(f,x,this._globeness)}projectTileCoordinates(t,a,l,f){return this.currentTransform.projectTileCoordinates(t,a,l,f)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,a){return this.currentTransform.lngLatToCameraDepth(t,a)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(t,a,l,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,l,f)}setLocationAtPoint(t,a){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,a),void this.apply(this._mercatorTransform,!1);this._verticalPerspectiveTransform.setLocationAtPoint(t,a),this.apply(this._verticalPerspectiveTransform,!1)}locationToScreenPoint(t,a){return this.currentTransform.locationToScreenPoint(t,a)}screenPointToMercatorCoordinate(t,a){return this.currentTransform.screenPointToMercatorCoordinate(t,a)}screenPointToLocation(t,a){return this.currentTransform.screenPointToLocation(t,a)}isPointOnMapSurface(t,a){return this.currentTransform.isPointOnMapSurface(t,a)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,a){return this.currentTransform.getMatrixForModel(t,a)}getProjectionDataForCustomLayer(t=!0){const a=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return a;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return l.fallbackMatrix=a.mainMatrix,l}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class Sn{get useGlobeControls(){return!0}handlePanInertia(t,a){const l=ff(t,a);return Math.abs(l.lng-a.center.lng)>180&&(l.lng=a.center.lng+179.5*Math.sign(l.lng-a.center.lng)),{easingCenter:l,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,a){const l=t.around,f=a.screenPointToLocation(l);t.bearingDelta&&a.setBearing(a.bearing+t.bearingDelta),t.pitchDelta&&a.setPitch(a.pitch+t.pitchDelta),t.rollDelta&&a.setRoll(a.roll+t.rollDelta);const x=a.zoom;t.zoomDelta&&a.setZoom(a.zoom+t.zoomDelta);const b=a.zoom-x;if(b===0)return;const E=c.bK(a.center.lng,f.lng),D=E/(Math.abs(E/180)+1),k=c.bK(a.center.lat,f.lat),j=a.getRayDirectionFromPixel(l),U=a.cameraPosition,N=-1*c.b5(U,j),H=c.bA();c.b0(H,U,[j[0]*N,j[1]*N,j[2]*N]);const Q=c.b7(H)-1,ae=Math.exp(.5*-Math.max(Q-.3,0)),oe=il(a.worldSize,a.center.lat)/Math.min(a.width,a.height),se=c.bx(oe,.9,.5,1,.25),he=(1-c.aq(-b))*Math.min(ae,se),ye=a.center.lat,ce=a.zoom,ge=new c.V(a.center.lng+D*he,c.an(a.center.lat+k*he,-c.ao,c.ao));a.setLocationAtPoint(f,l);const be=a.center,me=c.bx(Math.abs(E),45,85,0,1),Me=c.bx(oe,.75,.35,0,1),Fe=Math.pow(Math.max(me,Me),.25),Le=c.bK(be.lng,ge.lng),Be=c.bK(be.lat,ge.lat);a.setCenter(new c.V(be.lng+Le*Fe,be.lat+Be*Fe).wrap()),a.setZoom(ce+mn(ye,a.center.lat))}handleMapControlsPan(t,a,l){if(!t.panDelta)return;const f=a.center.lat,x=a.zoom;a.setCenter(ff(t.panDelta,a).wrap()),a.setZoom(x+mn(f,a.center.lat))}cameraForBoxAndBearing(t,a,l,f,x){const b=Jo(t,a,l,f,x),E=a.left/x.width*2-1,D=(x.width-a.right)/x.width*2-1,k=a.top/x.height*-2+1,j=(x.height-a.bottom)/x.height*-2+1,U=c.bK(l.getWest(),l.getEast())<0,N=U?l.getEast():l.getWest(),H=U?l.getWest():l.getEast(),Q=Math.max(l.getNorth(),l.getSouth()),ae=Math.min(l.getNorth(),l.getSouth()),oe=N+.5*c.bK(N,H),se=Q+.5*c.bK(Q,ae),he=x.clone();he.setCenter(b.center),he.setBearing(b.bearing),he.setPitch(0),he.setRoll(0),he.setZoom(b.zoom);const ye=he.modelViewProjectionMatrix,ce=[en(l.getNorthWest()),en(l.getNorthEast()),en(l.getSouthWest()),en(l.getSouthEast()),en(new c.V(H,se)),en(new c.V(N,se)),en(new c.V(oe,Q)),en(new c.V(oe,ae))],ge=en(b.center);let be=Number.POSITIVE_INFINITY;for(const me of ce)E<0&&(be=Sn.getLesserNonNegativeNonNull(be,Sn.solveVectorScale(me,ge,ye,"x",E))),D>0&&(be=Sn.getLesserNonNegativeNonNull(be,Sn.solveVectorScale(me,ge,ye,"x",D))),k>0&&(be=Sn.getLesserNonNegativeNonNull(be,Sn.solveVectorScale(me,ge,ye,"y",k))),j<0&&(be=Sn.getLesserNonNegativeNonNull(be,Sn.solveVectorScale(me,ge,ye,"y",j)));if(Number.isFinite(be)&&be!==0)return b.zoom=he.zoom+c.at(be),b;zr()}handleJumpToCenterZoom(t,a){const l=t.center.lat,f=t.applyConstrain(a.center?c.V.convert(a.center):t.center,t.zoom).center;t.setCenter(f.wrap());const x=a.zoom!==void 0?+a.zoom:t.zoom+mn(l,f.lat);t.zoom!==x&&t.setZoom(x)}handleEaseTo(t,a){const l=t.zoom,f=t.center,x=t.padding,b={roll:t.roll,pitch:t.pitch,bearing:t.bearing},E={roll:a.roll===void 0?t.roll:a.roll,pitch:a.pitch===void 0?t.pitch:a.pitch,bearing:a.bearing===void 0?t.bearing:a.bearing},D=a.zoom!==void 0,k=!t.isPaddingEqual(a.padding);let j=!1;const U=a.center?c.V.convert(a.center):f,N=t.applyConstrain(U,l).center;ms(t,N);const H=t.clone();H.setCenter(N),H.setZoom(D?+a.zoom:l+mn(f.lat,U.lat)),H.setBearing(a.bearing);const Q=new c.P(c.an(t.centerPoint.x+a.offsetAsPoint.x,0,t.width),c.an(t.centerPoint.y+a.offsetAsPoint.y,0,t.height));H.setLocationAtPoint(N,Q);const ae=(a.offset&&a.offsetAsPoint.mag())>0?H.center:N,oe=D?+a.zoom:l+mn(f.lat,ae.lat),se=l+mn(f.lat,0),he=oe+mn(ae.lat,0),ye=c.bK(f.lng,ae.lng),ce=c.bK(f.lat,ae.lat),ge=c.aq(he-se);return j=oe!==l,{easeFunc:be=>{if(c.bo(b,E)||Nc({startEulerAngles:b,endEulerAngles:E,tr:t,k:be,useSlerp:b.roll!=E.roll}),k&&t.interpolatePadding(x,a.padding,be),a.around)c.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(a.around,a.aroundPoint);else{const me=he>se?Math.min(2,ge):Math.max(.5,ge),Me=Math.pow(me,1-be),Fe=pf(f,ye,ce,be*Me);t.setCenter(Fe.wrap())}if(j){const me=c.G.number(se,he,be)+mn(0,t.center.lat);t.setZoom(me)}},isZooming:j,elevationCenter:ae}}handleFlyTo(t,a){const l=a.zoom!==void 0,f=t.center,x=t.zoom,b=t.padding,E=!t.isPaddingEqual(a.padding),D=t.applyConstrain(c.V.convert(a.center||a.locationAtOffset),x).center,k=l?+a.zoom:t.zoom+mn(t.center.lat,D.lat),j=t.clone();j.setCenter(D),j.setZoom(k),j.setBearing(a.bearing);const U=new c.P(c.an(t.centerPoint.x+a.offsetAsPoint.x,0,t.width),c.an(t.centerPoint.y+a.offsetAsPoint.y,0,t.height));j.setLocationAtPoint(D,U);const N=j.center;ms(t,N);const H=(function(ce,ge,be){const me=en(ge),Me=en(be),Fe=c.b5(me,Me),Le=Math.acos(Fe),Be=Pr(ce);return Le/(2*Math.PI)*Be})(t,f,N),Q=x+mn(f.lat,0),ae=k+mn(N.lat,0),oe=c.aq(ae-Q);let se;if(typeof a.minZoom=="number"){const ce=+a.minZoom+mn(N.lat,0),ge=Math.min(ce,Q,ae)+mn(0,N.lat),be=t.applyConstrain(N,ge).zoom+mn(N.lat,0);se=c.aq(be-Q)}const he=c.bK(f.lng,N.lng),ye=c.bK(f.lat,N.lat);return{easeFunc:(ce,ge,be,me)=>{const Me=pf(f,he,ye,be);E&&t.interpolatePadding(b,a.padding,ce);const Fe=ce===1?N:Me;t.setCenter(Fe.wrap());const Le=Q+c.at(ge);t.setZoom(ce===1?k:Le+mn(0,Fe.lat))},scaleOfZoom:oe,targetCenter:N,scaleOfMinZoom:se,pixelPathLength:H}}static solveVectorScale(t,a,l,f,x){const b=f==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],E=[l[3],l[7],l[11],l[15]],D=t[0]*b[0]+t[1]*b[1]+t[2]*b[2],k=t[0]*E[0]+t[1]*E[1]+t[2]*E[2],j=a[0]*b[0]+a[1]*b[1]+a[2]*b[2],U=a[0]*E[0]+a[1]*E[1]+a[2]*E[2];return j+x*k===D+x*U||E[3]*(D-j)+b[3]*(U-k)+D*U==j*k?null:(j+b[3]-x*U-x*E[3])/(j-D-x*U+x*k)}static getLesserNonNegativeNonNull(t,a){return a!==null&&a>=0&&a<t?a:t}}class Kl{constructor(t){this._globe=t,this._mercatorCameraHelper=new el,this._verticalPerspectiveCameraHelper=new Sn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,a){return this.currentHelper.handlePanInertia(t,a)}handleMapControlsRollPitchBearingZoom(t,a){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,a)}handleMapControlsPan(t,a,l){this.currentHelper.handleMapControlsPan(t,a,l)}cameraForBoxAndBearing(t,a,l,f,x){return this.currentHelper.cameraForBoxAndBearing(t,a,l,f,x)}handleJumpToCenterZoom(t,a){this.currentHelper.handleJumpToCenterZoom(t,a)}handleEaseTo(t,a){return this.currentHelper.handleEaseTo(t,a)}handleFlyTo(t,a){return this.currentHelper.handleFlyTo(t,a)}}const Ql=(y,t)=>c.B(y,t&&t.filter((a=>a.identifier!=="source.canvas"))),Jl=c.bO();class bo extends c.E{constructor(t,a={}){var l,f;super(),this._rtlPluginLoaded=()=>{for(const b in this.tileManagers){const E=this.tileManagers[b].getSource().type;E!=="vector"&&E!=="geojson"||this.tileManagers[b].reload()}},this.map=t,this.dispatcher=new va(Xi(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((b,E)=>this.getGlyphs(b,E))),this.dispatcher.registerMessageHandler("GI",((b,E)=>this.getImages(b,E))),this.dispatcher.registerMessageHandler("GDA",((b,E)=>this.getDashes(b,E))),this.imageManager=new ki,this.imageManager.setEventedParent(this);const x=((l=t._container)===null||l===void 0?void 0:l.lang)||typeof document<"u"&&((f=document.documentElement)===null||f===void 0?void 0:f.lang)||void 0;this.glyphManager=new at(t._requestManager,a.localIdeographFontFamily,x),this.lineAtlas=new St(256,512),this.crossTileSymbolIndex=new Zn,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",c.bP()),J().on(Ce,this._rtlPluginLoaded),this.on("data",(b=>{if(b.dataType!=="source"||b.sourceDataType!=="metadata")return;const E=this.tileManagers[b.sourceId];if(!E)return;const D=E.getSource();if(D&&D.vectorLayerIds)for(const k in this._layers){const j=this._layers[k];j.source===D.id&&this._validateLayer(j)}}))}_setInitialValues(){var t;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new c.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((t=this.crossTileSymbolIndex)===null||t===void 0?void 0:t.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(t,a){var l,f,x;this._checkLoaded();const b=a===null?(x=(f=(l=this.stylesheet.state)===null||l===void 0?void 0:l[t])===null||f===void 0?void 0:f.default)!==null&&x!==void 0?x:null:a;if(c.bR(b,this._globalState[t]))return this;this._globalState[t]=b,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const a=[];for(const l in t)!c.bR(this._globalState[l],t[l].default)&&(a.push(l),this._globalState[l]=t[l].default);this._applyGlobalStateChanges(a)}_applyGlobalStateChanges(t){if(t.length===0)return;const a=new Set,l={};for(const f of t){l[f]=this._globalState[f];for(const x in this._layers){const b=this._layers[x],E=b.getLayoutAffectingGlobalStateRefs(),D=b.getPaintAffectingGlobalStateRefs(),k=b.getVisibilityAffectingGlobalStateRefs();if(E.has(f)&&a.add(b.source),D.has(f))for(const{name:j,value:U}of D.get(f))this._updatePaintProperty(b,j,U);k?.has(f)&&(b.recalculateVisibility(),this._updateLayer(b))}}this.dispatcher.broadcast("UGS",l);for(const f in this.tileManagers)a.has(f)&&(this._reloadSource(f),this._changed=!0)}loadURL(t,a={},l){this.fire(new c.l("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const f=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const x=this._loadStyleRequest;c.j(f,this._loadStyleRequest).then((b=>{this._loadStyleRequest=null,this._load(b.data,a,l)})).catch((b=>{this._loadStyleRequest=null,b&&!x.signal.aborted&&this.fire(new c.k(b))}))}loadJSON(t,a={},l){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,De.frameAsync(this._frameRequest,this.map._ownerWindow).then((()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(t,a,l)})).catch((()=>{}))}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(Jl,{validate:!1})}_load(t,a,l){var f,x;let b=a.transformStyle?a.transformStyle(l,t):t;if(!a.validate||!Ql(this,c.C(b))){b=Object.assign({},b),this._loaded=!0,this.stylesheet=b;for(const E in b.sources)this.addSource(E,b.sources[E],{validate:!1});b.sprite?this._loadSprite(b.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs),this._createLayers(),this.light=new ni(this.stylesheet.light),this._setProjectionInternal(((f=this.stylesheet.projection)===null||f===void 0?void 0:f.type)||"mercator"),this.sky=new ot(this.stylesheet.sky),this.map.setTerrain((x=this.stylesheet.terrain)!==null&&x!==void 0?x:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){var t,a,l;const f=c.bS(this.stylesheet.layers);this.setGlobalState((t=this.stylesheet.state)!==null&&t!==void 0?t:null),this.dispatcher.broadcast("SL",f),this._order=f.map((x=>x.id)),this._layers={},this._serializedLayers=null;for(const x of f){const b=c.bT(x,this._globalState);if(b.setEventedParent(this,{layer:{id:x.id}}),this._layers[x.id]=b,c.bU(b)&&this.tileManagers[b.source]){const E=(l=(a=x.paint)===null||a===void 0?void 0:a["raster-fade-duration"])!==null&&l!==void 0?l:b.paint.get("raster-fade-duration");this.tileManagers[b.source].setRasterFadeDuration(E)}}}_loadSprite(t,a=!1,l=void 0){this.imageManager.setLoaded(!1);const f=new AbortController;let x;this._spriteRequest=f,(function(b,E,D,k){return c._(this,void 0,void 0,(function*(){const j=Ot(b),U=D>1?"@2x":"",N={},H={};for(const{id:Q,url:ae}of j){const oe=E.transformRequest(si(ae,U,".json"),"SpriteJSON");N[Q]=c.j(oe,k);const se=E.transformRequest(si(ae,U,".png"),"SpriteImage");H[Q]=_t.getImage(se,k)}return yield Promise.all([...Object.values(N),...Object.values(H)]),(function(Q,ae){return c._(this,void 0,void 0,(function*(){const oe={};for(const se in Q){oe[se]={};const he=De.getImageCanvasContext((yield ae[se]).data),ye=(yield Q[se]).data;for(const ce in ye){const{width:ge,height:be,x:me,y:Me,sdf:Fe,pixelRatio:Le,stretchX:Be,stretchY:Oe,content:dt,textFitWidth:ft,textFitHeight:rt}=ye[ce];oe[se][ce]={data:null,pixelRatio:Le,sdf:Fe,stretchX:Be,stretchY:Oe,content:dt,textFitWidth:ft,textFitHeight:rt,spriteData:{width:ge,height:be,x:me,y:Me,context:he}}}}return oe}))})(N,H)}))})(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((b=>{if(this._spriteRequest=null,b)for(const E in b){this._spritesImagesIds[E]=[];const D=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter((k=>!(k in b))):[];for(const k of D)this.imageManager.removeImage(k),this._changedImages[k]=!0;for(const k in b[E]){const j=E==="default"?k:`${E}:${k}`;this._spritesImagesIds[E].push(j),j in this.imageManager.images?this.imageManager.updateImage(j,b[E][k],!1):this.imageManager.addImage(j,b[E][k]),a&&(this._changedImages[j]=!0)}}})).catch((b=>{this._spriteRequest=null,x=b,f.signal.aborted||this.fire(new c.k(x))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),l&&l(x)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(t){const a=this.tileManagers[t.source];if(!a)return;const l=t.sourceLayer;if(!l)return;const f=a.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(l)===-1)&&this.fire(new c.k(new Error(`Source layer "${l}" does not exist on source "${f.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.tileManagers)if(!this.tileManagers[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,a=!1){const l=this._serializedAllLayers();if(!t||t.length===0)return Object.values(a?c.bV(l):l);const f=[];for(const x of t)if(l[x]){const b=a?c.bV(l[x]):l[x];f.push(b)}return f}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const a=Object.keys(this._layers);for(const l of a){const f=this._layers[l];f.type!=="custom"&&(t[l]=f.serialize())}return t}hasTransitions(){var t,a,l;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((a=this.sky)===null||a===void 0)&&a.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const f in this.tileManagers)if(this.tileManagers[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const a=this._changed;if(a){const f=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(f.length||x.length)&&this._updateWorkerLayers(f,x);for(const b in this._updatedSources){const E=this._updatedSources[b];if(E==="reload")this._reloadSource(b);else{if(E!=="clear")throw new Error(`Invalid action ${E}`);this._clearSource(b)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const l={};for(const f in this.tileManagers){const x=this.tileManagers[f];l[f]=x.used,x.used=!1}for(const f of this._order){const x=this._layers[f];x.recalculate(t,this._availableImages),!x.isHidden(t.zoom)&&x.source&&(this.tileManagers[x.source].used=!0)}for(const f in l){const x=this.tileManagers[f];!!l[f]!=!!x.used&&x.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,a&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const a in this.tileManagers)this.tileManagers[a].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.tileManagers)this.tileManagers[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,a={}){var l;this._checkLoaded();const f=this.serialize();if(t=a.transformStyle?a.transformStyle(f,t):t,((l=a.validate)===null||l===void 0||l)&&Ql(this,c.C(t)))return!1;(t=c.bV(t)).layers=c.bS(t.layers);const x=c.bW(f,t),b=this._getOperationsToPerform(x);if(b.unimplemented.length>0)throw new Error(`Unimplemented: ${b.unimplemented.join(", ")}.`);if(b.operations.length===0)return!1;for(const E of b.operations)E();return this.stylesheet=t,this._serializedLayers=null,this.fire(new c.l("style.load",{style:this})),!0}_getOperationsToPerform(t){const a=[],l=[];for(const f of t)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":a.push((()=>this.addLayer.apply(this,f.args)));break;case"removeLayer":a.push((()=>this.removeLayer.apply(this,f.args)));break;case"setPaintProperty":a.push((()=>this.setPaintProperty.apply(this,f.args)));break;case"setLayoutProperty":a.push((()=>this.setLayoutProperty.apply(this,f.args)));break;case"setFilter":a.push((()=>this.setFilter.apply(this,f.args)));break;case"addSource":a.push((()=>this.addSource.apply(this,f.args)));break;case"removeSource":a.push((()=>this.removeSource.apply(this,f.args)));break;case"setLayerZoomRange":a.push((()=>this.setLayerZoomRange.apply(this,f.args)));break;case"setLight":a.push((()=>this.setLight.apply(this,f.args)));break;case"setGeoJSONSourceData":a.push((()=>this.setGeoJSONSourceData.apply(this,f.args)));break;case"setGlyphs":a.push((()=>this.setGlyphs.apply(this,f.args)));break;case"setSprite":a.push((()=>this.setSprite.apply(this,f.args)));break;case"setTerrain":a.push((()=>this.map.setTerrain.apply(this,f.args)));break;case"setSky":a.push((()=>this.setSky.apply(this,f.args)));break;case"setProjection":this.setProjection.apply(this,f.args);break;case"setGlobalState":a.push((()=>this.setGlobalState.apply(this,f.args)));break;case"setTransition":a.push((()=>{}));break;default:l.push(f.command)}return{operations:a,unimplemented:l}}addImage(t,a){if(this.getImage(t))return this.fire(new c.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,a),this._afterImageUpdated(t)}updateImage(t,a){this.imageManager.updateImage(t,a)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new c.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,a,l={}){if(this._checkLoaded(),this.tileManagers[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.C.source,`sources.${t}`,a,null,l))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const f=this.tileManagers[t]=new ci(t,a,this.dispatcher);f.style=this,f.setEventedParent(this,(()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:t}))),f.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===t)return this.fire(new c.k(new Error(`Source "${t}" cannot be removed while layer "${l}" is using it.`)));const a=this.tileManagers[t];delete this.tileManagers[t],delete this._updatedSources[t],a.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,a){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const l=this.tileManagers[t].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(a),this._changed=!0}getSource(t){return this.tileManagers[t]&&this.tileManagers[t].getSource()}addLayer(t,a,l={}){this._checkLoaded();const f=t.id;if(this.getLayer(f))return void this.fire(new c.k(new Error(`Layer "${f}" already exists on this map.`)));let x;if(t.type==="custom"){if(Ql(this,c.bX(t)))return;x=c.bT(t,this._globalState)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(f,t.source),t=c.bV(t),t=c.e(t,{source:f})),this._validate(c.C.layer,`layers.${f}`,t,{arrayIndex:-1},l))return;x=c.bT(t,this._globalState),this._validateLayer(x),x.setEventedParent(this,{layer:{id:f}})}const b=a?this._order.indexOf(a):this._order.length;if(a&&b===-1)this.fire(new c.k(new Error(`Cannot add layer "${f}" before non-existing layer "${a}".`)));else{if(this._order.splice(b,0,f),this._layerOrderChanged=!0,this._layers[f]=x,this._removedLayers[f]&&x.source&&x.type!=="custom"){const E=this._removedLayers[f];delete this._removedLayers[f],E.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.tileManagers[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(t,a){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new c.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===a)return;const l=this._order.indexOf(t);this._order.splice(l,1);const f=a?this._order.indexOf(a):this._order.length;a&&f===-1?this.fire(new c.k(new Error(`Cannot move layer "${t}" before non-existing layer "${a}".`))):(this._order.splice(f,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const a=this._layers[t];if(!a)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${t}".`)));a.setEventedParent(null);const l=this._order.indexOf(t);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=a,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],a.onRemove&&a.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,a,l){this._checkLoaded();const f=this.getLayer(t);f?f.minzoom===a&&f.maxzoom===l||(a!=null&&(f.minzoom=a),l!=null&&(f.maxzoom=l),this._updateLayer(f)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,a,l={}){this._checkLoaded();const f=this.getLayer(t);if(f){if(!c.bR(f.filter,a))return a==null?(f.setFilter(void 0),void this._updateLayer(f)):void(this._validate(c.C.filter,`layers.${f.id}.filter`,a,null,l)||(f.setFilter(c.bV(a)),this._updateLayer(f)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return c.bV(this.getLayer(t).filter)}setLayoutProperty(t,a,l,f={}){this._checkLoaded();const x=this.getLayer(t);x?c.bR(x.getLayoutProperty(a),l)||(x.setLayoutProperty(a,l,f),this._updateLayer(x)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,a){const l=this.getLayer(t);if(l)return l.getLayoutProperty(a);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,a,l,f={}){this._checkLoaded();const x=this.getLayer(t);x?c.bR(x.getPaintProperty(a),l)||this._updatePaintProperty(x,a,l,f):this.fire(new c.k(new Error(`Cannot style non-existing layer "${t}".`)))}_updatePaintProperty(t,a,l,f={}){t.setPaintProperty(a,l,f)&&this._updateLayer(t),c.bU(t)&&a==="raster-fade-duration"&&this.tileManagers[t.source].setRasterFadeDuration(l),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,a){return this.getLayer(t).getPaintProperty(a)}setFeatureState(t,a){this._checkLoaded();const l=t.source,f=t.sourceLayer,x=this.tileManagers[l];if(x===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const b=x.getSource().type;b==="geojson"&&f?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):b!=="vector"||f?(t.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),x.setFeatureState(f,t.id,a)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,a){this._checkLoaded();const l=t.source,f=this.tileManagers[l];if(f===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const x=f.getSource().type,b=x==="vector"?t.sourceLayer:void 0;x!=="vector"||b?a&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(b,t.id,a):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const a=t.source,l=t.sourceLayer,f=this.tileManagers[a];if(f!==void 0)return f.getSource().type!=="vector"||l?(t.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),f.getFeatureState(l,t.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=c.bY(this.tileManagers,(x=>x.serialize())),a=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,f=this.stylesheet;return c.bZ({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,projection:f.projection,sources:t,layers:a,terrain:l},(x=>x!==void 0))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.tileManagers[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.tileManagers[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const a=b=>this._layers[b].type==="fill-extrusion",l={},f=[];for(let b=this._order.length-1;b>=0;b--){const E=this._order[b];if(a(E)){l[E]=b;for(const D of t){const k=D[E];if(k)for(const j of k)f.push(j)}}}f.sort(((b,E)=>E.intersectionZ-b.intersectionZ));const x=[];for(let b=this._order.length-1;b>=0;b--){const E=this._order[b];if(a(E))for(let D=f.length-1;D>=0;D--){const k=f[D].feature;if(l[k.layer.id]<b)break;x.push(k),f.pop()}else for(const D of t){const k=D[E];if(k)for(const j of k)x.push(j.feature)}}return x}queryRenderedFeatures(t,a,l){a&&a.filter&&this._validate(c.C.filter,"queryRenderedFeatures.filter",a.filter,null,a);const f={};if(a&&a.layers){if(!(Array.isArray(a.layers)||a.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const k of a.layers){const j=this._layers[k];if(!j)return this.fire(new c.k(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];f[j.source]=!0}}const x=[];a.availableImages=this._availableImages;const b=this._serializedAllLayers(),E=a.layers instanceof Set?a.layers:Array.isArray(a.layers)?new Set(a.layers):null,D=Object.assign(Object.assign({},a),{layers:E,globalState:this._globalState});for(const k in this.tileManagers)a.layers&&!f[k]||x.push(kc(this.tileManagers[k],this._layers,b,t,D,l,this.map.terrain?(j,U,N)=>this.map.terrain.getElevation(j,U,N):void 0));return this.placement&&x.push((function(k,j,U,N,H,Q,ae){const oe={},se=Q.queryRenderedSymbols(N),he=[];for(const ye of Object.keys(se).map(Number))he.push(ae[ye]);he.sort(sn);for(const ye of he){const ce=ye.featureIndex.lookupSymbolFeatures(se[ye.bucketInstanceId],j,ye.bucketIndex,ye.sourceLayerIndex,{filterSpec:H.filter,globalState:H.globalState},H.layers,H.availableImages,k);for(const ge in ce){const be=oe[ge]=oe[ge]||[],me=ce[ge];me.sort(((Me,Fe)=>{const Le=ye.featureSortOrder;if(Le){const Be=Le.indexOf(Me.featureIndex);return Le.indexOf(Fe.featureIndex)-Be}return Fe.featureIndex-Me.featureIndex}));for(const Me of me)be.push(Me)}}return(function(ye,ce,ge){for(const be in ye)for(const me of ye[be])jr(me,ge[ce[be].source]);return ye})(oe,k,U)})(this._layers,b,this.tileManagers,t,D,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(t,a){a?.filter&&this._validate(c.C.filter,"querySourceFeatures.filter",a.filter,null,a);const l=this.tileManagers[t];return l?(function(f,x){const b=f.getRenderableIds().map((k=>f.getTileByID(k))),E=[],D={};for(let k=0;k<b.length;k++){const j=b[k],U=j.tileID.canonical.key;D[U]||(D[U]=!0,j.querySourceFeatures(E,x))}return E})(l,a?Object.assign(Object.assign({},a),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t,a={}){this._checkLoaded();const l=this.light.getLight();let f=!1;for(const b in t)if(!c.bR(t[b],l[b])){f=!0;break}if(!f)return;const x={now:xe(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,a),this.light.updateTransitions(x)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,a={}){this._checkLoaded();const l=this.getSky();let f=!1;if(!t&&!l)return;if(t&&!l)f=!0;else if(!t&&l)f=!0;else for(const b in t)if(!c.bR(t[b],l[b])){f=!0;break}if(!f)return;const x={now:xe(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,a),this.sky.updateTransitions(x)}_setProjectionInternal(t){const a=(function(l,f){const x={constrainOverride:f};if(Array.isArray(l)){const b=new Yh({type:l});return{projection:b,transform:new Wl(x),cameraHelper:new Kl(b)}}switch(l){case"mercator":return{projection:new Hn,transform:new Vn(x),cameraHelper:new el};case"globe":{const b=new Yh({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:b,transform:new Wl(x),cameraHelper:new Kl(b)}}case"vertical-perspective":return{projection:new Xh,transform:new Yl(x),cameraHelper:new Sn};default:return c.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new Hn,transform:new Vn(x),cameraHelper:new el}}})(t,this.map.transformConstrain);this.projection=a.projection,this.map.migrateProjection(a.transform,a.cameraHelper);for(const l in this.tileManagers)this.tileManagers[l].reload()}_validate(t,a,l,f,x={}){return(!x||x.validate!==!1)&&Ql(this,t.call(c.C,c.e({key:a,style:this.serialize(),value:l,styleSpec:c.u},f)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),J().off(Ce,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.tileManagers){const l=this.tileManagers[a];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.tileManagers[t].clearTiles()}_reloadSource(t){this.tileManagers[t].resume(),this.tileManagers[t].reload()}_updateSources(t){for(const a in this.tileManagers)this.tileManagers[a].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.tileManagers)this._reloadSource(t)}_updatePlacement(t,a,l,f,x=!1){let b=!1,E=!1;const D={};for(const k of this._order){const j=this._layers[k];if(j.type!=="symbol")continue;if(!D[j.source]){const N=this.tileManagers[j.source];D[j.source]=N.getRenderableIds(!0).map((H=>N.getTileByID(H))).sort(((H,Q)=>Q.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(Q.tileID)?-1:1)))}const U=this.crossTileSymbolIndex.addLayer(j,D[j.source],t.center.lng);b=b||U}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(xe(),t.zoom))&&(this.pauseablePlacement=new Hl(t,this.map.terrain,this._order,x,a,l,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,D),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(xe()),E=!0),b&&this.pauseablePlacement.placement.setStale()),E||b)for(const k of this._order){const j=this._layers[k];j.type==="symbol"&&this.placement.updateLayerOpacities(j,D[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(xe())}_releaseSymbolFadeTiles(){for(const t in this.tileManagers)this.tileManagers[t].releaseSymbolFadeTiles()}getImages(t,a){return c._(this,void 0,void 0,(function*(){const l=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const f=this.tileManagers[a.source];return f&&f.setDependencies(a.tileID.key,a.type,a.icons),l}))}getGlyphs(t,a){return c._(this,void 0,void 0,(function*(){const l=yield this.glyphManager.getGlyphs(a.stacks),f=this.tileManagers[a.source];return f&&f.setDependencies(a.tileID.key,a.type,[""]),l}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,a={}){this._checkLoaded(),t&&this._validate(c.C.glyphs,"glyphs",t,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}getDashes(t,a){return c._(this,void 0,void 0,(function*(){const l={};for(const[f,x]of Object.entries(a.dashes))l[f]=this.lineAtlas.getDash(x.dasharray,x.round);return l}))}addSprite(t,a,l={},f){this._checkLoaded();const x=[{id:t,url:a}],b=[...Ot(this.stylesheet.sprite),...x];this._validate(c.C.sprite,"sprite",b,null,l)||(this.stylesheet.sprite=b,this._loadSprite(x,!0,f))}removeSprite(t){this._checkLoaded();const a=Ot(this.stylesheet.sprite);if(a.find((l=>l.id===t))){if(this._spritesImagesIds[t])for(const l of this._spritesImagesIds[t])this.imageManager.removeImage(l),this._changedImages[l]=!0;a.splice(a.findIndex((l=>l.id===t)),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Ot(this.stylesheet.sprite)}setSprite(t,a={},l){this._checkLoaded(),t&&this._validate(c.C.sprite,"sprite",t,null,a)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,l):(this._unloadSprite(),l&&l(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const t in this.tileManagers){const a=this.tileManagers[t];a.setEventedParent(null),a.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const t in this._layers){const a=this._layers[t];a.setEventedParent(null),a.onRemove&&a.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var mf=c.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Hc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,a,l,f,x,b,E,D,k){this.context=t;let j=this.boundPaintVertexBuffers.length!==f.length;for(let U=0;!j&&U<f.length;U++)this.boundPaintVertexBuffers[U]!==f[U]&&(j=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==l||j||this.boundIndexBuffer!==x||this.boundVertexOffset!==b||this.boundDynamicVertexBuffer!==E||this.boundDynamicVertexBuffer2!==D||this.boundDynamicVertexBuffer3!==k?this.freshBind(a,l,f,x,b,E,D,k):(t.bindVertexArray.set(this.vao),E&&E.bind(),x&&x.dynamicDraw&&x.bind(),D&&D.bind(),k&&k.bind())}freshBind(t,a,l,f,x,b,E,D){const k=t.numAttributes,j=this.context,U=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=f,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=E,this.boundDynamicVertexBuffer3=D,a.enableAttributes(U,t);for(const N of l)N.enableAttributes(U,t);b&&b.enableAttributes(U,t),E&&E.enableAttributes(U,t),D&&D.enableAttributes(U,t),a.bind(),a.setVertexAttribPointers(U,t,x);for(const N of l)N.bind(),N.setVertexAttribPointers(U,t,x);b&&(b.bind(),b.setVertexAttribPointers(U,t,x)),f&&f.bind(),E&&(E.bind(),E.setVertexAttribPointers(U,t,x)),D&&(D.bind(),D.setVertexAttribPointers(U,t,x)),j.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const gf=(y,t,a,l,f)=>({u_texture:0,u_ele_delta:y,u_fog_matrix:t,u_fog_color:a?a.properties.get("fog-color"):c.bp.white,u_fog_ground_blend:a?a.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:f?0:a?a.calculateFogBlendOpacity(l):0,u_horizon_color:a?a.properties.get("horizon-color"):c.bp.white,u_horizon_fog_blend:a?a.properties.get("horizon-fog-blend"):1,u_is_globe_mode:f?1:0}),Ha={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Gu(y){const t=[];for(let a=0;a<y.length;a++){if(y[a]===null)continue;const l=y[a].split(" ");t.push(l.pop())}return t}class yf{constructor(t,a,l,f,x,b,E,D,k=[]){const j=t.gl;this.program=j.createProgram();const U=Gu(a.staticAttributes),N=l?l.getBinderAttributes():[],H=U.concat(N),Q=Qi.prelude.staticUniforms?Gu(Qi.prelude.staticUniforms):[],ae=E.staticUniforms?Gu(E.staticUniforms):[],oe=a.staticUniforms?Gu(a.staticUniforms):[],se=l?l.getBinderUniforms():[],he=Q.concat(ae).concat(oe).concat(se),ye=[];for(const Le of he)ye.indexOf(Le)<0&&ye.push(Le);const ce=l?l.defines():[];Sa(j)&&ce.unshift("#version 300 es"),x&&ce.push("#define OVERDRAW_INSPECTOR;"),b&&ce.push("#define TERRAIN3D;"),D&&ce.push(D),k&&ce.push(...k);let ge=ce.concat(Qi.prelude.fragmentSource,E.fragmentSource,a.fragmentSource).join(`
`),be=ce.concat(Qi.prelude.vertexSource,E.vertexSource,a.vertexSource).join(`
`);Sa(j)||(ge=(function(Le){return Le.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(ge),be=(function(Le){return Le.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(be));const me=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(me,ge),j.compileShader(me),!j.getShaderParameter(me,j.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${j.getShaderInfoLog(me)}`);j.attachShader(this.program,me);const Me=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(Me,be),j.compileShader(Me),!j.getShaderParameter(Me,j.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${j.getShaderInfoLog(Me)}`);j.attachShader(this.program,Me),this.attributes={};const Fe={};this.numAttributes=H.length;for(let Le=0;Le<this.numAttributes;Le++)H[Le]&&(j.bindAttribLocation(this.program,Le,H[Le]),this.attributes[H[Le]]=Le);if(j.linkProgram(this.program),!j.getProgramParameter(this.program,j.LINK_STATUS))throw new Error(`Program failed to link: ${j.getProgramInfoLog(this.program)}`);j.deleteShader(Me),j.deleteShader(me);for(let Le=0;Le<ye.length;Le++){const Be=ye[Le];if(Be&&!Fe[Be]){const Oe=j.getUniformLocation(this.program,Be);Oe&&(Fe[Be]=Oe)}}this.fixedUniforms=f(t,Fe),this.terrainUniforms=((Le,Be)=>({u_depth:new c.b_(Le,Be.u_depth),u_terrain:new c.b_(Le,Be.u_terrain),u_terrain_dim:new c.bq(Le,Be.u_terrain_dim),u_terrain_matrix:new c.c0(Le,Be.u_terrain_matrix),u_terrain_unpack:new c.c1(Le,Be.u_terrain_unpack),u_terrain_exaggeration:new c.bq(Le,Be.u_terrain_exaggeration)}))(t,Fe),this.projectionUniforms=((Le,Be)=>({u_projection_matrix:new c.c0(Le,Be.u_projection_matrix),u_projection_tile_mercator_coords:new c.c1(Le,Be.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.c1(Le,Be.u_projection_clipping_plane),u_projection_transition:new c.bq(Le,Be.u_projection_transition),u_projection_fallback_matrix:new c.c0(Le,Be.u_projection_fallback_matrix)}))(t,Fe),this.binderUniforms=l?l.getUniforms(t,Fe):[]}draw(t,a,l,f,x,b,E,D,k,j,U,N,H,Q,ae,oe,se,he,ye){const ce=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(l),t.setStencilMode(f),t.setColorMode(x),t.setCullFace(b),D){t.activeTexture.set(ce.TEXTURE2),ce.bindTexture(ce.TEXTURE_2D,D.depthTexture),t.activeTexture.set(ce.TEXTURE3),ce.bindTexture(ce.TEXTURE_2D,D.texture);for(const be in this.terrainUniforms)this.terrainUniforms[be].set(D[be])}if(k)for(const be in k)this.projectionUniforms[Ha[be]].set(k[be]);if(E)for(const be in this.fixedUniforms)this.fixedUniforms[be].set(E[be]);oe&&oe.setUniforms(t,this.binderUniforms,Q,{zoom:ae});let ge=0;switch(a){case ce.LINES:ge=2;break;case ce.TRIANGLES:ge=3;break;case ce.LINE_STRIP:ge=1}for(const be of H.get()){const me=be.vaos||(be.vaos={});(me[j]||(me[j]=new Hc)).bind(t,this,U,oe?oe.getPaintVertexBuffers():[],N,be.vertexOffset,se,he,ye),ce.drawElements(a,be.primitiveLength*ge,ce.UNSIGNED_SHORT,be.primitiveOffset*ge*2)}}}function _f(y,t,a){const l=1/c.aN(a,1,t.transform.tileZoom),f=Math.pow(2,a.tileID.overscaledZ),x=a.tileSize*Math.pow(2,t.transform.tileZoom)/f,b=x*(a.tileID.canonical.x+a.tileID.wrap*f),E=x*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[l,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[b>>16,E>>16],u_pixel_coord_lower:[65535&b,65535&E]}}const qu=(y,t,a,l)=>{const f=y.style.light,x=f.properties.get("position"),b=[x.x,x.y,x.z],E=c.c4();f.properties.get("anchor")==="viewport"&&c.c5(E,y.transform.bearingInRadians),c.c6(b,b,E);const D=y.transform.transformLightDirection(b),k=f.properties.get("color");return{u_lightpos:b,u_lightpos_globe:D,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+t,u_opacity:a,u_fill_translate:l}},Zu=(y,t,a,l,f,x,b)=>c.e(qu(y,t,a,l),_f(x,y,b),{u_height_factor:-Math.pow(2,f.overscaledZ)/b.tileSize/8}),nl=(y,t,a,l)=>c.e(_f(t,y,a),{u_fill_translate:l}),ec=(y,t)=>({u_world:y,u_fill_translate:t}),xf=(y,t,a,l,f)=>c.e(nl(y,t,a,f),{u_world:l}),$c=(y,t,a,l,f)=>{const x=y.transform;let b,E,D=0;if(a.paint.get("circle-pitch-alignment")==="map"){const k=c.aN(t,1,x.zoom);b=!0,E=[k,k],D=k/(c.a5*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*f}else b=!1,E=x.pixelsToGLUnits;return{u_camera_to_center_distance:x.cameraToCenterDistance,u_scale_with_map:+(a.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+b,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:E,u_globe_extrude_scale:D,u_translate:l}},wo=y=>({u_pixel_extrude_scale:[1/y.width,1/y.height]}),Kh=y=>({u_viewport_size:[y.width,y.height]}),Xc=(y,t=1)=>({u_color:y,u_overlay:0,u_overlay_scale:t}),To=(y,t,a,l)=>{const f=c.aN(y,1,t)/(c.a5*Math.pow(2,y.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:c.aN(y,1,t),u_intensity:a,u_globe_extrude_scale:f}},Qh=(y,t,a,l)=>{const f=c.N();c.c7(f,0,y.width,y.height,0,0,1);const x=y.context.gl;return{u_matrix:f,u_world:[x.drawingBufferWidth,x.drawingBufferHeight],u_image:a,u_color_ramp:l,u_opacity:t.paint.get("heatmap-opacity")}},Yc=(y,t,a)=>{const l=a.paint.get("hillshade-accent-color");let f;switch(a.paint.get("hillshade-method")){case"basic":f=4;break;case"combined":f=1;break;case"igor":f=2;break;case"multidirectional":f=3;break;default:f=0}const x=a.getIlluminationProperties();for(let b=0;b<x.directionRadians.length;b++)a.paint.get("hillshade-illumination-anchor")==="viewport"&&(x.directionRadians[b]+=y.transform.bearingInRadians);return{u_image:0,u_latrange:Up(0,t.tileID),u_exaggeration:a.paint.get("hillshade-exaggeration"),u_altitudes:x.altitudeRadians,u_azimuths:x.directionRadians,u_accent:l,u_method:f,u_highlights:x.highlightColor,u_shadows:x.shadowColor}},vf=(y,t)=>{const a=t.stride,l=c.N();return c.c7(l,0,c.a5,-c.a5,0,0,1),c.O(l,l,[0,-c.a5,0]),{u_matrix:l,u_image:1,u_dimension:[a,a],u_zoom:y.overscaledZ,u_unpack:t.getUnpackVector()}};function Up(y,t){const a=Math.pow(2,t.canonical.z),l=t.canonical.y;return[new c.a9(0,l/a).toLngLat().lat,new c.a9(0,(l+1)/a).toLngLat().lat]}const bf=(y,t,a=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:a,u_opacity:y.paint.get("color-relief-opacity")}),Wc=(y,t,a,l)=>{const f=y.transform;return{u_translation:Kc(y,t,a),u_ratio:l/c.aN(t,1,f.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},wf=(y,t,a,l,f)=>c.e(Wc(y,t,a,l),{u_image:0,u_image_height:f}),Jh=(y,t,a,l,f)=>{const x=y.transform,b=Ma(t,x);return{u_translation:Kc(y,t,a),u_texsize:t.imageAtlasTexture.size,u_ratio:l/c.aN(t,1,x.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[b,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Or=(y,t,a,l,f)=>{const x=Ma(t,y.transform);return c.e(Wc(y,t,a,l),{u_tileratio:x,u_crossfade_from:f.fromScale,u_crossfade_to:f.toScale,u_image:0,u_mix:f.t,u_lineatlas_width:y.lineAtlas.width,u_lineatlas_height:y.lineAtlas.height})},So=(y,t,a,l,f,x)=>{const b=Ma(t,y.transform);return c.e(Wc(y,t,a,l),{u_image:0,u_image_height:x,u_tileratio:b,u_crossfade_from:f.fromScale,u_crossfade_to:f.toScale,u_image_dash:1,u_mix:f.t,u_lineatlas_width:y.lineAtlas.width,u_lineatlas_height:y.lineAtlas.height})};function Ma(y,t){return 1/c.aN(y,1,t.tileZoom)}function Kc(y,t,a){return c.aO(y.transform,t,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Hu=(y,t,a,l,f)=>{return{u_tl_parent:y,u_scale_parent:t,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(b=l.paint.get("raster-saturation"),b>0?1-1/(1.001-b):-b),u_contrast_factor:(x=l.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:$u(l.paint.get("raster-hue-rotate")),u_coords_top:[f[0].x,f[0].y,f[1].x,f[1].y],u_coords_bottom:[f[3].x,f[3].y,f[2].x,f[2].y]};var x,b};function $u(y){y*=Math.PI/180;const t=Math.sin(y),a=Math.cos(y);return[(2*a+1)/3,(-Math.sqrt(3)*t-a+1)/3,(Math.sqrt(3)*t-a+1)/3]}const Qc=(y,t,a,l,f,x,b,E,D,k,j,U,N)=>{const H=b.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:H.cameraToCenterDistance,u_pitch:H.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:H.width/H.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_label_plane_matrix:E,u_coord_matrix:D,u_is_text:+j,u_pitch_with_map:+l,u_is_along_line:f,u_is_variable_anchor:x,u_texsize:U,u_texture:0,u_translation:k,u_pitched_scale:N}},Xu=(y,t,a,l,f,x,b,E,D,k,j,U,N,H)=>{const Q=b.transform;return c.e(Qc(y,t,a,l,f,x,b,E,D,k,j,U,H),{u_gamma_scale:l?Math.cos(Q.pitch*Math.PI/180)*Q.cameraToCenterDistance:1,u_device_pixel_ratio:b.pixelRatio,u_is_halo:1})},Ea=(y,t,a,l,f,x,b,E,D,k,j,U,N)=>c.e(Xu(y,t,a,l,f,x,b,E,D,k,!0,j,0,N),{u_texsize_icon:U,u_texture_icon:1}),Jc=(y,t)=>({u_opacity:y,u_color:t}),eu=(y,t,a,l,f)=>c.e((function(x,b,E,D){const k=E.imageManager.getPattern(x.from.toString()),j=E.imageManager.getPattern(x.to.toString()),{width:U,height:N}=E.imageManager.getPixelSize(),H=Math.pow(2,D.tileID.overscaledZ),Q=D.tileSize*Math.pow(2,E.transform.tileZoom)/H,ae=Q*(D.tileID.canonical.x+D.tileID.wrap*H),oe=Q*D.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:k.tl,u_pattern_br_a:k.br,u_pattern_tl_b:j.tl,u_pattern_br_b:j.br,u_texsize:[U,N],u_mix:b.t,u_pattern_size_a:k.displaySize,u_pattern_size_b:j.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/c.aN(D,1,E.transform.tileZoom),u_pixel_coord_upper:[ae>>16,oe>>16],u_pixel_coord_lower:[65535&ae,65535&oe]}})(a,f,t,l),{u_opacity:y}),Yu=(y,t)=>{},Tf={fillExtrusion:(y,t)=>({u_lightpos:new c.c2(y,t.u_lightpos),u_lightpos_globe:new c.c2(y,t.u_lightpos_globe),u_lightintensity:new c.bq(y,t.u_lightintensity),u_lightcolor:new c.c2(y,t.u_lightcolor),u_vertical_gradient:new c.bq(y,t.u_vertical_gradient),u_opacity:new c.bq(y,t.u_opacity),u_fill_translate:new c.c3(y,t.u_fill_translate)}),fillExtrusionPattern:(y,t)=>({u_lightpos:new c.c2(y,t.u_lightpos),u_lightpos_globe:new c.c2(y,t.u_lightpos_globe),u_lightintensity:new c.bq(y,t.u_lightintensity),u_lightcolor:new c.c2(y,t.u_lightcolor),u_vertical_gradient:new c.bq(y,t.u_vertical_gradient),u_height_factor:new c.bq(y,t.u_height_factor),u_opacity:new c.bq(y,t.u_opacity),u_fill_translate:new c.c3(y,t.u_fill_translate),u_image:new c.b_(y,t.u_image),u_texsize:new c.c3(y,t.u_texsize),u_pixel_coord_upper:new c.c3(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.c3(y,t.u_pixel_coord_lower),u_scale:new c.c2(y,t.u_scale),u_fade:new c.bq(y,t.u_fade)}),fill:(y,t)=>({u_fill_translate:new c.c3(y,t.u_fill_translate)}),fillPattern:(y,t)=>({u_image:new c.b_(y,t.u_image),u_texsize:new c.c3(y,t.u_texsize),u_pixel_coord_upper:new c.c3(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.c3(y,t.u_pixel_coord_lower),u_scale:new c.c2(y,t.u_scale),u_fade:new c.bq(y,t.u_fade),u_fill_translate:new c.c3(y,t.u_fill_translate)}),fillOutline:(y,t)=>({u_world:new c.c3(y,t.u_world),u_fill_translate:new c.c3(y,t.u_fill_translate)}),fillOutlinePattern:(y,t)=>({u_world:new c.c3(y,t.u_world),u_image:new c.b_(y,t.u_image),u_texsize:new c.c3(y,t.u_texsize),u_pixel_coord_upper:new c.c3(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.c3(y,t.u_pixel_coord_lower),u_scale:new c.c2(y,t.u_scale),u_fade:new c.bq(y,t.u_fade),u_fill_translate:new c.c3(y,t.u_fill_translate)}),circle:(y,t)=>({u_camera_to_center_distance:new c.bq(y,t.u_camera_to_center_distance),u_scale_with_map:new c.b_(y,t.u_scale_with_map),u_pitch_with_map:new c.b_(y,t.u_pitch_with_map),u_extrude_scale:new c.c3(y,t.u_extrude_scale),u_device_pixel_ratio:new c.bq(y,t.u_device_pixel_ratio),u_globe_extrude_scale:new c.bq(y,t.u_globe_extrude_scale),u_translate:new c.c3(y,t.u_translate)}),collisionBox:(y,t)=>({u_pixel_extrude_scale:new c.c3(y,t.u_pixel_extrude_scale)}),collisionCircle:(y,t)=>({u_viewport_size:new c.c3(y,t.u_viewport_size)}),debug:(y,t)=>({u_color:new c.b$(y,t.u_color),u_overlay:new c.b_(y,t.u_overlay),u_overlay_scale:new c.bq(y,t.u_overlay_scale)}),depth:Yu,clippingMask:Yu,heatmap:(y,t)=>({u_extrude_scale:new c.bq(y,t.u_extrude_scale),u_intensity:new c.bq(y,t.u_intensity),u_globe_extrude_scale:new c.bq(y,t.u_globe_extrude_scale)}),heatmapTexture:(y,t)=>({u_matrix:new c.c0(y,t.u_matrix),u_world:new c.c3(y,t.u_world),u_image:new c.b_(y,t.u_image),u_color_ramp:new c.b_(y,t.u_color_ramp),u_opacity:new c.bq(y,t.u_opacity)}),hillshade:(y,t)=>({u_image:new c.b_(y,t.u_image),u_latrange:new c.c3(y,t.u_latrange),u_exaggeration:new c.bq(y,t.u_exaggeration),u_altitudes:new c.c9(y,t.u_altitudes),u_azimuths:new c.c9(y,t.u_azimuths),u_accent:new c.b$(y,t.u_accent),u_method:new c.b_(y,t.u_method),u_shadows:new c.c8(y,t.u_shadows),u_highlights:new c.c8(y,t.u_highlights)}),hillshadePrepare:(y,t)=>({u_matrix:new c.c0(y,t.u_matrix),u_image:new c.b_(y,t.u_image),u_dimension:new c.c3(y,t.u_dimension),u_zoom:new c.bq(y,t.u_zoom),u_unpack:new c.c1(y,t.u_unpack)}),colorRelief:(y,t)=>({u_image:new c.b_(y,t.u_image),u_unpack:new c.c1(y,t.u_unpack),u_dimension:new c.c3(y,t.u_dimension),u_elevation_stops:new c.b_(y,t.u_elevation_stops),u_color_stops:new c.b_(y,t.u_color_stops),u_color_ramp_size:new c.b_(y,t.u_color_ramp_size),u_opacity:new c.bq(y,t.u_opacity)}),line:(y,t)=>({u_translation:new c.c3(y,t.u_translation),u_ratio:new c.bq(y,t.u_ratio),u_device_pixel_ratio:new c.bq(y,t.u_device_pixel_ratio),u_units_to_pixels:new c.c3(y,t.u_units_to_pixels)}),lineGradient:(y,t)=>({u_translation:new c.c3(y,t.u_translation),u_ratio:new c.bq(y,t.u_ratio),u_device_pixel_ratio:new c.bq(y,t.u_device_pixel_ratio),u_units_to_pixels:new c.c3(y,t.u_units_to_pixels),u_image:new c.b_(y,t.u_image),u_image_height:new c.bq(y,t.u_image_height)}),linePattern:(y,t)=>({u_translation:new c.c3(y,t.u_translation),u_texsize:new c.c3(y,t.u_texsize),u_ratio:new c.bq(y,t.u_ratio),u_device_pixel_ratio:new c.bq(y,t.u_device_pixel_ratio),u_image:new c.b_(y,t.u_image),u_units_to_pixels:new c.c3(y,t.u_units_to_pixels),u_scale:new c.c2(y,t.u_scale),u_fade:new c.bq(y,t.u_fade)}),lineSDF:(y,t)=>({u_translation:new c.c3(y,t.u_translation),u_ratio:new c.bq(y,t.u_ratio),u_device_pixel_ratio:new c.bq(y,t.u_device_pixel_ratio),u_units_to_pixels:new c.c3(y,t.u_units_to_pixels),u_image:new c.b_(y,t.u_image),u_mix:new c.bq(y,t.u_mix),u_tileratio:new c.bq(y,t.u_tileratio),u_crossfade_from:new c.bq(y,t.u_crossfade_from),u_crossfade_to:new c.bq(y,t.u_crossfade_to),u_lineatlas_width:new c.bq(y,t.u_lineatlas_width),u_lineatlas_height:new c.bq(y,t.u_lineatlas_height)}),lineGradientSDF:(y,t)=>({u_translation:new c.c3(y,t.u_translation),u_ratio:new c.bq(y,t.u_ratio),u_device_pixel_ratio:new c.bq(y,t.u_device_pixel_ratio),u_units_to_pixels:new c.c3(y,t.u_units_to_pixels),u_image:new c.b_(y,t.u_image),u_image_height:new c.bq(y,t.u_image_height),u_tileratio:new c.bq(y,t.u_tileratio),u_crossfade_from:new c.bq(y,t.u_crossfade_from),u_crossfade_to:new c.bq(y,t.u_crossfade_to),u_image_dash:new c.b_(y,t.u_image_dash),u_mix:new c.bq(y,t.u_mix),u_lineatlas_width:new c.bq(y,t.u_lineatlas_width),u_lineatlas_height:new c.bq(y,t.u_lineatlas_height)}),raster:(y,t)=>({u_tl_parent:new c.c3(y,t.u_tl_parent),u_scale_parent:new c.bq(y,t.u_scale_parent),u_buffer_scale:new c.bq(y,t.u_buffer_scale),u_fade_t:new c.bq(y,t.u_fade_t),u_opacity:new c.bq(y,t.u_opacity),u_image0:new c.b_(y,t.u_image0),u_image1:new c.b_(y,t.u_image1),u_brightness_low:new c.bq(y,t.u_brightness_low),u_brightness_high:new c.bq(y,t.u_brightness_high),u_saturation_factor:new c.bq(y,t.u_saturation_factor),u_contrast_factor:new c.bq(y,t.u_contrast_factor),u_spin_weights:new c.c2(y,t.u_spin_weights),u_coords_top:new c.c1(y,t.u_coords_top),u_coords_bottom:new c.c1(y,t.u_coords_bottom)}),symbolIcon:(y,t)=>({u_is_size_zoom_constant:new c.b_(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.b_(y,t.u_is_size_feature_constant),u_size_t:new c.bq(y,t.u_size_t),u_size:new c.bq(y,t.u_size),u_camera_to_center_distance:new c.bq(y,t.u_camera_to_center_distance),u_pitch:new c.bq(y,t.u_pitch),u_rotate_symbol:new c.b_(y,t.u_rotate_symbol),u_aspect_ratio:new c.bq(y,t.u_aspect_ratio),u_fade_change:new c.bq(y,t.u_fade_change),u_label_plane_matrix:new c.c0(y,t.u_label_plane_matrix),u_coord_matrix:new c.c0(y,t.u_coord_matrix),u_is_text:new c.b_(y,t.u_is_text),u_pitch_with_map:new c.b_(y,t.u_pitch_with_map),u_is_along_line:new c.b_(y,t.u_is_along_line),u_is_variable_anchor:new c.b_(y,t.u_is_variable_anchor),u_texsize:new c.c3(y,t.u_texsize),u_texture:new c.b_(y,t.u_texture),u_translation:new c.c3(y,t.u_translation),u_pitched_scale:new c.bq(y,t.u_pitched_scale)}),symbolSDF:(y,t)=>({u_is_size_zoom_constant:new c.b_(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.b_(y,t.u_is_size_feature_constant),u_size_t:new c.bq(y,t.u_size_t),u_size:new c.bq(y,t.u_size),u_camera_to_center_distance:new c.bq(y,t.u_camera_to_center_distance),u_pitch:new c.bq(y,t.u_pitch),u_rotate_symbol:new c.b_(y,t.u_rotate_symbol),u_aspect_ratio:new c.bq(y,t.u_aspect_ratio),u_fade_change:new c.bq(y,t.u_fade_change),u_label_plane_matrix:new c.c0(y,t.u_label_plane_matrix),u_coord_matrix:new c.c0(y,t.u_coord_matrix),u_is_text:new c.b_(y,t.u_is_text),u_pitch_with_map:new c.b_(y,t.u_pitch_with_map),u_is_along_line:new c.b_(y,t.u_is_along_line),u_is_variable_anchor:new c.b_(y,t.u_is_variable_anchor),u_texsize:new c.c3(y,t.u_texsize),u_texture:new c.b_(y,t.u_texture),u_gamma_scale:new c.bq(y,t.u_gamma_scale),u_device_pixel_ratio:new c.bq(y,t.u_device_pixel_ratio),u_is_halo:new c.b_(y,t.u_is_halo),u_translation:new c.c3(y,t.u_translation),u_pitched_scale:new c.bq(y,t.u_pitched_scale)}),symbolTextAndIcon:(y,t)=>({u_is_size_zoom_constant:new c.b_(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.b_(y,t.u_is_size_feature_constant),u_size_t:new c.bq(y,t.u_size_t),u_size:new c.bq(y,t.u_size),u_camera_to_center_distance:new c.bq(y,t.u_camera_to_center_distance),u_pitch:new c.bq(y,t.u_pitch),u_rotate_symbol:new c.b_(y,t.u_rotate_symbol),u_aspect_ratio:new c.bq(y,t.u_aspect_ratio),u_fade_change:new c.bq(y,t.u_fade_change),u_label_plane_matrix:new c.c0(y,t.u_label_plane_matrix),u_coord_matrix:new c.c0(y,t.u_coord_matrix),u_is_text:new c.b_(y,t.u_is_text),u_pitch_with_map:new c.b_(y,t.u_pitch_with_map),u_is_along_line:new c.b_(y,t.u_is_along_line),u_is_variable_anchor:new c.b_(y,t.u_is_variable_anchor),u_texsize:new c.c3(y,t.u_texsize),u_texsize_icon:new c.c3(y,t.u_texsize_icon),u_texture:new c.b_(y,t.u_texture),u_texture_icon:new c.b_(y,t.u_texture_icon),u_gamma_scale:new c.bq(y,t.u_gamma_scale),u_device_pixel_ratio:new c.bq(y,t.u_device_pixel_ratio),u_is_halo:new c.b_(y,t.u_is_halo),u_translation:new c.c3(y,t.u_translation),u_pitched_scale:new c.bq(y,t.u_pitched_scale)}),background:(y,t)=>({u_opacity:new c.bq(y,t.u_opacity),u_color:new c.b$(y,t.u_color)}),backgroundPattern:(y,t)=>({u_opacity:new c.bq(y,t.u_opacity),u_image:new c.b_(y,t.u_image),u_pattern_tl_a:new c.c3(y,t.u_pattern_tl_a),u_pattern_br_a:new c.c3(y,t.u_pattern_br_a),u_pattern_tl_b:new c.c3(y,t.u_pattern_tl_b),u_pattern_br_b:new c.c3(y,t.u_pattern_br_b),u_texsize:new c.c3(y,t.u_texsize),u_mix:new c.bq(y,t.u_mix),u_pattern_size_a:new c.c3(y,t.u_pattern_size_a),u_pattern_size_b:new c.c3(y,t.u_pattern_size_b),u_scale_a:new c.bq(y,t.u_scale_a),u_scale_b:new c.bq(y,t.u_scale_b),u_pixel_coord_upper:new c.c3(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.c3(y,t.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bq(y,t.u_tile_units_to_pixels)}),terrain:(y,t)=>({u_texture:new c.b_(y,t.u_texture),u_ele_delta:new c.bq(y,t.u_ele_delta),u_fog_matrix:new c.c0(y,t.u_fog_matrix),u_fog_color:new c.b$(y,t.u_fog_color),u_fog_ground_blend:new c.bq(y,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bq(y,t.u_fog_ground_blend_opacity),u_horizon_color:new c.b$(y,t.u_horizon_color),u_horizon_fog_blend:new c.bq(y,t.u_horizon_fog_blend),u_is_globe_mode:new c.bq(y,t.u_is_globe_mode)}),terrainDepth:(y,t)=>({u_ele_delta:new c.bq(y,t.u_ele_delta)}),terrainCoords:(y,t)=>({u_texture:new c.b_(y,t.u_texture),u_terrain_coords_id:new c.bq(y,t.u_terrain_coords_id),u_ele_delta:new c.bq(y,t.u_ele_delta)}),projectionErrorMeasurement:(y,t)=>({u_input:new c.bq(y,t.u_input),u_output_expected:new c.bq(y,t.u_output_expected)}),atmosphere:(y,t)=>({u_sun_pos:new c.c2(y,t.u_sun_pos),u_atmosphere_blend:new c.bq(y,t.u_atmosphere_blend),u_globe_position:new c.c2(y,t.u_globe_position),u_globe_radius:new c.bq(y,t.u_globe_radius),u_inv_proj_matrix:new c.c0(y,t.u_inv_proj_matrix)}),sky:(y,t)=>({u_sky_color:new c.b$(y,t.u_sky_color),u_horizon_color:new c.b$(y,t.u_horizon_color),u_horizon:new c.c3(y,t.u_horizon),u_horizon_normal:new c.c3(y,t.u_horizon_normal),u_sky_horizon_blend:new c.bq(y,t.u_sky_horizon_blend),u_sky_blend:new c.bq(y,t.u_sky_blend)})};class rl{constructor(t,a,l){this.context=t;const f=t.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const al={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ed{constructor(t,a,l,f){this.length=a.length,this.attributes=l,this.itemSize=a.bytesPerElement,this.dynamicDraw=f,this.context=t;const x=t.gl;this.buffer=x.createBuffer(),t.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,a){for(let l=0;l<this.attributes.length;l++){const f=a.attributes[this.attributes[l].name];f!==void 0&&t.enableVertexAttribArray(f)}}setVertexAttribPointers(t,a,l){for(let f=0;f<this.attributes.length;f++){const x=this.attributes[f],b=a.attributes[x.name];b!==void 0&&t.vertexAttribPointer(b,x.components,t[al[x.type]],!1,this.itemSize,x.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class xi{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ys extends xi{getDefault(){return c.bp.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class tu extends xi{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class iu extends xi{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Wu extends xi{getDefault(){return[!0,!0,!0,!0]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class sl extends xi{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class nu extends xi{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class tc extends xi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const a=this.current;(t.func!==a.func||t.ref!==a.ref||t.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class ra extends xi{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class td extends xi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=t,this.dirty=!1}}class Ku extends xi{getDefault(){return[0,1]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class aa extends xi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=t,this.dirty=!1}}class _s extends xi{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Ir extends xi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.BLEND):a.disable(a.BLEND),this.current=t,this.dirty=!1}}class qs extends xi{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class ol extends xi{getDefault(){return c.bp.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class ll extends xi{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class ru extends xi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=t,this.dirty=!1}}class Mo extends xi{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Aa extends xi{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class id extends xi{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class ic extends xi{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Kt extends xi{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Qu extends xi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class sa extends xi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Ju extends xi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class oa extends xi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Sf extends xi{getDefault(){return null}set(t){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class eh extends xi{getDefault(){return null}set(t){var a;if(t===this.current&&!this.dirty)return;const l=this.gl;Sa(l)?l.bindVertexArray(t):(a=l.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Eo extends xi{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class nd extends xi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class th extends xi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Ao extends xi{constructor(t,a){super(t),this.context=t,this.parent=a}getDefault(){return null}}class nc extends Ao{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Rr extends Ao{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Co extends Ao{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const Do="Framebuffer is not complete";class cl{constructor(t,a,l,f,x){this.context=t,this.width=a,this.height=l;const b=t.gl,E=this.framebuffer=b.createFramebuffer();if(this.colorAttachment=new nc(t,E),f)this.depthAttachment=x?new Co(t,E):new Rr(t,E);else if(x)throw new Error("Stencil cannot be set without depth");if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw new Error(Do)}destroy(){const t=this.context.gl,a=this.colorAttachment.get();if(a&&t.deleteTexture(a),this.depthAttachment){const l=this.depthAttachment.get();l&&t.deleteRenderbuffer(l)}t.deleteFramebuffer(this.framebuffer)}}class zo{constructor(t){var a,l;if(this.gl=t,this.clearColor=new ys(this),this.clearDepth=new tu(this),this.clearStencil=new iu(this),this.colorMask=new Wu(this),this.depthMask=new sl(this),this.stencilMask=new nu(this),this.stencilFunc=new tc(this),this.stencilOp=new ra(this),this.stencilTest=new td(this),this.depthRange=new Ku(this),this.depthTest=new aa(this),this.depthFunc=new _s(this),this.blend=new Ir(this),this.blendFunc=new qs(this),this.blendColor=new ol(this),this.blendEquation=new ll(this),this.cullFace=new ru(this),this.cullFaceSide=new Mo(this),this.frontFace=new Aa(this),this.program=new id(this),this.activeTexture=new ic(this),this.viewport=new Kt(this),this.bindFramebuffer=new Qu(this),this.bindRenderbuffer=new sa(this),this.bindTexture=new Ju(this),this.bindVertexBuffer=new oa(this),this.bindElementBuffer=new Sf(this),this.bindVertexArray=new eh(this),this.pixelStoreUnpack=new Eo(this),this.pixelStoreUnpackPremultiplyAlpha=new nd(this),this.pixelStoreUnpackFlipY=new th(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),Sa(t)){this.HALF_FLOAT=t.HALF_FLOAT;const f=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=t.RGBA16F)!==null&&a!==void 0?a:f?.RGBA16F_EXT,this.RGB16F=(l=t.RGB16F)!==null&&l!==void 0?l:f?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const f=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=f?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,a){return new rl(this,t,a)}createVertexBuffer(t,a,l){return new ed(this,t,a,l)}createRenderbuffer(t,a,l){const f=this.gl,x=f.createRenderbuffer();return this.bindRenderbuffer.set(x),f.renderbufferStorage(f.RENDERBUFFER,t,a,l),this.bindRenderbuffer.set(null),x}createFramebuffer(t,a,l,f){return new cl(this,t,a,l,f)}clear({color:t,depth:a,stencil:l}){const f=this.gl;let x=0;t&&(x|=f.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(x|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),l!==void 0&&(x|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),f.clear(x)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){c.bR(t.blendFunction,Ci.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return Sa(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var a;return Sa(this.gl)?this.gl.deleteVertexArray(t):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let $n;function Jn(y,t,a,l,f){const x=y.context,b=y.transform,E=x.gl,D=y.useProgram("collisionBox"),k=[];let j=0,U=0;for(let se=0;se<l.length;se++){const he=l[se],ye=t.getTile(he).getBucket(a);if(!ye)continue;const ce=f?ye.textCollisionBox:ye.iconCollisionBox,ge=ye.collisionCircleArray;ge.length>0&&(k.push({circleArray:ge,circleOffset:U,coord:he}),j+=ge.length/4,U=j),ce&&D.draw(x,E.LINES,Yt.disabled,fi.disabled,y.colorModeForRenderPass(),ri.disabled,wo(y.transform),y.style.map.terrain&&y.style.map.terrain.getTerrainData(he),b.getProjectionData({overscaledTileID:he,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),a.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,null,y.transform.zoom,null,null,ce.collisionVertexBuffer)}if(!f||!k.length)return;const N=y.useProgram("collisionCircle"),H=new c.ca;H.resize(4*j),H._trim();let Q=0;for(const se of k)for(let he=0;he<se.circleArray.length/4;he++){const ye=4*he,ce=se.circleArray[ye+0],ge=se.circleArray[ye+1],be=se.circleArray[ye+2],me=se.circleArray[ye+3];H.emplace(Q++,ce,ge,be,me,0),H.emplace(Q++,ce,ge,be,me,1),H.emplace(Q++,ce,ge,be,me,2),H.emplace(Q++,ce,ge,be,me,3)}(!$n||$n.length<2*j)&&($n=(function(se){const he=2*se,ye=new c.cc;ye.resize(he),ye._trim();for(let ce=0;ce<he;ce++){const ge=6*ce;ye.uint16[ge+0]=4*ce+0,ye.uint16[ge+1]=4*ce+1,ye.uint16[ge+2]=4*ce+2,ye.uint16[ge+3]=4*ce+2,ye.uint16[ge+4]=4*ce+3,ye.uint16[ge+5]=4*ce+0}return ye})(j));const ae=x.createIndexBuffer($n,!0),oe=x.createVertexBuffer(H,c.cb.members,!0);for(const se of k){const he=Kh(y.transform);N.draw(x,E.TRIANGLES,Yt.disabled,fi.disabled,y.colorModeForRenderPass(),ri.disabled,he,y.style.map.terrain&&y.style.map.terrain.getTerrainData(se.coord),null,a.id,oe,ae,c.aX.simpleSegment(0,2*se.circleOffset,se.circleArray.length,se.circleArray.length/2),null,y.transform.zoom,null,null,null)}oe.destroy(),ae.destroy()}const xs=c.ar(new Float32Array(16));function vs(y,t,a,l,f,x){const{horizontalAlign:b,verticalAlign:E}=c.aS(y);return new c.P((-(b-.5)*t/f+l[0])*x,(-(E-.5)*a/f+l[1])*x)}function Fr(y,t,a,l,f,x){const b=t.tileAnchorPoint.add(new c.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let E=l.mult(x);a||(E=E.rotate(-f));const D=b.add(E);return Xt(D.x,D.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(a){const E=di(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(y),D=Math.atan(E.y/E.x)+(E.x<0?Math.PI:0);return y.add(l.rotate(D))}return y.add(l)}function Zs(y,t,a,l,f,x,b,E,D,k,j,U){const N=y.text.placedSymbolArray,H=y.text.dynamicLayoutVertexArray,Q=y.icon.dynamicLayoutVertexArray,ae={};H.clear();for(let oe=0;oe<N.length;oe++){const se=N.get(oe),he=se.hidden||!se.crossTileID||y.allowVerticalPlacement&&!se.placedOrientation?null:l[se.crossTileID];if(he){const ye=new c.P(se.anchorX,se.anchorY),ce={getElevation:U,width:f.width,height:f.height,pitchedLabelPlaneMatrix:x,pitchWithMap:a,transform:f,tileAnchorPoint:ye,translation:k,unwrappedTileID:j},ge=a?Gl(ye.x,ye.y,ce):di(ye.x,ye.y,ce),be=Xo(f.cameraToCenterDistance,ge.signedDistanceFromCamera);let me=c.aA(y.textSizeData,E,se)*be/c.aM;a&&(me*=y.tilePixelRatio/b);const{width:Me,height:Fe,anchor:Le,textOffset:Be,textBoxScale:Oe}=he,dt=vs(Le,Me,Fe,Be,Oe,me),ft=f.getPitchedTextCorrection(ye.x+k[0],ye.y+k[1],j),rt=Fr(ge.point,ce,t,dt,-f.bearingInRadians,ft),yt=y.allowVerticalPlacement&&se.placedOrientation===c.az.vertical?Math.PI/2:0;for(let $t=0;$t<se.numGlyphs;$t++)c.aG(H,rt,yt);D&&se.associatedIconIndex>=0&&(ae[se.associatedIconIndex]={shiftedAnchor:rt,angle:yt})}else ps(se.numGlyphs,H)}if(D){Q.clear();const oe=y.icon.placedSymbolArray;for(let se=0;se<oe.length;se++){const he=oe.get(se);if(he.hidden)ps(he.numGlyphs,Q);else{const ye=ae[se];if(ye)for(let ce=0;ce<he.numGlyphs;ce++)c.aG(Q,ye.shiftedAnchor,ye.angle);else ps(he.numGlyphs,Q)}}y.icon.dynamicLayoutVertexBuffer.updateData(Q)}y.text.dynamicLayoutVertexBuffer.updateData(H)}function rd(y,t,a){return a.iconsInText&&t?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function ul(y,t,a,l,f,x,b,E,D,k,j,U,N){const H=y.context,Q=H.gl,ae=y.transform,oe=E==="map",se=D==="map",he=E!=="viewport"&&a.layout.get("symbol-placement")!=="point",ye=oe&&!se&&!he,ce=!a.layout.get("symbol-sort-key").isConstant();let ge=!1;const be=y.getDepthModeForSublayer(0,Yt.ReadOnly),me=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Me=[],Fe=ae.getCircleRadiusCorrection();for(const Le of l){const Be=t.getTile(Le),Oe=Be.getBucket(a);if(!Oe)continue;const dt=f?Oe.text:Oe.icon;if(!dt||!dt.segments.get().length||!dt.hasVisibleVertices)continue;const ft=dt.programConfigurations.get(a.id),rt=f||Oe.sdfIcons,yt=f?Oe.textSizeData:Oe.iconSizeData,$t=se||ae.pitch!==0,Si=y.useProgram(rd(rt,f,Oe),ft),Ui=c.ay(yt,ae.zoom),Oi=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Le);let Wi,Di,hn,Ki,tr=[0,0],yn=null;if(f)Di=Be.glyphAtlasTexture,hn=Q.LINEAR,Wi=Be.glyphAtlasTexture.size,Oe.iconsInText&&(tr=Be.imageAtlasTexture.size,yn=Be.imageAtlasTexture,Ki=$t||y.options.rotating||y.options.zooming||yt.kind==="composite"||yt.kind==="camera"?Q.LINEAR:Q.NEAREST);else{const Ei=a.layout.get("icon-size").constantOr(0)!==1||Oe.iconsNeedLinear;Di=Be.imageAtlasTexture,hn=rt||y.options.rotating||y.options.zooming||Ei||$t?Q.LINEAR:Q.NEAREST,Wi=Be.imageAtlasTexture.size}const _n=c.aN(Be,1,y.transform.zoom),ir=ta(oe,y.transform,_n),Rs=c.N();c.aB(Rs,ir);const ks=Ou(se,oe,y.transform,_n),Ja=c.aO(ae,Be,x,b),Gr=ae.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),xl=me&&Oe.hasTextData(),fc=a.layout.get("icon-text-fit")!=="none"&&xl&&Oe.hasIconData();if(he){const Ei=y.style.map.terrain?(In,Un)=>y.style.map.terrain.getElevation(Le,In,Un):null,Fi=a.layout.get("text-rotation-alignment")==="map";Vs(Oe,y,f,ir,Rs,se,k,Fi,Le.toUnwrapped(),ae.width,ae.height,Ja,Ei)}const es=f&&me||fc,qr=he||es?xs:se?ir:y.transform.clipSpaceToPixelsMatrix,da=rt&&a.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ra;Ra=rt?Oe.iconsInText?Ea(yt.kind,Ui,ye,se,he,es,y,qr,ks,Ja,Wi,tr,Fe):Xu(yt.kind,Ui,ye,se,he,es,y,qr,ks,Ja,f,Wi,0,Fe):Qc(yt.kind,Ui,ye,se,he,es,y,qr,ks,Ja,f,Wi,Fe);const ka={program:Si,buffers:dt,uniformValues:Ra,projectionData:Gr,atlasTexture:Di,atlasTextureIcon:yn,atlasInterpolation:hn,atlasInterpolationIcon:Ki,isSDF:rt,hasHalo:da};if(ce&&Oe.canOverlap){ge=!0;const Ei=dt.segments.get();for(const Fi of Ei)Me.push({segments:new c.aX([Fi]),sortKey:Fi.sortKey,state:ka,terrainData:Oi})}else Me.push({segments:dt.segments,sortKey:0,state:ka,terrainData:Oi})}ge&&Me.sort(((Le,Be)=>Le.sortKey-Be.sortKey));for(const Le of Me){const Be=Le.state;if(H.activeTexture.set(Q.TEXTURE0),Be.atlasTexture.bind(Be.atlasInterpolation,Q.CLAMP_TO_EDGE),Be.atlasTextureIcon&&(H.activeTexture.set(Q.TEXTURE1),Be.atlasTextureIcon&&Be.atlasTextureIcon.bind(Be.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),Be.isSDF){const Oe=Be.uniformValues;Be.hasHalo&&(Oe.u_is_halo=1,rc(Be.buffers,Le.segments,a,y,Be.program,be,j,U,Oe,Be.projectionData,Le.terrainData)),Oe.u_is_halo=0}rc(Be.buffers,Le.segments,a,y,Be.program,be,j,U,Be.uniformValues,Be.projectionData,Le.terrainData)}}function rc(y,t,a,l,f,x,b,E,D,k,j){const U=l.context;f.draw(U,U.gl.TRIANGLES,x,b,E,ri.backCCW,D,j,k,a.id,y.layoutVertexBuffer,y.indexBuffer,t,a.paint,l.transform.zoom,y.programConfigurations.get(a.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function ad(y,t,a,l,f){const x=y.context,b=x.gl,E=fi.disabled,D=new Ci([b.ONE,b.ONE],c.bp.transparent,[!0,!0,!0,!0]),k=t.getBucket(a);if(!k)return;const j=l.key;let U=a.heatmapFbos.get(j);U||(U=Bi(x,t.tileSize,t.tileSize),a.heatmapFbos.set(j,U)),x.bindFramebuffer.set(U.framebuffer),x.viewport.set([0,0,t.tileSize,t.tileSize]),x.clear({color:c.bp.transparent});const N=k.programConfigurations.get(a.id),H=y.useProgram("heatmap",N,!f),Q=y.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ae=y.style.map.terrain.getTerrainData(l);H.draw(x,b.TRIANGLES,Yt.disabled,E,D,ri.disabled,To(t,y.transform.zoom,a.paint.get("heatmap-intensity"),1),ae,Q,a.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,a.paint,y.transform.zoom,N)}function er(y,t,a,l,f){const x=y.context,b=x.gl,E=y.transform;x.setColorMode(y.colorModeForRenderPass());const D=ui(x,t),k=a.key,j=t.heatmapFbos.get(k);if(!j)return;x.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,j.colorAttachment.get()),x.activeTexture.set(b.TEXTURE1),D.bind(b.LINEAR,b.CLAMP_TO_EDGE);const U=E.getProjectionData({overscaledTileID:a,applyTerrainMatrix:f,applyGlobeMatrix:!l});y.useProgram("heatmapTexture").draw(x,b.TRIANGLES,Yt.disabled,fi.disabled,y.colorModeForRenderPass(),ri.disabled,Qh(y,t,0,1),null,U,t.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments,t.paint,E.zoom),j.destroy(),t.heatmapFbos.delete(k)}function Bi(y,t,a){var l,f;const x=y.gl,b=x.createTexture();x.bindTexture(x.TEXTURE_2D,b),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.LINEAR);const E=(l=y.HALF_FLOAT)!==null&&l!==void 0?l:x.UNSIGNED_BYTE,D=(f=y.RGBA16F)!==null&&f!==void 0?f:x.RGBA;x.texImage2D(x.TEXTURE_2D,0,D,t,a,0,x.RGBA,E,null);const k=y.createFramebuffer(t,a,!1,!1);return k.colorAttachment.set(b),k}function ui(y,t){return t.colorRampTexture||(t.colorRampTexture=new c.T(y,t.colorRamp,y.gl.RGBA)),t.colorRampTexture}function Hs(y,t,a,l,f,x,b,E){let D=256;if(f.stepInterpolant){const k=t.getSource().maxzoom,j=b.canonical.z===k?Math.ceil(1<<y.transform.maxZoom-b.canonical.z):1;D=c.an(c.ce(x.maxLineLength/c.a5*1024*j),256,a.maxTextureSize)}return E.gradient=c.cf({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:D,image:E.gradient||void 0,clips:x.lineClipsArray}),E.texture?E.texture.update(E.gradient):E.texture=new c.T(a,E.gradient,l.RGBA),E.version=f.gradientVersion,E.texture}function la(y,t,a,l,f){y.activeTexture.set(t.TEXTURE0),a.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),l.updatePaintBuffers(f)}function cn(y,t,a,l,f,x){(f||y.lineAtlas.dirty)&&(t.activeTexture.set(a.TEXTURE0),y.lineAtlas.bind(t)),l.updatePaintBuffers(x)}function Nr(y,t,a,l,f,x,b){const E=x.gradients[f.id];let D=E.texture;f.gradientVersion!==E.version&&(D=Hs(y,t,a,l,f,x,b,E)),a.activeTexture.set(l.TEXTURE0),D.bind(f.stepInterpolant?l.NEAREST:l.LINEAR,l.CLAMP_TO_EDGE)}function Vr(y,t,a,l,f,x,b,E,D){const k=x.gradients[f.id];let j=k.texture;f.gradientVersion!==k.version&&(j=Hs(y,t,a,l,f,x,b,k)),a.activeTexture.set(l.TEXTURE0),j.bind(f.stepInterpolant?l.NEAREST:l.LINEAR,l.CLAMP_TO_EDGE),a.activeTexture.set(l.TEXTURE1),y.lineAtlas.bind(a),E.updatePaintBuffers(D)}function au(y,t,a,l,f){if(!a||!l||!l.imageAtlas)return;const x=l.imageAtlas.patternPositions;let b=x[a.to.toString()],E=x[a.from.toString()];if(!b&&E&&(b=E),!E&&b&&(E=b),!b||!E){const D=f.getPaintProperty(t);b=x[D],E=x[D]}b&&E&&y.setConstantPatternPositions(b,E)}function bs(y,t,a,l,f,x,b,E){const D=y.context.gl,k="fill-pattern",j=a.paint.get(k),U=j&&j.constantOr(1),N=a.getCrossfadeParameters();let H,Q,ae,oe,se;const he=y.transform,ye=a.paint.get("fill-translate"),ce=a.paint.get("fill-translate-anchor");b?(Q=U&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",H=D.LINES):(Q=U?"fillPattern":"fill",H=D.TRIANGLES);const ge=j.constantOr(null);for(const be of l){const me=t.getTile(be);if(U&&!me.patternsLoaded())continue;const Me=me.getBucket(a);if(!Me)continue;const Fe=Me.programConfigurations.get(a.id),Le=y.useProgram(Q,Fe),Be=y.style.map.terrain&&y.style.map.terrain.getTerrainData(be);U&&(y.context.activeTexture.set(D.TEXTURE0),me.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),Fe.updatePaintBuffers(N)),au(Fe,k,ge,me,a);const Oe=he.getProjectionData({overscaledTileID:be,applyGlobeMatrix:!E,applyTerrainMatrix:!0}),dt=c.aO(he,me,ye,ce);if(b){oe=Me.indexBuffer2,se=Me.segments2;const rt=[D.drawingBufferWidth,D.drawingBufferHeight];ae=Q==="fillOutlinePattern"&&U?xf(y,N,me,rt,dt):ec(rt,dt)}else oe=Me.indexBuffer,se=Me.segments,ae=U?nl(y,N,me,dt):{u_fill_translate:dt};const ft=y.stencilModeForClipping(be);Le.draw(y.context,H,f,ft,x,ri.backCCW,ae,Be,Oe,a.id,Me.layoutVertexBuffer,oe,se,a.paint,y.transform.zoom,Fe)}}function ws(y,t,a,l,f,x,b,E){const D=y.context,k=D.gl,j="fill-extrusion-pattern",U=a.paint.get(j),N=U.constantOr(1),H=a.getCrossfadeParameters(),Q=a.paint.get("fill-extrusion-opacity"),ae=U.constantOr(null),oe=y.transform;for(const se of l){const he=t.getTile(se),ye=he.getBucket(a);if(!ye)continue;const ce=y.style.map.terrain&&y.style.map.terrain.getTerrainData(se),ge=ye.programConfigurations.get(a.id),be=y.useProgram(N?"fillExtrusionPattern":"fillExtrusion",ge);N&&(y.context.activeTexture.set(k.TEXTURE0),he.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ge.updatePaintBuffers(H));const me=oe.getProjectionData({overscaledTileID:se,applyGlobeMatrix:!E,applyTerrainMatrix:!0});au(ge,j,ae,he,a);const Me=c.aO(oe,he,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Fe=a.paint.get("fill-extrusion-vertical-gradient"),Le=N?Zu(y,Fe,Q,Me,se,H,he):qu(y,Fe,Q,Me);be.draw(D,D.gl.TRIANGLES,f,x,b,ri.backCCW,Le,ce,me,a.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,a.paint,y.transform.zoom,ge,y.style.map.terrain&&ye.centroidVertexBuffer)}}function Ts(y,t,a,l,f,x,b,E,D){var k;const j=y.style.projection,U=y.context,N=y.transform,H=U.gl,Q=[`#define NUM_ILLUMINATION_SOURCES ${a.paint.get("hillshade-highlight-color").values.length}`],ae=y.useProgram("hillshade",null,!1,Q),oe=!y.options.moving;for(const se of l){const he=t.getTile(se),ye=he.fbo;if(!ye)continue;const ce=j.getMeshFromTileID(U,se.canonical,E,!0,"raster"),ge=(k=y.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(se);U.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,ye.colorAttachment.get());const be=N.getProjectionData({overscaledTileID:se,aligned:oe,applyGlobeMatrix:!D,applyTerrainMatrix:!0});ae.draw(U,H.TRIANGLES,x,f[se.overscaledZ],b,ri.backCCW,Yc(y,he,a),ge,be,a.id,ce.vertexBuffer,ce.indexBuffer,ce.segments)}}function $s(y,t,a,l,f,x,b,E,D){var k;const j=y.style.projection,U=y.context,N=y.transform,H=U.gl,Q=y.useProgram("colorRelief"),ae=!y.options.moving;let oe=!0,se=0;for(const he of l){const ye=t.getTile(he),ce=ye.dem;if(oe){const Le=H.getParameter(H.MAX_TEXTURE_SIZE),{elevationTexture:Be,colorTexture:Oe}=a.getColorRampTextures(U,Le,ce.getUnpackVector());U.activeTexture.set(H.TEXTURE1),Be.bind(H.NEAREST,H.CLAMP_TO_EDGE),U.activeTexture.set(H.TEXTURE4),Oe.bind(H.LINEAR,H.CLAMP_TO_EDGE),oe=!1,se=Be.size[0]}if(!ce||!ce.data)continue;const ge=ce.stride,be=ce.getPixels();if(U.activeTexture.set(H.TEXTURE0),U.pixelStoreUnpackPremultiplyAlpha.set(!1),ye.demTexture=ye.demTexture||y.getTileTexture(ge),ye.demTexture){const Le=ye.demTexture;Le.update(be,{premultiply:!1}),Le.bind(H.LINEAR,H.CLAMP_TO_EDGE)}else ye.demTexture=new c.T(U,be,H.RGBA,{premultiply:!1}),ye.demTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE);const me=j.getMeshFromTileID(U,he.canonical,E,!0,"raster"),Me=(k=y.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(he),Fe=N.getProjectionData({overscaledTileID:he,aligned:ae,applyGlobeMatrix:!D,applyTerrainMatrix:!0});Q.draw(U,H.TRIANGLES,x,f[he.overscaledZ],b,ri.backCCW,bf(a,ye.dem,se),Me,Fe,a.id,me.vertexBuffer,me.indexBuffer,me.segments)}}const Xs=[new c.P(0,0),new c.P(c.a5,0),new c.P(c.a5,c.a5),new c.P(0,c.a5)];function Ca(y,t,a,l,f,x,b,E,D=!1,k=!1){const j=l[l.length-1].overscaledZ,U=y.context,N=U.gl,H=y.useProgram("raster"),Q=y.transform,ae=y.style.projection,oe=y.colorModeForRenderPass(),se=!y.options.moving,he=a.paint.get("raster-opacity"),ye=a.paint.get("raster-resampling"),ce=a.paint.get("raster-fade-duration"),ge=!!y.style.map.terrain;for(const be of l){const me=y.getDepthModeForSublayer(be.overscaledZ-j,he===1?Yt.ReadWrite:Yt.ReadOnly,N.LESS),Me=t.getTile(be),Fe=ye==="nearest"?N.NEAREST:N.LINEAR;U.activeTexture.set(N.TEXTURE0),Me.texture.bind(Fe,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST),U.activeTexture.set(N.TEXTURE1);const{parentTile:Le,parentScaleBy:Be,parentTopLeft:Oe,fadeValues:dt}=Ss(Me,t,ce,ge);Me.fadeOpacity=dt.tileOpacity,Le?(Le.fadeOpacity=dt.parentTileOpacity,Le.texture.bind(Fe,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST)):Me.texture.bind(Fe,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST),Me.texture.useMipmap&&U.extTextureFilterAnisotropic&&y.transform.pitch>20&&N.texParameterf(N.TEXTURE_2D,U.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,U.extTextureFilterAnisotropicMax);const ft=y.style.map.terrain&&y.style.map.terrain.getTerrainData(be),rt=Q.getProjectionData({overscaledTileID:be,aligned:se,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),yt=Hu(Oe,Be,dt.fadeMix,a,E),$t=ae.getMeshFromTileID(U,be.canonical,x,b,"raster");H.draw(U,N.TRIANGLES,me,f?f[be.overscaledZ]:fi.disabled,oe,D?ri.frontCCW:ri.backCCW,yt,ft,rt,a.id,$t.vertexBuffer,$t.indexBuffer,$t.segments)}}function Ss(y,t,a,l){const f={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(a===0||l)return f;if(y.fadingParentID){const x=t.getLoadedTile(y.fadingParentID);if(!x)return f;const b=Math.pow(2,x.tileID.overscaledZ-y.tileID.overscaledZ),E=[y.tileID.canonical.x*b%1,y.tileID.canonical.y*b%1],D=(function(k,j,U){const N=xe(),H=(N-j.timeAdded)/U,Q=k.fadingDirection===ve.Incoming,ae=c.an((N-k.timeAdded)/U,0,1),oe=c.an(1-H,0,1),se=Q?ae:oe;return{tileOpacity:se,parentTileOpacity:Q?oe:ae,fadeMix:{opacity:1,mix:1-se}}})(y,x,a);return{parentTile:x,parentScaleBy:b,parentTopLeft:E,fadeValues:D}}if(y.selfFading){const x=(function(b,E){const D=(xe()-b.timeAdded)/E,k=c.an(D,0,1);return{tileOpacity:k,fadeMix:{opacity:k,mix:0}}})(y,a);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:x}}return f}const Ys=new c.bp(1,0,0,1),Ms=new c.bp(0,1,0,1),ih=new c.bp(0,0,1,1),nh=new c.bp(1,0,1,1),ca=new c.bp(0,1,1,1);function ac(y,t,a,l){Pn(y,0,t+a/2,y.transform.width,a,l)}function Ws(y,t,a,l){Pn(y,t-a/2,0,a,y.transform.height,l)}function Pn(y,t,a,l,f,x){const b=y.context,E=b.gl;E.enable(E.SCISSOR_TEST),E.scissor(t*y.pixelRatio,a*y.pixelRatio,l*y.pixelRatio,f*y.pixelRatio),b.clear({color:x}),E.disable(E.SCISSOR_TEST)}function su(y,t,a){const l=y.context,f=l.gl,x=y.useProgram("debug"),b=Yt.disabled,E=fi.disabled,D=y.colorModeForRenderPass(),k="$debug",j=y.style.map.terrain&&y.style.map.terrain.getTerrainData(a);l.activeTexture.set(f.TEXTURE0);const U=t.getTileByID(a.key).latestRawTileData,N=Math.floor((U&&U.byteLength||0)/1024),H=t.getTile(a).tileSize,Q=512/Math.min(H,512)*(a.overscaledZ/y.transform.zoom)*.5;let ae=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(ae+=` => ${a.overscaledZ}`),(function(se,he){se.initDebugOverlayCanvas();const ye=se.debugOverlayCanvas,ce=se.context.gl,ge=se.debugOverlayCanvas.getContext("2d");ge.clearRect(0,0,ye.width,ye.height),ge.shadowColor="white",ge.shadowBlur=2,ge.lineWidth=1.5,ge.strokeStyle="white",ge.textBaseline="top",ge.font="bold 36px Open Sans, sans-serif",ge.fillText(he,5,5),ge.strokeText(he,5,5),se.debugOverlayTexture.update(ye),se.debugOverlayTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE)})(y,`${ae} ${N}kB`);const oe=y.transform.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(l,f.TRIANGLES,b,E,Ci.alphaBlended,ri.disabled,Xc(c.bp.transparent,Q),null,oe,k,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),x.draw(l,f.LINE_STRIP,b,E,D,ri.disabled,Xc(c.bp.red),j,oe,k,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function rh(y,t,a,l){const{isRenderingGlobe:f}=l,x=y.context,b=x.gl,E=y.transform,D=y.colorModeForRenderPass(),k=y.getDepthModeFor3D(),j=y.useProgram("terrain");x.bindFramebuffer.set(null),x.viewport.set([0,0,y.width,y.height]);for(const U of a){const N=t.getTerrainMesh(U.tileID),H=y.renderToTexture.getTexture(U),Q=t.getTerrainData(U.tileID);x.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,H.texture);const ae=t.getMeshFrameDelta(E.zoom),oe=E.calculateFogMatrix(U.tileID.toUnwrapped()),se=gf(ae,oe,y.style.sky,E.pitch,f),he=E.getProjectionData({overscaledTileID:U.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});j.draw(x,b.TRIANGLES,k,fi.disabled,D,ri.backCCW,se,Q,he,"terrain",N.vertexBuffer,N.indexBuffer,N.segments)}}function sd(y,t){if(!t.mesh){const a=new c.aW;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(1,1),a.emplaceBack(-1,1);const l=new c.aY;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),t.mesh=new ji(y.createVertexBuffer(a,Ta.members),y.createIndexBuffer(l),c.aX.simpleSegment(0,0,a.length,l.length))}return t.mesh}class Mf{constructor(t,a){this.context=new zo(t),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ci.maxOverzooming+ci.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Zn}resize(t,a,l){if(this.width=Math.floor(t*l),this.height=Math.floor(a*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const t=this.context,a=new c.aW;a.emplaceBack(0,0),a.emplaceBack(c.a5,0),a.emplaceBack(0,c.a5),a.emplaceBack(c.a5,c.a5),this.tileExtentBuffer=t.createVertexBuffer(a,Ta.members),this.tileExtentSegments=c.aX.simpleSegment(0,0,4,2);const l=new c.aW;l.emplaceBack(0,0),l.emplaceBack(c.a5,0),l.emplaceBack(0,c.a5),l.emplaceBack(c.a5,c.a5),this.debugBuffer=t.createVertexBuffer(l,Ta.members),this.debugSegments=c.aX.simpleSegment(0,0,4,5);const f=new c.ch;f.emplaceBack(0,0,0,0),f.emplaceBack(c.a5,0,c.a5,0),f.emplaceBack(0,c.a5,0,c.a5),f.emplaceBack(c.a5,c.a5,c.a5,c.a5),this.rasterBoundsBuffer=t.createVertexBuffer(f,mf.members),this.rasterBoundsSegments=c.aX.simpleSegment(0,0,4,2);const x=new c.aW;x.emplaceBack(0,0),x.emplaceBack(c.a5,0),x.emplaceBack(0,c.a5),x.emplaceBack(c.a5,c.a5),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(x,Ta.members),this.rasterBoundsSegmentsPosOnly=c.aX.simpleSegment(0,0,4,5);const b=new c.aW;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(b,Ta.members),this.viewportSegments=c.aX.simpleSegment(0,0,4,2);const E=new c.ci;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(E);const D=new c.aY;D.emplaceBack(1,0,2),D.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(D);const k=this.context.gl;this.stencilClearMode=new fi({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.tileExtentMesh=new ji(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,a=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=c.N();c.c7(l,0,this.width,this.height,0,0,1),c.Q(l,l,[a.drawingBufferWidth,a.drawingBufferHeight,0]);const f={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(t,a.TRIANGLES,Yt.disabled,this.stencilClearMode,Ci.disabled,ri.disabled,null,null,f,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,a,l){if(this.currentStencilSource===t.source||!t.isTileClipped()||!a||!a.length)return;this.currentStencilSource=t.source,this.nextStencilID+a.length>256&&this.clearStencil();const f=this.context;f.setColorMode(Ci.disabled),f.setDepthMode(Yt.disabled);const x={};for(const b of a)x[b.key]=this.nextStencilID++;this._renderTileMasks(x,a,l,!0),this._renderTileMasks(x,a,l,!1),this._tileClippingMaskIDs=x}_renderTileMasks(t,a,l,f){const x=this.context,b=x.gl,E=this.style.projection,D=this.transform,k=this.useProgram("clippingMask");for(const j of a){const U=t[j.key],N=this.style.map.terrain&&this.style.map.terrain.getTerrainData(j),H=E.getMeshFromTileID(this.context,j.canonical,f,!0,"stencil"),Q=D.getProjectionData({overscaledTileID:j,applyGlobeMatrix:!l,applyTerrainMatrix:!0});k.draw(x,b.TRIANGLES,Yt.disabled,new fi({func:b.ALWAYS,mask:0},U,255,b.KEEP,b.KEEP,b.REPLACE),Ci.disabled,l?ri.disabled:ri.backCCW,null,N,Q,"$clipping",H.vertexBuffer,H.indexBuffer,H.segments)}}_renderTilesDepthBuffer(){const t=this.context,a=t.gl,l=this.style.projection,f=this.transform,x=this.useProgram("depth"),b=this.getDepthModeFor3D(),E=Zi(f,{tileSize:f.tileSize});for(const D of E){const k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(D),j=l.getMeshFromTileID(this.context,D.canonical,!0,!0,"raster"),U=f.getProjectionData({overscaledTileID:D,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(t,a.TRIANGLES,b,fi.disabled,Ci.disabled,ri.backCCW,null,k,U,"$clipping",j.vertexBuffer,j.indexBuffer,j.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,a=this.context.gl;return new fi({func:a.NOTEQUAL,mask:255},t,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(t){const a=this.context.gl;return new fi({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,a.KEEP,a.KEEP,a.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const a=this.context.gl,l=t.sort(((b,E)=>E.overscaledZ-b.overscaledZ)),f=l[l.length-1].overscaledZ,x=l[0].overscaledZ-f+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const b={};for(let E=0;E<x;E++)b[E+f]=new fi({func:a.GEQUAL,mask:255},E+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=x,[b,l]}return[{[f]:fi.disabled},l]}stencilConfigForOverlapTwoPass(t){const a=this.context.gl,l=t.sort(((b,E)=>E.overscaledZ-b.overscaledZ)),f=l[l.length-1].overscaledZ,x=l[0].overscaledZ-f+1;if(this.clearStencil(),x>1){const b={},E={};for(let D=0;D<x;D++)b[D+f]=new fi({func:a.GREATER,mask:255},x+1+D,255,a.KEEP,a.KEEP,a.REPLACE),E[D+f]=new fi({func:a.GREATER,mask:255},1+D,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID=2*x+1,[b,E,l]}return this.nextStencilID=3,[{[f]:new fi({func:a.GREATER,mask:255},2,255,a.KEEP,a.KEEP,a.REPLACE)},{[f]:new fi({func:a.GREATER,mask:255},1,255,a.KEEP,a.KEEP,a.REPLACE)},l]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Ci([t.CONSTANT_COLOR,t.ONE],new c.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ci.unblended:Ci.alphaBlended}getDepthModeForSublayer(t,a,l){if(!this.opaquePassEnabledForLayer())return Yt.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Yt(l||this.context.gl.LEQUAL,a,[f,f])}getDepthModeFor3D(){return new Yt(this.context.gl.LEQUAL,Yt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,a){var l,f;this.style=t,this.options=a,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(xe()),this.imageManager.beginFrame();const x=this.style._order,b=this.style.tileManagers,E={},D={},k={},j={isRenderingToTexture:!1,isRenderingGlobe:((l=t.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const N in b){const H=b[N];H.used&&H.prepare(this.context),E[N]=H.getVisibleCoordinates(!1),D[N]=E[N].slice().reverse(),k[N]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let N=0;N<x.length;N++)if(this.style._layers[x[N]].is3D()){this.opaquePassCutoff=N;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const N of x){const H=this.style._layers[N];if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const Q=D[H.source];(H.type==="custom"||Q.length)&&this.renderLayer(this,b[H.source],H,Q,j)}if((f=this.style.projection)===null||f===void 0||f.updateGPUdependent({context:this.context,useProgram:N=>this.useProgram(N)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.bp.black:c.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(N,H){const Q=N.context,ae=Q.gl,oe=((be,me,Me)=>{const Fe=Math.cos(me.rollInRadians),Le=Math.sin(me.rollInRadians),Be=$e(me),Oe=me.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:be.properties.get("sky-color"),u_horizon_color:be.properties.get("horizon-color"),u_horizon:[(me.width/2-Be*Le)*Me,(me.height/2+Be*Fe)*Me],u_horizon_normal:[-Le,Fe],u_sky_horizon_blend:be.properties.get("sky-horizon-blend")*me.height/2*Me,u_sky_blend:Oe}})(H,N.style.map.transform,N.pixelRatio),se=new Yt(ae.LEQUAL,Yt.ReadWrite,[0,1]),he=fi.disabled,ye=N.colorModeForRenderPass(),ce=N.useProgram("sky"),ge=sd(Q,H);ce.draw(Q,ae.TRIANGLES,se,he,ye,ri.disabled,oe,null,void 0,"sky",ge.vertexBuffer,ge.indexBuffer,ge.segments)})(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const N=this.style._layers[x[this.currentLayer]],H=b[N.source],Q=E[N.source];this._renderTileClippingMasks(N,Q,!1),this.renderLayer(this,H,N,Q,j)}this.renderPass="translucent";let U=!1;for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const N=this.style._layers[x[this.currentLayer]],H=b[N.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(N,j))continue;this.opaquePassEnabledForLayer()||U||(U=!0,j.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Q=(N.type==="symbol"?k:D)[N.source];this._renderTileClippingMasks(N,E[N.source],!!this.renderToTexture),this.renderLayer(this,H,N,Q,j)}if(j.isRenderingGlobe&&(function(N,H,Q){const ae=N.context,oe=ae.gl,se=N.useProgram("atmosphere"),he=new Yt(oe.LEQUAL,Yt.ReadOnly,[0,1]),ye=N.transform,ce=(function(Oe,dt){const ft=Oe.properties.get("position"),rt=[-ft.x,-ft.y,-ft.z],yt=c.ar(new Float64Array(16));return Oe.properties.get("anchor")==="map"&&(c.bg(yt,yt,dt.rollInRadians),c.bh(yt,yt,-dt.pitchInRadians),c.bg(yt,yt,dt.bearingInRadians),c.bh(yt,yt,dt.center.lat*Math.PI/180),c.bJ(yt,yt,-dt.center.lng*Math.PI/180)),c.cg(rt,rt,yt),rt})(Q,N.transform),ge=ye.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),be=H.properties.get("atmosphere-blend")*ge.projectionTransition;if(be===0)return;const me=il(ye.worldSize,ye.center.lat),Me=ye.inverseProjectionMatrix,Fe=new Float64Array(4);Fe[3]=1,c.aH(Fe,Fe,ye.modelViewProjectionMatrix),Fe[0]/=Fe[3],Fe[1]/=Fe[3],Fe[2]/=Fe[3],Fe[3]=1,c.aH(Fe,Fe,Me),Fe[0]/=Fe[3],Fe[1]/=Fe[3],Fe[2]/=Fe[3],Fe[3]=1;const Le=((Oe,dt,ft,rt,yt)=>({u_sun_pos:Oe,u_atmosphere_blend:dt,u_globe_position:ft,u_globe_radius:rt,u_inv_proj_matrix:yt}))(ce,be,[Fe[0],Fe[1],Fe[2]],me,Me),Be=sd(ae,H);se.draw(ae,oe.TRIANGLES,he,fi.disabled,Ci.alphaBlended,ri.disabled,Le,null,null,"atmosphere",Be.vertexBuffer,Be.indexBuffer,Be.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const N=(function(H,Q){let ae=null;const oe=Object.values(H._layers).flatMap((ce=>ce.source&&!ce.isHidden(Q)?[H.tileManagers[ce.source]]:[])),se=oe.filter((ce=>ce.getSource().type==="vector")),he=oe.filter((ce=>ce.getSource().type!=="vector")),ye=ce=>{(!ae||ae.getSource().maxzoom<ce.getSource().maxzoom)&&(ae=ce)};return se.forEach((ce=>ye(ce))),ae||he.forEach((ce=>ye(ce))),ae})(this.style,this.transform.zoom);N&&(function(H,Q,ae){for(let oe=0;oe<ae.length;oe++)su(H,Q,ae[oe])})(this,N,N.getVisibleCoordinates())}this.options.showPadding&&(function(N){const H=N.transform.padding;ac(N,N.transform.height-(H.top||0),3,Ys),ac(N,H.bottom||0,3,Ms),Ws(N,H.left||0,3,ih),Ws(N,N.transform.width-(H.right||0),3,nh);const Q=N.transform.centerPoint;(function(ae,oe,se,he){Pn(ae,oe-1,se-10,2,20,he),Pn(ae,oe-10,se-1,20,2,he)})(N,Q.x,N.transform.height-Q.y,ca)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=t?!c.cj(a,l):!c.ck(a,l)),f||(f=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),f&&(c.cl(a,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(x,b){const E=x.context,D=E.gl,k=x.transform,j=Ci.unblended,U=new Yt(D.LEQUAL,Yt.ReadWrite,[0,1]),N=b.tileManager.getRenderableTiles(),H=x.useProgram("terrainDepth");E.bindFramebuffer.set(b.getFramebuffer("depth").framebuffer),E.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),E.clear({color:c.bp.transparent,depth:1});for(const Q of N){const ae=b.getTerrainMesh(Q.tileID),oe=b.getTerrainData(Q.tileID),se=k.getProjectionData({overscaledTileID:Q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),he={u_ele_delta:b.getMeshFrameDelta(k.zoom)};H.draw(E,D.TRIANGLES,U,fi.disabled,j,ri.backCCW,he,oe,se,"terrain",ae.vertexBuffer,ae.indexBuffer,ae.segments)}E.bindFramebuffer.set(null),E.viewport.set([0,0,x.width,x.height])})(this,this.style.map.terrain),(function(x,b){const E=x.context,D=E.gl,k=x.transform,j=Ci.unblended,U=new Yt(D.LEQUAL,Yt.ReadWrite,[0,1]),N=b.getCoordsTexture(),H=b.tileManager.getRenderableTiles(),Q=x.useProgram("terrainCoords");E.bindFramebuffer.set(b.getFramebuffer("coords").framebuffer),E.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),E.clear({color:c.bp.transparent,depth:1}),b.coordsIndex=[];for(const ae of H){const oe=b.getTerrainMesh(ae.tileID),se=b.getTerrainData(ae.tileID);E.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,N.texture);const he={u_terrain_coords_id:(255-b.coordsIndex.length)/255,u_texture:0,u_ele_delta:b.getMeshFrameDelta(k.zoom)},ye=k.getProjectionData({overscaledTileID:ae.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Q.draw(E,D.TRIANGLES,U,fi.disabled,j,ri.backCCW,he,se,ye,"terrain",oe.vertexBuffer,oe.indexBuffer,oe.segments),b.coordsIndex.push(ae.tileID.key)}E.bindFramebuffer.set(null),E.viewport.set([0,0,x.width,x.height])})(this,this.style.map.terrain))}renderLayer(t,a,l,f,x){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(f||[]).length)&&(this.id=l.id,c.cm(l)?(function(b,E,D,k,j,U){if(b.renderPass!=="translucent")return;const{isRenderingToTexture:N}=U,H=fi.disabled,Q=b.colorModeForRenderPass();(D._unevaluatedLayout.hasValue("text-variable-anchor")||D._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(ae,oe,se,he,ye,ce,ge,be,me){const Me=oe.transform,Fe=oe.style.map.terrain,Le=ye==="map",Be=ce==="map";for(const Oe of ae){const dt=he.getTile(Oe),ft=dt.getBucket(se);if(!ft||!ft.text||!ft.text.segments.get().length)continue;const rt=c.ay(ft.textSizeData,Me.zoom),yt=c.aN(dt,1,oe.transform.zoom),$t=ta(Le,oe.transform,yt),Si=se.layout.get("icon-text-fit")!=="none"&&ft.hasIconData();if(rt){const Ui=Math.pow(2,Me.zoom-dt.tileID.overscaledZ),Oi=Fe?(Wi,Di)=>Fe.getElevation(Oe,Wi,Di):null;Zs(ft,Le,Be,me,Me,$t,Ui,rt,Si,c.aO(Me,dt,ge,be),Oe.toUnwrapped(),Oi)}}})(k,b,D,E,D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),j),D.paint.get("icon-opacity").constantOr(1)!==0&&ul(b,E,D,k,!1,D.paint.get("icon-translate"),D.paint.get("icon-translate-anchor"),D.layout.get("icon-rotation-alignment"),D.layout.get("icon-pitch-alignment"),D.layout.get("icon-keep-upright"),H,Q,N),D.paint.get("text-opacity").constantOr(1)!==0&&ul(b,E,D,k,!0,D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.layout.get("text-keep-upright"),H,Q,N),E.map.showCollisionBoxes&&(Jn(b,E,D,k,!0),Jn(b,E,D,k,!1))})(t,a,l,f,this.style.placement.variableOffsets,x):c.cn(l)?(function(b,E,D,k,j){if(b.renderPass!=="translucent")return;const{isRenderingToTexture:U}=j,N=D.paint.get("circle-opacity"),H=D.paint.get("circle-stroke-width"),Q=D.paint.get("circle-stroke-opacity"),ae=!D.layout.get("circle-sort-key").isConstant();if(N.constantOr(1)===0&&(H.constantOr(1)===0||Q.constantOr(1)===0))return;const oe=b.context,se=oe.gl,he=b.transform,ye=b.getDepthModeForSublayer(0,Yt.ReadOnly),ce=fi.disabled,ge=b.colorModeForRenderPass(),be=[],me=he.getCircleRadiusCorrection();for(let Me=0;Me<k.length;Me++){const Fe=k[Me],Le=E.getTile(Fe),Be=Le.getBucket(D);if(!Be)continue;const Oe=D.paint.get("circle-translate"),dt=D.paint.get("circle-translate-anchor"),ft=c.aO(he,Le,Oe,dt),rt=Be.programConfigurations.get(D.id),yt=b.useProgram("circle",rt),$t=Be.layoutVertexBuffer,Si=Be.indexBuffer,Ui=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Fe),Oi={programConfiguration:rt,program:yt,layoutVertexBuffer:$t,indexBuffer:Si,uniformValues:$c(b,Le,D,ft,me),terrainData:Ui,projectionData:he.getProjectionData({overscaledTileID:Fe,applyGlobeMatrix:!U,applyTerrainMatrix:!0})};if(ae){const Wi=Be.segments.get();for(const Di of Wi)be.push({segments:new c.aX([Di]),sortKey:Di.sortKey,state:Oi})}else be.push({segments:Be.segments,sortKey:0,state:Oi})}ae&&be.sort(((Me,Fe)=>Me.sortKey-Fe.sortKey));for(const Me of be){const{programConfiguration:Fe,program:Le,layoutVertexBuffer:Be,indexBuffer:Oe,uniformValues:dt,terrainData:ft,projectionData:rt}=Me.state;Le.draw(oe,se.TRIANGLES,ye,ce,ge,ri.backCCW,dt,ft,rt,D.id,Be,Oe,Me.segments,D.paint,b.transform.zoom,Fe)}})(t,a,l,f,x):c.co(l)?(function(b,E,D,k,j){if(D.paint.get("heatmap-opacity")===0)return;const U=b.context,{isRenderingToTexture:N,isRenderingGlobe:H}=j;if(b.style.map.terrain){for(const Q of k){const ae=E.getTile(Q);E.hasRenderableParent(Q)||(b.renderPass==="offscreen"?ad(b,ae,D,Q,H):b.renderPass==="translucent"&&er(b,D,Q,N,H))}U.viewport.set([0,0,b.width,b.height])}else b.renderPass==="offscreen"?(function(Q,ae,oe,se){const he=Q.context,ye=he.gl,ce=Q.transform,ge=fi.disabled,be=new Ci([ye.ONE,ye.ONE],c.bp.transparent,[!0,!0,!0,!0]);(function(me,Me,Fe){const Le=me.gl;me.activeTexture.set(Le.TEXTURE1),me.viewport.set([0,0,Me.width/4,Me.height/4]);let Be=Fe.heatmapFbos.get(c.cd);Be?(Le.bindTexture(Le.TEXTURE_2D,Be.colorAttachment.get()),me.bindFramebuffer.set(Be.framebuffer)):(Be=Bi(me,Me.width/4,Me.height/4),Fe.heatmapFbos.set(c.cd,Be))})(he,Q,oe),he.clear({color:c.bp.transparent});for(let me=0;me<se.length;me++){const Me=se[me];if(ae.hasRenderableParent(Me))continue;const Fe=ae.getTile(Me),Le=Fe.getBucket(oe);if(!Le)continue;const Be=Le.programConfigurations.get(oe.id),Oe=Q.useProgram("heatmap",Be),dt=ce.getProjectionData({overscaledTileID:Me,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),ft=ce.getCircleRadiusCorrection();Oe.draw(he,ye.TRIANGLES,Yt.disabled,ge,be,ri.backCCW,To(Fe,ce.zoom,oe.paint.get("heatmap-intensity"),ft),null,dt,oe.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,oe.paint,ce.zoom,Be)}he.viewport.set([0,0,Q.width,Q.height])})(b,E,D,k):b.renderPass==="translucent"&&(function(Q,ae){const oe=Q.context,se=oe.gl;oe.setColorMode(Q.colorModeForRenderPass());const he=ae.heatmapFbos.get(c.cd);he&&(oe.activeTexture.set(se.TEXTURE0),se.bindTexture(se.TEXTURE_2D,he.colorAttachment.get()),oe.activeTexture.set(se.TEXTURE1),ui(oe,ae).bind(se.LINEAR,se.CLAMP_TO_EDGE),Q.useProgram("heatmapTexture").draw(oe,se.TRIANGLES,Yt.disabled,fi.disabled,Q.colorModeForRenderPass(),ri.disabled,Qh(Q,ae,0,1),null,null,ae.id,Q.viewportBuffer,Q.quadTriangleIndexBuffer,Q.viewportSegments,ae.paint,Q.transform.zoom))})(b,D)})(t,a,l,f,x):c.cp(l)?(function(b,E,D,k,j){if(b.renderPass!=="translucent")return;const{isRenderingToTexture:U}=j,N=D.paint.get("line-opacity"),H=D.paint.get("line-width");if(N.constantOr(1)===0||H.constantOr(1)===0)return;const Q=b.getDepthModeForSublayer(0,Yt.ReadOnly),ae=b.colorModeForRenderPass(),oe=D.paint.get("line-dasharray"),se=oe.constantOr(1),he=D.paint.get("line-pattern"),ye=he.constantOr(1),ce=D.paint.get("line-gradient"),ge=D.getCrossfadeParameters();let be;be=ye?"linePattern":se&&ce?"lineGradientSDF":se?"lineSDF":ce?"lineGradient":"line";const me=b.context,Me=me.gl,Fe=b.transform;let Le=!0;for(const Be of k){const Oe=E.getTile(Be);if(ye&&!Oe.patternsLoaded())continue;const dt=Oe.getBucket(D);if(!dt)continue;const ft=dt.programConfigurations.get(D.id),rt=b.context.program.get(),yt=b.useProgram(be,ft),$t=Le||yt.program!==rt,Si=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Be),Ui=he.constantOr(null),Oi=oe&&oe.constantOr(null);if(Ui&&Oe.imageAtlas){const tr=Oe.imageAtlas,yn=tr.patternPositions[Ui.to.toString()],_n=tr.patternPositions[Ui.from.toString()];yn&&_n&&ft.setConstantPatternPositions(yn,_n)}else if(Oi){const tr=D.layout.get("line-cap")==="round",yn=b.lineAtlas.getDash(Oi.to,tr),_n=b.lineAtlas.getDash(Oi.from,tr);ft.setConstantDashPositions(yn,_n)}const Wi=Fe.getProjectionData({overscaledTileID:Be,applyGlobeMatrix:!U,applyTerrainMatrix:!0}),Di=Fe.getPixelScale();let hn;ye?(hn=Jh(b,Oe,D,Di,ge),la(me,Me,Oe,ft,ge)):se&&ce?(hn=So(b,Oe,D,Di,ge,dt.lineClipsArray.length),Vr(b,E,me,Me,D,dt,Be,ft,ge)):se?(hn=Or(b,Oe,D,Di,ge),cn(b,me,Me,ft,$t,ge)):ce?(hn=wf(b,Oe,D,Di,dt.lineClipsArray.length),Nr(b,E,me,Me,D,dt,Be)):hn=Wc(b,Oe,D,Di);const Ki=b.stencilModeForClipping(Be);yt.draw(me,Me.TRIANGLES,Q,Ki,ae,ri.disabled,hn,Si,Wi,D.id,dt.layoutVertexBuffer,dt.indexBuffer,dt.segments,D.paint,b.transform.zoom,ft,dt.layoutVertexBuffer2),Le=!1}})(t,a,l,f,x):c.cq(l)?(function(b,E,D,k,j){const U=D.paint.get("fill-color"),N=D.paint.get("fill-opacity");if(N.constantOr(1)===0)return;const{isRenderingToTexture:H}=j,Q=b.colorModeForRenderPass(),ae=D.paint.get("fill-pattern"),oe=b.opaquePassEnabledForLayer()&&!ae.constantOr(1)&&U.constantOr(c.bp.transparent).a===1&&N.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===oe){const se=b.getDepthModeForSublayer(1,b.renderPass==="opaque"?Yt.ReadWrite:Yt.ReadOnly);bs(b,E,D,k,se,Q,!1,H)}if(b.renderPass==="translucent"&&D.paint.get("fill-antialias")){const se=b.getDepthModeForSublayer(D.getPaintProperty("fill-outline-color")?2:0,Yt.ReadOnly);bs(b,E,D,k,se,Q,!0,H)}})(t,a,l,f,x):c.cr(l)?(function(b,E,D,k,j){const U=D.paint.get("fill-extrusion-opacity");if(U===0)return;const{isRenderingToTexture:N}=j;if(b.renderPass==="translucent"){const H=new Yt(b.context.gl.LEQUAL,Yt.ReadWrite,b.depthRangeFor3D);if(U!==1||D.paint.get("fill-extrusion-pattern").constantOr(1))ws(b,E,D,k,H,fi.disabled,Ci.disabled,N),ws(b,E,D,k,H,b.stencilModeFor3D(),b.colorModeForRenderPass(),N);else{const Q=b.colorModeForRenderPass();ws(b,E,D,k,H,fi.disabled,Q,N)}}})(t,a,l,f,x):c.cs(l)?(function(b,E,D,k,j){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent")return;const{isRenderingToTexture:U}=j,N=b.context,H=b.style.projection.useSubdivision,Q=b.getDepthModeForSublayer(0,Yt.ReadOnly),ae=b.colorModeForRenderPass();if(b.renderPass==="offscreen")(function(oe,se,he,ye,ce,ge,be){const me=oe.context,Me=me.gl;for(const Fe of he){const Le=se.getTile(Fe),Be=Le.dem;if(!Be||!Be.data||!Le.needsHillshadePrepare)continue;const Oe=Be.dim,dt=Be.stride,ft=Be.getPixels();if(me.activeTexture.set(Me.TEXTURE1),me.pixelStoreUnpackPremultiplyAlpha.set(!1),Le.demTexture=Le.demTexture||oe.getTileTexture(dt),Le.demTexture){const yt=Le.demTexture;yt.update(ft,{premultiply:!1}),yt.bind(Me.NEAREST,Me.CLAMP_TO_EDGE)}else Le.demTexture=new c.T(me,ft,Me.RGBA,{premultiply:!1}),Le.demTexture.bind(Me.NEAREST,Me.CLAMP_TO_EDGE);me.activeTexture.set(Me.TEXTURE0);let rt=Le.fbo;if(!rt){const yt=new c.T(me,{width:Oe,height:Oe,data:null},Me.RGBA);yt.bind(Me.LINEAR,Me.CLAMP_TO_EDGE),rt=Le.fbo=me.createFramebuffer(Oe,Oe,!0,!1),rt.colorAttachment.set(yt.texture)}me.bindFramebuffer.set(rt.framebuffer),me.viewport.set([0,0,Oe,Oe]),oe.useProgram("hillshadePrepare").draw(me,Me.TRIANGLES,ce,ge,be,ri.disabled,vf(Le.tileID,Be),null,null,ye.id,oe.rasterBoundsBuffer,oe.quadTriangleIndexBuffer,oe.rasterBoundsSegments),Le.needsHillshadePrepare=!1}})(b,E,k,D,Q,fi.disabled,ae),N.viewport.set([0,0,b.width,b.height]);else if(b.renderPass==="translucent")if(H){const[oe,se,he]=b.stencilConfigForOverlapTwoPass(k);Ts(b,E,D,he,oe,Q,ae,!1,U),Ts(b,E,D,he,se,Q,ae,!0,U)}else{const[oe,se]=b.getStencilConfigForOverlapAndUpdateStencilID(k);Ts(b,E,D,se,oe,Q,ae,!1,U)}})(t,a,l,f,x):c.ct(l)?(function(b,E,D,k,j){if(b.renderPass!=="translucent"||!k.length)return;const{isRenderingToTexture:U}=j,N=b.style.projection.useSubdivision,H=b.getDepthModeForSublayer(0,Yt.ReadOnly),Q=b.colorModeForRenderPass();if(N){const[ae,oe,se]=b.stencilConfigForOverlapTwoPass(k);$s(b,E,D,se,ae,H,Q,!1,U),$s(b,E,D,se,oe,H,Q,!0,U)}else{const[ae,oe]=b.getStencilConfigForOverlapAndUpdateStencilID(k);$s(b,E,D,oe,ae,H,Q,!1,U)}})(t,a,l,f,x):c.bU(l)?(function(b,E,D,k,j){if(b.renderPass!=="translucent"||D.paint.get("raster-opacity")===0||!k.length)return;const{isRenderingToTexture:U}=j,N=E.getSource(),H=b.style.projection.useSubdivision;if(N instanceof ea)Ca(b,E,D,k,null,!1,!1,N.tileCoords,N.flippedWindingOrder,U);else if(H){const[Q,ae,oe]=b.stencilConfigForOverlapTwoPass(k);Ca(b,E,D,oe,Q,!1,!0,Xs,!1,U),Ca(b,E,D,oe,ae,!0,!0,Xs,!1,U)}else{const[Q,ae]=b.getStencilConfigForOverlapAndUpdateStencilID(k);Ca(b,E,D,ae,Q,!1,!0,Xs,!1,U)}})(t,a,l,f,x):c.cu(l)?(function(b,E,D,k,j){const U=D.paint.get("background-color"),N=D.paint.get("background-opacity");if(N===0)return;const{isRenderingToTexture:H}=j,Q=b.context,ae=Q.gl,oe=b.style.projection,se=b.transform,he=se.tileSize,ye=D.paint.get("background-pattern");if(b.isPatternMissing(ye))return;const ce=!ye&&U.a===1&&N===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==ce)return;const ge=fi.disabled,be=b.getDepthModeForSublayer(0,ce==="opaque"?Yt.ReadWrite:Yt.ReadOnly),me=b.colorModeForRenderPass(),Me=b.useProgram(ye?"backgroundPattern":"background"),Fe=k||Zi(se,{tileSize:he,terrain:b.style.map.terrain});ye&&(Q.activeTexture.set(ae.TEXTURE0),b.imageManager.bind(b.context));const Le=D.getCrossfadeParameters();for(const Be of Fe){const Oe=se.getProjectionData({overscaledTileID:Be,applyGlobeMatrix:!H,applyTerrainMatrix:!0}),dt=ye?eu(N,b,ye,{tileID:Be,tileSize:he},Le):Jc(N,U),ft=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Be),rt=oe.getMeshFromTileID(Q,Be.canonical,!1,!0,"raster");Me.draw(Q,ae.TRIANGLES,be,ge,me,ri.backCCW,dt,ft,Oe,D.id,rt.vertexBuffer,rt.indexBuffer,rt.segments)}})(t,0,l,f,x):c.cv(l)&&(function(b,E,D,k){const{isRenderingGlobe:j}=k,U=b.context,N=D.implementation,H=b.style.projection,Q=b.transform,ae=Q.getProjectionDataForCustomLayer(j),oe={farZ:Q.farZ,nearZ:Q.nearZ,fov:Q.fov*Math.PI/180,modelViewProjectionMatrix:Q.modelViewProjectionMatrix,projectionMatrix:Q.projectionMatrix,shaderData:{variantName:H.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${H.shaderPreludeCode.vertexSource}`,define:H.shaderDefine},defaultProjectionData:ae},se=N.renderingMode?N.renderingMode:"2d";if(b.renderPass==="offscreen"){const he=N.prerender;he&&(b.setCustomLayerDefaults(),U.setColorMode(b.colorModeForRenderPass()),he.call(N,U.gl,oe),U.setDirty(),b.setBaseState())}else if(b.renderPass==="translucent"){b.setCustomLayerDefaults(),U.setColorMode(b.colorModeForRenderPass()),U.setStencilMode(fi.disabled);const he=se==="3d"?b.getDepthModeFor3D():b.getDepthModeForSublayer(0,Yt.ReadOnly);U.setDepthMode(he),N.render(U.gl,oe),U.setDirty(),b.setBaseState(),U.bindFramebuffer.set(null)}})(t,0,l,x))}saveTileTexture(t){const a=this._tileTextures[t.size[0]];a?a.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const a=this._tileTextures[t];return a&&a.length>0?a.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const a=this.imageManager.getPattern(t.from.toString()),l=this.imageManager.getPattern(t.to.toString());return!a||!l}useProgram(t,a,l=!1,f=[]){this.cache=this.cache||{};const x=!!this.style.map.terrain,b=this.style.projection,E=l?Qi.projectionMercator:b.shaderPreludeCode,D=l?pn:b.shaderDefine,k=t+(a?a.cacheKey:"")+`/${l?Cr:b.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(x?"/terrain":"")+(f?`/${f.join("/")}`:"");return this.cache[k]||(this.cache[k]=new yf(this.context,Qi[t],a,Tf[t],this._showOverdrawInspector,x,E,D,f)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var t,a;if(this._tileTextures){for(const l in this._tileTextures){const f=this._tileTextures[l];if(f)for(const x of f)x.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((t=this.tileExtentMesh.vertexBuffer)===null||t===void 0||t.destroy()),this.tileExtentMesh&&((a=this.tileExtentMesh.indexBuffer)===null||a===void 0||a.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const l in this.cache){const f=this.cache[l];f&&f.program&&this.context.gl.deleteProgram(f.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:a}=this.context.gl;return this.width!==t||this.height!==a}}function od(y,t){let a,l=!1,f=null,x=null;const b=()=>{f=null,l&&(y.apply(x,a),f=setTimeout(b,t),l=!1)};return(...E)=>(l=!0,x=this,a=E,f||b(),f)}class Mn{constructor(t){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let l;return a.split("&").map((f=>f.split("="))).forEach((f=>{f[0]===this._hashName&&(l=f)})),(l&&l[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(!this._isValidHash(a))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:l,pitch:+(a[4]||0)}),!0},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const l=a.join("/");let f=l;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${l}`);let x=window.location.hash.replace(f,"");x.startsWith("#&")?x=x.slice(0,1)+x.slice(2):x==="#"&&(x="");let b=window.location.href.replace(/(#.+)?$/,x);b=b.replace("&&","&"),window.history.replaceState(window.history.state,null,b)},this._updateHash=od(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const a=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,f=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,f),b=Math.round(a.lng*x)/x,E=Math.round(a.lat*x)/x,D=this._map.getBearing(),k=this._map.getPitch();let j="";if(j+=t?`/${b}/${E}/${l}`:`${l}/${E}/${b}`,(D||k)&&(j+="/"+Math.round(10*D)/10),k&&(j+=`/${Math.round(k)}`),this._hashName){const U=this._hashName;let N=!1;const H=window.location.hash.slice(1).split("&").map((Q=>{const ae=Q.split("=")[0];return ae===U?(N=!0,`${ae}=${j}`):Q})).filter((Q=>Q));return N||H.push(`${U}=${j}`),`#${H.join("&")}`}return`#${j}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new c.V(+t[2],+t[1])}catch{return!1}const a=+t[0],l=+(t[3]||0),f=+(t[4]||0);return a>=this._map.getMinZoom()&&a<=this._map.getMaxZoom()&&l>=-180&&l<=180&&f>=this._map.getMinPitch()&&f<=this._map.getMaxPitch()}}const Es={linearity:.3,easing:c.cw(0,0,.3,1)},sc=c.e({deceleration:2500,maxSpeed:1400},Es),xr=c.e({deceleration:20,maxSpeed:1400},Es),ua=c.e({deceleration:1e3,maxSpeed:360},Es),hl=c.e({deceleration:1e3,maxSpeed:90},Es),vr=c.e({deceleration:1e3,maxSpeed:360},Es);class Gp{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:xe(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,a=xe();for(;t.length>0&&a-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)a.zoom+=x.zoomDelta||0,a.bearing+=x.bearingDelta||0,a.pitch+=x.pitchDelta||0,a.roll+=x.rollDelta||0,x.panDelta&&a.pan._add(x.panDelta),x.around&&(a.around=x.around),x.pinchAround&&(a.pinchAround=x.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(a.pan.mag()){const x=ou(a.pan.mag(),l,c.e({},sc,t||{})),b=a.pan.mult(x.amount/a.pan.mag()),E=this._map.cameraHelper.handlePanInertia(b,this._map.transform);f.center=E.easingCenter,f.offset=E.easingOffset,oc(f,x)}if(a.zoom){const x=ou(a.zoom,l,xr),b=c.cx(this._map.transform.zoom+x.amount,this._map.getZoomSnap(),x.amount);f.zoom=b,oc(f,x)}if(a.bearing){const x=ou(a.bearing,l,ua);f.bearing=this._map.transform.bearing+c.an(x.amount,-179,179),oc(f,x)}if(a.pitch){const x=ou(a.pitch,l,hl);f.pitch=this._map.transform.pitch+x.amount,oc(f,x)}if(a.roll){const x=ou(a.roll,l,vr);f.roll=this._map.transform.roll+c.an(x.amount,-179,179),oc(f,x)}if(f.zoom||f.bearing){const x=a.pinchAround===void 0?a.around:a.pinchAround;f.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),c.e(f,{noMoveStart:!0})}}function oc(y,t){(!y.duration||y.duration<t.duration)&&(y.duration=t.duration,y.easing=t.easing)}function ou(y,t,a){const{maxSpeed:l,linearity:f,deceleration:x}=a,b=c.an(y*f/(t/1e3),-l,l),E=Math.abs(b)/(x*f);return{easing:a.easing,duration:1e3*E,amount:b*(E/2)}}class Xn extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,l,f={}){l=l instanceof MouseEvent?l:new MouseEvent(t,l);const x=le.mousePos(a.getCanvas(),l),b=a.unproject(x);super(t,c.e({point:x,lngLat:b,originalEvent:l},f)),this._defaultPrevented=!1,this.target=a}}class $a extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,l){const f=t==="touchend"?l.changedTouches:l.touches,x=le.touchPos(a.getCanvasContainer(),f),b=x.map((D=>a.unproject(D))),E=x.reduce(((D,k,j,U)=>D.add(k.div(U.length))),new c.P(0,0));super(t,{points:x,point:E,lngLats:b,lngLat:a.unproject(E),originalEvent:l}),this._defaultPrevented=!1}}class ah extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,l){super(t,{originalEvent:l}),this._defaultPrevented=!1}}class sh{constructor(t,a){this._map=t,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new ah(t.type,this._map,t))}mousedown(t,a){return this._mousedownPos=a,this._firePreventable(new Xn(t.type,this._map,t))}mouseup(t){this._map.fire(new Xn(t.type,this._map,t))}click(t,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Xn(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Xn(t.type,this._map,t))}mouseover(t){this._map.fire(new Xn(t.type,this._map,t))}mouseout(t){this._map.fire(new Xn(t.type,this._map,t))}touchstart(t){return this._firePreventable(new $a(t.type,this._map,t))}touchmove(t){this._map.fire(new $a(t.type,this._map,t))}touchend(t){this._map.fire(new $a(t.type,this._map,t))}touchcancel(t){this._map.fire(new $a(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ef{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Xn(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Xn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Xn(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Xa{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(c.P.convert(t),this._map.terrain)}}class Po{constructor(t,a){this._map=t,this._tr=new Xa(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,a){this.isEnabled()&&t.shiftKey&&t.button===0&&(le.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(t,a){if(!this._active)return;const l=a;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=l,this._box||(this._box=le.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const x=Math.min(f.x,l.x),b=Math.max(f.x,l.x),E=Math.min(f.y,l.y),D=Math.max(f.y,l.y);le.setTransform(this._box,`translate(${x}px,${E}px)`),this._box.style.width=b-x+"px",this._box.style.height=D-E+"px"}mouseupWindow(t,a){if(!this._active||t.button!==0)return;const l=this._startPos,f=a;if(this.reset(),le.suppressClick(),l.x!==f.x||l.y!==f.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:t})),{cameraAnimation:x=>x.fitScreenCoordinates(l,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(le.remove(this._box),this._box=null),le.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,a){return this._map.fire(new c.l(t,{originalEvent:a}))}}function Ur(y,t){if(y.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${t.length}`);const a={};for(let l=0;l<y.length;l++)a[y[l].identifier]=t[l];return a}class wt{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,a,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),l.length===this.numTouches&&(this.centroid=(function(f){const x=new c.P(0,0);for(const b of f)x._add(b);return x.div(f.length)})(a),this.touches=Ur(l,a)))}touchmove(t,a,l){if(this.aborted||!this.centroid)return;const f=Ur(l,a);for(const x in this.touches){const b=f[x];(!b||b.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(t,a,l){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class lu{constructor(t){this.singleTap=new wt(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,a,l){this.singleTap.touchstart(t,a,l)}touchmove(t,a,l){this.singleTap.touchmove(t,a,l)}touchend(t,a,l){const f=this.singleTap.touchend(t,a,l);if(f){const x=t.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(f)<30;if(x&&b||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class oh{constructor(t){this._tr=new Xa(t),this._zoomIn=new lu({numTouches:1,numTaps:2}),this._zoomOut=new lu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,a,l){this._zoomIn.touchstart(t,a,l),this._zoomOut.touchstart(t,a,l)}touchmove(t,a,l){this._zoomIn.touchmove(t,a,l),this._zoomOut.touchmove(t,a,l)}touchend(t,a,l){const f=this._zoomIn.touchend(t,a,l),x=this._zoomOut.touchend(t,a,l),b=this._tr;return f?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:c.cx(b.zoom+1,E.getZoomSnap()),around:b.unproject(f)},{originalEvent:t})}):x?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:c.cx(b.zoom-1,E.getZoomSnap()),around:b.unproject(x)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Da{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const a=this._moveFunction(...t);if(a.bearingDelta||a.pitchDelta||a.rollDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(t,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(a)?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,a){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const f=Array.isArray(a)?a[0]:a;return!this._moved&&f.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(l,f))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&le.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ya=0,lc=2,lh={[Ya]:1,[lc]:2};class As{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const a=le.mouseButton(t);this._eventButton=a}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!(function(a,l){const f=lh[l];return a.buttons===void 0||(a.buttons&f)!==f})(t,this._eventButton)}isValidEndEvent(t){return le.mouseButton(t)===this._eventButton}}class dl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class cu{constructor(t=new As({checkCorrectEvent:()=>!0}),a=new dl){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=a}_executeRelevantHandler(t,a,l){return t instanceof MouseEvent?a(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?l(t):void 0}startMove(t){this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.startMove(a)),(a=>this.oneFingerTouchMoveStateManager.startMove(a)))}endMove(t){this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.endMove(a)),(a=>this.oneFingerTouchMoveStateManager.endMove(a)))}isValidStartEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidStartEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidStartEvent(a)))}isValidMoveEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidMoveEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(a)))}isValidEndEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidEndEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidEndEvent(a)))}}const Cs=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=t=>{t.preventDefault()}};class ch{constructor(t,a){this._clickTolerance=t.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,a,l){return this._calculateTransform(t,a,l)}touchmove(t,a,l){if(this._active){if(!this._shouldBePrevented(l.length))return t.preventDefault(),this._calculateTransform(t,a,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,a,l){this._calculateTransform(t,a,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,a,l){l.length>0&&(this._active=!0);const f=Ur(l,a),x=new c.P(0,0),b=new c.P(0,0);let E=0;for(const k in f){const j=f[k],U=this._touches[k];U&&(x._add(j),b._add(j.sub(U)),E++,f[k]=j)}if(this._touches=f,this._shouldBePrevented(E)||!b.mag())return;const D=b.div(E);return this._sum._add(D),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(E),panDelta:D}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class uu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,a,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([a[0],a[1]]))}touchmove(t,a,l){if(!this._firstTwoTouches)return;t.preventDefault();const[f,x]=this._firstTwoTouches,b=Ds(l,a,f),E=Ds(l,a,x);if(!b||!E)return;const D=this._aroundCenter?null:b.add(E).div(2);return this._move([b,E],D,t)}touchend(t,a,l){if(!this._firstTwoTouches)return;const[f,x]=this._firstTwoTouches,b=Ds(l,a,f),E=Ds(l,a,x);b&&E||(this._active&&le.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ds(y,t,a){for(let l=0;l<y.length;l++)if(y[l].identifier===a)return t[l]}function ld(y,t){return Math.log(y/t)/Math.LN2}class zs extends uu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,a){const l=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(ld(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ld(this._distance,l),pinchAround:a}}}function uh(y,t){return 180*y.angleWith(t)/Math.PI}class hu extends uu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,a,l){const f=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:uh(this._vector,f),pinchAround:a}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const a=25/(Math.PI*this._minDiameter)*360,l=uh(t,this._startVector);return Math.abs(l)<a}}function Ps(y){return Math.abs(y.y)>Math.abs(y.x)}class Ks extends uu{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,a,l){super.touchstart(t,a,l),this._currentTouchCount=l.length}_start(t){this._lastPoints=t,Ps(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,a,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=t[0].sub(this._lastPoints[0]),x=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,x,l.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(f.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(t,a,l){if(this._valid!==void 0)return this._valid;const f=t.mag()>=2,x=a.mag()>=2;if(!f&&!x)return;if(!f||!x)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const b=t.y>0==a.y>0;return Ps(t)&&Ps(a)&&b}}const za={panStep:100,bearingStep:15,pitchStep:10};class Mi{constructor(t){this._tr=new Xa(t);const a=za;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let a=0,l=0,f=0,x=0,b=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:t.shiftKey?l=-1:(t.preventDefault(),x=-1);break;case 39:t.shiftKey?l=1:(t.preventDefault(),x=1);break;case 38:t.shiftKey?f=1:(t.preventDefault(),b=-1);break;case 40:t.shiftKey?f=-1:(t.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(l=0,f=0),{cameraAnimation:E=>{const D=this._tr;E.easeTo({duration:300,easeId:"keyboardHandler",easing:cd,zoom:a?c.cx(D.zoom+a*(t.shiftKey?2:1),E.getZoomSnap()):D.zoom,bearing:D.bearing+l*this._bearingStep,pitch:D.pitch+f*this._pitchStep,offset:[-x*this._panStep,-b*this._panStep],center:D.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function cd(y){return y*(2-y)}const Qs=4.000244140625,Io=1/450;class du{constructor(t,a){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=t,this._tr=new Xa(t),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Io}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let a=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const l=xe(),f=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,a!==0&&a%Qs==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(f*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),t.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=t,this._delta-=a,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=le.mousePos(this._map.getCanvas(),t),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(c.V.convert(l.center)):a,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const E=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=E),typeof this._targetZoom=="number"&&(this._targetZoom+=E)}if(this._delta!==0){const E=this._type==="wheel"&&Math.abs(this._delta)>Qs?this._wheelZoomRate:this._defaultZoomRate;let D=2/(1+Math.exp(-Math.abs(this._delta*E)));this._delta<0&&D!==0&&(D=1/D);const k=typeof this._targetZoom!="number"?t.scale:c.aq(this._targetZoom),j=t.applyConstrain(t.getCameraLngLat(),c.at(k*D)).zoom,U=this._map.getZoomSnap();if(this._type==="wheel"&&U>0){const N=c.cx(t.zoom,U);this._targetZoom=c.cx(j,U,j-N)}else this._targetZoom=j;this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,l=this._startZoom,f=this._easing;let x,b=!1;if(this._type==="wheel"&&l&&f){const E=xe()-this._lastWheelEventTime,D=Math.min((E+5)/200,1),k=f(D);x=c.G.number(l,a,k),D<1?this._frameId||(this._frameId=!0):b=!0}else x=a,b=!0;return this._active=!0,b&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=x,{noInertia:!0,needsRenderFrame:!b,zoomDelta:x-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let a=c.cz;if(this._prevEase){const l=this._prevEase,f=(xe()-l.start)/l.duration,x=l.easing(f+.01)-l.easing(f),b=.27/Math.sqrt(x*x+1e-4)*.01,E=Math.sqrt(.0729-b*b);a=c.cw(b,E,.25,1)}return this._prevEase={start:xe(),duration:t,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class hh{constructor(t,a){this._clickZoom=t,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class fl{constructor(t){this._tr=new Xa(t),this.reset()}reset(){this._active=!1}dblclick(t,a){return t.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:c.cx(this._tr.zoom+(t.shiftKey?-1:1),l.getZoomSnap()),around:this._tr.unproject(a)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fu{constructor(){this._tap=new lu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,a,l){if(!this._swipePoint)if(this._tapTime){const f=a[0],x=t.timeStamp-this._tapTime<500,b=this._tapPoint.dist(f)<30;x&&b?l.length>0&&(this._swipePoint=f,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(t,a,l)}touchmove(t,a,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const f=a[0],x=f.y-this._swipePoint.y;return this._swipePoint=f,t.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(t,a,l)}touchend(t,a,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const f=this._tap.touchend(t,a,l);f&&(this._tapTime=t.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ud{constructor(t,a,l){this._el=t,this._mousePan=a,this._touchPan=l}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ha{constructor(t,a,l,f){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=a,this._mousePitch=l,this._mouseRoll=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class pl{constructor(t,a,l,f){this._el=t,this._touchZoom=a,this._touchRotate=l,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Tt{constructor(t,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=le.create("div","maplibregl-cooperative-gesture-screen",t);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=a,this._container.appendChild(f);const x=document.createElement("div");x.className="maplibregl-mobile-message",x.textContent=l,this._container.appendChild(x),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(le.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,a){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:t,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Ct=y=>y.zoom||y.drag||y.roll||y.pitch||y.rotate;class Pa extends c.l{}function cc(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta||y.rollDelta}class pu{get _ownerDocument(){var t;return((t=this._el)===null||t===void 0?void 0:t.ownerDocument)||document}get _ownerWindow(){var t,a;return((a=(t=this._el)===null||t===void 0?void 0:t.ownerDocument)===null||a===void 0?void 0:a.defaultView)||window}constructor(t,a){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,x)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const b=f.type==="renderFrame"?void 0:f,E={needsRenderFrame:!1},D={},k={};for(const{handlerName:N,handler:H,allowed:Q}of this._handlers){if(!H.isEnabled())continue;let ae;if(this._blockedByActive(k,Q,N))H.reset();else if(H[x||f.type]){if(c.cA(f,x||f.type)){const oe=le.mousePos(this._map.getCanvas(),f);ae=H[x||f.type](f,oe)}else if(c.cB(f,x||f.type)){const oe=this._getMapTouches(f.touches),se=le.touchPos(this._map.getCanvas(),oe);ae=H[x||f.type](f,se,oe)}else c.cC(x||f.type)||(ae=H[x||f.type](f));this.mergeHandlerResult(E,D,ae,N,b),ae&&ae.needsRenderFrame&&this._triggerRenderFrame()}(ae||H.isActive())&&(k[N]=H)}const j={};for(const N in this._previousActiveHandlers)k[N]||(j[N]=b);this._previousActiveHandlers=k,(Object.keys(j).length||cc(E))&&(this._changes.push([E,D,j]),this._triggerRenderFrame()),(Object.keys(k).length||cc(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:U}=E;U&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],U(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Gp(t),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[this._ownerDocument,"mousemove",{capture:!0}],[this._ownerDocument,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[this._ownerWindow,"blur",void 0]];for(const[f,x,b]of this._listeners)le.addEventListener(f,x,f===this._ownerDocument?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[t,a,l]of this._listeners)le.removeEventListener(t,a,t===this._ownerDocument?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(t){const a=this._map,l=a.getCanvasContainer();this._add("mapEvent",new sh(a,t));const f=a.boxZoom=new Po(a,t);this._add("boxZoom",f),t.interactive&&t.boxZoom&&f.enable();const x=a.cooperativeGestures=new Tt(a,t.cooperativeGestures);this._add("cooperativeGestures",x),t.cooperativeGestures&&x.enable();const b=new oh(a),E=new fl(a);a.doubleClickZoom=new hh(E,b),this._add("tapZoom",b),this._add("clickZoom",E),t.interactive&&t.doubleClickZoom&&a.doubleClickZoom.enable();const D=new fu;this._add("tapDragZoom",D);const k=a.touchPitch=new Ks(a);this._add("touchPitch",k),t.interactive&&t.touchPitch&&a.touchPitch.enable(t.touchPitch);const j=()=>a.project(a.getCenter()),U=(function({enable:ce,clickTolerance:ge,aroundCenter:be=!0,minPixelCenterThreshold:me=100,rotateDegreesPerPixelMoved:Me=.8},Fe){const Le=new As({checkCorrectEvent:Be=>le.mouseButton(Be)===0&&Be.ctrlKey||le.mouseButton(Be)===2&&!Be.ctrlKey});return new Da({clickTolerance:ge,move:(Be,Oe)=>{const dt=Fe();if(be&&Math.abs(dt.y-Be.y)>me)return{bearingDelta:c.cy(new c.P(Be.x,Oe.y),Oe,dt)};let ft=(Oe.x-Be.x)*Me;return be&&Oe.y<dt.y&&(ft=-ft),{bearingDelta:ft}},moveStateManager:Le,enable:ce,assignEvents:Cs})})(t,j),N=(function({enable:ce,clickTolerance:ge,pitchDegreesPerPixelMoved:be=-.5}){const me=new As({checkCorrectEvent:Me=>le.mouseButton(Me)===0&&Me.ctrlKey||le.mouseButton(Me)===2});return new Da({clickTolerance:ge,move:(Me,Fe)=>({pitchDelta:(Fe.y-Me.y)*be}),moveStateManager:me,enable:ce,assignEvents:Cs})})(t),H=(function({enable:ce,clickTolerance:ge,rollDegreesPerPixelMoved:be=.3},me){const Me=new As({checkCorrectEvent:Fe=>le.mouseButton(Fe)===2&&Fe.ctrlKey});return new Da({clickTolerance:ge,move:(Fe,Le)=>{const Be=me();let Oe=(Le.x-Fe.x)*be;return Le.y<Be.y&&(Oe=-Oe),{rollDelta:Oe}},moveStateManager:Me,enable:ce,assignEvents:Cs})})(t,j);a.dragRotate=new ha(t,U,N,H),this._add("mouseRotate",U,["mousePitch"]),this._add("mousePitch",N,["mouseRotate","mouseRoll"]),this._add("mouseRoll",H,["mousePitch"]),t.interactive&&t.dragRotate&&a.dragRotate.enable();const Q=(function({enable:ce,clickTolerance:ge}){const be=new As({checkCorrectEvent:me=>le.mouseButton(me)===0&&!me.ctrlKey});return new Da({clickTolerance:ge,move:(me,Me)=>({around:Me,panDelta:Me.sub(me)}),activateOnStart:!0,moveStateManager:be,enable:ce,assignEvents:Cs})})(t),ae=new ch(t,a);a.dragPan=new ud(l,Q,ae),this._add("mousePan",Q),this._add("touchPan",ae,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&a.dragPan.enable(t.dragPan);const oe=new hu,se=new zs;a.touchZoomRotate=new pl(l,se,oe,D),this._add("touchRotate",oe,["touchPan","touchZoom"]),this._add("touchZoom",se,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&a.touchZoomRotate.enable(t.touchZoomRotate),this._add("blockableMapEvent",new Ef(a));const he=a.scrollZoom=new du(a,(()=>this._triggerRenderFrame()));this._add("scrollZoom",he,["mousePan"]),t.interactive&&t.scrollZoom&&a.scrollZoom.enable(t.scrollZoom);const ye=a.keyboard=new Mi(a);this._add("keyboard",ye),t.interactive&&t.keyboard&&a.keyboard.enable()}_add(t,a,l){this._handlers.push({handlerName:t,handler:a,allowed:l}),this._handlersById[t]=a}stop(t){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ct(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,a,l){for(const f in t)if(f!==l&&(!a||a.indexOf(f)<0))return!0;return!1}_getMapTouches(t){const a=[];for(const l of t)this._el.contains(l.target)&&a.push(l);return a}mergeHandlerResult(t,a,l,f,x){if(!l)return;c.e(t,l);const b={handlerName:f,originalEvent:l.originalEvent||x};l.zoomDelta!==void 0&&(a.zoom=b),l.panDelta!==void 0&&(a.drag=b),l.rollDelta!==void 0&&(a.roll=b),l.pitchDelta!==void 0&&(a.pitch=b),l.bearingDelta!==void 0&&(a.rotate=b)}_applyChanges(){const t={},a={},l={};for(const[f,x,b]of this._changes)f.panDelta&&(t.panDelta=(t.panDelta||new c.P(0,0))._add(f.panDelta)),f.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+f.pitchDelta),f.rollDelta&&(t.rollDelta=(t.rollDelta||0)+f.rollDelta),f.around!==void 0&&(t.around=f.around),f.pinchAround!==void 0&&(t.pinchAround=f.pinchAround),f.noInertia&&(t.noInertia=f.noInertia),c.e(a,x),c.e(l,b);this._updateMapTransform(t,a,l),this._changes=[]}_updateMapTransform(t,a,l){const f=this._map,x=f._getTransformForUpdate(),b=f.terrain;if(!(cc(t)||b&&this._terrainMovement))return this._fireEvents(a,l,!0);f._stop(!0);let{panDelta:E,zoomDelta:D,bearingDelta:k,pitchDelta:j,rollDelta:U,around:N,pinchAround:H}=t;H!==void 0&&(N=H),N=N||f.transform.centerPoint,b&&!x.isPointOnMapSurface(N)&&(N=x.centerPoint);const Q={panDelta:E,zoomDelta:D,rollDelta:U,pitchDelta:j,bearingDelta:k,around:N};this._map.cameraHelper.useGlobeControls&&!x.isPointOnMapSurface(N)&&(N=x.centerPoint);const ae=N.distSqr(x.centerPoint)<.01?x.center:x.screenPointToLocation(E?N.sub(E):N);this._handleMapControls({terrain:b,tr:x,deltasForHelper:Q,preZoomAroundLoc:ae,combinedEventsInProgress:a,panDelta:E}),f._applyUpdatedTransform(x),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(a,l,!0)}_handleMapControls({terrain:t,tr:a,deltasForHelper:l,preZoomAroundLoc:f,combinedEventsInProgress:x,panDelta:b}){const E=this._map.cameraHelper;if(E.handleMapControlsRollPitchBearingZoom(l,a),t)return E.useGlobeControls?(this._terrainMovement||!x.drag&&!x.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void E.handleMapControlsPan(l,a,f)):this._terrainMovement||!x.drag&&!x.zoom?void(x.drag&&this._terrainMovement&&b?a.setCenter(a.screenPointToLocation(a.centerPoint.sub(b))):E.handleMapControlsPan(l,a,f)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void E.handleMapControlsPan(l,a,f));E.handleMapControlsPan(l,a,f)}_fireEvents(t,a,l){const f=Ct(this._eventsInProgress),x=Ct(t),b={};for(const U in t){const{originalEvent:N}=t[U];this._eventsInProgress[U]||(b[`${U}start`]=N),this._eventsInProgress[U]=t[U]}!f&&x&&this._fireEvent("movestart",x.originalEvent);for(const U in b)this._fireEvent(U,b[U]);x&&this._fireEvent("move",x.originalEvent);for(const U in t){const{originalEvent:N}=t[U];this._fireEvent(U,N)}const E={};let D;for(const U in this._eventsInProgress){const{handlerName:N,originalEvent:H}=this._eventsInProgress[U];this._handlersById[N].isActive()||(delete this._eventsInProgress[U],D=a[N]||H,E[`${U}end`]=D)}for(const U in E)this._fireEvent(U,E[U]);const k=Ct(this._eventsInProgress),j=(f||x)&&!k;if(j&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const U=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&U.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(U)}if(l&&j){this._updatingCamera=!0;const U=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;!U||!U.essential&&De.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:D})),N(this._map.getBearing())&&this._map.resetNorth()):(N(U.bearing||this._map.getBearing())&&(U.bearing=0),U.freezeElevation=!0,this._map.easeTo(U,{originalEvent:D})),this._updatingCamera=!1}}_fireEvent(t,a){this._map.fire(new c.l(t,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new Pa("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class En extends c.E{constructor(t,a,l){super(),this._renderFrameCallback=()=>{const f=Math.min((xe()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=l.bearingSnap,this._zoomSnap=l.zoomSnap,this.cameraHelper=a,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(t,a){t.apply(this.transform,!0),this.transform=t,this.cameraHelper=a}getCenter(){return new c.V(this.transform.center.lng,this.transform.center.lat)}setCenter(t,a){return this.jumpTo({center:t},a)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,a){return this.jumpTo({elevation:t},a),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,a,l){return t=c.P.convert(t).mult(-1),this.panTo(this.transform.center,c.e({offset:t},a),l)}panTo(t,a,l){return this.easeTo(c.e({center:t},a),l)}getZoom(){return this.transform.zoom}setZoom(t,a){return this.jumpTo({zoom:t},a),this}zoomTo(t,a,l){return this.easeTo(c.e({zoom:t},a),l)}zoomIn(t,a){return this.zoomTo(c.cx(this.getZoom()+1,this._zoomSnap),t,a),this}zoomOut(t,a){return this.zoomTo(c.cx(this.getZoom()-1,this._zoomSnap),t,a),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,a){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new c.l("movestart",a)).fire(new c.l("move",a)).fire(new c.l("moveend",a))),this}getBearing(){return this.transform.bearing}setZoomSnap(t){return this._zoomSnap=t,this}getZoomSnap(){return this._zoomSnap}setBearing(t,a){return this.jumpTo({bearing:t},a),this}getPadding(){return this.transform.padding}setPadding(t,a){return this.jumpTo({padding:t},a),this}rotateTo(t,a,l){return this.easeTo(c.e({bearing:t},a),l)}resetNorth(t,a){return this.rotateTo(0,c.e({duration:1e3},t),a),this}resetNorthPitch(t,a){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},t),a),this}snapToNorth(t,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,a):this}getPitch(){return this.transform.pitch}setPitch(t,a){return this.jumpTo({pitch:t},a),this}getRoll(){return this.transform.roll}setRoll(t,a){return this.jumpTo({roll:t},a),this}cameraForBounds(t,a){t=on.convert(t).adjustAntiMeridian();const l=a&&a.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),l,a)}_cameraForBoxAndBearing(t,a,l,f){const x={top:0,bottom:0,right:0,left:0};if(typeof(f=c.e({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const k=f.padding;f.padding={top:k,bottom:k,right:k,left:k}}const b=c.e(x,f.padding);f.padding=b;const E=this.transform,D=new on(t,a);return this.cameraHelper.cameraForBoxAndBearing(f,b,D,l,E)}fitBounds(t,a,l){return this._fitInternal(this.cameraForBounds(t,a),a,l)}fitScreenCoordinates(t,a,l,f,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(t)),this.transform.screenPointToLocation(c.P.convert(a)),l,f),f,x)}_fitInternal(t,a,l){return t?(delete(a=c.e(t,a)).padding,a.linear?this.easeTo(a,l):this.flyTo(a,l)):this}jumpTo(t,a){this.stop();const l=this._getTransformForUpdate();let f=!1,x=!1,b=!1;const E=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,t);const D=l.zoom!==E;return"elevation"in t&&l.elevation!==+t.elevation&&l.setElevation(+t.elevation),"bearing"in t&&l.bearing!==+t.bearing&&(f=!0,l.setBearing(+t.bearing)),"pitch"in t&&l.pitch!==+t.pitch&&(x=!0,l.setPitch(+t.pitch)),"roll"in t&&l.roll!==+t.roll&&(b=!0,l.setRoll(+t.roll)),t.padding==null||l.isPaddingEqual(t.padding)||l.setPadding(t.padding),this._applyUpdatedTransform(l),this.fire(new c.l("movestart",a)).fire(new c.l("move",a)),D&&this.fire(new c.l("zoomstart",a)).fire(new c.l("zoom",a)).fire(new c.l("zoomend",a)),f&&this.fire(new c.l("rotatestart",a)).fire(new c.l("rotate",a)).fire(new c.l("rotateend",a)),x&&this.fire(new c.l("pitchstart",a)).fire(new c.l("pitch",a)).fire(new c.l("pitchend",a)),b&&this.fire(new c.l("rollstart",a)).fire(new c.l("roll",a)).fire(new c.l("rollend",a)),this.fire(new c.l("moveend",a))}calculateCameraOptionsFromTo(t,a,l,f=0){const x=c.a9.fromLngLat(t,a),b=c.a9.fromLngLat(l,f),E=b.x-x.x,D=b.y-x.y,k=b.z-x.z,j=Math.hypot(E,D,k);if(j===0)throw new Error("Can't calculate camera options with same From and To");const U=Math.hypot(E,D),N=c.at(this.transform.cameraToCenterDistance/j/this.transform.tileSize),H=180*Math.atan2(E,-D)/Math.PI;let Q=180*Math.acos(U/j)/Math.PI;return Q=k<0?90-Q:90+Q,{center:b.toLngLat(),elevation:f,zoom:N,pitch:Q,bearing:H}}calculateCameraOptionsFromCameraLngLatAltRotation(t,a,l,f,x){const b=this.transform.calculateCenterFromCameraLngLatAlt(t,a,l,f);return{center:b.center,elevation:b.elevation,zoom:b.zoom,bearing:l,pitch:f,roll:x}}easeTo(t,a){this._stop(!1,t.easeId),((t=c.e({offset:[0,0],duration:500,easing:c.cz},t)).animate===!1||!t.essential&&De.prefersReducedMotion)&&(t.duration=0);const l=this._getTransformForUpdate(),f=this.getBearing(),x=l.pitch,b=l.roll,E="bearing"in t?this._normalizeBearing(t.bearing,f):f,D="pitch"in t?+t.pitch:x,k="roll"in t?this._normalizeBearing(t.roll,b):b,j="padding"in t?t.padding:l.padding,U=c.P.convert(t.offset);let N,H;t.around&&(N=c.V.convert(t.around),H=l.locationToScreenPoint(N));const Q={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ae=this.cameraHelper.handleEaseTo(l,{bearing:E,pitch:D,roll:k,padding:j,around:N,aroundPoint:H,offsetAsPoint:U,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||f!==E,this._pitching=this._pitching||D!==x,this._rolling=this._rolling||k!==b,this._padding=!l.isPaddingEqual(j),this._zooming=this._zooming||ae.isZooming,this._easeId=t.easeId,this._prepareEase(a,t.noMoveStart,Q),this.terrain&&this._prepareElevation(ae.elevationCenter),this._ease((oe=>{ae.easeFunc(oe),this.terrain&&!t.freezeElevation&&this._updateElevation(oe),this._applyUpdatedTransform(l),this._fireMoveEvents(a)}),(oe=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a,oe)}),t),this}_prepareEase(t,a,l={}){this._moving=!0,a||l.moving||this.fire(new c.l("movestart",t)),this._zooming&&!l.zooming&&this.fire(new c.l("zoomstart",t)),this._rotating&&!l.rotating&&this.fire(new c.l("rotatestart",t)),this._pitching&&!l.pitching&&this.fire(new c.l("pitchstart",t)),this._rolling&&!l.rolling&&this.fire(new c.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&a!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(l-(a-(l*t+this._elevationStart))/(1-t)),this._elevationTarget=a}this.transform.setElevation(c.G.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const a=t.getCameraLngLat(),l=t.getCameraAltitude(),f=this.terrain?this.terrain.getElevationForLngLatZoom(a,t.zoom):0;if(l<f){const x=this.calculateCameraOptionsFromTo(a,f,t.center,t.elevation);return{pitch:x.pitch,zoom:x.zoom}}return{}}_applyUpdatedTransform(t){const a=[];if(a.push((f=>this._elevateCameraIfInsideTerrain(f))),this.transformCameraUpdate&&a.push((f=>this.transformCameraUpdate(f))),!a.length)return;const l=t.clone();for(const f of a){const x=l.clone(),{center:b,zoom:E,roll:D,pitch:k,bearing:j,elevation:U}=f(x);b&&x.setCenter(b),U!==void 0&&x.setElevation(U),E!==void 0&&x.setZoom(E),D!==void 0&&x.setRoll(D),k!==void 0&&x.setPitch(k),j!==void 0&&x.setBearing(j),l.apply(x,!1)}this.transform.apply(l,!1)}_fireMoveEvents(t){this.fire(new c.l("move",t)),this._zooming&&this.fire(new c.l("zoom",t)),this._rotating&&this.fire(new c.l("rotate",t)),this._pitching&&this.fire(new c.l("pitch",t)),this._rolling&&this.fire(new c.l("roll",t))}_afterEase(t,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const l=this._zooming,f=this._rotating,x=this._pitching,b=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new c.l("zoomend",t)),f&&this.fire(new c.l("rotateend",t)),x&&this.fire(new c.l("pitchend",t)),b&&this.fire(new c.l("rollend",t)),this.fire(new c.l("moveend",t))}flyTo(t,a){if(!t.essential&&De.prefersReducedMotion){const Oe=c.U(t,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(Oe,a)}this.stop(),t=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.cz},t);const l=this._getTransformForUpdate(),f=l.bearing,x=l.pitch,b=l.roll,E=l.padding,D="bearing"in t?this._normalizeBearing(t.bearing,f):f,k="pitch"in t?+t.pitch:x,j="roll"in t?this._normalizeBearing(t.roll,b):b,U="padding"in t?t.padding:l.padding,N=c.P.convert(t.offset);let H=l.centerPoint.add(N);const Q=l.screenPointToLocation(H),ae=this.cameraHelper.handleFlyTo(l,{bearing:D,pitch:k,roll:j,padding:U,locationAtOffset:Q,offsetAsPoint:N,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let oe=t.curve;const se=Math.max(l.width,l.height),he=se/ae.scaleOfZoom,ye=ae.pixelPathLength;typeof ae.scaleOfMinZoom=="number"&&(oe=Math.sqrt(se/ae.scaleOfMinZoom/ye*2));const ce=oe*oe;function ge(Oe){const dt=(he*he-se*se+(Oe?-1:1)*ce*ce*ye*ye)/(2*(Oe?he:se)*ce*ye);return Math.log(Math.sqrt(dt*dt+1)-dt)}function be(Oe){return(Math.exp(Oe)-Math.exp(-Oe))/2}function me(Oe){return(Math.exp(Oe)+Math.exp(-Oe))/2}const Me=ge(!1);let Fe=function(Oe){return me(Me)/me(Me+oe*Oe)},Le=function(Oe){return se*((me(Me)*(be(dt=Me+oe*Oe)/me(dt))-be(Me))/ce)/ye;var dt},Be=(ge(!0)-Me)/oe;if(Math.abs(ye)<2e-6||!isFinite(Be)){if(Math.abs(se-he)<1e-6)return this.easeTo(t,a);const Oe=he<se?-1:1;Be=Math.abs(Math.log(he/se))/oe,Le=()=>0,Fe=dt=>Math.exp(Oe*oe*dt)}return t.duration="duration"in t?+t.duration:1e3*Be/("screenSpeed"in t?+t.screenSpeed/oe:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=f!==D,this._pitching=k!==x,this._rolling=j!==b,this._padding=!l.isPaddingEqual(U),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(ae.targetCenter),this._ease((Oe=>{const dt=Oe*Be,ft=1/Fe(dt),rt=Le(dt);this._rotating&&l.setBearing(c.G.number(f,D,Oe)),this._pitching&&l.setPitch(c.G.number(x,k,Oe)),this._rolling&&l.setRoll(c.G.number(b,j,Oe)),this._padding&&(l.interpolatePadding(E,U,Oe),H=l.centerPoint.add(N)),ae.easeFunc(Oe,ft,rt,H),this.terrain&&!t.freezeElevation&&this._updateElevation(Oe),this._applyUpdatedTransform(l),this._fireMoveEvents(a)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,a){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,a)}return t||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(t,a,l){l.animate===!1||l.duration===0?(t(1),a()):(this._easeStart=xe(),this._easeOptions=l,this._onEaseFrame=t,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,a){t=c.W(t,-180,180);const l=Math.abs(t-a);return Math.abs(t-360-a)<l&&(t-=360),Math.abs(t+360-a)<l&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLat(c.V.convert(t),this.transform):null}}const un={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class gn{constructor(t=un){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=le.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=le.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=le.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){le.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,a){const l=this._map._getUIString(`AttributionControl.${a}`);t.title=l,t.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((f=>typeof f!="string"?"":f))):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const a=this._map.style.tileManagers;for(const f in a){const x=a[f];if(x.used||x.usedForTerrain){const b=x.getSource();b.attribution&&t.indexOf(b.attribution)<0&&t.push(b.attribution)}}t=t.filter((f=>String(f).trim())),t.sort(((f,x)=>f.length-x.length)),t=t.filter(((f,x)=>{for(let b=x+1;b<t.length;b++)if(t[b].indexOf(f)>=0)return!1;return!0}));const l=t.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,t.length?(this._innerContainer.innerHTML=le.sanitize(l),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class mu{constructor(t={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const l=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=le.create("div","maplibregl-ctrl");const a=le.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){le.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Js{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const a=++this._id;return this._queue.push({callback:t,id:a,cancelled:!1}),a}remove(t){const a=this._currentlyRunning,l=a?this._queue.concat(a):this._queue;for(const f of l)if(f.id===t)return void(f.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const l of a)if(!l.cancelled&&(l.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var ii=c.aU([{name:"a_pos3d",type:"Int16",components:3}]);class Ti extends c.E{constructor(t){super(),this._lastTilesetChange=xe(),this.tileManager=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(t,a){this.tileManager.update(t,a),this._renderableTilesKeys=[];const l={};for(const f of Zi(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a,calculateTileZoom:this.tileManager._source.calculateTileZoom}))l[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.terrainRttPosMatrix32f=new Float64Array(16),c.c7(f.terrainRttPosMatrix32f,0,c.a5,c.a5,0,0,1),this._tiles[f.key]=new Pe(f,this.tileSize),this._lastTilesetChange=xe());for(const f in this._tiles)l[f]||delete this._tiles[f]}freeRtt(t){for(const a in this._tiles){const l=this._tiles[a];(!t||l.tileID.equals(t)||l.tileID.isChildOf(t)||t.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,a){return a?this._getTerrainCoordsForTileRanges(t,a):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const a={};for(const l of this._renderableTilesKeys){const f=this._tiles[l].tileID,x=t.clone(),b=c.bk();if(f.canonical.equals(t.canonical))c.c7(b,0,c.a5,c.a5,0,0,1);else if(f.canonical.isChildOf(t.canonical)){const E=f.canonical.z-t.canonical.z,D=f.canonical.x-(f.canonical.x>>E<<E),k=f.canonical.y-(f.canonical.y>>E<<E),j=c.a5>>E;c.c7(b,0,j,j,0,0,1),c.O(b,b,[-D*j,-k*j,0])}else{if(!t.canonical.isChildOf(f.canonical))continue;{const E=t.canonical.z-f.canonical.z,D=t.canonical.x-(t.canonical.x>>E<<E),k=t.canonical.y-(t.canonical.y>>E<<E),j=c.a5>>E;c.c7(b,0,c.a5,c.a5,0,0,1),c.O(b,b,[D*j,k*j,0]),c.Q(b,b,[1/2**E,1/2**E,0])}}x.terrainRttPosMatrix32f=new Float32Array(b),a[l]=x}return a}_getTerrainCoordsForTileRanges(t,a){const l={};for(const f of this._renderableTilesKeys){const x=this._tiles[f].tileID;if(!this._isWithinTileRanges(x,a))continue;const b=t.clone(),E=c.bk();if(x.canonical.z===t.canonical.z){const D=t.canonical.x-x.canonical.x+t.wrap*(1<<t.canonical.z),k=t.canonical.y-x.canonical.y;c.c7(E,0,c.a5,c.a5,0,0,1),c.O(E,E,[D*c.a5,k*c.a5,0])}else if(x.canonical.z>t.canonical.z){const D=x.canonical.z-t.canonical.z,k=x.canonical.x-(x.canonical.x>>D<<D)+t.wrap*(1<<x.canonical.z),j=x.canonical.y-(x.canonical.y>>D<<D),U=t.canonical.x-(x.canonical.x>>D),N=t.canonical.y-(x.canonical.y>>D),H=c.a5>>D;c.c7(E,0,H,H,0,0,1),c.O(E,E,[-k*H+U*c.a5,-j*H+N*c.a5,0])}else{const D=t.canonical.z-x.canonical.z,k=t.canonical.x-(t.canonical.x>>D<<D)+t.wrap*(1<<t.canonical.z),j=t.canonical.y-(t.canonical.y>>D<<D),U=(t.canonical.x>>D)-x.canonical.x,N=(t.canonical.y>>D)-x.canonical.y,H=c.a5<<D;c.c7(E,0,H,H,0,0,1),c.O(E,E,[k*c.a5+U*H,j*c.a5+N*H,0])}b.terrainRttPosMatrix32f=new Float32Array(E),l[f]=b}return l}getSourceTile(t,a){const l=this.tileManager._source;let f=t.overscaledZ-this.deltaZoom;if(f>l.maxzoom&&(f=l.maxzoom),f<l.minzoom)return;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(f).key);let x=this.findTileInCaches(this._sourceTileCache[t.key]);if(!x?.dem&&a)for(;f>=l.minzoom&&!x?.dem;)x=this.findTileInCaches(t.scaledTo(f--).key);return x}findTileInCaches(t){let a=this.tileManager.getTileByID(t);return a||(a=this.tileManager._outOfViewCache.getByKey(t),a)}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,a){const l=a[t.canonical.z];return!!l&&(t.wrap>l.minWrap||t.wrap<l.maxWrap||t.canonical.x>=l.minTileXWrapped&&t.canonical.x<=l.maxTileXWrapped&&t.canonical.y>=l.minTileY&&t.canonical.y<=l.maxTileY)}}class ei{constructor(t,a,l){this._meshCache={},this.painter=t,this.tileManager=new Ti(a),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,a,l,f=c.a5){var x;if(!(a>=0&&a<f&&l>=0&&l<f))return 0;const b=this.getTerrainData(t),E=(x=b.tile)===null||x===void 0?void 0:x.dem;if(!E)return 0;const D=c.cD([],[a/f*c.a5,l/f*c.a5],b.u_terrain_matrix),k=[D[0]*E.dim,D[1]*E.dim],j=Math.floor(k[0]),U=Math.floor(k[1]),N=k[0]-j,H=k[1]-U;return E.get(j,U)*(1-N)*(1-H)+E.get(j+1,U)*N*(1-H)+E.get(j,U+1)*(1-N)*H+E.get(j+1,U+1)*N*H}getElevationForLngLatZoom(t,a){if(!c.cE(a,t.wrap()))return 0;const{tileID:l,mercatorX:f,mercatorY:x}=this._getOverscaledTileIDFromLngLatZoom(t,a);return this.getElevation(l,f%c.a5,x%c.a5,c.a5)}getElevationForLngLat(t,a){const l=Zi(a,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let f=0;for(const x of l)x.canonical.z>f&&(f=Math.min(x.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(t,f)}getElevation(t,a,l,f=c.a5){return this.getDEMElevation(t,a,l,f)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const f=this.painter.context,x=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(f,x,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(f,new c.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.ar([])}const a=this.tileManager.getSourceTile(t,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const f=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new c.T(f,a.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),a.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const l=a&&a.toString()+a.tileID.key+t.key;if(l&&!this._demMatrixCache[l]){const f=this.tileManager.getSource().maxzoom;let x=t.canonical.z-a.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=f?x=t.canonical.z-f:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const b=t.canonical.x-(t.canonical.x>>x<<x),E=t.canonical.y-(t.canonical.y>>x<<x),D=c.cF(new Float64Array(16),[1/(c.a5<<x),1/(c.a5<<x),0]);c.O(D,D,[b*c.a5,E*c.a5,0]),this._demMatrixCache[t.key]={matrix:D,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(t){const a=this.painter,l=a.width/devicePixelRatio,f=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(a.context,{width:l,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(a.context,{width:l,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(l,f,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,l,f))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,b=0;x<this._coordsTextureSize;x++)for(let E=0;E<this._coordsTextureSize;E++,b+=4)a[b+0]=255&E,a[b+1]=255&x,a[b+2]=E>>8<<4|x>>8,a[b+3]=0;const l=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),f=new c.T(t,l,t.gl.RGBA,{premultiply:!1});return f.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),l=this.painter.context,f=l.gl,x=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),b=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),E=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(x,E-b-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null);const D=a[0]+(a[2]>>4<<8),k=a[1]+((15&a[2])<<8),j=this.coordsIndex[255-a[3]],U=j&&this.tileManager.getTileByID(j);if(!U)return null;const N=this._coordsTextureSize,H=(1<<U.tileID.canonical.z)*N;return new c.a9((U.tileID.canonical.x*N+D)/H+U.tileID.wrap,(U.tileID.canonical.y*N+k)/H,this.getElevation(U.tileID,D,k,N))}depthAtPoint(t){const a=new Uint8Array(4),l=this.painter.context,f=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(t){var a;const l=((a=this.painter.style.projection)===null||a===void 0?void 0:a.transitionState)>0,f=l&&t.canonical.y===0,x=l&&t.canonical.y===(1<<t.canonical.z)-1,b=`m_${f?"n":""}_${x?"s":""}`;if(this._meshCache[b])return this._meshCache[b];const E=this.painter.context,D=new c.cG,k=new c.aY,j=this.meshSize,U=c.a5/j,N=j*j;for(let me=0;me<=j;me++)for(let Me=0;Me<=j;Me++)D.emplaceBack(Me*U,me*U,0);for(let me=0;me<N;me+=j+1)for(let Me=0;Me<j;Me++)k.emplaceBack(Me+me,j+Me+me+1,j+Me+me+2),k.emplaceBack(Me+me,j+Me+me+2,Me+me+1);const H=D.length,Q=H+(j+1),ae=(j+1)*j,oe=f?c.br:0,se=f?0:1,he=x?c.bs:c.a5,ye=x?0:1;for(let me=0;me<=j;me++)D.emplaceBack(me*U,oe,se);for(let me=0;me<=j;me++)D.emplaceBack(me*U,he,ye);for(let me=0;me<j;me++)k.emplaceBack(ae+me,Q+me,Q+me+1),k.emplaceBack(ae+me,Q+me+1,ae+me+1),k.emplaceBack(0+me,H+me+1,H+me),k.emplaceBack(0+me,0+me+1,H+me+1);const ce=D.length,ge=ce+2*(j+1);for(const me of[0,1])for(let Me=0;Me<=j;Me++)for(const Fe of[0,1])D.emplaceBack(me*c.a5,Me*U,Fe);for(let me=0;me<2*j;me+=2)k.emplaceBack(ce+me,ce+me+1,ce+me+3),k.emplaceBack(ce+me,ce+me+3,ce+me+2),k.emplaceBack(ge+me,ge+me+3,ge+me+1),k.emplaceBack(ge+me,ge+me+2,ge+me+3);const be=new ji(E.createVertexBuffer(D,ii.members),E.createIndexBuffer(k),c.aX.simpleSegment(0,0,D.length,k.length));return this._meshCache[b]=be,be}getMeshFrameDelta(t){return 2*Math.PI*c.bE/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,a){var l;if(!c.cE(a,t.wrap()))return 0;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(t,a);return(l=this.getMinMaxElevation(f).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(t){const a=this.getTerrainData(t).tile,l={minElevation:null,maxElevation:null};return a&&a.dem&&(l.minElevation=a.dem.min*this.exaggeration,l.maxElevation=a.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(t,a){const l=c.a9.fromLngLat(t.wrap()),f=(1<<a)*c.a5,x=l.x*f,b=l.y*f,E=Math.floor(x/c.a5),D=Math.floor(b/c.a5);return{tileID:new c.a2(a,0,a,E,D),mercatorX:x,mercatorY:b}}}class tn{constructor(t,a,l){this._context=t,this._size=a,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(l.texture),{id:t,fbo:a,texture:l,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((a=>t.id!==a)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((t=>!t.inUse))===!1}}const Ia={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Wa{constructor(t,a){this.painter=t,this.terrain=a,this.pool=new tn(t.context,30,a.tileManager.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=t._order.filter((l=>!t._layers[l].isHidden(a))),this._coordsAscending={};for(const l in t.tileManagers){this._coordsAscending[l]={};const f=t.tileManagers[l].getVisibleCoordinates(),x=t.tileManagers[l].getSource(),b=x instanceof ea?x.terrainTileRanges:null;for(const E of f){const D=this.terrain.tileManager.getTerrainCoords(E,b);for(const k in D)this._coordsAscending[l][k]||(this._coordsAscending[l][k]=[]),this._coordsAscending[l][k].push(D[k])}}this._coordsAscendingStr={};for(const l of t._order){const f=t._layers[l],x=f.source;if(Ia[f.type]&&!this._coordsAscendingStr[x]){this._coordsAscendingStr[x]={};for(const b in this._coordsAscending[x])this._coordsAscendingStr[x][b]=this._coordsAscending[x][b].map((E=>E.key)).sort().join()}}for(const l of this._renderableTiles)for(const f in this._coordsAscendingStr){const x=this._coordsAscendingStr[f][l.tileID.key];x&&x!==l.rttCoords[f]&&(l.rtt=[])}}renderLayer(t,a){if(t.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},a),{isRenderingToTexture:!0}),f=t.type,x=this.painter,b=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Ia[f]&&(this._prevType&&Ia[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(t.id),!b))return!0;if(Ia[this._prevType]||Ia[f]&&b){this._prevType=f;const E=this._stacks.length-1,D=this._stacks[E]||[];for(const k of this._renderableTiles){if(this.pool.isFull()&&(rh(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(k),k.rtt[E]){const U=this.pool.getObjectForId(k.rtt[E].id);if(U.stamp===k.rtt[E].stamp){this.pool.useObject(U);continue}}const j=this.pool.getOrCreateFreeObject();this.pool.useObject(j),this.pool.stampObject(j),k.rtt[E]={id:j.id,stamp:j.stamp},x.context.bindFramebuffer.set(j.fbo.framebuffer),x.context.clear({color:c.bp.transparent,stencil:0}),x.currentStencilSource=void 0;for(let U=0;U<D.length;U++){const N=x.style._layers[D[U]],H=N.source?this._coordsAscending[N.source][k.tileID.key]:[k.tileID];x.context.viewport.set([0,0,j.fbo.width,j.fbo.height]),x._renderTileClippingMasks(N,H,!0),x.renderLayer(x,x.style.tileManagers[N.source],N,H,l),N.source&&(k.rttCoords[N.source]=this._coordsAscendingStr[N.source][k.tileID.key])}}return rh(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),Ia[f]}return!1}}const ml={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},gl=V,eo={hash:!1,interactive:!0,bearingSnap:7,zoomSnap:0,attributionControl:un,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},hd={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Yi{constructor(t,a,l=!1){this.mousedown=x=>{this.startMove(x,le.mousePos(this.element,x)),le.addEventListener(window,"mousemove",this.mousemove),le.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.move(x,le.mousePos(this.element,x))},this.mouseup=x=>{this._rotatePitchHandler.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=le.touchPos(this.element,x.targetTouches)[0],this.startMove(x,this._startPos),le.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),le.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=le.touchPos(this.element,x.targetTouches)[0],this.move(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=a;const f=new cu;this._rotatePitchHandler=new Da({clickTolerance:3,move:(x,b)=>{const E=a.getBoundingClientRect(),D=new c.P((E.bottom-E.top)/2,(E.right-E.left)/2);return{bearingDelta:c.cy(new c.P(x.x,b.y),b,D),pitchDelta:l?-.5*(b.y-x.y):void 0}},moveStateManager:f,enable:!0,assignEvents:()=>{}}),this.map=t,le.addEventListener(a,"mousedown",this.mousedown),le.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),le.addEventListener(a,"touchcancel",this.reset)}startMove(t,a){this._rotatePitchHandler.dragStart(t,a),le.disableDrag()}move(t,a){const l=this.map,{bearingDelta:f,pitchDelta:x}=this._rotatePitchHandler.dragMove(t,a)||{};f&&l.setBearing(l.getBearing()+f),x&&l.setPitch(l.getPitch()+x)}off(){const t=this.element;le.removeEventListener(t,"mousedown",this.mousedown),le.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),le.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),le.removeEventListener(window,"touchend",this.touchend),le.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){le.enableDrag(),le.removeEventListener(window,"mousemove",this.mousemove),le.removeEventListener(window,"mouseup",this.mouseup),le.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),le.removeEventListener(window,"touchend",this.touchend)}}let Ka;function uc(y,t,a,l=!1){if(l||!a.getCoveringTilesDetailsProvider().allowWorldCopies())return y?.wrap();const f=new c.V(y.lng,y.lat);if(y=new c.V(y.lng,y.lat),t){const x=new c.V(y.lng-360,y.lat),b=new c.V(y.lng+360,y.lat),E=a.locationToScreenPoint(y).distSqr(t);a.locationToScreenPoint(x).distSqr(t)<E?y=x:a.locationToScreenPoint(b).distSqr(t)<E&&(y=b)}for(;Math.abs(y.lng-a.center.lng)>180;){const x=a.locationToScreenPoint(y);if(x.x>=0&&x.y>=0&&x.x<=a.width&&x.y<=a.height)break;y.lng>a.center.lng?y.lng-=360:y.lng+=360}return y.lng!==f.lng&&a.isPointOnMapSurface(a.locationToScreenPoint(y))?y:f}const hc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function gu(y,t,a){const l=y.classList;for(const f in hc)l.remove(`maplibregl-${a}-anchor-${f}`);l.add(`maplibregl-${a}-anchor-${t}`)}class yu extends c.E{constructor(t){if(super(),this._onKeyPress=a=>{const l=a.code,f=a.charCode||a.keyCode;l!=="Space"&&l!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=a=>{const l=a.originalEvent.target,f=this._element;this._popup&&(l===f||f.contains(l))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();(a?.type==="terrain"||a?.type==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=uc(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let x="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?x="rotateX(0deg)":this._pitchAlignment==="map"&&(x=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),le.setTransform(this._element,`${hc[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${x} ${f}`),De.frameAsync(new AbortController,this._map._ownerWindow).then((()=>{this._updateOpacity(a&&a.type==="moveend")})).catch((()=>{}))},this._onMove=a=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=c.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=le.create("div");const a=le.createNS("http://www.w3.org/2000/svg","svg"),l=41,f=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${l}px`),a.setAttributeNS(null,"width",`${f}px`),a.setAttributeNS(null,"viewBox",`0 0 ${f} ${l}`);const x=le.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const b=le.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const E=le.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"transform","translate(3.0, 29.0)"),E.setAttributeNS(null,"fill","#000000");const D=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const se of D){const he=le.createNS("http://www.w3.org/2000/svg","ellipse");he.setAttributeNS(null,"opacity","0.04"),he.setAttributeNS(null,"cx","10.5"),he.setAttributeNS(null,"cy","5.80029008"),he.setAttributeNS(null,"rx",se.rx),he.setAttributeNS(null,"ry",se.ry),E.appendChild(he)}const k=le.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const j=le.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(j);const U=le.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"opacity","0.25"),U.setAttributeNS(null,"fill","#000000");const N=le.createNS("http://www.w3.org/2000/svg","path");N.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),U.appendChild(N);const H=le.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const Q=le.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ae=le.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#000000"),ae.setAttributeNS(null,"opacity","0.25"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962");const oe=le.createNS("http://www.w3.org/2000/svg","circle");oe.setAttributeNS(null,"fill","#FFFFFF"),oe.setAttributeNS(null,"cx","5.5"),oe.setAttributeNS(null,"cy","5.5"),oe.setAttributeNS(null,"r","5.4999962"),Q.appendChild(ae),Q.appendChild(oe),b.appendChild(E),b.appendChild(k),b.appendChild(U),b.appendChild(H),b.appendChild(Q),a.appendChild(b),a.setAttributeNS(null,"height",l*this._scale+"px"),a.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(a=>{a.preventDefault()})),this._element.addEventListener("mousedown",(a=>{a.preventDefault()})),gu(this._element,this._anchor,"marker"),t&&t.className)for(const a of t.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),le.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=c.V.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const f=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var a,l;const f=(a=this._map)===null||a===void 0?void 0:a.terrain,x=this._map.transform.isLocationOccluded(this._lngLat);if(!f||x){const H=x?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==H&&(this._element.style.opacity=H))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const b=this._map,E=b.terrain.depthAtPoint(this._pos),D=b.terrain.getElevationForLngLat(this._lngLat,b.transform);if(b.transform.lngLatToCameraDepth(this._lngLat,D)-E<.006)return void(this._element.style.opacity=this._opacity);const k=-this._offset.y/b.transform.pixelsPerMeter,j=Math.sin(b.getPitch()*Math.PI/180)*k,U=b.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),N=b.transform.lngLatToCameraDepth(this._lngLat,D+j)-U>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&N&&this._popup.remove(),this._element.style.opacity=N?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=c.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,a){return(this._opacity===void 0||t===void 0&&a===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const _u={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ro=0,to=!1;const dr={maxWidth:100,unit:"metric"};function nn(y,t,a){const l=a&&a.maxWidth||100,f=y._container.clientHeight/2,x=y._container.clientWidth/2,b=y.unproject([x-l/2,f]),E=y.unproject([x+l/2,f]),D=Math.round(y.project(E).x-y.project(b).x),k=Math.min(l,D,y._container.clientWidth),j=b.distanceTo(E);if(a&&a.unit==="imperial"){const U=3.2808*j;U>5280?Is(t,k,U/5280,y._getUIString("ScaleControl.Miles")):Is(t,k,U,y._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?Is(t,k,j/1852,y._getUIString("ScaleControl.NauticalMiles")):j>=1e3?Is(t,k,j/1e3,y._getUIString("ScaleControl.Kilometers")):Is(t,k,j,y._getUIString("ScaleControl.Meters"))}function Is(y,t,a,l){const f=(function(x){const b=Math.pow(10,`${Math.floor(x)}`.length-1);let E=x/b;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:E>=1?1:(function(D){const k=Math.pow(10,Math.ceil(-Math.log(D)/Math.LN10));return Math.round(D*k)/k})(E),b*E})(a);y.style.width=t*(f/a)+"px",y.innerHTML=`${f}&nbsp;${l}`}const yl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0,padding:void 0},_l=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function dc(y){if(y){if(typeof y=="number"){const t=Math.round(Math.abs(y)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,y),"top-left":new c.P(t,t),"top-right":new c.P(-t,t),bottom:new c.P(0,-y),"bottom-left":new c.P(t,-t),"bottom-right":new c.P(-t,-t),left:new c.P(y,0),right:new c.P(-y,0)}}if(y instanceof c.P||Array.isArray(y)){const t=c.P.convert(y);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:c.P.convert(y.center||[0,0]),top:c.P.convert(y.top||[0,0]),"top-left":c.P.convert(y["top-left"]||[0,0]),"top-right":c.P.convert(y["top-right"]||[0,0]),bottom:c.P.convert(y.bottom||[0,0]),"bottom-left":c.P.convert(y["bottom-left"]||[0,0]),"bottom-right":c.P.convert(y["bottom-right"]||[0,0]),left:c.P.convert(y.left||[0,0]),right:c.P.convert(y.right||[0,0])}}return dc(new c.P(0,0))}const Qa=V;M.AJAXError=c.cJ,M.Event=c.l,M.Evented=c.E,M.LngLat=c.V,M.MercatorCoordinate=c.a9,M.Point=c.P,M.addProtocol=c.cK,M.config=c.c,M.removeProtocol=c.cL,M.AttributionControl=gn,M.BoxZoomHandler=Po,M.CanvasSource=Nl,M.CooperativeGesturesHandler=Tt,M.DoubleClickZoomHandler=hh,M.DragPanHandler=ud,M.DragRotateHandler=ha,M.EdgeInsets=ia,M.FullscreenControl=class extends c.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var t;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=a?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=le.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){le.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=le.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);le.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},M.GeoJSONSource=Qn,M.GeolocateControl=class extends c.E{constructor(y){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const a=new c.V(t.coords.longitude,t.coords.latitude),l=t.coords.accuracy,f=this._map.getBearing(),x=c.e({bearing:f},this.options.fitBoundsOptions),b=on.fromLngLat(a,l);this._map.fitBounds(b,x,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const a=new c.V(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&to)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=le.create("button","maplibregl-ctrl-geolocate",this._container),le.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=le.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new yu({element:this._dotElement}),this._circleElement=le.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new yu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(a=>{const l=a?.[0]instanceof ResizeObserverEntry;a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))}))}},this.options=c.e({},_u,y)}onAdd(y){return this._map=y,this._container=le.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return c._(this,arguments,void 0,(function*(t=!1){if(Ka!==void 0&&!t)return Ka;if(window.navigator.permissions===void 0)return Ka=!!window.navigator.geolocation,Ka;try{Ka=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Ka=!!window.navigator.geolocation}return Ka}))})().then((t=>this._finishSetupUI(t))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),le.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Ro=0,to=!1}_isOutOfMapMaxBounds(y){const t=this._map.getMaxBounds(),a=y.coords;return t&&(a.longitude<t.getWest()||a.longitude>t.getEast()||a.latitude<t.getSouth()||a.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const y=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&y))return;const t=this._map.project(y),a=this._map.unproject([t.x+100,t.y]),l=y.distanceTo(a)/100,f=2*this._accuracy/l;this._circleElement.style.width=`${f.toFixed(2)}px`,this._circleElement.style.height=`${f.toFixed(2)}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ro--,to=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ro++,Ro>1?(y={maximumAge:6e5,timeout:0},to=!0):(y=this.options.positionOptions,to=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},M.GlobeControl=class{constructor(){this._toggleProjection=()=>{var y;const t=(y=this._map.getProjection())===null||y===void 0?void 0:y.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var y;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((y=this._map.getProjection())===null||y===void 0?void 0:y.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(y){return this._map=y,this._container=le.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=le.create("button","maplibregl-ctrl-globe",this._container),le.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){le.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},M.Hash=Mn,M.ImageSource=ea,M.KeyboardHandler=Mi,M.LngLatBounds=on,M.LogoControl=mu,M.Map=class extends En{get _ownerWindow(){var y,t;return((t=(y=this._container)===null||y===void 0?void 0:y.ownerDocument)===null||t===void 0?void 0:t.defaultView)||window}constructor(y){var t,a;c.cH.mark(c.cI.create);const l=Object.assign(Object.assign(Object.assign({},eo),y),{canvasContextAttributes:Object.assign(Object.assign({},eo.canvasContextAttributes),y.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const f=new Vn,x=new el;l.minZoom!==void 0&&f.setMinZoom(l.minZoom),l.maxZoom!==void 0&&f.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&f.setMinPitch(l.minPitch),l.maxPitch!==void 0&&f.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&f.setRenderWorldCopies(l.renderWorldCopies),l.transformConstrain!==null&&f.setConstrainOverride(l.transformConstrain),super(f,x,{bearingSnap:l.bearingSnap,zoomSnap:l.zoomSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Js,this._controls=[],this._mapId=c.af(),this._lostContextStyle={style:null,images:null},this._contextLost=E=>{E.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const D of Object.values(this.style._layers))if(D.type==="custom"&&console.warn(`Custom layer with id '${D.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),D._listeners)for(const[k]of Object.entries(D._listeners))console.warn(`Custom layer with id '${D.id}' had event listeners for event '${k}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new c.l("webglcontextlost",{originalEvent:E}))},this._contextRestored=E=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._lostContextStyle={style:null,images:null},this._setupPainter(),this.resize(),this._update(),this._resizeInternal(),this.fire(new c.l("webglcontextrestored",{originalEvent:E}))},this._onMapScroll=E=>{if(E.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._zoomSnap=l.zoomSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},ml),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this._zoomLevelsToOverscale=l.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=l.transformCameraUpdate,this.transformConstrain=l.transformConstrain,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,l.reduceMotion!==void 0&&(De.prefersReducedMotion=l.reduceMotion),this._imageQueueHandle=_t.addThrottleControl((()=>this.isMoving())),this._requestManager=new Mt(l.transformRequest),this._container=this._resolveContainer(l.container),l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"&&(this._ownerWindow.addEventListener("online",this._onWindowOnline,!1),this._setupResizeObserver()),this.handlers=new pu(this,l),this._hash=l.hash&&new Mn(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,c.e({},l.fitBoundsOptions,{duration:0}))));const b=typeof l.style=="string"||((a=(t=l.style)===null||t===void 0?void 0:t.projection)===null||a===void 0?void 0:a.type)!=="globe";this.resize(null,b),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new gn(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new mu,l.logoPosition),this.on("style.load",(()=>{if(b||this._resizeTransform(),this.transform.unmodified){const E=c.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(E)}})),this.on("data",(E=>{this._update(E.dataType==="style"),this.fire(new c.l(`${E.dataType}data`,E))})),this.on("dataloading",(E=>{this.fire(new c.l(`${E.dataType}dataloading`,E))})),this.on("dataabort",(E=>{this.fire(new c.l("sourcedataabort",E))}))}_getMapId(){return this._mapId}setGlobalStateProperty(y,t){return this.style.setGlobalStateProperty(y,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(y,t){if(t===void 0&&(t=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=y.onAdd(this);this._controls.push(y);const l=this._controlPositions[t];return t.indexOf("bottom")!==-1?l.insertBefore(a,l.firstChild):l.appendChild(a),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(y);return t>-1&&this._controls.splice(t,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}coveringTiles(y){return Zi(this.transform,y)}calculateCameraOptionsFromTo(y,t,a,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLat(a,this.transform)),super.calculateCameraOptionsFromTo(y,t,a,l)}resize(y,t=!0){if(this._lostContextStyle.style!==null)return this;this._resizeInternal(t);const a=!this._moving;return a&&(this.stop(),this.fire(new c.l("movestart",y)).fire(new c.l("move",y))),this.fire(new c.l("resize",y)),a&&this.fire(new c.l("moveend",y)),this}_resizeInternal(y=!0){const[t,a]=this._containerDimensions(),l=this._getClampedPixelRatio(t,a);if(this._resizeCanvas(t,a,l),this.painter.resize(t,a,l),this.painter.overLimit()){const f=this.painter.context.gl;this._maxCanvasSize=[f.drawingBufferWidth,f.drawingBufferHeight];const x=this._getClampedPixelRatio(t,a);this._resizeCanvas(t,a,x),this.painter.resize(t,a,x)}this._resizeTransform(y)}_resizeTransform(y=!0){var t;const[a,l]=this._containerDimensions();this.transform.resize(a,l,y),(t=this._requestedCameraState)===null||t===void 0||t.resize(a,l,y)}_getClampedPixelRatio(y,t){const{0:a,1:l}=this._maxCanvasSize,f=this.getPixelRatio(),x=y*f,b=t*f;return Math.min(x>a?a/x:1,b>l?l/b:1)*f}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(on.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom){const t=this.transform.zoom,a=this._getTransformForUpdate();return a.setMinZoom(y),this._applyUpdatedTransform(a),this._update(),t!==this.transform.zoom&&this.fire(new c.l("zoomstart")).fire(new c.l("zoom")).fire(new c.l("zoomend")).fire(new c.l("movestart")).fire(new c.l("move")).fire(new c.l("moveend")),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom){const t=this.transform.zoom,a=this._getTransformForUpdate();return a.setMaxZoom(y),this._applyUpdatedTransform(a),this._update(),t!==this.transform.zoom&&this.fire(new c.l("zoomstart")).fire(new c.l("zoom")).fire(new c.l("zoomend")).fire(new c.l("movestart")).fire(new c.l("move")).fire(new c.l("moveend")),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch){const t=this.transform.pitch,a=this._getTransformForUpdate();return a.setMinPitch(y),this._applyUpdatedTransform(a),this._update(),t!==this.transform.pitch&&this.fire(new c.l("pitchstart")).fire(new c.l("pitch")).fire(new c.l("pitchend")).fire(new c.l("movestart")).fire(new c.l("move")).fire(new c.l("moveend")),this}throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(y>=this.transform.minPitch){const t=this.transform.pitch,a=this._getTransformForUpdate();return a.setMaxPitch(y),this._applyUpdatedTransform(a),this._update(),t!==this.transform.pitch&&this.fire(new c.l("pitchstart")).fire(new c.l("pitch")).fire(new c.l("pitchend")).fire(new c.l("movestart")).fire(new c.l("move")).fire(new c.l("moveend")),this}throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.setRenderWorldCopies(y),this._update()}setTransformConstrain(y){return this.transform.setConstrainOverride(y),this._update()}project(y){return this.transform.locationToScreenPoint(c.V.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.screenPointToLocation(c.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,t,a){if(y==="mouseenter"||y==="mouseover"){let l=!1;return{layers:t,listener:a,delegates:{mousemove:x=>{const b=t.filter((D=>this.getLayer(D))),E=b.length!==0?this.queryRenderedFeatures(x.point,{layers:b}):[];E.length?l||(l=!0,a.call(this,new Xn(y,this,x.originalEvent,{features:E}))):l=!1},mouseout:()=>{l=!1}}}}if(y==="mouseleave"||y==="mouseout"){let l=!1;return{layers:t,listener:a,delegates:{mousemove:b=>{const E=t.filter((D=>this.getLayer(D)));(E.length!==0?this.queryRenderedFeatures(b.point,{layers:E}):[]).length?l=!0:l&&(l=!1,a.call(this,new Xn(y,this,b.originalEvent)))},mouseout:b=>{l&&(l=!1,a.call(this,new Xn(y,this,b.originalEvent)))}}}}{const l=f=>{const x=t.filter((E=>this.getLayer(E))),b=x.length!==0?this.queryRenderedFeatures(f.point,{layers:x}):[];b.length&&(f.features=b,a.call(this,f),delete f.features)};return{layers:t,listener:a,delegates:{[y]:l}}}}_saveDelegatedListener(y,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(t)}_removeDelegatedListener(y,t,a){if(!this._delegatedListeners||!this._delegatedListeners[y])return;const l=this._delegatedListeners[y];for(let f=0;f<l.length;f++){const x=l[f];if(x.listener===a&&x.layers.length===t.length&&x.layers.every((b=>t.includes(b)))){for(const b in x.delegates)this.off(b,x.delegates[b]);return void l.splice(f,1)}}}on(y,t,a){if(a===void 0)return super.on(y,t);const l=typeof t=="string"?[t]:t,f=this._createDelegatedListener(y,l,a);this._saveDelegatedListener(y,f);for(const x in f.delegates)this.on(x,f.delegates[x]);return{unsubscribe:()=>{this._removeDelegatedListener(y,l,a)}}}once(y,t,a){if(a===void 0)return super.once(y,t);const l=typeof t=="string"?[t]:t,f=this._createDelegatedListener(y,l,a);for(const x in f.delegates){const b=f.delegates[x];f.delegates[x]=(...E)=>{this._removeDelegatedListener(y,l,a),b(...E)}}this._saveDelegatedListener(y,f);for(const x in f.delegates)this.once(x,f.delegates[x]);return this}off(y,t,a){return a===void 0?super.off(y,t):(this._removeDelegatedListener(y,typeof t=="string"?[t]:t,a),this)}queryRenderedFeatures(y,t){if(!this.style)return[];let a;const l=y instanceof c.P||Array.isArray(y),f=l?y:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(l?{}:y)||{},f instanceof c.P||typeof f[0]=="number")a=[c.P.convert(f)];else{const x=c.P.convert(f[0]),b=c.P.convert(f[1]);a=[x,new c.P(b.x,x.y),b,new c.P(x.x,b.y),x]}return this.style.queryRenderedFeatures(a,t,this.transform)}querySourceFeatures(y,t){return this.style.querySourceFeatures(y,t)}setStyle(y,t){return(t=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(y,t))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const t=this._locale[y];if(t==null)throw new Error(`Missing UI string '${y}'`);return t}_updateStyle(y,t){var a,l;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(y,t)));const f=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new bo(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,t,f):this.style.loadJSON(y,t,f),this):((l=(a=this.style)===null||a===void 0?void 0:a.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new bo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,t){if(typeof y=="string"){const a=this._requestManager.transformRequest(y,"Style");c.j(a,new AbortController).then((l=>{this._updateDiff(l.data,t)})).catch((l=>{l&&this.fire(new c.k(l))}))}else typeof y=="object"&&this._updateDiff(y,t)}_updateDiff(y,t){try{this.style.setState(y,t)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(y,t)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(y,t){return this._lazyInitEmptyStyle(),this.style.addSource(y,t),this._update(!0)}isSourceLoaded(y){const t=this.style&&this.style.tileManagers[y];if(t!==void 0)return t.loaded();this.fire(new c.k(new Error(`There is no tile manager with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const t=this.style.tileManagers[y.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&t.reload();for(const a in this.style._layers){const l=this.style._layers[a];l.type==="hillshade"&&l.source===y.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),l.type==="color-relief"&&l.source===y.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ei(this.painter,t,y),this.painter.renderToTexture=new Wa(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=a=>{var l;a.dataType==="style"?this.terrain.tileManager.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==y.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((l=a.source)===null||l===void 0?void 0:l.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:y})),this}getTerrain(){var y,t;return(t=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const y=this.style&&this.style.tileManagers;for(const t of Object.values(y))if(!t.areTilesLoaded())return!1;return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}setSourceTileLodParams(y,t,a){if(a){const l=this.getSource(a);if(!l)throw new Error(`There is no source with ID "${a}", cannot set LOD parameters`);l.calculateTileZoom=Rt(Math.max(1,y),Math.max(1,t))}else for(const l in this.style.tileManagers)this.style.tileManagers[l].getSource().calculateTileZoom=Rt(Math.max(1,y),Math.max(1,t));return this._update(!0),this}refreshTiles(y,t){const a=this.style.tileManagers[y];if(!a)throw new Error(`There is no tile manager with ID "${y}", cannot refresh tile`);t===void 0?a.reload(!0):a.refreshTiles(t.map((l=>new c.ac(l.z,l.x,l.y))))}addImage(y,t,a={}){const{pixelRatio:l=1,sdf:f=!1,stretchX:x,stretchY:b,content:E,textFitWidth:D,textFitHeight:k}=a;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||c.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:j,height:U,data:N}=t,H=t;return this.style.addImage(y,{data:new c.R({width:j,height:U},new Uint8Array(N)),pixelRatio:l,stretchX:x,stretchY:b,content:E,textFitWidth:D,textFitHeight:k,sdf:f,version:0,userImage:H}),H.onAdd&&H.onAdd(this,y),this}}{const{width:j,height:U,data:N}=De.getImageData(t);this.style.addImage(y,{data:new c.R({width:j,height:U},N),pixelRatio:l,stretchX:x,stretchY:b,content:E,textFitWidth:D,textFitHeight:k,sdf:f,version:0})}}updateImage(y,t){const a=this.style.getImage(y);if(!a)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=t instanceof HTMLImageElement||c.b(t)?De.getImageData(t):t,{width:f,height:x,data:b}=l;if(f===void 0||x===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==a.data.width||x!==a.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const E=!(t instanceof HTMLImageElement||c.b(t));return a.data.replace(b,E),this.style.updateImage(y,a),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return _t.getImage(this._requestManager.transformRequest(y,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,t){return this._lazyInitEmptyStyle(),this.style.addLayer(y,t),this._update(!0)}moveLayer(y,t){return this.style.moveLayer(y,t),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,t,a){return this.style.setLayerZoomRange(y,t,a),this._update(!0)}setFilter(y,t,a={}){return this.style.setFilter(y,t,a),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,t,a,l={}){return this.style.setPaintProperty(y,t,a,l),this._update(!0)}getPaintProperty(y,t){return this.style.getPaintProperty(y,t)}setLayoutProperty(y,t,a,l={}){return this.style.setLayoutProperty(y,t,a,l),this._update(!0)}getLayoutProperty(y,t){return this.style.getLayoutProperty(y,t)}setGlyphs(y,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,t,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,t,a,(l=>{l||this._update(!0)})),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,t,(a=>{a||this._update(!0)})),this}setLight(y,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(y,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(y,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(y,t){return this.style.setFeatureState(y,t),this._update()}removeFeatureState(y,t){return this.style.removeFeatureState(y,t),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,t=0;return this._container&&(y=this._container.clientWidth||400,t=this._container.clientHeight||300),[y,t]}_setupResizeObserver(){var y;let t=!1;const a=od((f=>{this._trackResize&&!this._removed&&(this.resize(f),this.redraw())}),50),l=(y=this._ownerWindow.ResizeObserver)!==null&&y!==void 0?y:ResizeObserver;this._resizeObserver=new l((f=>{t?a(f):t=!0})),this._resizeObserver.observe(this._container)}_resolveContainer(y){if(typeof y=="string"){const t=document.getElementById(y);if(!t)throw new Error(`Container '${y}' not found.`);return t}if(y instanceof HTMLElement||y&&typeof y=="object"&&y.nodeType===1)return y;throw new Error("Invalid type: 'container' must be a String or HTMLElement.")}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const t=this._canvasContainer=le.create("div","maplibregl-canvas-container",y);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=le.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),l=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],l);const f=this._controlContainer=le.create("div","maplibregl-control-container",y),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((b=>{x[b]=le.create("div",`maplibregl-ctrl-${b} `,f)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,t,a){this._canvas.width=Math.floor(a*y),this._canvas.height=Math.floor(a*t),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const y=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",(l=>{t={requestedAttributes:y},l&&(t.statusMessage=l.statusMessage,t.type=l.type)}),{once:!0});let a=null;if(a=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,y):this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y),!a){const l="Failed to initialize WebGL";throw t?(t.message=l,new Error(JSON.stringify(t))):new Error(l)}this.painter=new Mf(a,this.transform),Xe.testSupport(a)}migrateProjection(y,t){super.migrateProjection(y,t),this.painter.transform=y,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){var t,a,l,f,x;const b=this._idleTriggered?this._fadeDuration:0,E=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let D=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,N=xe();this.style.zoomHistory.update(U,N);const H=new c.H(U,{now:N,fadeDuration:b,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Q=H.crossFadingFactor();Q===1&&Q===this._crossFadingFactor||(D=!0,this._crossFadingFactor=Q),this.style.update(H)}const k=((a=this.style.projection)===null||a===void 0?void 0:a.transitionState)>0!==E;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((f=this.style.projection)===null||f===void 0?void 0:f.transitionState,(x=this.style.projection)===null||x===void 0?void 0:x.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||k)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,b,this._crossSourceCollisions,k),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cH.mark(c.cI.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||D)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const j=this._sourcesDirty||this._styleDirty||this._placementDirty;return j||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||j||(this._fullyLoaded=!0,c.cH.mark(c.cI.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&this._ownerWindow.removeEventListener("online",this._onWindowOnline,!1),_t.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),le.remove(this._canvasContainer),le.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cH.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,De.frame(this._frameRequest,(y=>{c.cH.frame(y),this._frameRequest=null;try{this._render(y)}catch(t){if(!c.Z(t)&&!(function(a){return a.message===Do})(t))throw t}}),(()=>{}),this._ownerWindow))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return gl}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(y){return this._lazyInitEmptyStyle(),this.style.setProjection(y),this._update(!0)}},M.MapMouseEvent=Xn,M.MapTouchEvent=$a,M.MapWheelEvent=ah,M.Marker=yu,M.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const t=this._map.getZoom(),a=t===this._map.getMaxZoom(),l=t===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,a)=>{const l=this._map._getUIString(`NavigationControl.${a}`);t.title=l,t.setAttribute("aria-label",l)},this.options=c.e({},hd,y),this._container=le.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),le.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),le.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=le.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Yi(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){le.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,t){const a=le.create("button",y,this._container);return a.type="button",a.addEventListener("click",t),a}},M.Popup=class extends c.E{constructor(y){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&le.remove(this._content),this._container&&(le.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=le.create("div","maplibregl-popup",this._map.getContainer()),this._tip=le.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const b of this.options.className.split(" "))this._container.classList.add(b);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=uc(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const a=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let l=this.options.anchor;const f=dc(this.options.offset);if(!l){const b=this._container.offsetWidth,E=this._container.offsetHeight,D=(function(j){var U,N,H,Q;return j?{top:(U=j.top)!==null&&U!==void 0?U:0,right:(N=j.right)!==null&&N!==void 0?N:0,bottom:(H=j.bottom)!==null&&H!==void 0?H:0,left:(Q=j.left)!==null&&Q!==void 0?Q:0}:{top:0,right:0,bottom:0,left:0}})(this.options.padding);let k;k=a.y+f.bottom.y<E+D.top?["top"]:a.y>this._map.transform.height-E-D.bottom?["bottom"]:[],a.x<b/2+D.left?k.push("left"):a.x>this._map.transform.width-b/2-D.right&&k.push("right"),l=k.length===0?"bottom":k.join("-")}let x=a.add(f[l]);this.options.subpixelPositioning||(x=x.round()),le.setTransform(this._container,`${hc[l]} translate(${x.x}px,${x.y}px)`),gu(this._container,l,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(yl),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=c.V.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const t=document.createDocumentFragment(),a=document.createElement("body");let l;for(a.innerHTML=y;l=a.firstChild,l;)t.appendChild(l);return this.setDOMContent(t)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=le.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){return this._container&&this._container.classList.add(y),this}removeClassName(y){return this._container&&this._container.classList.remove(y),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}setPadding(y){this.options.padding=y,this._update()}_createCloseButton(){this.options.closeButton&&(this._closeButton=le.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(_l);y&&y.focus()}},M.RasterDEMTileSource=ba,M.RasterTileSource=fo,M.ScaleControl=class{constructor(y){this._onMove=()=>{nn(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,nn(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},dr),y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=le.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){le.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},M.ScrollZoomHandler=du,M.Style=bo,M.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=le.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=le.create("button","maplibregl-ctrl-terrain",this._container),le.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){le.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},M.TwoFingersTouchPitchHandler=Ks,M.TwoFingersTouchRotateHandler=hu,M.TwoFingersTouchZoomHandler=zs,M.TwoFingersTouchZoomRotateHandler=pl,M.VectorTileSource=ho,M.VideoSource=Fs,M.addSourceType=(y,t)=>c._(void 0,void 0,void 0,(function*(){if(Vl(y))throw new Error(`A source type called "${y}" already exists.`);((a,l)=>{Ns[a]=l})(y,t)})),M.clearPrewarmedResources=function(){const y=hi;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(zt),hi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},M.createTileMesh=df,M.getMaxParallelImageRequests=function(){return c.c.MAX_PARALLEL_IMAGE_REQUESTS},M.getRTLTextPluginStatus=function(){return J().getRTLTextPluginStatus()},M.getVersion=function(){return Qa},M.getWorkerCount=function(){return Ht.workerCount},M.getWorkerUrl=function(){return c.c.WORKER_URL},M.importScriptInWorkers=function(y){return Kr().broadcast("IS",y)},M.isTimeFrozen=function(){return Ze.isFrozen()},M.now=xe,M.prewarm=function(){Xi().acquire(zt)},M.restoreNow=function(){Ze.restoreNow()},M.setMaxParallelImageRequests=function(y){c.c.MAX_PARALLEL_IMAGE_REQUESTS=y},M.setNow=function(y){Ze.setNow(y)},M.setRTLTextPlugin=function(y,t){return J().setRTLTextPlugin(y,t)},M.setWorkerCount=function(y){Ht.workerCount=y},M.setWorkerUrl=function(y){c.c.WORKER_URL=y}}));var B=T;return B}))})(Cy)),Cy.exports}YA();function WA({value:d,onChange:g,min:T=300,max:S=1e5,step:I=100,className:B=""}){const[M,c]=Se.useState(!1),V=Se.useCallback(de=>de>=1e3?`${(de/1e3).toFixed(de>=1e4?0:1)}k`:de.toString(),[]),X=(d-T)/(S-T)*100,te=(de=>de<500?{name:"Growing Fleet",color:"text-green-500"}:de<2e3?{name:"Mid-Size Fleet",color:"text-primary"}:de<1e4?{name:"Large Fleet",color:"text-purple-500"}:{name:"Enterprise Fleet",color:"text-secondary"})(d);return R.jsxs("div",{className:`space-y-4 ${B}`,children:[R.jsxs("div",{className:"flex items-center justify-between",children:[R.jsx("label",{className:"text-sm font-medium text-dark-600 dark:text-dark-300",children:"Fleet Size"}),R.jsx("span",{className:`text-sm font-medium ${te.color}`,children:te.name})]}),R.jsxs("div",{className:"relative",children:[R.jsx("div",{className:"h-3 bg-dark-100 dark:bg-dark-700 rounded-full overflow-hidden",children:R.jsx(Ri.div,{className:"h-full bg-gradient-to-r from-primary to-secondary rounded-full",style:{width:`${X}%`},animate:{width:`${X}%`},transition:{type:"spring",stiffness:300,damping:30}})}),R.jsx("input",{type:"range",min:T,max:S,step:I,value:d,onChange:de=>g(Number(de.target.value)),onMouseDown:()=>c(!0),onMouseUp:()=>c(!1),onTouchStart:()=>c(!0),onTouchEnd:()=>c(!1),className:"absolute inset-0 w-full h-3 opacity-0 cursor-pointer",style:{margin:0}}),R.jsx(Ri.div,{className:"absolute top-1/2 -translate-y-1/2 w-6 h-6 bg-white rounded-full shadow-lg border-2 border-primary pointer-events-none",style:{left:`calc(${X}% - 12px)`},animate:{scale:M?1.2:1,boxShadow:M?"0 0 20px rgba(35, 122, 189, 0.5)":"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},transition:{type:"spring",stiffness:400,damping:25},children:R.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:R.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"})})})]}),R.jsxs("div",{className:"flex justify-between text-xs text-dark-400 dark:text-dark-500",children:[R.jsx("span",{children:V(T)}),R.jsx("span",{children:V(Math.round((S-T)*.25+T))}),R.jsx("span",{children:V(Math.round((S-T)*.5+T))}),R.jsx("span",{children:V(Math.round((S-T)*.75+T))}),R.jsx("span",{children:V(S)})]}),R.jsx("div",{className:"text-center",children:R.jsxs(Ri.div,{className:"inline-flex items-baseline gap-2 bg-dark-50 dark:bg-dark-800 px-4 py-2 rounded-lg",animate:{scale:M?1.05:1},transition:{type:"spring",stiffness:400,damping:25},children:[R.jsx("span",{className:"text-3xl font-bold text-dark-900 dark:text-white",children:d.toLocaleString()}),R.jsx("span",{className:"text-dark-500 dark:text-dark-400",children:"vehicles"})]})})]})}function $1(d={}){const{threshold:g=.1,rootMargin:T="0px",triggerOnce:S=!0}=d,I=Se.useRef(null),[B,M]=Se.useState(!1);return Se.useEffect(()=>{const c=I.current;if(!c)return;const V=new IntersectionObserver(([X])=>{X.isIntersecting?(M(!0),S&&V.unobserve(c)):S||M(!1)},{threshold:g,rootMargin:T});return V.observe(c),()=>V.disconnect()},[g,T,S]),{ref:I,isVisible:B}}const Lv={up:{y:30},down:{y:-30},left:{x:30},right:{x:-30},none:{}};function ti({children:d,direction:g="up",delay:T=0,duration:S=.6,className:I="",threshold:B=.1}){const{ref:M,isVisible:c}=$1({threshold:B});return R.jsx(Ri.div,{ref:M,initial:{opacity:0,...Lv[g]},animate:c?{opacity:1,x:0,y:0}:{opacity:0,...Lv[g]},transition:{duration:S,delay:T,ease:"easeOut"},className:I,children:d})}function U0({children:d,staggerDelay:g=.1,className:T=""}){const{ref:S,isVisible:I}=$1({threshold:.1});return R.jsx(Ri.div,{ref:S,initial:"hidden",animate:I?"visible":"hidden",variants:{hidden:{},visible:{transition:{staggerChildren:g}}},className:T,children:d})}function G0({children:d,className:g=""}){return R.jsx(Ri.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},transition:{duration:.5,ease:"easeOut"},className:g,children:d})}function KA({className:d=""}){const g=Se.useRef(null),T=Se.useRef([]),S=Se.useRef({x:0,y:0}),I=Se.useRef(void 0);return Se.useEffect(()=>{const B=g.current;if(!B)return;const M=B.getContext("2d");if(!M)return;const c=()=>{B.width=window.innerWidth,B.height=window.innerHeight,K()},V=xe=>{const le=B.getBoundingClientRect(),Xe=B.width/le.width,Ve=B.height/le.height;S.current.x=(xe.clientX-le.left)*Xe,S.current.y=(xe.clientY-le.top)*Ve},X=xe=>{const le=B.getBoundingClientRect(),Xe=B.width/le.width,Ve=B.height/le.height;S.current.x=(xe.touches[0].clientX-le.left)*Xe,S.current.y=(xe.touches[0].clientY-le.top)*Ve},K=()=>{const xe=[],le=B.width*B.height,Xe=1920*1080,Ve=Math.min(1,le/Xe),Ue=Math.floor(150*Ve),gt=Math.floor(15*Ve);for(let pt=0;pt<Ue;pt++){const Dt=Math.random()*B.width,_t=Math.random()*B.height;xe.push({x:Dt,y:_t,baseX:Dt,baseY:_t,speed:.25,direction:Math.random()*Math.PI*2,radius:Math.random()*4.5+.5,isFloating:!1})}for(let pt=0;pt<gt;pt++){const Dt=Math.random()*B.width,_t=Math.random()*B.height;xe.push({x:Dt,y:_t,baseX:Dt,baseY:_t,originalX:Dt,speed:.01+Math.random()*.2,direction:0,radius:Math.random()*4.5+.5,isFloating:!0,amplitude:Math.random()*10+1,period:Math.random()*.25+.02,phase:Math.random()*Math.PI*2})}T.current=xe},te=xe=>{const le=S.current;xe.isFloating?(xe.y-=xe.speed,xe.x=(xe.originalX||0)+Math.sin(xe.y*(xe.period||.1)+(xe.phase||0))*(xe.amplitude||5),xe.y<0&&(xe.y=B.height,xe.originalX=Math.random()*B.width)):(xe.x+=Math.cos(xe.direction)*xe.speed,xe.y+=Math.sin(xe.direction)*xe.speed,(xe.x<0||xe.x>B.width)&&(xe.direction=Math.PI-xe.direction),(xe.y<0||xe.y>B.height)&&(xe.direction=-xe.direction));const Xe=le.x-xe.x,Ve=le.y-xe.y,Ue=Math.sqrt(Xe*Xe+Ve*Ve);if(Ue<150){const gt=(200-Ue)/200,pt=Math.atan2(Ve,Xe);xe.x-=Math.cos(pt)*gt*5,xe.y-=Math.sin(pt)*gt*5}T.current.forEach(gt=>{if(gt!==xe){const pt=gt.x-xe.x,Dt=gt.y-xe.y,_t=Math.sqrt(pt*pt+Dt*Dt);if(_t<80){const Mt=(80-_t)/80;xe.x-=pt*Mt*.08,xe.y-=Dt*Mt*.08}}})},de=xe=>{const le=M.createRadialGradient(xe.x,xe.y,0,xe.x,xe.y,xe.radius);le.addColorStop(0,"rgba(255, 255, 255, 0.5)"),le.addColorStop(1,"rgba(255, 255, 255, 0)"),M.beginPath(),M.arc(xe.x,xe.y,xe.radius,0,Math.PI*2),M.fillStyle=le,M.fill()},De=()=>{const xe=T.current;for(let le=0;le<xe.length;le++)for(let Xe=le+1;Xe<xe.length;Xe++){const Ve=xe[le].x-xe[Xe].x,Ue=xe[le].y-xe[Xe].y,gt=Math.sqrt(Ve*Ve+Ue*Ue);if(gt>100&&gt<250){const pt=1-(gt-100)/150;M.beginPath(),M.strokeStyle=`rgba(99, 102, 241, ${pt*.3})`,M.lineWidth=.5,M.moveTo(xe[le].x,xe[le].y),M.lineTo(xe[Xe].x,xe[Xe].y),M.stroke()}}},Ze=()=>{const xe=M.createLinearGradient(0,0,0,B.height);xe.addColorStop(0,"#0a0a1a"),xe.addColorStop(.5,"#0d0d2b"),xe.addColorStop(1,"#000000"),M.fillStyle=xe,M.fillRect(0,0,B.width,B.height),T.current.forEach(le=>{te(le),de(le)}),De(),I.current=requestAnimationFrame(Ze)};return c(),window.addEventListener("resize",c),window.addEventListener("mousemove",V),window.addEventListener("touchmove",X,{passive:!0}),Ze(),()=>{I.current&&cancelAnimationFrame(I.current),window.removeEventListener("resize",c),window.removeEventListener("mousemove",V),window.removeEventListener("touchmove",X)}},[]),R.jsx("canvas",{ref:g,className:`absolute inset-0 w-full h-full ${d}`,style:{touchAction:"none"}})}function QA(){return R.jsxs("section",{className:"relative min-h-screen flex items-start overflow-hidden bg-dark-900",children:[R.jsx(KA,{}),R.jsx(xa,{size:700,color:"primary",top:"-15%",right:"-10%",opacity:.25,blur:120,animation:"float-slow"}),R.jsx(xa,{size:500,color:"mixed",bottom:"5%",left:"-8%",opacity:.2,blur:100,animation:"float-delayed",delay:1}),R.jsx(xa,{size:300,color:"secondary",top:"50%",right:"15%",opacity:.15,blur:80,animation:"float",delay:2}),R.jsx(Ay,{shape:"square",size:120,top:"15%",right:"20%",rotate:15,opacity:.08,color:"primary",delay:.5}),R.jsx(Ay,{shape:"arc",size:80,bottom:"25%",right:"10%",rotate:-30,opacity:.1,color:"gradient",delay:.8}),R.jsx(Ay,{shape:"corner",size:60,top:"40%",left:"5%",rotate:45,opacity:.06,color:"secondary",delay:1.1}),R.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-dark-900/80 via-transparent to-transparent"}),R.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-dark-900 via-transparent to-dark-900/50"}),R.jsx(Uh,{className:"relative z-10 pt-20 pb-16 md:pt-24 md:pb-20 lg:pt-28 lg:pb-24",children:R.jsxs("div",{className:"max-w-4xl",children:[R.jsxs(Ri.div,{className:"flex items-center gap-4 mb-10",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6},children:[R.jsx("div",{className:"h-px w-12 bg-gradient-to-r from-primary to-secondary"}),R.jsx("span",{className:"text-dark-400 text-sm font-medium tracking-wider uppercase",children:"Fuel Optimization Platform"})]}),R.jsxs(Ri.h1,{className:"text-5xl sm:text-6xl md:text-7xl lg:text-8xl font-bold text-white mb-8 leading-[1.05] tracking-tight text-balance",initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.8,delay:.1,ease:[.25,.1,.25,1]},children:["Driving Fleet Efficiency",R.jsx("br",{}),R.jsx("span",{className:"gradient-text-hero",children:"Through Data-Driven Insights"})]}),R.jsx(Ri.p,{className:"text-xl md:text-2xl text-dark-300 mb-12 max-w-2xl leading-relaxed text-balance",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.7,delay:.25},children:"CypherFuel combines telemetry, topography, engine performance and driver behaviour analytics to give fleet owners a complete view of fuel efficiencyand the insights to improve it."}),R.jsxs(Ri.div,{className:"flex flex-col sm:flex-row gap-4",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.7,delay:.4},children:[R.jsx(Ga,{as:"link",to:"/schedule-demo",size:"lg",className:"group relative !px-10 !py-5 !text-lg !font-semibold overflow-hidden animate-glow-pulse",children:R.jsxs("span",{className:"relative z-10 flex items-center",children:["Request a Demo",R.jsx("svg",{className:"w-5 h-5 ml-3 transition-transform group-hover:translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})}),R.jsx(Ga,{as:"link",to:"/how-it-works",variant:"ghost",size:"lg",className:"!border !border-white/20 !text-white hover:!bg-white/5 !px-10 !py-5 !text-lg backdrop-blur-sm transition-all hover:!border-white/30",children:"See How It Works"})]}),R.jsxs(Ri.div,{className:"mt-16 relative max-w-5xl",initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6},children:[R.jsx("div",{className:"rounded-2xl overflow-hidden border border-dark-700/50 shadow-2xl bg-dark-800/30 backdrop-blur-sm",children:R.jsx("img",{src:"/images/screenshots/cypherFuel-dashboard-1.png",alt:"CypherFuel Fuel Optimization Dashboard",className:"w-full",loading:"eager"})}),R.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-dark-900 via-transparent to-transparent pointer-events-none"}),R.jsx("div",{className:"absolute -inset-4 bg-gradient-to-r from-primary/10 via-transparent to-secondary/10 blur-3xl -z-10 opacity-50"})]})]})}),R.jsx(Ri.div,{className:"absolute bottom-10 left-1/2 -translate-x-1/2",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.5},children:R.jsxs(Ri.div,{className:"flex flex-col items-center gap-2",animate:{y:[0,8,0]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut"},children:[R.jsx("span",{className:"text-dark-500 text-xs tracking-widest uppercase",children:"Scroll"}),R.jsx("svg",{className:"w-5 h-5 text-dark-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})]})})]})}function JA(){return R.jsxs(gr,{background:"alt",className:"relative",children:[R.jsx(xa,{size:400,color:"primary",top:"20%",left:"-10%",opacity:.08,blur:100,animation:"float-slow"}),R.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[R.jsx(ti,{children:R.jsx(Bu,{title:"Fuel is Your Biggest Variable Cost. Why Are You Still Guessing?",align:"center",accentLine:!0})}),R.jsx(ti,{delay:.2,children:R.jsxs("div",{className:"space-y-6 text-lg md:text-xl text-dark-600 dark:text-dark-300 leading-relaxed",children:[R.jsx("p",{children:"Fuel accounts for up to 30% of total fleet operating costsyet most fleet managers rely on simple mileage-based tracking that tells only part of the story."}),R.jsx("p",{children:"The reality is that fuel consumption is influenced by dozens of interconnected factors: driver technique, terrain, payload, vehicle condition, weather, and more. Without visibility into these variables, inefficiencies go undetected, costs accumulate, and corrective action comes too late."}),R.jsx("p",{className:"text-dark-900 dark:text-white font-semibold text-xl md:text-2xl mt-8",children:"Traditional fleet management shows you what happened. CypherFuel reveals whyand how to fix it."})]})})]})]})}const eC=[{value:"Up to 20%",label:"Fuel reduction achievable",source:"ODYSSEE-MURE / European eco-driving initiatives"},{value:"2-4+ L/Hour",label:"Wasted by engine idling alone",source:"U.S. Department of Energy"},{value:"Up to 33%",label:"Of fuel consumption is tire-related",source:"Continental Tire / NACFE / U.S. DOE"}],tC=["Identify inefficiencies at the fleet, vehicle, and driver level","Understand root causes through multi-factor analysis","Take corrective action with AI-powered recommendations","Track improvements with daily comparisons and trend analysis"];function iC(){return R.jsxs(gr,{background:"default",className:"relative",children:[R.jsx(xa,{size:500,color:"secondary",top:"10%",right:"-10%",opacity:.1,blur:100,animation:"float-delayed"}),R.jsxs("div",{className:"max-w-5xl mx-auto",children:[R.jsx(ti,{children:R.jsx(Bu,{title:"A 360 View of Fleet Fuel Efficiency",align:"center",accentLine:!0})}),R.jsx(ti,{delay:.1,children:R.jsx("p",{className:"text-lg md:text-xl text-dark-600 dark:text-dark-300 text-center mb-8 max-w-3xl mx-auto leading-relaxed",children:"CypherFuel is an add-on analytics platform that integrates with your existing fleet management and telematics systems. We don't replace your current toolswe make them smarter."})}),R.jsx(ti,{delay:.2,children:R.jsx("p",{className:"text-lg md:text-xl text-dark-600 dark:text-dark-300 text-center mb-12 max-w-3xl mx-auto leading-relaxed",children:"By combining real-time engine telemetry with topography data and advanced driver behaviour analysis, CypherFuel delivers actionable insights that help you:"})}),R.jsx(U0,{className:"grid md:grid-cols-2 gap-4 mb-16 max-w-3xl mx-auto",children:tC.map((d,g)=>R.jsx(G0,{children:R.jsxs(Ri.div,{className:"flex items-start gap-3 p-4 rounded-xl bg-dark-800/30 border border-dark-700/30",whileHover:{x:4,borderColor:"rgba(35, 122, 189, 0.3)"},transition:{duration:.2},children:[R.jsx("div",{className:"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:R.jsx(wn,{name:"check",size:16,className:"text-green-400"})}),R.jsx("span",{className:"text-dark-700 dark:text-dark-200",children:d})]})},g))}),R.jsx(ti,{delay:.4,children:R.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:eC.map((d,g)=>R.jsxs("div",{className:"text-center",children:[R.jsx("div",{className:"text-4xl md:text-5xl font-bold gradient-text-hero mb-3",children:d.value}),R.jsx("div",{className:"text-lg text-dark-900 dark:text-white font-medium mb-2",children:d.label}),R.jsxs("div",{className:"text-sm text-dark-500 dark:text-dark-400",children:["Source: ",d.source]})]},g))})})]})]})}const nC=[{number:"01",title:"Connect",subtitle:"Seamless Integration",description:"CypherFuel connects to your existing fleet management or telematics platform via data streaming. No hardware changes, no system replacementjust enhanced intelligence on top of what you already have.",icon:"puzzle"},{number:"02",title:"Analyze",subtitle:"Multi-Factor Scoring",description:"Our platform evaluates every trip across 20+ metrics spanning four categories: road conditions, environmental factors, vehicle performance, and driver behaviour. Each factor is weighted and scored to provide a comprehensive efficiency picture.",icon:"analytics"},{number:"03",title:"Act",subtitle:"AI-Powered Recommendations",description:"CypherFuel's intelligent insights engine generates specific, prioritized recommendations for each driver and vehicletelling you exactly what to address first for maximum impact.",icon:"chart"}];function rC(){return R.jsxs(gr,{background:"alt",className:"relative",children:[R.jsx(xa,{size:450,color:"mixed",top:"15%",right:"-8%",opacity:.09,blur:110,animation:"float-slow"}),R.jsx(ti,{children:R.jsx(Bu,{label:"How It Works",title:"From Data to Decisions in Three Steps",align:"center",accentLine:!0})}),R.jsx("div",{className:"max-w-6xl mx-auto space-y-12",children:nC.map((d,g)=>R.jsx(ti,{delay:g*.2,children:R.jsxs(Ri.div,{className:"grid lg:grid-cols-2 gap-8 lg:gap-12 items-center",whileHover:{scale:1.01},transition:{duration:.3},children:[R.jsxs("div",{className:`${g%2===1?"lg:order-2":""}`,children:[R.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[R.jsx("div",{className:"text-6xl font-bold text-primary/20",children:d.number}),R.jsxs("div",{children:[R.jsx("h3",{className:"text-3xl font-bold text-dark-900 dark:text-white mb-1",children:d.title}),R.jsx("p",{className:"text-primary-600 dark:text-primary-400 font-medium",children:d.subtitle})]})]}),R.jsx("p",{className:"text-lg text-dark-600 dark:text-dark-300 leading-relaxed",children:d.description})]}),R.jsx("div",{className:`${g%2===1?"lg:order-1":""}`,children:R.jsx("div",{className:"relative aspect-square max-w-md mx-auto",children:d.number==="01"?R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"absolute inset-0 rounded-2xl overflow-hidden",children:R.jsx("img",{src:"/images/Connect.png",alt:"Connect - Seamless Integration",className:"w-full h-full object-cover"})}),R.jsx("div",{className:"absolute -inset-4 bg-gradient-to-br from-primary/5 to-secondary/5 blur-2xl -z-10 opacity-50"})]}):d.number==="02"?R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"absolute inset-0 rounded-2xl overflow-hidden",children:R.jsx("img",{src:"/images/Analyze.png",alt:"Analyze - Multi-Factor Scoring",className:"w-full h-full object-cover"})}),R.jsx("div",{className:"absolute -inset-4 bg-gradient-to-br from-primary/5 to-secondary/5 blur-2xl -z-10 opacity-50"})]}):d.number==="03"?R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"absolute inset-0 rounded-2xl overflow-hidden",children:R.jsx("img",{src:"/images/Act.png",alt:"Act - AI-Powered Recommendations",className:"w-full h-full object-cover"})}),R.jsx("div",{className:"absolute -inset-4 bg-gradient-to-br from-primary/5 to-secondary/5 blur-2xl -z-10 opacity-50"})]}):R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-br from-dark-800/50 to-dark-700/30 backdrop-blur-sm border border-dark-700/50 flex items-center justify-center",children:R.jsx("div",{className:"w-32 h-32 rounded-2xl bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center",children:R.jsx(wn,{name:d.icon,size:64,className:"text-primary"})})}),R.jsx("div",{className:"absolute -inset-4 bg-gradient-to-br from-primary/5 to-secondary/5 blur-2xl -z-10 opacity-50"})]})})})]})},d.number))})]})}const aC=[{title:"Road Conditions",icon:"route",factors:["Road types (highway vs. urban)","Speed limit compliance","Traffic patterns"],whyItMatters:"Highway driving provides optimal fuel economy with consistent speeds, while urban roads increase consumption due to stop-and-go traffic.",color:"from-blue-500/20 to-blue-600/5",iconColor:"text-blue-400"},{title:"Environmental Factors",icon:"settings",factors:["Operating altitude","Air temperature","Elevation gain and loss"],whyItMatters:"Higher altitudes reduce air density, leading to incomplete combustion and increased fuel usage. Temperatures above 30C increase high-consumption probability by 57%.",source:"Ghazikhani et al.; Gong et al., 2021",color:"from-green-500/20 to-green-600/5",iconColor:"text-green-400"},{title:"Vehicle Factors",icon:"fuel",factors:["Aerodynamic drag","Gross Combination Weight (GCW) / Payload","Maintenance compliance","Tire rolling resistance","Neutral and powertrain coasting"],whyItMatters:"Tires alone can account for up to one-third of total fuel consumption. Wheel misalignment can increase consumption by up to 18.5%.",source:"Goodyear",color:"from-orange-500/20 to-orange-600/5",iconColor:"text-orange-400"},{title:"Driver Factors",icon:"user",factors:["Accelerator pedal technique","Green band (optimal RPM) driving","Cruise control usage and effectiveness","Idle time","Speed management","Acceleration and braking patterns","Coasting and eco-roll utilization"],whyItMatters:'Driver behaviour can "wipe out" gains from fuel-efficient tires, aerodynamic devices, and engine improvements. Conversely, eco-driving training programs consistently deliver 5-15% fuel savings.',source:"Goodyear; multiple academic studies",color:"from-purple-500/20 to-purple-600/5",iconColor:"text-purple-400"}];function sC(){return R.jsxs(gr,{background:"default",className:"relative",children:[R.jsx(xa,{size:500,color:"primary",bottom:"10%",left:"-10%",opacity:.08,blur:120,animation:"float-slow"}),R.jsx(ti,{children:R.jsx(Bu,{label:"Comprehensive Scoring",title:"We Measure What Matters",description:"Fuel efficiency isn't just about how someone drivesit's about understanding the full context. CypherFuel evaluates performance across four interconnected categories:",align:"center",accentLine:!0})}),R.jsx(U0,{className:"grid md:grid-cols-2 gap-6 max-w-6xl mx-auto",children:aC.map(d=>R.jsx(G0,{children:R.jsxs(Ri.div,{className:"h-full p-6 md:p-8 rounded-2xl bg-dark-800/50 backdrop-blur-sm border border-dark-700/50 hover:border-primary/30 transition-colors duration-300",whileHover:{y:-4,boxShadow:"0 20px 40px -15px rgba(35, 122, 189, 0.15)"},transition:{duration:.25},children:[R.jsx("div",{className:`w-16 h-16 rounded-xl bg-gradient-to-br ${d.color} flex items-center justify-center mb-6`,children:R.jsx(wn,{name:d.icon,size:32,className:d.iconColor})}),R.jsx("h3",{className:"text-2xl font-bold text-dark-900 dark:text-white mb-4",children:d.title}),R.jsx("div",{className:"space-y-4 mb-6",children:d.factors.map((g,T)=>R.jsxs("div",{className:"flex items-start gap-3",children:[R.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-primary mt-2.5 flex-shrink-0"}),R.jsx("span",{className:"text-dark-600 dark:text-dark-300",children:g})]},T))}),R.jsxs("div",{className:"pt-4 border-t border-dark-700/50",children:[R.jsx("p",{className:"text-sm font-semibold text-primary-600 dark:text-primary-400 mb-2",children:"Why it matters:"}),R.jsx("p",{className:"text-dark-700 dark:text-dark-400 text-sm leading-relaxed mb-2",children:d.whyItMatters}),d.source&&R.jsxs("p",{className:"text-xs text-dark-500",children:["Source: ",d.source]})]})]})},d.title))})]})}const oC=[{icon:"user",title:"Personalized",description:"Tailored to individual driving patterns and vehicle characteristics"},{icon:"chart",title:"Prioritized",description:"Ranked by potential impact so you know what to address first"},{icon:"check",title:"Specific",description:"Concrete targets and techniques, not vague suggestions"},{icon:"settings",title:"Contextual",description:"Accounting for route, load, and environmental conditions"}];function lC(){return R.jsxs(gr,{background:"alt",className:"relative",children:[R.jsx(xa,{size:400,color:"secondary",top:"20%",right:"-10%",opacity:.1,blur:100,animation:"pulse"}),R.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center max-w-6xl mx-auto",children:[R.jsxs("div",{children:[R.jsx(ti,{children:R.jsx(Bu,{label:"AI-Powered",title:"Intelligent Recommendations, Not Just Reports",align:"left",accentLine:!0})}),R.jsx(ti,{delay:.1,children:R.jsx("p",{className:"text-lg text-dark-600 dark:text-dark-300 mb-8 leading-relaxed",children:"Data is only valuable if you can act on it. CypherFuel's AI engine analyzes trip information, scoring patterns, and historical performance to generate specific, actionable recommendations for each driver."})}),R.jsx(ti,{delay:.2,children:R.jsx("p",{className:"text-lg text-dark-600 dark:text-dark-300 mb-8 leading-relaxed",children:"Unlike generic advice, our insights are:"})}),R.jsx("div",{className:"grid sm:grid-cols-2 gap-4 mb-8",children:oC.map((d,g)=>R.jsx(ti,{delay:.3+g*.1,children:R.jsxs(Ri.div,{className:"flex items-start gap-3",whileHover:{x:4},transition:{duration:.2},children:[R.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:R.jsx(wn,{name:d.icon,size:20,className:"text-primary"})}),R.jsxs("div",{children:[R.jsx("h4",{className:"font-semibold text-dark-900 dark:text-white mb-1",children:d.title}),R.jsx("p",{className:"text-sm text-dark-700 dark:text-dark-400",children:d.description})]})]})},d.title))})]}),R.jsx(ti,{direction:"right",delay:.2,children:R.jsxs("div",{className:"rounded-2xl bg-dark-800/50 backdrop-blur-sm border border-dark-700/50 p-6 md:p-8",children:[R.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[R.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center",children:R.jsx(wn,{name:"chart",size:24,className:"text-primary"})}),R.jsxs("div",{children:[R.jsx("h4",{className:"font-semibold text-dark-900 dark:text-white",children:"Example Output"}),R.jsx("p",{className:"text-sm text-dark-700 dark:text-dark-400",children:"AI-Generated Recommendations"})]})]}),R.jsxs("div",{className:"space-y-4 text-sm text-dark-700 dark:text-dark-300 leading-relaxed",children:[R.jsxs("div",{className:"p-4 rounded-lg bg-dark-900/50 border border-primary/20",children:[R.jsx("p",{className:"font-medium text-primary-400 mb-2",children:" Optimize accelerator pedal technique"}),R.jsx("p",{children:"Your 58.10% score indicates excessive throttle application; gentler acceleration can reduce fuel consumption dramatically."})]}),R.jsxs("div",{className:"p-4 rounded-lg bg-dark-900/50 border border-green-500/20",children:[R.jsx("p",{className:"font-medium text-green-400 mb-2",children:" Increase coasting and eco-roll usage"}),R.jsx("p",{children:"At only 9.07%, significantly more coasting during deceleration will reduce engine load and improve overall efficiency."})]}),R.jsxs("div",{className:"p-4 rounded-lg bg-dark-900/50 border border-blue-500/20",children:[R.jsx("p",{className:"font-medium text-blue-400 mb-2",children:" Maximize cruise control utilization"}),R.jsx("p",{children:"Boost usage from 74.22% to 85%+ on suitable terrain to maintain optimal speeds and reduce fuel variability."})]}),R.jsxs("div",{className:"p-4 rounded-lg bg-dark-900/50 border border-orange-500/20",children:[R.jsx("p",{className:"font-medium text-orange-400 mb-2",children:" Priority Focus"}),R.jsx("p",{children:"Your vehicle performance score of 53.71% is the primary concern. Address accelerator usage and coasting techniques first, as these driver behaviours directly impact your heaviest efficiency factor."})]})]})]})})]})]})}const cC=[{icon:"fuel",title:"Reduce Fuel Costs",description:"Targeted driver coaching based on actual behaviour data. Industry research shows eco-driving programs deliver 5-15% fuel savings, with some fleets achieving 20% or more through sustained engagement.",color:"from-green-500/20 to-green-600/5",iconBg:"bg-green-500/10",iconColor:"text-green-400"},{icon:"analytics",title:"Live Running Costs",description:"Real-time visibility into fleet economics. Know what fuel is costing you todaynot at the end of the month when it's too late to act.",color:"from-blue-500/20 to-blue-600/5",iconBg:"bg-blue-500/10",iconColor:"text-blue-400"},{icon:"chart",title:"Prevent Accumulating Inefficiencies",description:"Daily vehicle and driver comparisons enable quick corrective action. Small issues addressed early don't become expensive problems.",color:"from-purple-500/20 to-purple-600/5",iconBg:"bg-purple-500/10",iconColor:"text-purple-400"},{icon:"check",title:"Environmental Impact",description:"Reduced fuel consumption means reduced CO emissions. Meet sustainability goals while improving your bottom line.",color:"from-emerald-500/20 to-emerald-600/5",iconBg:"bg-emerald-500/10",iconColor:"text-emerald-400"},{icon:"puzzle",title:"No System Replacement",description:"CypherFuel integrates with leading fleet management and telematics platforms. Enhance your existing investmentdon't replace it.",color:"from-orange-500/20 to-orange-600/5",iconBg:"bg-orange-500/10",iconColor:"text-orange-400"},{icon:"settings",title:"Data-Driven Maintenance Insights",description:"Identify vehicle issues affecting fuel efficiency before they become costly repairs. Maintenance compliance scoring helps ensure your fleet operates at peak performance.",color:"from-cyan-500/20 to-cyan-600/5",iconBg:"bg-cyan-500/10",iconColor:"text-cyan-400"}];function uC(){return R.jsxs(gr,{background:"default",className:"relative",children:[R.jsx(xa,{size:500,color:"mixed",top:"10%",left:"50%",opacity:.08,blur:120,animation:"pulse"}),R.jsx(ti,{children:R.jsx(Bu,{label:"Benefits",title:"The CypherFuel Advantage",align:"center",accentLine:!0})}),R.jsx(U0,{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-7xl mx-auto",children:cC.map(d=>R.jsx(G0,{children:R.jsxs(Ri.div,{className:"h-full p-6 rounded-2xl bg-dark-800/50 backdrop-blur-sm border border-dark-700/50 hover:border-primary/30 transition-colors duration-300",whileHover:{y:-4,boxShadow:"0 20px 40px -15px rgba(35, 122, 189, 0.15)"},transition:{duration:.25},children:[R.jsx("div",{className:`w-14 h-14 rounded-xl ${d.iconBg} flex items-center justify-center mb-5`,children:R.jsx(wn,{name:d.icon,size:28,className:d.iconColor})}),R.jsx("h3",{className:"text-xl font-bold text-dark-900 dark:text-white mb-3",children:d.title}),R.jsx("p",{className:"text-dark-700 dark:text-dark-400 leading-relaxed",children:d.description})]})},d.title))})]})}const hC=["Transportation research institutions","Vehicle manufacturers' engineering data","Fleet telematics providers analyzing millions of kilometres","Published fuel consumption studies"];function dC(){return R.jsxs(gr,{background:"alt",className:"relative",children:[R.jsx(xa,{size:400,color:"primary",bottom:"10%",right:"-10%",opacity:.08,blur:100,animation:"float-slow"}),R.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[R.jsx(ti,{children:R.jsx(Bu,{label:"Trust",title:"Built on Proven Research",align:"center",accentLine:!0})}),R.jsx(ti,{delay:.1,children:R.jsx("p",{className:"text-lg md:text-xl text-dark-600 dark:text-dark-300 leading-relaxed mb-12",children:"CypherFuel's methodology is grounded in peer-reviewed academic research and validated industry data. Our scoring models incorporate findings from:"})}),R.jsx("div",{className:"grid sm:grid-cols-2 gap-4 mb-12 max-w-2xl mx-auto",children:hC.map((d,g)=>R.jsx(ti,{delay:.2+g*.1,children:R.jsxs(Ri.div,{className:"flex items-start gap-3 p-4 rounded-xl bg-dark-800/50 border border-dark-700/30 text-left",whileHover:{x:4,borderColor:"rgba(35, 122, 189, 0.3)"},transition:{duration:.2},children:[R.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:R.jsx(wn,{name:"check",size:16,className:"text-primary"})}),R.jsx("span",{className:"text-dark-700 dark:text-dark-200",children:d})]})},g))}),R.jsx(ti,{delay:.6,children:R.jsx("p",{className:"text-xl text-dark-900 dark:text-white font-semibold",children:"We don't guess at what affects fuel efficiencywe measure the factors that research has proven to matter."})})]})]})}const By=[{id:"real-time-analytics",title:"Real-Time Fleet Analytics",shortDescription:"Monitor fuel consumption, speed, RPM, acceleration patterns, and engine load across your entire fleet.",fullDescription:"Monitor fuel consumption, speed, RPM, acceleration patterns, and engine load across your entire fleet with intuitive dashboards and visualizations. Get live consumption rate tracking, fleet-wide performance overview, individual vehicle deep-dives, and driver-level analysis with customizable date ranges and comparisons.",icon:"analytics",benefits:["Live consumption rate tracking","Fleet-wide performance overview","Individual vehicle deep-dives","Driver-level analysis","Customizable date ranges and comparisons","Intuitive graphs and charts","Comparative visualizations","Trend analysis displays"]},{id:"multi-factor-scoring",title:"Multi-Factor Efficiency Scoring",shortDescription:"Move beyond simple fuel-per-kilometre metrics with comprehensive scoring across 20+ factors.",fullDescription:"Move beyond simple fuel-per-kilometre or mile metrics. CypherFuel evaluates performance across 20+ factors organized into four categories: Road Conditions, Environmental Factors, Vehicle Factors, and Driver Factorsproviding a holistic efficiency score that accounts for variables beyond driver control.",icon:"chart",benefits:["Overall efficiency score","Category scores across 4 dimensions","Individual metric scores (20+ factors)","Benchmarking against fleet averages","Road conditions impact assessment","Environmental factors analysis","Vehicle performance evaluation","Driver behaviour optimization"]},{id:"ai-recommendations",title:"Intelligent, Actionable Recommendations",shortDescription:"Get intelligent, actionable recommendations prioritized by impact potential.",fullDescription:"CypherFuel's AI engine transforms data into decisions. By analyzing trip information, scoring patterns, and contextual factors, we generate specific recommendations prioritized by impact potential. Unlike generic advice, our insights are personalized, prioritized, specific, and contextualaccounting for route, load, and environmental conditions.",icon:"settings",benefits:["AI has full context of trip information, vehicle data, and scoring models","Recommendations tailored to each driver's specific patterns","Insights prioritized by potential fuel savings impact",'Specific, measurable targets (e.g., "Increase cruise control from 74% to 85%+")',"Contextual recommendations accounting for route, load, and environmental conditions","Clear priority guidance on what to address first"]},{id:"trip-section-analysis",title:"Route Section Analysis",shortDescription:"Analyze specific route segments with granular trip-level data access.",fullDescription:"Don't just analyze tripsanalyze sections within trips. CypherFuel provides granular access to analytic information per trip, enabling fleet owners and driver trainers to review specific route segments, identify problematic sections, and support targeted coaching.",icon:"route",benefits:["Identify problematic route sections","Compare driver performance on identical routes","Optimize route planning based on efficiency data","Support targeted driver coaching conversations","Inform vehicle maintenance decisions"]},{id:"live-running-costs",title:"Real-Time Cost Visibility",shortDescription:"Know what fuel is costing you right nownot at month-end reconciliation.",fullDescription:"Know what fuel is costing you right nownot at month-end reconciliation. CypherFuel calculates live average running costs, giving you immediate visibility into fleet economics with early detection of cost anomalies.",icon:"fuel",benefits:["Immediate cost awareness","Early detection of cost anomalies","Budget tracking and forecasting support","ROI measurement for improvement initiatives"]},{id:"daily-comparisons",title:"Daily Performance Tracking",shortDescription:"Enable quick corrective action with daily vehicle and driver evaluations.",fullDescription:"Vehicle and driver data can be individually evaluated and compared on a daily basis. This enables quick corrective action, preventing inefficiencies from persisting and accumulating over time.",icon:"check",benefits:["Catch issues before they become patterns","Provide timely feedback to drivers","Track improvement from coaching interventions","Maintain accountability and engagement"]},{id:"detailed-reporting",title:"Actionable Reports for Every Stakeholder",shortDescription:"Detailed reports for fleet owners, operations managers, and driver trainers.",fullDescription:"Detailed reports serve as a valuable tool for fleet owners, operations managers, and driver trainers. Get the right level of detail for every use case with fleet overview summaries, vehicle performance reports, driver efficiency scorecards, trip analysis reports, and trend comparisons.",icon:"analytics",benefits:["Fleet overview summaries","Vehicle performance reports","Driver efficiency scorecards","Trip analysis reports","Trend and comparison reports"]},{id:"seamless-integration",title:"Works With Your Existing Systems",shortDescription:"Add-on to your existing fleet management ecosystem with data streaming integration.",fullDescription:"CypherFuel is designed as an add-on to your existing fleet management ecosystem. Data streams from your current telematics and fleet management platforms into CypherFuel, where it's analyzed and enriched with our proprietary scoring and AI insights.",icon:"puzzle",benefits:["Data streaming from existing platforms","iFrame embedding within partner systems","Integration with leading SaaS fleet management platforms","Open to new integration partnerships","No system replacement required"]}];function fC(d){return By.find(g=>g.id===d)}const pC=[{id:"1",quote:"The fuel visibility CypherFuel provides has transformed how we manage our fleet operations. We can finally see exactly where our fuel dollars are going.",author:"Fleet Operations Manager",title:"Logistics Company",company:"Enterprise Customer",featured:!0},{id:"2",quote:"Fuel efficiency was our priority, and CypherFuel delivered. The telemetry analytics give us the insights we need to coach our drivers effectively.",author:"Operations Director",title:"Transportation Company",company:"Enterprise Customer",featured:!0},{id:"3",quote:"Scaling fuel optimization from a few hundred to thousands of vehicles was seamless. The platform handles our growing fleet without missing a beat.",author:"CTO",title:"Transit Authority",company:"Enterprise Customer",featured:!0},{id:"4",quote:"The per-trip analytics are exactly what we needed. We can now identify which routes and drivers need attention to improve overall fleet efficiency.",author:"Operations Manager",title:"Field Services",company:"Enterprise Customer"},{id:"5",quote:"Integration with our existing telemetry systems was straightforward. The API is well-documented and the technical support team was incredibly helpful.",author:"IT Director",title:"Carrier Company",company:"Enterprise Customer"},{id:"6",quote:"The interactive reports and visualizations surface insights we never knew we needed. It's like having a fuel analyst that never sleeps.",author:"Data Analytics Lead",title:"Delivery Network",company:"Enterprise Customer"}];pC.filter(d=>d.featured);const jv={"real-time-analytics":"/images/screenshots/cypherFuel-dashboard-1.png","multi-factor-scoring":"/images/screenshots/cypherFuel-dashboard-2.png","ai-recommendations":"/images/screenshots/cypherFuel-dashboard-3.png","trip-section-analysis":"/images/screenshots/cypherFuel-dashboard-2.png","live-running-costs":"/images/screenshots/cypherFuel-dashboard-1.png","daily-comparisons":"/images/screenshots/cypherFuel-dashboard-3.png","detailed-reporting":"/images/screenshots/cypherFuel-dashboard-3.png","seamless-integration":"/images/screenshots/cypherFuel-dashboard-1.png"};function mC(){const[d,g]=Se.useState(By[0]);return R.jsxs(gr,{background:"alt",id:"features",className:"relative",children:[R.jsx(xa,{size:400,color:"primary",top:"10%",right:"-10%",opacity:.08,blur:100,animation:"float-slow"}),R.jsx(ti,{children:R.jsx(Bu,{label:"Features",title:"Everything you need to optimize fleet fuel consumption.",description:"From fuel monitoring to intelligent analytics and efficiency scoring, CypherFuel powers data-driven decisions that reduce costs and improve performance.",accentLine:!0})}),R.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 lg:gap-16 items-start",children:[R.jsx(ti,{direction:"left",delay:.1,children:R.jsx("div",{className:"space-y-2",children:By.map(T=>R.jsx(Ri.button,{onClick:()=>g(T),className:`w-full text-left p-5 rounded-xl transition-all duration-300 ${d.id===T.id?"bg-white dark:bg-dark-800 shadow-premium border border-primary/20 dark:border-primary/30":"bg-white/50 dark:bg-dark-800/20 hover:bg-white dark:hover:bg-dark-800/50 border border-transparent hover:border-dark-200 dark:hover:border-dark-700/50"}`,whileHover:{x:d.id===T.id?0:4},transition:{duration:.2},children:R.jsxs("div",{className:"flex items-start gap-4",children:[R.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 transition-all duration-300 ${d.id===T.id?"bg-primary text-white shadow-glow-sm":"bg-primary/10 dark:bg-primary/20 text-primary"}`,children:R.jsx(wn,{name:T.icon,size:24})}),R.jsxs("div",{className:"flex-1 min-w-0",children:[R.jsx("h3",{className:"font-semibold text-dark-900 dark:text-white mb-1",children:T.title}),R.jsx("p",{className:"text-sm text-dark-500 dark:text-dark-400 line-clamp-2",children:T.shortDescription})]}),R.jsx(Ri.div,{animate:{rotate:d.id===T.id?90:0},transition:{duration:.2},children:R.jsx(wn,{name:"arrow",size:20,className:`flex-shrink-0 transition-colors ${d.id===T.id?"text-primary":"text-dark-400 dark:text-dark-500"}`})})]})},T.id))})}),R.jsx(ti,{direction:"right",delay:.2,children:R.jsx("div",{className:"lg:sticky lg:top-24",children:R.jsx(C1,{mode:"wait",children:R.jsxs(Ri.div,{initial:{opacity:0,scale:.98,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.98,y:-10},transition:{duration:.3,ease:[.25,.1,.25,1]},className:"bg-white dark:bg-dark-800 rounded-2xl shadow-premium p-6 md:p-8 border border-dark-100 dark:border-dark-700/50",children:[R.jsxs("div",{className:"aspect-video rounded-xl mb-8 overflow-hidden bg-gradient-to-br from-dark-100 to-dark-50 dark:from-dark-700 dark:to-dark-800 relative",children:[jv[d.id]?R.jsx(Ri.img,{src:jv[d.id],alt:d.title,className:"w-full h-full object-cover",initial:{scale:1.05},animate:{scale:1},transition:{duration:.4}}):R.jsx("div",{className:"w-full h-full flex items-center justify-center",children:R.jsx(Ri.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:R.jsx(wn,{name:d.icon,size:80,className:"text-primary/30"})})}),R.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/10 to-transparent"})]}),R.jsx("h3",{className:"text-2xl font-bold text-dark-900 dark:text-white mb-4",children:d.title}),R.jsx("p",{className:"text-dark-600 dark:text-dark-300 mb-8 leading-relaxed text-lg",children:d.fullDescription}),R.jsx("ul",{className:"space-y-4 mb-8",children:d.benefits.slice(0,4).map((T,S)=>R.jsxs(Ri.li,{className:"flex items-start gap-3",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:S*.1},children:[R.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500/10 flex items-center justify-center flex-shrink-0 mt-0.5",children:R.jsx(wn,{name:"check",size:14,className:"text-green-500"})}),R.jsx("span",{className:"text-dark-600 dark:text-dark-300",children:T})]},S))}),R.jsxs("div",{className:"flex gap-4",children:[R.jsx(Ga,{as:"link",to:`/features/${d.id}`,variant:"outline",size:"md",children:"Learn More"}),R.jsx(Ga,{as:"link",to:"/schedule-demo",size:"md",children:"Schedule Demo"})]})]},d.id)})})})]}),R.jsx(ti,{delay:.3,children:R.jsx("div",{className:"text-center mt-16",children:R.jsxs(Ic,{to:"/features",className:"group inline-flex items-center gap-2 text-primary dark:text-primary-400 font-semibold text-lg hover:gap-3 transition-all",children:["View all features",R.jsx(wn,{name:"arrowRight",size:20,className:"transition-transform group-hover:translate-x-1"})]})})})]})}function gC(){return R.jsxs(gr,{background:"default",padding:"xl",className:"relative",children:[R.jsx(xa,{size:500,color:"primary",top:"-20%",right:"-10%",opacity:.15,blur:100,animation:"float-slow"}),R.jsx(xa,{size:400,color:"secondary",bottom:"-20%",left:"-10%",opacity:.12,blur:100,animation:"float-delayed",delay:1}),R.jsxs("div",{className:"relative text-center max-w-4xl mx-auto",children:[R.jsx(ti,{children:R.jsxs("div",{className:"flex items-center justify-center gap-4 mb-8",children:[R.jsx("div",{className:"h-px w-12 bg-gradient-to-r from-transparent to-primary"}),R.jsx("span",{className:"text-dark-500 dark:text-dark-400 text-sm font-medium tracking-wider uppercase",children:"Get Started"}),R.jsx("div",{className:"h-px w-12 bg-gradient-to-l from-transparent to-primary"})]})}),R.jsx(ti,{delay:.1,children:R.jsxs("h2",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-dark-900 dark:text-white mb-8 leading-tight text-balance",children:["Your Journey to"," ",R.jsx("span",{className:"gradient-text-hero",children:"Fuel Optimization"})," Begins Here"]})}),R.jsx(ti,{delay:.2,children:R.jsx("p",{className:"text-xl md:text-2xl text-dark-600 dark:text-dark-300 mb-12 max-w-2xl mx-auto leading-relaxed text-balance",children:"See how CypherFuel can transform your fleet's fuel efficiency. Request a demo and discover what's really driving your costs."})}),R.jsx(ti,{delay:.3,children:R.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-14",children:[R.jsxs(Ga,{as:"link",to:"/schedule-demo",size:"lg",className:"!px-10 !py-5 !text-lg animate-glow-pulse",children:["Request a Demo",R.jsx(wn,{name:"arrowRight",size:20,className:"ml-2"})]}),R.jsx(Ga,{as:"link",to:"/features",variant:"ghost",size:"lg",className:"!border !border-dark-300 dark:!border-white/20 !text-dark-900 dark:!text-white hover:!bg-dark-100 dark:hover:!bg-white/5 !px-10 !py-5 !text-lg",children:"Learn More"})]})}),R.jsx(ti,{delay:.4,children:R.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-8 text-dark-700 dark:text-dark-400",children:[R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500/20 flex items-center justify-center",children:R.jsx(wn,{name:"check",size:14,className:"text-green-400"})}),R.jsx("span",{children:"Free consultation"})]}),R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500/20 flex items-center justify-center",children:R.jsx(wn,{name:"check",size:14,className:"text-green-400"})}),R.jsx("span",{children:"Custom demo for your fleet"})]}),R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500/20 flex items-center justify-center",children:R.jsx(wn,{name:"check",size:14,className:"text-green-400"})}),R.jsx("span",{children:"Enterprise support"})]})]})})]})]})}function yC(){return R.jsxs(R.Fragment,{children:[R.jsx(QA,{}),R.jsx(JA,{}),R.jsx(iC,{}),R.jsx(rC,{}),R.jsx(sC,{}),R.jsx(lC,{}),R.jsx(mC,{}),R.jsx(uC,{}),R.jsx(dC,{}),R.jsx(gC,{})]})}const Bv={"real-time-analytics":"/images/screenshots/cypherFuel-dashboard-1.png","multi-factor-scoring":"/images/screenshots/cypherFuel-dashboard-2.png","ai-recommendations":"/images/screenshots/cypherFuel-dashboard-3.png","trip-section-analysis":"/images/screenshots/cypherFuel-dashboard-2.png","live-running-costs":"/images/screenshots/cypherFuel-dashboard-1.png","daily-comparisons":"/images/screenshots/cypherFuel-dashboard-3.png","detailed-reporting":"/images/screenshots/cypherFuel-dashboard-3.png","seamless-integration":"/images/screenshots/cypherFuel-dashboard-1.png"},_C=d=>d<2?"large":"default";function xC(){return R.jsxs(R.Fragment,{children:[R.jsxs(gr,{background:"default",padding:"lg",className:"relative",children:[R.jsx(xa,{size:600,color:"primary",top:"-20%",right:"-10%",opacity:.15,blur:100,animation:"float-slow"}),R.jsx(Ay,{shape:"square",size:100,top:"20%",left:"5%",rotate:12,opacity:.06,color:"primary"}),R.jsxs("div",{className:"text-center max-w-4xl mx-auto relative z-10",children:[R.jsx(ti,{children:R.jsxs("div",{className:"flex items-center justify-center gap-4 mb-8",children:[R.jsx("div",{className:"h-px w-12 bg-gradient-to-r from-transparent to-primary"}),R.jsx("span",{className:"text-dark-500 dark:text-dark-400 text-sm font-medium tracking-wider uppercase",children:"Features"}),R.jsx("div",{className:"h-px w-12 bg-gradient-to-l from-transparent to-primary"})]})}),R.jsx(ti,{delay:.1,children:R.jsxs("h1",{className:"text-5xl md:text-6xl lg:text-7xl font-bold text-dark-900 dark:text-white mb-8 leading-[1.1] tracking-tight text-balance",children:["Everything You Need to Optimize"," ",R.jsx("span",{className:"gradient-text-hero",children:"Fleet Fuel Efficiency"})]})}),R.jsx(ti,{delay:.2,children:R.jsx("p",{className:"text-xl md:text-2xl text-dark-600 dark:text-dark-300 max-w-2xl mx-auto text-balance",children:"Powerful analytics, intelligent insights, and seamless integrationall in one platform."})})]})]}),R.jsx(gr,{background:"default",padding:"lg",children:R.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:By.map((d,g)=>{const T=_C(g)==="large";return R.jsx(ti,{delay:g*.1,children:R.jsx(Ic,{to:`/features/${d.id}`,className:`group block h-full ${T?"lg:col-span-1 lg:row-span-1":""}`,children:R.jsxs(Ri.div,{className:`h-full rounded-2xl bg-dark-800/50 backdrop-blur-sm border border-dark-700/50 hover:border-primary/30 transition-colors duration-300 overflow-hidden ${T?"p-8":"p-6"}`,whileHover:{y:-4,boxShadow:"0 20px 40px -15px rgba(35, 122, 189, 0.15)"},transition:{duration:.25},children:[R.jsx("div",{className:`${T?"w-16 h-16":"w-14 h-14"} rounded-xl bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center text-primary mb-6 group-hover:from-primary group-hover:to-primary-600 group-hover:text-white group-hover:shadow-glow-sm transition-all duration-300`,children:R.jsx(wn,{name:d.icon,size:T?32:28})}),R.jsx("h3",{className:`${T?"text-2xl":"text-xl"} font-semibold text-dark-900 dark:text-white mb-3`,children:d.title}),R.jsx("p",{className:"text-dark-700 dark:text-dark-400 mb-6 leading-relaxed",children:d.shortDescription}),R.jsxs("span",{className:"inline-flex items-center text-primary-600 dark:text-primary-400 font-medium group-hover:gap-2 transition-all",children:["Learn more",R.jsx(wn,{name:"arrow",size:16,className:"ml-1 transition-transform group-hover:translate-x-1"})]})]})})},d.id)})})}),R.jsxs(gr,{background:"default",padding:"lg",className:"relative",children:[R.jsx(xa,{size:400,color:"mixed",bottom:"-20%",left:"50%",opacity:.1,blur:100,animation:"pulse"}),R.jsx("div",{className:"text-center max-w-2xl mx-auto relative z-10",children:R.jsxs(ti,{children:[R.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-dark-900 dark:text-white mb-4 text-balance",children:"Ready to see CypherFuel in action?"}),R.jsx("p",{className:"text-dark-600 dark:text-dark-300 text-lg mb-8",children:"Schedule a personalized demo to see how CypherFuel can optimize your fleet's fuel consumption."}),R.jsx(Ga,{as:"link",to:"/schedule-demo",size:"lg",className:"animate-glow-pulse",children:"Schedule a Demo"})]})})]})]})}function vC(){const{featureId:d}=a2(),g=d?fC(d):null;return g?R.jsxs(R.Fragment,{children:[R.jsxs(gr,{background:"default",padding:"lg",className:"relative",children:[R.jsx(xa,{size:500,color:"primary",top:"-10%",right:"-5%",opacity:.12,blur:100,animation:"float-slow"}),R.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center relative z-10",children:[R.jsxs("div",{children:[R.jsx(ti,{children:R.jsxs(Ic,{to:"/features",className:"inline-flex items-center text-primary-600 dark:text-primary-400 font-medium mb-6 hover:gap-2 transition-all",children:[R.jsx(wn,{name:"arrow",size:16,className:"mr-2 rotate-180"}),"All Features"]})}),R.jsx(ti,{delay:.1,children:R.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[R.jsx("div",{className:"w-16 h-16 rounded-xl bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center text-primary shadow-glow-sm",children:R.jsx(wn,{name:g.icon,size:32})}),R.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-dark-900 dark:text-white",children:g.title})]})}),R.jsx(ti,{delay:.2,children:R.jsx("p",{className:"text-xl text-dark-600 dark:text-dark-300 mb-8 leading-relaxed",children:g.fullDescription})}),R.jsx(ti,{delay:.3,children:R.jsx(Ga,{as:"link",to:"/schedule-demo",size:"lg",className:"animate-glow-pulse",children:"Schedule a Demo"})})]}),R.jsx(ti,{direction:"right",delay:.2,children:R.jsx(Ri.div,{className:"aspect-video rounded-2xl overflow-hidden bg-gradient-to-br from-dark-800 to-dark-700 border border-dark-700/50",whileHover:{scale:1.02},transition:{duration:.3},children:Bv[g.id]?R.jsx("img",{src:Bv[g.id],alt:g.title,className:"w-full h-full object-cover"}):R.jsx("div",{className:"w-full h-full flex items-center justify-center",children:R.jsx(wn,{name:g.icon,size:120,className:"text-primary/20"})})})})]})]}),R.jsxs(gr,{background:"default",padding:"lg",children:[R.jsx(Bu,{label:"Benefits",title:"Why choose this feature",align:"left",accentLine:!0}),R.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:g.benefits.map((T,S)=>R.jsx(ti,{delay:S*.1,children:R.jsxs(Ri.div,{className:"flex items-start gap-4 p-5 rounded-xl bg-dark-800/50 border border-dark-700/50",whileHover:{x:4,borderColor:"rgba(35, 122, 189, 0.3)"},transition:{duration:.2},children:[R.jsx("div",{className:"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:R.jsx(wn,{name:"check",size:16,className:"text-green-400"})}),R.jsx("span",{className:"text-dark-700 dark:text-dark-200",children:T})]})},S))})]}),R.jsxs(gr,{background:"default",padding:"lg",className:"relative",children:[R.jsx(xa,{size:300,color:"secondary",bottom:"-20%",right:"20%",opacity:.08,blur:80,animation:"pulse"}),R.jsx("div",{className:"text-center max-w-2xl mx-auto relative z-10",children:R.jsxs(ti,{children:[R.jsxs("h2",{className:"text-2xl md:text-3xl font-bold text-dark-900 dark:text-white mb-4",children:["See ",g.title," in action"]}),R.jsx("p",{className:"text-dark-600 dark:text-dark-300 mb-8",children:"Schedule a personalized demo to see how this feature can help optimize your fuel consumption."}),R.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[R.jsx(Ga,{as:"link",to:"/schedule-demo",size:"lg",children:"Schedule a Demo"}),R.jsx(Ga,{as:"link",to:"/features",variant:"outline",size:"lg",children:"Explore Other Features"})]})]})})]})]}):R.jsx(gr,{background:"default",padding:"lg",children:R.jsxs("div",{className:"text-center",children:[R.jsx("h1",{className:"text-3xl font-bold text-dark-900 dark:text-white mb-4",children:"Feature not found"}),R.jsx(Ga,{as:"link",to:"/features",children:"View all features"})]})})}const bC="https://docs.google.com/forms/d/e/1FAIpQLSeG8OJMvTxpZg-2OU-IVIbUoJSsa5X2oe2PNb5Vf1zTkoSluA/formResponse",nf={firstName:"entry.1085986904",lastName:"entry.1177015433",email:"entry.1997236169",company:"entry.1137452985",phone:"entry.511575629",fleetSize:"entry.97601548",message:"entry.2073793653"},wC=[{icon:"shield",text:"Enterprise Security"},{icon:"globe",text:"99.9% Uptime SLA"},{icon:"users",text:"Dedicated Support"}];function TC(){const[d,g]=Se.useState({firstName:"",lastName:"",email:"",company:"",phone:"",fleetSize:1e3,message:""}),[T,S]=Se.useState(!1),[I,B]=Se.useState(!1),[M,c]=Se.useState(null),V=async K=>{K.preventDefault(),S(!0),c(null);try{const te=new FormData;te.append(nf.firstName,d.firstName),te.append(nf.lastName,d.lastName),te.append(nf.email,d.email),te.append(nf.company,d.company),te.append(nf.phone,d.phone),te.append(nf.fleetSize,d.fleetSize.toString()),te.append(nf.message,d.message),await fetch(bC,{method:"POST",mode:"no-cors",body:te}),B(!0)}catch(te){console.error("Form submission error:",te),c("There was an error submitting the form. Please try again or contact us directly.")}finally{S(!1)}},X=(K,te)=>{g(de=>({...de,[K]:te}))};return I?R.jsx(gr,{background:"default",padding:"lg",children:R.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[R.jsx(Ri.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",duration:.5},className:"w-20 h-20 rounded-full bg-green-500/20 flex items-center justify-center mx-auto mb-6",children:R.jsx(wn,{name:"check",size:40,className:"text-green-400"})}),R.jsxs(ti,{children:[R.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Thank you for your interest!"}),R.jsx("p",{className:"text-xl text-dark-300 mb-8",children:"We've received your demo request and will be in touch within 24 hours to schedule a personalized demonstration of CypherFuel."}),R.jsx(Ga,{as:"link",to:"/",variant:"outline",children:"Return to Home"})]})]})}):R.jsx(R.Fragment,{children:R.jsx(gr,{background:"default",padding:"lg",children:R.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-16 items-start",children:[R.jsxs("div",{className:"lg:sticky lg:top-24",children:[R.jsxs(ti,{children:[R.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[R.jsx("div",{className:"h-px w-12 bg-gradient-to-r from-primary to-secondary"}),R.jsx("span",{className:"text-dark-400 text-sm font-medium tracking-wider uppercase",children:"Schedule a Demo"})]}),R.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white mb-6",children:"See CypherFuel in action"}),R.jsx("p",{className:"text-xl text-dark-300 mb-8 leading-relaxed",children:"Schedule a personalized demo to discover how CypherFuel can optimize your fleet's fuel consumption with data-driven insights."})]}),R.jsx(ti,{delay:.1,children:R.jsx("div",{className:"space-y-4 mb-10",children:["Live demo tailored to your fleet size","See all fuel optimization features in action","Get pricing for your specific needs","Q&A with fuel efficiency experts"].map((K,te)=>R.jsxs("div",{className:"flex items-center gap-3",children:[R.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500/20 flex items-center justify-center",children:R.jsx(wn,{name:"check",size:14,className:"text-green-400"})}),R.jsx("span",{className:"text-dark-300",children:K})]},te))})}),R.jsx(ti,{delay:.2,children:R.jsx("div",{className:"grid grid-cols-3 gap-4",children:wC.map(K=>R.jsxs("div",{className:"text-center p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[R.jsx(wn,{name:K.icon,size:24,className:"text-primary-400 mx-auto mb-2"}),R.jsx("span",{className:"text-xs text-dark-400",children:K.text})]},K.text))})})]}),R.jsx(ti,{direction:"right",delay:.1,children:R.jsx("div",{className:"bg-dark-800/50 backdrop-blur-sm rounded-2xl p-8 border border-dark-700/50",children:R.jsxs("form",{onSubmit:V,className:"space-y-6",children:[R.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[R.jsxs("div",{children:[R.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-dark-200 mb-2",children:"First Name *"}),R.jsx("input",{type:"text",id:"firstName",required:!0,value:d.firstName,onChange:K=>X("firstName",K.target.value),className:"w-full px-4 py-3 rounded-lg border border-dark-700/50 bg-dark-900/50 text-white placeholder-dark-500 focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary/50 transition-all",placeholder:"John"})]}),R.jsxs("div",{children:[R.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-dark-200 mb-2",children:"Last Name *"}),R.jsx("input",{type:"text",id:"lastName",required:!0,value:d.lastName,onChange:K=>X("lastName",K.target.value),className:"w-full px-4 py-3 rounded-lg border border-dark-700/50 bg-dark-900/50 text-white placeholder-dark-500 focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary/50 transition-all",placeholder:"Doe"})]})]}),R.jsxs("div",{children:[R.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-dark-200 mb-2",children:"Work Email *"}),R.jsx("input",{type:"email",id:"email",required:!0,value:d.email,onChange:K=>X("email",K.target.value),className:"w-full px-4 py-3 rounded-lg border border-dark-700/50 bg-dark-900/50 text-white placeholder-dark-500 focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary/50 transition-all",placeholder:"john@company.com"})]}),R.jsxs("div",{children:[R.jsx("label",{htmlFor:"company",className:"block text-sm font-medium text-dark-200 mb-2",children:"Company *"}),R.jsx("input",{type:"text",id:"company",required:!0,value:d.company,onChange:K=>X("company",K.target.value),className:"w-full px-4 py-3 rounded-lg border border-dark-700/50 bg-dark-900/50 text-white placeholder-dark-500 focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary/50 transition-all",placeholder:"Acme Logistics"})]}),R.jsxs("div",{children:[R.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-dark-200 mb-2",children:"Phone Number"}),R.jsx("input",{type:"tel",id:"phone",value:d.phone,onChange:K=>X("phone",K.target.value),className:"w-full px-4 py-3 rounded-lg border border-dark-700/50 bg-dark-900/50 text-white placeholder-dark-500 focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary/50 transition-all",placeholder:"+1 (555) 000-0000"})]}),R.jsx("div",{children:R.jsx(WA,{value:d.fleetSize,onChange:K=>X("fleetSize",K),min:300,max:1e5,step:100})}),R.jsxs("div",{children:[R.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-dark-200 mb-2",children:"Additional Information"}),R.jsx("textarea",{id:"message",rows:4,value:d.message,onChange:K=>X("message",K.target.value),className:"w-full px-4 py-3 rounded-lg border border-dark-700/50 bg-dark-900/50 text-white placeholder-dark-500 focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary/50 transition-all resize-none",placeholder:"Tell us about your fuel optimization challenges..."})]}),M&&R.jsx("div",{className:"p-4 rounded-lg bg-red-500/10 border border-red-500/30 text-red-400 text-sm",children:M}),R.jsx(Ga,{type:"submit",size:"lg",className:"w-full",isLoading:T,children:T?"Submitting...":"Request Demo"}),R.jsxs("p",{className:"text-xs text-center text-dark-500",children:["By submitting this form, you agree to our"," ",R.jsx(Ic,{to:"/privacy",className:"text-primary-400 hover:underline",children:"Privacy Policy"})," ","and"," ",R.jsx(Ic,{to:"/terms",className:"text-primary-400 hover:underline",children:"Terms of Service"}),"."]})]})})})]})})})}function SC(){return R.jsx(gr,{background:"default",padding:"lg",children:R.jsx(Uh,{children:R.jsx(ti,{children:R.jsxs("div",{className:"max-w-4xl mx-auto",children:[R.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white mb-8",children:"Privacy Policy"}),R.jsx("p",{className:"text-dark-400 mb-8",children:"Last updated: January 2026"}),R.jsx("div",{className:"prose prose-invert prose-lg max-w-none",children:R.jsxs("div",{className:"space-y-8 text-dark-300",children:[R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"1. Introduction"}),R.jsx("p",{children:'CypherFuel ("we," "our," or "us") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our fuel optimization platform and related services.'})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"2. Information We Collect"}),R.jsx("h3",{className:"text-xl font-medium text-white mb-3",children:"2.1 Information You Provide"}),R.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[R.jsx("li",{children:"Account information (name, email, company name, phone number)"}),R.jsx("li",{children:"Billing and payment information"}),R.jsx("li",{children:"Vehicle and driver information you input into the platform"}),R.jsx("li",{children:"Communications with our support team"})]}),R.jsx("h3",{className:"text-xl font-medium text-white mb-3 mt-6",children:"2.2 Information Collected Automatically"}),R.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[R.jsx("li",{children:"Vehicle telemetry data (GPS location, speed, fuel levels, diagnostics)"}),R.jsx("li",{children:"Device information and usage analytics"}),R.jsx("li",{children:"Log data and cookies"})]})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"3. How We Use Your Information"}),R.jsx("p",{children:"We use the collected information to:"}),R.jsxs("ul",{className:"list-disc pl-6 space-y-2 mt-3",children:[R.jsx("li",{children:"Provide and maintain our fuel optimization services"}),R.jsx("li",{children:"Process transactions and send related information"}),R.jsx("li",{children:"Send administrative information and service updates"}),R.jsx("li",{children:"Respond to inquiries and provide customer support"}),R.jsx("li",{children:"Improve our platform and develop new features"}),R.jsx("li",{children:"Ensure security and prevent fraud"}),R.jsx("li",{children:"Comply with legal obligations"})]})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"4. Data Sharing and Disclosure"}),R.jsx("p",{children:"We may share your information with:"}),R.jsxs("ul",{className:"list-disc pl-6 space-y-2 mt-3",children:[R.jsxs("li",{children:[R.jsx("strong",{children:"Service providers:"})," Third parties who assist in operating our platform"]}),R.jsxs("li",{children:[R.jsx("strong",{children:"Business partners:"})," With your consent, for integrated services"]}),R.jsxs("li",{children:[R.jsx("strong",{children:"Legal requirements:"})," When required by law or to protect our rights"]}),R.jsxs("li",{children:[R.jsx("strong",{children:"Business transfers:"})," In connection with mergers or acquisitions"]})]}),R.jsx("p",{className:"mt-4",children:"We do not sell your personal information to third parties."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"5. Data Security"}),R.jsx("p",{children:"We implement industry-standard security measures to protect your data, including encryption in transit and at rest, access controls, and regular security audits. However, no method of transmission over the Internet is 100% secure."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"6. Data Retention"}),R.jsx("p",{children:"We retain your information for as long as your account is active or as needed to provide services. Telemetry data retention periods are configurable based on your subscription plan. You may request deletion of your data subject to legal retention requirements."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"7. Your Rights"}),R.jsx("p",{children:"Depending on your location, you may have the right to:"}),R.jsxs("ul",{className:"list-disc pl-6 space-y-2 mt-3",children:[R.jsx("li",{children:"Access and receive a copy of your personal data"}),R.jsx("li",{children:"Rectify inaccurate personal data"}),R.jsx("li",{children:"Request deletion of your personal data"}),R.jsx("li",{children:"Object to or restrict processing of your data"}),R.jsx("li",{children:"Data portability"}),R.jsx("li",{children:"Withdraw consent at any time"})]})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"8. International Data Transfers"}),R.jsx("p",{children:"Your information may be transferred to and processed in countries other than your own. We ensure appropriate safeguards are in place for such transfers in compliance with applicable data protection laws."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"9. Children's Privacy"}),R.jsx("p",{children:"Our services are not intended for individuals under 18 years of age. We do not knowingly collect personal information from children."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"10. Changes to This Policy"}),R.jsx("p",{children:'We may update this Privacy Policy from time to time. We will notify you of any material changes by posting the new policy on this page and updating the "Last updated" date.'})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"11. Contact Us"}),R.jsx("p",{children:"If you have questions about this Privacy Policy or our data practices, please contact us at:"}),R.jsxs("p",{className:"mt-3",children:[R.jsx("strong",{children:"Email:"})," privacy@cypherfuel.com",R.jsx("br",{}),R.jsx("strong",{children:"Address:"})," CypherFuel, Johannesburg, South Africa"]})]})]})})]})})})})}function MC(){return R.jsx(gr,{background:"default",padding:"lg",children:R.jsx(Uh,{children:R.jsx(ti,{children:R.jsxs("div",{className:"max-w-4xl mx-auto",children:[R.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white mb-8",children:"Terms of Service"}),R.jsx("p",{className:"text-dark-400 mb-8",children:"Last updated: January 2026"}),R.jsx("div",{className:"prose prose-invert prose-lg max-w-none",children:R.jsxs("div",{className:"space-y-8 text-dark-300",children:[R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"1. Acceptance of Terms"}),R.jsx("p",{children:`By accessing or using CypherFuel's fleet management platform and services ("Services"), you agree to be bound by these Terms of Service ("Terms"). If you do not agree to these Terms, do not use our Services.`})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"2. Description of Services"}),R.jsx("p",{children:"CypherFuel provides a cloud-based fuel optimization platform that includes fuel monitoring, telemetry analytics, efficiency scoring, trip analysis, and related services. The specific features available to you depend on your subscription plan."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"3. Account Registration"}),R.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[R.jsx("li",{children:"You must provide accurate and complete registration information"}),R.jsx("li",{children:"You are responsible for maintaining the confidentiality of your account credentials"}),R.jsx("li",{children:"You must notify us immediately of any unauthorized use of your account"}),R.jsx("li",{children:"You are responsible for all activities that occur under your account"})]})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"4. Acceptable Use"}),R.jsx("p",{children:"You agree not to:"}),R.jsxs("ul",{className:"list-disc pl-6 space-y-2 mt-3",children:[R.jsx("li",{children:"Use the Services for any unlawful purpose"}),R.jsx("li",{children:"Violate any applicable laws, regulations, or third-party rights"}),R.jsx("li",{children:"Attempt to gain unauthorized access to our systems or networks"}),R.jsx("li",{children:"Interfere with or disrupt the integrity or performance of the Services"}),R.jsx("li",{children:"Reverse engineer, decompile, or disassemble any part of the Services"}),R.jsx("li",{children:"Use the Services to track individuals without proper consent or legal authority"}),R.jsx("li",{children:"Share your account credentials with unauthorized parties"})]})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"5. Data Ownership and Privacy"}),R.jsx("p",{children:"You retain ownership of all data you input into the platform. By using our Services, you grant us a license to process your data as necessary to provide the Services. Our collection and use of personal information is governed by our Privacy Policy."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"6. Payment Terms"}),R.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[R.jsx("li",{children:"Fees are based on your selected subscription plan"}),R.jsx("li",{children:"Payment is due according to your billing cycle (monthly or annually)"}),R.jsx("li",{children:"All fees are non-refundable unless otherwise specified"}),R.jsx("li",{children:"We may change our fees with 30 days' notice"}),R.jsx("li",{children:"Failure to pay may result in suspension or termination of Services"})]})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"7. Service Availability"}),R.jsx("p",{children:"We strive to maintain high availability but do not guarantee uninterrupted access to the Services. We may perform scheduled maintenance with advance notice. We are not liable for any downtime or service interruptions beyond our reasonable control."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"8. Intellectual Property"}),R.jsx("p",{children:"The Services, including all software, designs, text, graphics, and other content, are owned by CypherFuel and protected by intellectual property laws. You are granted a limited, non-exclusive license to use the Services for your internal business purposes only."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"9. Limitation of Liability"}),R.jsx("p",{children:"TO THE MAXIMUM EXTENT PERMITTED BY LAW, CYPHERVIEW SHALL NOT BE LIABLE FOR ANY INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES, INCLUDING LOSS OF PROFITS, DATA, OR BUSINESS OPPORTUNITIES, ARISING OUT OF OR RELATED TO YOUR USE OF THE SERVICES."}),R.jsx("p",{className:"mt-4",children:"Our total liability for any claims arising under these Terms shall not exceed the amount you paid for the Services in the twelve (12) months preceding the claim."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"10. Indemnification"}),R.jsx("p",{children:"You agree to indemnify and hold harmless CypherFuel and its officers, directors, employees, and agents from any claims, damages, losses, or expenses arising from your use of the Services, violation of these Terms, or infringement of any third-party rights."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"11. Termination"}),R.jsx("p",{children:"Either party may terminate these Terms with 30 days' written notice. We may suspend or terminate your access immediately if you breach these Terms. Upon termination, your right to use the Services ceases, and we may delete your data after a reasonable retention period."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"12. Changes to Terms"}),R.jsx("p",{children:"We may modify these Terms at any time. Material changes will be notified via email or through the platform. Continued use of the Services after changes constitutes acceptance of the modified Terms."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"13. Governing Law"}),R.jsx("p",{children:"These Terms are governed by the laws of South Africa. Any disputes shall be resolved in the courts of Johannesburg, South Africa, unless otherwise required by applicable law."})]}),R.jsxs("section",{children:[R.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"14. Contact Information"}),R.jsx("p",{children:"For questions about these Terms, please contact us at:"}),R.jsxs("p",{className:"mt-3",children:[R.jsx("strong",{children:"Email:"})," legal@cypherfuel.com",R.jsx("br",{}),R.jsx("strong",{children:"Address:"})," CypherFuel, Johannesburg, South Africa"]})]})]})})]})})})})}function EC(){return R.jsx(b2,{children:R.jsxs(Bh,{element:R.jsx($A,{}),children:[R.jsx(Bh,{path:"/",element:R.jsx(yC,{})}),R.jsx(Bh,{path:"/features",element:R.jsx(xC,{})}),R.jsx(Bh,{path:"/features/:featureId",element:R.jsx(vC,{})}),R.jsx(Bh,{path:"/schedule-demo",element:R.jsx(TC,{})}),R.jsx(Bh,{path:"/privacy",element:R.jsx(SC,{})}),R.jsx(Bh,{path:"/terms",element:R.jsx(MC,{})})]})})}xw.createRoot(document.getElementById("root")).render(R.jsx(hw.StrictMode,{children:R.jsx(Z2,{children:R.jsx(EC,{})})}));
